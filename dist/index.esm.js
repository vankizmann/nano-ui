!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("nano-js"),require("vue")):"function"==typeof define&&define.amd?define(["nano-js","vue"],e):"object"==typeof exports?exports["nano-ui"]=e(require("nano-js"),require("vue")):t["nano-ui"]=e(t.Nano,t.Vue)}(window,(function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(e,n){e.exports=t},function(t,e,n){"use strict";n.r(e),n.d(e,"AllSelection",(function(){return f})),n.d(e,"EditorState",(function(){return k})),n.d(e,"NodeSelection",(function(){return h})),n.d(e,"Plugin",(function(){return O})),n.d(e,"PluginKey",(function(){return T})),n.d(e,"Selection",(function(){return s})),n.d(e,"SelectionRange",(function(){return c})),n.d(e,"TextSelection",(function(){return l})),n.d(e,"Transaction",(function(){return g}));var r=n(2),o=n(5),i=Object.create(null),s=function(t,e,n){this.ranges=n||[new c(t.min(e),t.max(e))],this.$anchor=t,this.$head=e},a={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};a.anchor.get=function(){return this.$anchor.pos},a.head.get=function(){return this.$head.pos},a.from.get=function(){return this.$from.pos},a.to.get=function(){return this.$to.pos},a.$from.get=function(){return this.ranges[0].$from},a.$to.get=function(){return this.ranges[0].$to},a.empty.get=function(){for(var t=this.ranges,e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0},s.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},s.prototype.replace=function(t,e){void 0===e&&(e=r.i.empty);for(var n=e.content.lastChild,o=null,i=0;i<e.openEnd;i++)o=n,n=n.lastChild;for(var s=t.steps.length,a=this.ranges,c=0;c<a.length;c++){var l=a[c],u=l.$from,h=l.$to,p=t.mapping.slice(s);t.replaceRange(p.map(u.pos),p.map(h.pos),c?r.i.empty:e),0==c&&m(t,s,(n?n.isInline:o&&o.isTextblock)?-1:1)}},s.prototype.replaceWith=function(t,e){for(var n=t.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],s=i.$from,a=i.$to,c=t.mapping.slice(n),l=c.map(s.pos),u=c.map(a.pos);o?t.deleteRange(l,u):(t.replaceRangeWith(l,u,e),m(t,n,e.isInline?-1:1))}},s.findFrom=function(t,e,n){var r=t.parent.inlineContent?new l(t):v(t.node(0),t.parent,t.pos,t.index(),e,n);if(r)return r;for(var o=t.depth-1;o>=0;o--){var i=e<0?v(t.node(0),t.node(o),t.before(o+1),t.index(o),e,n):v(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,e,n);if(i)return i}},s.near=function(t,e){return void 0===e&&(e=1),this.findFrom(t,e)||this.findFrom(t,-e)||new f(t.node(0))},s.atStart=function(t){return v(t,t,0,0,1)||new f(t)},s.atEnd=function(t){return v(t,t,t.content.size,t.childCount,-1)||new f(t)},s.fromJSON=function(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=i[e.type];if(!n)throw new RangeError("No selection type "+e.type+" defined");return n.fromJSON(t,e)},s.jsonID=function(t,e){if(t in i)throw new RangeError("Duplicate use of selection JSON ID "+t);return i[t]=e,e.prototype.jsonID=t,e},s.prototype.getBookmark=function(){return l.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(s.prototype,a),s.prototype.visible=!0;var c=function(t,e){this.$from=t,this.$to=e},l=function(t){function e(e,n){void 0===n&&(n=e),t.call(this,e,n)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return t.near(o);var i=n.resolve(r.map(this.anchor));return new e(i.parent.inlineContent?i:o,o)},e.prototype.replace=function(e,n){if(void 0===n&&(n=r.i.empty),t.prototype.replace.call(this,e,n),n==r.i.empty){var o=this.$from.marksAcross(this.$to);o&&e.ensureMarks(o)}},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor&&t.head==this.head},e.prototype.getBookmark=function(){return new u(this.anchor,this.head)},e.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,e,n){void 0===n&&(n=e);var r=t.resolve(e);return new this(r,n==e?r:t.resolve(n))},e.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=t.findFrom(r,o,!0)||t.findFrom(r,-o,!0);if(!s)return t.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i||(n=(t.findFrom(n,-o,!0)||t.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new e(n,r)},Object.defineProperties(e.prototype,n),e}(s);s.jsonID("text",l);var u=function(t,e){this.anchor=t,this.head=e};u.prototype.map=function(t){return new u(t.map(this.anchor),t.map(this.head))},u.prototype.resolve=function(t){return l.between(t.resolve(this.anchor),t.resolve(this.head))};var h=function(t){function e(e){var n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);t.call(this,e,r),this.node=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?t.near(a):new e(a)},e.prototype.content=function(){return new r.i(r.c.from(this.node),0,0)},e.prototype.eq=function(t){return t instanceof e&&t.anchor==this.anchor},e.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},e.prototype.getBookmark=function(){return new p(this.anchor)},e.fromJSON=function(t,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new e(t.resolve(n.anchor))},e.create=function(t,e){return new this(t.resolve(e))},e.isSelectable=function(t){return!t.isText&&!1!==t.type.spec.selectable},e}(s);h.prototype.visible=!1,s.jsonID("node",h);var p=function(t){this.anchor=t};p.prototype.map=function(t){var e=t.mapResult(this.anchor),n=e.deleted,r=e.pos;return n?new u(r,r):new p(r)},p.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=e.nodeAfter;return n&&h.isSelectable(n)?new h(e):s.near(e)};var f=function(t){function e(e){t.call(this,e.resolve(0),e.resolve(e.content.size))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.toJSON=function(){return{type:"all"}},e.fromJSON=function(t){return new e(t)},e.prototype.map=function(t){return new e(t)},e.prototype.eq=function(t){return t instanceof e},e.prototype.getBookmark=function(){return d},e}(s);s.jsonID("all",f);var d={map:function(){return this},resolve:function(t){return new f(t)}};function v(t,e,n,r,o,i){if(e.inlineContent)return l.create(t,n);for(var s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){var a=e.child(s);if(a.isAtom){if(!i&&h.isSelectable(a))return h.create(t,n-(o<0?a.nodeSize:0))}else{var c=v(t,a,n+o,o<0?a.childCount:0,o,i);if(c)return c}n+=a.nodeSize*o}}function m(t,e,n){var r=t.steps.length-1;if(!(r<e)){var i,a=t.steps[r];if(a instanceof o.c||a instanceof o.b)t.mapping.maps[r].forEach((function(t,e,n,r){null==i&&(i=r)})),t.setSelection(s.near(t.doc.resolve(i),n))}}var g=function(t){function e(e){t.call(this,e.doc),this.time=Date.now(),this.curSelection=e.selection,this.curSelectionFor=0,this.storedMarks=e.storedMarks,this.updated=0,this.meta=Object.create(null)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},e.prototype.setSelection=function(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},e.prototype.setStoredMarks=function(t){return this.storedMarks=t,this.updated|=2,this},e.prototype.ensureMarks=function(t){return r.d.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this},e.prototype.addStoredMark=function(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))},e.prototype.removeStoredMark=function(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},e.prototype.addStep=function(e,n){t.prototype.addStep.call(this,e,n),this.updated=-3&this.updated,this.storedMarks=null},e.prototype.setTime=function(t){return this.time=t,this},e.prototype.replaceSelection=function(t){return this.selection.replace(this,t),this},e.prototype.replaceSelectionWith=function(t,e){var n=this.selection;return!1!==e&&(t=t.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||r.d.none))),n.replaceWith(this,t),this},e.prototype.deleteSelection=function(){return this.selection.replace(this),this},e.prototype.insertText=function(t,e,n){void 0===n&&(n=e);var r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();if(!t)return this.deleteRange(e,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(e);o=n==e?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(e,n,r.text(t,o)),this.selection.empty||this.setSelection(s.near(this.selection.$to)),this},e.prototype.setMeta=function(t,e){return this.meta["string"==typeof t?t:t.key]=e,this},e.prototype.getMeta=function(t){return this.meta["string"==typeof t?t:t.key]},n.isGeneric.get=function(){for(var t in this.meta)return!1;return!0},e.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(e.prototype,n),e}(o.d);function y(t,e){return e&&t?t.bind(e):t}var b=function(t,e,n){this.name=t,this.init=y(e.init,n),this.apply=y(e.apply,n)},w=[new b("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new b("selection",{init:function(t,e){return t.selection||s.atStart(e.doc)},apply:function(t){return t.selection}}),new b("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new b("scrollToSelection",{init:function(){return 0},apply:function(t,e){return t.scrolledIntoView?e+1:e}})],x=function(t,e){var n=this;this.schema=t,this.fields=w.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),e&&e.forEach((function(t){if(n.pluginsByKey[t.key])throw new RangeError("Adding different instances of a keyed plugin ("+t.key+")");n.plugins.push(t),n.pluginsByKey[t.key]=t,t.spec.state&&n.fields.push(new b(t.key,t.spec.state,t))}))},k=function(t){this.config=t},S={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};S.schema.get=function(){return this.config.schema},S.plugins.get=function(){return this.config.plugins},k.prototype.apply=function(t){return this.applyTransaction(t).state},k.prototype.filterTransaction=function(t,e){void 0===e&&(e=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=e){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,t,this))return!1}return!0},k.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var e=[t],n=this.applyInner(t),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var s=this.config.plugins[i];if(s.spec.appendTransaction){var a=r?r[i].n:0,c=r?r[i].state:this,l=a<e.length&&s.spec.appendTransaction.call(s,a?e.slice(a):e,c,n);if(l&&n.filterTransaction(l,i)){if(l.setMeta("appendedTransaction",t),!r){r=[];for(var u=0;u<this.config.plugins.length;u++)r.push(u<i?{state:n,n:e.length}:{state:this,n:0})}e.push(l),n=n.applyInner(l),o=!0}r&&(r[i]={state:n,n:e.length})}}if(!o)return{state:n,transactions:e}}},k.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var e=new k(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];e[o.name]=o.apply(t,this[o.name],this,e)}for(var i=0;i<C.length;i++)C[i](this,t,e);return e},S.tr.get=function(){return new g(this)},k.create=function(t){for(var e=new x(t.schema||t.doc.type.schema,t.plugins),n=new k(e),r=0;r<e.fields.length;r++)n[e.fields[r].name]=e.fields[r].init(t,n);return n},k.prototype.reconfigure=function(t){for(var e=new x(t.schema||this.schema,t.plugins),n=e.fields,r=new k(e),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(t,r)}return r},k.prototype.toJSON=function(t){var e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map((function(t){return t.toJSON()}))),t&&"object"==typeof t)for(var n in t){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=t[n],o=r.spec.state;o&&o.toJSON&&(e[n]=o.toJSON.call(r,this[r.key]))}return e},k.fromJSON=function(t,e,n){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var o=new x(t.schema,t.plugins),i=new k(o);return o.fields.forEach((function(o){if("doc"==o.name)i.doc=r.f.fromJSON(t.schema,e.doc);else if("selection"==o.name)i.selection=s.fromJSON(i.doc,e.selection);else if("storedMarks"==o.name)e.storedMarks&&(i.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(n)for(var a in n){var c=n[a],l=c.spec.state;if(c.key==o.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(e,a))return void(i[o.name]=l.fromJSON.call(c,t,e[a],i))}i[o.name]=o.init(t,i)}})),i},k.addApplyListener=function(t){C.push(t)},k.removeApplyListener=function(t){var e=C.indexOf(t);e>-1&&C.splice(e,1)},Object.defineProperties(k.prototype,S);var C=[];var O=function(t){this.props={},t.props&&function t(e,n,r){for(var o in e){var i=e[o];i instanceof Function?i=i.bind(n):"handleDOMEvents"==o&&(i=t(i,n,{})),r[o]=i}return r}(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:M("plugin")};O.prototype.getState=function(t){return t[this.key]};var N=Object.create(null);function M(t){return t in N?t+"$"+ ++N[t]:(N[t]=0,t+"$")}var T=function(t){void 0===t&&(t="key"),this.key=M(t)};T.prototype.get=function(t){return t.config.pluginsByKey[this.key]},T.prototype.getState=function(t){return t[this.key]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return Q})),n.d(e,"b",(function(){return ut})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return Y})),n.d(e,"f",(function(){return T})),n.d(e,"g",(function(){return O})),n.d(e,"h",(function(){return u})),n.d(e,"i",(function(){return h}));var r=n(8);var o=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},i={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};o.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},o.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},o.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},o.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)r.push(t.content[i]);return new o(r,this.size+t.size)},o.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;c>t&&((s<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-s),Math.min(a.text.length,e-s)):a.cut(Math.max(0,t-s-1),Math.min(a.content.size,e-s-1))),n.push(a),r+=a.nodeSize),s=c}return new o(n,r)},o.prototype.cutByIndex=function(t,e){return t==e?o.empty:0==t&&e==this.content.length?this:new o(this.content.slice(t,e))},o.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),i=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new o(r,i)},o.prototype.addToStart=function(t){return new o([t].concat(this.content),this.size+t.nodeSize)},o.prototype.addToEnd=function(t){return new o(this.content.concat(t),this.size+t.nodeSize)},o.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},i.firstChild.get=function(){return this.content.length?this.content[0]:null},i.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},i.childCount.get=function(){return this.content.length},o.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},o.prototype.maybeChild=function(t){return this.content[t]},o.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},o.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},o.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},o.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return a(0,t);if(t==this.size)return a(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?a(n+1,o):a(n,r);r=o}},o.prototype.toString=function(){return"<"+this.toStringInner()+">"},o.prototype.toStringInner=function(){return this.content.join(", ")},o.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},o.fromJSON=function(t,e){if(!e)return o.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new o(e.map(t.nodeFromJSON))},o.fromArray=function(t){if(!t.length)return o.empty;for(var e,n=0,r=0;r<t.length;r++){var i=t[r];n+=i.nodeSize,r&&i.isText&&t[r-1].sameMarkup(i)?(e||(e=t.slice(0,r)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new o(e||t,n)},o.from=function(t){if(!t)return o.empty;if(t instanceof o)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new o([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(o.prototype,i);var s={index:0,offset:0};function a(t,e){return s.index=t,s.offset=e,s}function c(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!c(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&c(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}o.empty=new o([],0);var l=function(t,e){this.type=t,this.attrs=e};function u(t){var e=Error.call(this,t);return e.__proto__=u.prototype,e}l.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},l.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},l.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},l.prototype.eq=function(t){return this==t||this.type==t.type&&c(this.attrs,t.attrs)},l.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},l.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},l.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},l.setFrom=function(t){if(!t||0==t.length)return l.none;if(t instanceof l)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},l.none=[],u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,u.prototype.name="ReplaceError";var h=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},p={size:{configurable:!0}};function f(t,e,n){if(n.openStart>t.depth)throw new u("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new u("Inconsistent open depths");return function t(e,n,r,i){var s=e.index(i),a=e.node(i);if(s==n.index(i)&&i<e.depth-r.openStart){var c=t(e,n,r,i+1);return a.copy(a.content.replaceChild(s,c))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=i||n.depth!=i){var l=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),i=n-1;i>=0;i--)r=e.node(i).copy(o.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),u=l.start,h=l.end;return y(a,function t(e,n,r,i,s){var a=e.depth>s&&v(e,n,s+1),c=i.depth>s&&v(r,i,s+1),l=[];g(null,e,s,l),a&&c&&n.index(s)==r.index(s)?(d(a,c),m(y(a,t(e,n,r,i,s+1)),l)):(a&&m(y(a,b(e,n,s+1)),l),g(n,r,s,l),c&&m(y(c,b(r,i,s+1)),l));return g(i,null,s,l),new o(l)}(e,u,h,n,i))}var p=e.parent,f=p.content;return y(p,f.cut(0,e.parentOffset).append(r.content).append(f.cut(n.parentOffset)))}return y(a,b(e,n,i))}(t,e,n,0)}function d(t,e){if(!e.type.compatibleContent(t.type))throw new u("Cannot join "+e.type.name+" onto "+t.type.name)}function v(t,e,n){var r=t.node(n);return d(r,e.node(n)),r}function m(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function g(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(m(t.nodeAfter,r),i++));for(var a=i;a<s;a++)m(o.child(a),r);e&&e.depth==n&&e.textOffset&&m(e.nodeBefore,r)}function y(t,e){if(!t.type.validContent(e))throw new u("Invalid content for node "+t.type.name);return t.copy(e)}function b(t,e,n){var r=[];(g(null,t,n,r),t.depth>n)&&m(y(v(t,e,n+1),b(t,e,n+1)),r);return g(e,null,n,r),new o(r)}p.size.get=function(){return this.content.size-this.openStart-this.openEnd},h.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new h(n,this.openStart,this.openEnd)},h.prototype.removeBetween=function(t,e){return new h(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},h.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},h.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},h.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},h.fromJSON=function(t,e){if(!e)return h.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new h(o.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},h.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new h(t,n,r)},Object.defineProperties(h.prototype,p),h.empty=new h(o.empty,0,0);var w=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},x={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};w.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},x.parent.get=function(){return this.node(this.depth)},x.doc.get=function(){return this.node(0)},w.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},w.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},w.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},w.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},w.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},w.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},w.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},x.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},x.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},x.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},w.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return l.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},w.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},w.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},w.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new O(this,t,n)},w.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},w.prototype.max=function(t){return t.pos>this.pos?t:this},w.prototype.min=function(t){return t.pos<this.pos?t:this},w.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},w.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new w(e,n,o)},w.resolveCached=function(t,e){for(var n=0;n<k.length;n++){var r=k[n];if(r.pos==e&&r.doc==t)return r}var o=k[S]=w.resolve(t,e);return S=(S+1)%C,o},Object.defineProperties(w.prototype,x);var k=[],S=0,C=12,O=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},N={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};N.start.get=function(){return this.$from.before(this.depth+1)},N.end.get=function(){return this.$to.after(this.depth+1)},N.parent.get=function(){return this.$from.node(this.depth)},N.startIndex.get=function(){return this.$from.index(this.depth)},N.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(O.prototype,N);var M=Object.create(null),T=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||o.empty,this.marks=r||l.none},A={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};A.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},A.childCount.get=function(){return this.content.childCount},T.prototype.child=function(t){return this.content.child(t)},T.prototype.maybeChild=function(t){return this.content.maybeChild(t)},T.prototype.forEach=function(t){this.content.forEach(t)},T.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},T.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},A.textContent.get=function(){return this.textBetween(0,this.content.size,"")},T.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},A.firstChild.get=function(){return this.content.firstChild},A.lastChild.get=function(){return this.content.lastChild},T.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},T.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},T.prototype.hasMarkup=function(t,e,n){return this.type==t&&c(this.attrs,e||t.defaultAttrs||M)&&l.sameSet(this.marks,n||l.none)},T.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},T.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},T.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},T.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return h.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new h(a,r.depth-i,o.depth-i)},T.prototype.replace=function(t,e,n){return f(this.resolve(t),this.resolve(e),n)},T.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},T.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},T.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},T.prototype.resolve=function(t){return w.resolveCached(this,t)},T.prototype.resolveNoCache=function(t){return w.resolve(this,t)},T.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},A.isBlock.get=function(){return this.type.isBlock},A.isTextblock.get=function(){return this.type.isTextblock},A.inlineContent.get=function(){return this.type.inlineContent},A.isInline.get=function(){return this.type.isInline},A.isText.get=function(){return this.type.isText},A.isLeaf.get=function(){return this.type.isLeaf},A.isAtom.get=function(){return this.type.isAtom},T.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),D(this.marks,t)},T.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},T.prototype.canReplace=function(t,e,n,r,i){void 0===n&&(n=o.empty),void 0===r&&(r=0),void 0===i&&(i=n.childCount);var s=this.contentMatchAt(t).matchFragment(n,r,i),a=s&&s.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<i;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},T.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},T.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},T.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},T.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},T.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=o.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(T.prototype,A);var E=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):D(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(T);function D(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var P=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},I={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};P.parse=function(t,e){var n=new R(t,e);if(null==n.next)return P.empty;var r=_(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];L(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new P(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(V);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(L(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},P.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},P.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},I.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},I.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},P.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},P.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function i(s,a){var c=s.matchFragment(t,n);if(c&&(!e||c.validEnd))return o.from(a.map((function(t){return t.createAndFill()})));for(var l=0;l<s.next.length;l+=2){var u=s.next[l],h=s.next[l+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(h)){r.push(h);var p=i(h,a.concat(u));if(p)return p}}}(this,[])},P.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},P.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},I.edgeCount.get=function(){return this.next.length>>1},P.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},P.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(P.prototype,I),P.empty=new P(!0);var R=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},z={next:{configurable:!0}};function _(t){var e=[];do{e.push($(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function $(t){var e=[];do{e.push(B(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function B(t){for(var e=function(t){if(t.eat("(")){var e=_(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=F(t,e)}return e}function j(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function F(t,e){var n=j(t),r=n;return t.eat(",")&&(r="}"!=t.next?j(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function V(t,e){return e-t}function L(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(V)}function q(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function J(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function W(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new K(t[n]);return e}z.next.get=function(){return this.tokens[this.pos]},R.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},R.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(R.prototype,z);var H=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=W(n.attrs),this.defaultAttrs=q(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},U={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};U.isInline.get=function(){return!this.isBlock},U.isTextblock.get=function(){return this.isBlock&&this.inlineContent},U.isLeaf.get=function(){return this.contentMatch==P.empty},U.isAtom.get=function(){return this.isLeaf||this.spec.atom},H.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},H.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},H.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:J(this.attrs,t)},H.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new T(this,this.computeAttrs(t),o.from(e),l.setFrom(n))},H.prototype.createChecked=function(t,e,n){if(e=o.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new T(this,this.computeAttrs(t),e,l.setFrom(n))},H.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=o.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var i=this.contentMatch.matchFragment(e).fillBefore(o.empty,!0);return i?new T(this,t,e.append(i),l.setFrom(n)):null},H.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},H.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},H.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},H.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:l.empty:t},H.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new H(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(H.prototype,U);var K=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},G={isRequired:{configurable:!0}};G.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(K.prototype,G);var Y=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=W(r.attrs),this.rank=e,this.excluded=null;var o=q(this.attrs);this.instance=o&&new l(this,o)};Y.prototype.create=function(t){return!t&&this.instance?this.instance:new l(this,J(this.attrs,t))},Y.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new Y(t,r++,e,o)})),n},Y.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},Y.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},Y.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var X=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=H.compile(this.spec.nodes,this),this.marks=Y.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=P.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?Z(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:Z(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Z(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}X.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof H))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},X.prototype.text=function(t,e){var n=this.nodes.text;return new E(n,n.defaultAttrs,t,l.setFrom(e))},X.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},X.prototype.nodeFromJSON=function(t){return T.fromJSON(this,t)},X.prototype.markFromJSON=function(t){return l.fromJSON(this,t)},X.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Q=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};Q.prototype.parse=function(t,e){void 0===e&&(e={});var n=new it(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Q.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new it(this,e,!0);return n.addAll(t,null,e.from,e.to),h.maxOpen(n.finish())},Q.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(at(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},Q.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Q.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=ct(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=ct(t)),t.node=s}));return e},Q.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Q(t,Q.schemaRules(t)))};var tt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},et={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nt={ol:!0,ul:!0};function rt(t){return(t?1:0)|("full"===t?2:0)}var ot=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=l.none,this.pendingMarks=r};ot.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(o.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},ot.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=o.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(o.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},ot.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):lt(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var it=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=rt(e.preserveWhitespace)|(n?4:0);r=o?new ot(o.type,o.attrs,l.none,l.none,!0,e.topMatch||o.type.contentMatch,i):new ot(n?null:t.schema.topNodeType,null,l.none,l.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},st={top:{configurable:!0},currentPos:{configurable:!0}};function at(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function ct(t){var e={};for(var n in t)e[n]=t[n];return e}function lt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[],s=function(t){i.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),o=r.type,a=r.next;if(o==e)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}st.top.get=function(){return this.nodes[this.open]},it.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},it.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},it.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();nt.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&nt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:et.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(tt.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},it.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},it.prototype.readStyles=function(t){for(var e=l.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},it.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o,s)},it.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&tt.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},it.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},it.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},it.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},it.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:rt(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new ot(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},it.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},it.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},it.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},st.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},it.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},it.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},it.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},it.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},it.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},it.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},it.prototype.addPendingMark=function(t){this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},it.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1?r.pendingMarks=t.removeFromSet(r.pendingMarks):r.activeMarks=t.removeFromSet(r.activeMarks),r==e)break}},Object.defineProperties(it.prototype,st);var ut=function(t,e){this.nodes=t||{},this.marks=e||{}};function ht(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function pt(t){return t.document||window.document}ut.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=pt(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},ut.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=ut.renderSpec(pt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},ut.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},ut.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&ut.renderSpec(pt(n),r(t,e))},ut.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var h=c;h<e.length;h++){var p=e[h];if(0===p){if(h<e.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var f=ut.renderSpec(t,p,n),d=f.dom,v=f.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},ut.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new ut(this.nodesFromSchema(t),this.marksFromSchema(t)))},ut.nodesFromSchema=function(t){var e=ht(t.nodes);return e.text||(e.text=function(t){return t.text}),e},ut.marksFromSchema=function(t){return ht(t.marks)}},function(t,e,n){"use strict";function r(){return(r=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)}var o=["attrs","props","domProps"],i=["class","style","directives"],s=["on","nativeOn"],a=function(t,e){return function(){t&&t.apply(this,arguments),e&&e.apply(this,arguments)}};t.exports=function(t){return t.reduce((function(t,e){for(var n in e)if(t[n])if(-1!==o.indexOf(n))t[n]=r({},t[n],e[n]);else if(-1!==i.indexOf(n)){var c=t[n]instanceof Array?t[n]:[t[n]],l=e[n]instanceof Array?e[n]:[e[n]];t[n]=c.concat(l)}else if(-1!==s.indexOf(n))for(var u in e[n])if(t[n][u]){var h=t[n][u]instanceof Array?t[n][u]:[t[n][u]],p=e[n][u]instanceof Array?e[n][u]:[e[n][u]];t[n][u]=h.concat(p)}else t[n][u]=e[n][u];else if("hook"==n)for(var f in e[n])t[n][f]=t[n][f]?a(t[n][f],e[n][f]):e[n][f];else t[n]=e[n];else t[n]=e[n];return t}),{})}},function(t,n){t.exports=e},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return m})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return C})),n.d(e,"f",(function(){return S})),n.d(e,"g",(function(){return M})),n.d(e,"h",(function(){return x})),n.d(e,"i",(function(){return N})),n.d(e,"j",(function(){return w}));var r=n(2),o=Math.pow(2,16);function i(t){return 65535&t}var s=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.pos=t,this.deleted=e,this.recover=n},a=function(t,e){void 0===e&&(e=!1),this.ranges=t,this.inverted=e};a.prototype.recover=function(t){var e=0,n=i(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/o}(t)},a.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},a.prototype.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},a.prototype._map=function(t,e,n){for(var r=0,i=this.inverted?2:1,a=this.inverted?1:2,c=0;c<this.ranges.length;c+=3){var l=this.ranges[c]-(this.inverted?r:0);if(l>t)break;var u=this.ranges[c+i],h=this.ranges[c+a],p=l+u;if(t<=p){var f=l+r+((u?t==l?-1:t==p?1:e:e)<0?0:h);if(n)return f;var d=c/3+(t-l)*o;return new s(f,e<0?t!=l:t!=p,d)}r+=h-u}return n?t+r:new s(t+r)},a.prototype.touches=function(t,e){for(var n=0,r=i(e),o=this.inverted?2:1,s=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var c=this.ranges[a]-(this.inverted?n:0);if(c>t)break;var l=this.ranges[a+o];if(t<=c+l&&a==3*r)return!0;n+=this.ranges[a+s]-l}return!1},a.prototype.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+e],l=this.ranges[r+n];t(s,s+c,a,a+l),o+=l-c}},a.prototype.invert=function(){return new a(this.ranges,!this.inverted)},a.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},a.offset=function(t){return 0==t?a.empty:new a(t<0?[0,-t,0]:[0,0,t])},a.empty=new a([]);var c=function(t,e,n,r){this.maps=t||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=e};function l(t){var e=Error.call(this,t);return e.__proto__=l.prototype,e}c.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.maps.length),new c(this.maps,this.mirror,t,e)},c.prototype.copy=function(){return new c(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},c.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},c.prototype.appendMapping=function(t){for(var e=0,n=this.maps.length;e<t.maps.length;e++){var r=t.getMirror(e);this.appendMap(t.maps[e],null!=r&&r<e?n+r:null)}},c.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},c.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},c.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){var r=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=r&&r>e?n-r-1:null)}},c.prototype.invert=function(){var t=new c;return t.appendMappingInverted(this),t},c.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t},c.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},c.prototype._map=function(t,e,n){for(var r=!1,o=null,i=this.from;i<this.to;i++){var a=this.maps[i],c=o&&o[i];if(null!=c&&a.touches(t,c))t=a.recover(c);else{var l=a.mapResult(t,e);if(null!=l.recover){var u=this.getMirror(i);if(null!=u&&u>i&&u<this.to){if(l.deleted){i=u,t=this.maps[u].recover(l.recover);continue}(o||(o=Object.create(null)))[u]=l.recover}}l.deleted&&(r=!0),t=l.pos}}return n?t:new s(t,r)},l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l.prototype.name="TransformError";var u=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new c},h={before:{configurable:!0},docChanged:{configurable:!0}};function p(){throw new Error("Override me")}h.before.get=function(){return this.docs.length?this.docs[0]:this.doc},u.prototype.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new l(e.failed);return this},u.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},h.docChanged.get=function(){return this.steps.length>0},u.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(u.prototype,h);var f=Object.create(null),d=function(){};d.prototype.apply=function(t){return p()},d.prototype.getMap=function(){return a.empty},d.prototype.invert=function(t){return p()},d.prototype.map=function(t){return p()},d.prototype.merge=function(t){return null},d.prototype.toJSON=function(){return p()},d.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=f[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},d.jsonID=function(t,e){if(t in f)throw new RangeError("Duplicate use of step JSON ID "+t);return f[t]=e,e.prototype.jsonID=t,e};var v=function(t,e){this.doc=t,this.failed=e};v.ok=function(t){return new v(t,null)},v.fail=function(t){return new v(null,t)},v.fromReplace=function(t,e,n,o){try{return v.ok(t.replace(e,n,o))}catch(t){if(t instanceof r.h)return v.fail(t.message);throw t}};var m=function(t){function e(e,n,r,o){t.call(this),this.from=e,this.to=n,this.slice=r,this.structure=!!o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){return this.structure&&y(t,this.from,this.to)?v.fail("Structure replace would overwrite content"):v.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new a([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new e(n.pos,Math.max(n.pos,r.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure!=this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?r.i.empty:new r.i(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}var o=this.slice.size+t.slice.size==0?r.i.empty:new r.i(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),o,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,r.i.fromJSON(t,n.slice),!!n.structure)},e}(d);d.jsonID("replace",m);var g=function(t){function e(e,n,r,o,i,s,a){t.call(this),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){if(this.structure&&(y(t,this.from,this.gapFrom)||y(t,this.gapTo,this.to)))return v.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return v.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,e.content);return n?v.fromReplace(t,this.from,this.to,n):v.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new a([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),o=t.map(this.gapFrom,-1),i=t.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new e(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,r.i.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(d);function y(t,e,n){for(var r=t.resolve(e),o=n-e,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function b(t,e,n){return(0==e||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function w(t){for(var e=t.parent.content.cutByIndex(t.startIndex,t.endIndex),n=t.depth;;--n){var r=t.$from.node(n),o=t.$from.index(n),i=t.$to.indexAfter(n);if(n<t.depth&&r.canReplace(o,i,e))return n;if(0==n||r.type.spec.isolating||!b(r,o,i))break}}function x(t,e,n,r){void 0===r&&(r=t);var o=function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.contentMatchAt(r).findWrapping(e);if(!i)return null;var s=i.length?i[0]:e;return n.canReplaceWith(r,o,s)?i:null}(t,e),i=o&&function(t,e){var n=t.parent,r=t.startIndex,o=t.endIndex,i=n.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=(s.length?s[s.length-1]:e).contentMatch,c=r;a&&c<o;c++)a=a.matchType(n.child(c).type);if(!a||!a.validEnd)return null;return s}(r,e);return i?o.map(k).concat({type:e,attrs:n}).concat(i.map(k)):null}function k(t){return{type:t,attrs:null}}function S(t,e,n,r){void 0===n&&(n=1);var o=t.resolve(e),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var l=o.node(a),u=o.index(a);if(l.type.spec.isolating)return!1;var h=l.content.cutByIndex(u,l.childCount),p=r&&r[c]||l;if(p!=l&&(h=h.replaceChild(0,p.type.create(p.attrs))),!l.canReplace(u+1,l.childCount)||!p.type.validContent(h))return!1}var f=o.indexAfter(i),d=r&&r[0];return o.node(i).canReplaceWith(f,f,d?d.type:o.node(i+1).type)}function C(t,e){var n=t.resolve(e),r=n.index();return O(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function O(t,e){return t&&e&&!t.isLeaf&&t.canAppend(e)}function N(t,e,n){void 0===n&&(n=-1);for(var r=t.resolve(e),o=r.depth;;o--){var i=void 0,s=void 0;if(o==r.depth?(i=r.nodeBefore,s=r.nodeAfter):n>0?(i=r.node(o+1),s=r.node(o).maybeChild(r.index(o)+1)):(i=r.node(o).maybeChild(r.index(o)-1),s=r.node(o+1)),i&&!i.isTextblock&&O(i,s))return e;if(0==o)break;e=n<0?r.before(o):r.after(o)}}function M(t,e,n){var r=t.resolve(e);if(!n.content.size)return e;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,l=r.index(a)+(c>0?1:0);if(1==s?r.node(a).canReplace(l,l,o):r.node(a).contentMatchAt(l).findWrapping(o.firstChild.type))return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}function T(t,e,n){for(var o=[],i=0;i<t.childCount;i++){var s=t.child(i);s.content.size&&(s=s.copy(T(s.content,e,s))),s.isInline&&(s=e(s,n,i)),o.push(s)}return r.c.fromArray(o)}d.jsonID("replaceAround",g),u.prototype.lift=function(t,e){for(var n=t.$from,o=t.$to,i=t.depth,s=n.before(i+1),a=o.after(i+1),c=s,l=a,u=r.c.empty,h=0,p=i,f=!1;p>e;p--)f||n.index(p)>0?(f=!0,u=r.c.from(n.node(p).copy(u)),h++):c--;for(var d=r.c.empty,v=0,m=i,y=!1;m>e;m--)y||o.after(m+1)<o.end(m)?(y=!0,d=r.c.from(o.node(m).copy(d)),v++):l++;return this.step(new g(c,l,s,a,new r.i(u.append(d),h,v),u.size-h,!0))},u.prototype.wrap=function(t,e){for(var n=r.c.empty,o=e.length-1;o>=0;o--)n=r.c.from(e[o].type.create(e[o].attrs,n));var i=t.start,s=t.end;return this.step(new g(i,s,i,s,new r.i(n,0,0),e.length,!0))},u.prototype.setBlockType=function(t,e,n,o){var i=this;if(void 0===e&&(e=t),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var s=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(n,o)&&function(t,e,n){var r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(i.doc,i.mapping.slice(s).map(e),n)){i.clearIncompatible(i.mapping.slice(s).map(e,1),n);var a=i.mapping.slice(s),c=a.map(e,1),l=a.map(e+t.nodeSize,1);return i.step(new g(c,l,c+1,l-1,new r.i(r.c.from(n.create(o,null,t.marks)),0,0),1,!0)),!1}})),this},u.prototype.setNodeMarkup=function(t,e,n,o){var i=this.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");e||(e=i.type);var s=e.create(n,null,o||i.marks);if(i.isLeaf)return this.replaceWith(t,t+i.nodeSize,s);if(!e.validContent(i.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new g(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new r.i(r.c.from(s),0,0),1,!0))},u.prototype.split=function(t,e,n){void 0===e&&(e=1);for(var o=this.doc.resolve(t),i=r.c.empty,s=r.c.empty,a=o.depth,c=o.depth-e,l=e-1;a>c;a--,l--){i=r.c.from(o.node(a).copy(i));var u=n&&n[l];s=r.c.from(u?u.type.create(u.attrs,s):o.node(a).copy(s))}return this.step(new m(t,t,new r.i(i.append(s),e,e),!0))},u.prototype.join=function(t,e){void 0===e&&(e=1);var n=new m(t-e,t+e,r.i.empty,!0);return this.step(n)};var A=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),o=t.resolve(this.from),i=o.node(o.sharedDepth(this.to)),s=new r.i(T(n.content,(function(t,n){return n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),i),n.openStart,n.openEnd);return v.fromReplace(t,this.from,this.to,s)},e.prototype.invert=function(){return new E(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(d);d.jsonID("addMark",A);var E=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),o=new r.i(T(n.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),n.openStart,n.openEnd);return v.fromReplace(t,this.from,this.to,o)},e.prototype.invert=function(){return new A(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(d);function D(t,e,n,o){if(void 0===n&&(n=e),void 0===o&&(o=r.i.empty),e==n&&!o.size)return null;var i=t.resolve(e),s=t.resolve(n);if(R(i,s,o))return new m(e,n,o);var a=function(t,e){var n=function t(e,n,o,i){var s=r.c.empty,a=0,c=o[n];if(e.depth>n){var l=t(e,n+1,o,i||c);a=l.openEnd+1,s=r.c.from(e.node(n+1).copy(l.content))}c&&(s=s.append(c.content),a=c.openEnd);i&&(s=s.append(e.node(n).contentMatchAt(e.indexAfter(n)).fillBefore(r.c.empty,!0)),a=0);return{content:s,openEnd:a}}(t,0,e,!1),o=n.content,i=n.openEnd;return new r.i(o,t.depth,i||0)}(i,function(t,e){for(var n=new z(t),r=1;e.size&&r<=3;r++){var o=n.placeSlice(e.content,e.openStart,e.openEnd,r);3==r&&o!=e&&o.size&&(r=0),e=o}for(;n.open.length;)n.closeNode();return n.placed}(i,o)),c=I(i,s,a);if(!c)return null;if(a.size!=c.size&&function(t,e,n){if(!e.parent.isTextblock)return!1;var r,o=n.openEnd?function(t,e){for(var n=1;n<e;n++)t=t.lastChild.content;return t.lastChild}(n.content,n.openEnd):t.node(t.depth-(n.openStart-n.openEnd));if(!o.isTextblock)return!1;for(var i=e.index();i<e.parent.childCount;i++)if(!o.type.allowsMarks(e.parent.child(i).marks))return!1;n.openEnd?r=o.contentMatchAt(o.childCount):(r=o.contentMatchAt(o.childCount),n.size&&(r=r.matchFragment(n.content,n.openStart?1:0)));return(r=r.matchFragment(e.parent.content,e.index()))&&r.validEnd}(i,s,a)){for(var l=s.depth,u=s.after(l);l>1&&u==s.end(--l);)++u;var h=I(i,t.resolve(u),a);if(h)return new g(e,u,n,s.end(),h,a.size)}return c.size||e!=n?new m(e,n,c):null}function P(t,e,n,o,i,s,a){var c,l=t.childCount,u=l-(a>0?1:0),h=s<0?e:n.node(i);c=s<0?h.contentMatchAt(u):1==l&&a>0?h.contentMatchAt(s?n.index(i):n.indexAfter(i)):h.contentMatchAt(n.indexAfter(i)).matchFragment(t,l>0&&s?1:0,u);var p=o.node(i);if(a>0&&i<o.depth){var f=p.content.cutByIndex(o.indexAfter(i)).addToStart(t.lastChild),d=c.fillBefore(f,!0);if(d&&d.size&&s>0&&1==l&&(d=null),d){var v=P(t.lastChild.content,t.lastChild,n,o,i+1,1==l?s-1:-1,a-1);if(v){var m=t.lastChild.copy(v);return d.size?t.cutByIndex(0,l-1).append(d).addToEnd(m):t.replaceChild(l-1,m)}}}a>0&&(c=c.matchType((1==l&&s>0?n.node(i+1):t.lastChild).type));var g=o.index(i);if(g==p.childCount&&!p.type.compatibleContent(e.type))return null;for(var y=c.fillBefore(p.content,!0,g),b=g;y&&b<p.content.childCount;b++)h.type.allowsMarks(p.content.child(b).marks)||(y=null);if(!y)return null;if(a>0){var w=function t(e,n,o,i,s){var a,c=e.content,l=c.childCount;a=s>=0?o.node(i).contentMatchAt(o.indexAfter(i)).matchFragment(c,s>0?1:0,l):e.contentMatchAt(l);if(n>0){var u=t(c.lastChild,n-1,o,i+1,1==l?s-1:-1);c=c.replaceChild(l-1,u)}return e.copy(c.append(a.fillBefore(r.c.empty,!0)))}(t.lastChild,a-1,n,i+1,1==l?s-1:-1);t=t.replaceChild(l-1,w)}return t=t.append(y),o.depth>i&&(t=t.addToEnd(function t(e,n){var r=e.node(n),o=r.contentMatchAt(0).fillBefore(r.content,!0,e.index(n));e.depth>n&&(o=o.addToEnd(t(e,n+1)));return r.copy(o)}(o,i+1))),t}function I(t,e,n){var o=P(n.content,t.node(0),t,e,0,n.openStart,n.openEnd);return o?function(t,e,n){for(;e>0&&n>0&&1==t.childCount;)t=t.firstChild.content,e--,n--;return new r.i(t,e,n)}(o,n.openStart,e.depth):null}function R(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}d.jsonID("removeMark",E),u.prototype.addMark=function(t,e,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(t,e,(function(r,c,l){if(r.isInline){var u=r.marks;if(!n.isInSet(u)&&l.type.allowsMarkType(n.type)){for(var h=Math.max(c,t),p=Math.min(c+r.nodeSize,e),f=n.addToSet(u),d=0;d<u.length;d++)u[d].isInSet(f)||(s&&s.to==h&&s.mark.eq(u[d])?s.to=p:o.push(s=new E(h,p,u[d])));a&&a.to==h?a.to=p:i.push(a=new A(h,p,n))}}})),o.forEach((function(t){return r.step(t)})),i.forEach((function(t){return r.step(t)})),this},u.prototype.removeMark=function(t,e,n){var o=this;void 0===n&&(n=null);var i=[],s=0;return this.doc.nodesBetween(t,e,(function(o,a){if(o.isInline){s++;var c=null;if(n instanceof r.e){var l=n.isInSet(o.marks);l&&(c=[l])}else n?n.isInSet(o.marks)&&(c=[n]):c=o.marks;if(c&&c.length)for(var u=Math.min(a+o.nodeSize,e),h=0;h<c.length;h++){for(var p=c[h],f=void 0,d=0;d<i.length;d++){var v=i[d];v.step==s-1&&p.eq(i[d].style)&&(f=v)}f?(f.to=u,f.step=s):i.push({style:p,from:Math.max(a,t),to:u,step:s})}}})),i.forEach((function(t){return o.step(new E(t.from,t.to,t.style))})),this},u.prototype.clearIncompatible=function(t,e,n){void 0===n&&(n=e.contentMatch);for(var o=this.doc.nodeAt(t),i=[],s=t+1,a=0;a<o.childCount;a++){var c=o.child(a),l=s+c.nodeSize,u=n.matchType(c.type,c.attrs);if(u){n=u;for(var h=0;h<c.marks.length;h++)e.allowsMarkType(c.marks[h].type)||this.step(new E(s,l,c.marks[h]))}else i.push(new m(s,l,r.i.empty));s=l}if(!n.validEnd){var p=n.fillBefore(r.c.empty,!0);this.replace(s,s,new r.i(p,0,0))}for(var f=i.length-1;f>=0;f--)this.step(i[f]);return this},u.prototype.replace=function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=r.i.empty);var o=D(this.doc,t,e,n);return o&&this.step(o),this},u.prototype.replaceWith=function(t,e,n){return this.replace(t,e,new r.i(r.c.from(n),0,0))},u.prototype.delete=function(t,e){return this.replace(t,e,r.i.empty)},u.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var z=function(t){this.open=[];for(var e=0;e<=t.depth;e++){var n=t.node(e),o=n.contentMatchAt(t.indexAfter(e));this.open.push({parent:n,match:o,content:r.c.empty,wrapper:!1,openEnd:0,depth:e})}this.placed=[]};function _(t,e,n){var r=t.content;if(e>1){var o=_(t.firstChild,e-1,1==t.childCount?n-1:0);r=t.content.replaceChild(0,o)}var i=t.type.contentMatch.fillBefore(r,0==n);return t.copy(i.append(r))}function $(t,e,n,o,i){if(e<n){var s=t.firstChild;t=t.replaceChild(0,s.copy($(s.content,e+1,n,o,s)))}if(e>o){var a=i.contentMatchAt(0),c=a.fillBefore(t).append(t);t=c.append(a.matchFragment(c).fillBefore(r.c.empty,!0))}return t}function B(t,e){for(var n=[],r=Math.min(t.depth,e.depth);r>=0;r--){var o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;o==e.start(r)&&n.push(r)}return n}z.prototype.placeSlice=function(t,e,n,o,i){if(e>0){var s=t.firstChild,a=this.placeSlice(s.content,Math.max(0,e-1),n&&1==t.childCount?n-1:0,o,s);a.content!=s.content&&(a.content.size?(t=t.replaceChild(0,s.copy(a.content)),e=a.openStart+1):(1==t.childCount&&(n=0),t=t.cutByIndex(1),e=0))}var c=this.placeContent(t,e,n,o,i);if(o>2&&c.size&&0==e){var l=c.content.firstChild,u=1==c.content.childCount;this.placeContent(l.content,0,n&&u?n-1:0,o,l),c=u?r.c.empty:new r.i(c.content.cutByIndex(1),0,n)}return c},z.prototype.placeContent=function(t,e,n,o,i){for(var s=0;s<t.childCount;s++){for(var a=t.child(s),c=!1,l=s==t.childCount-1,u=this.open.length-1;u>=0;u--){var h=this.open[u],p=void 0;if(o>1&&(p=h.match.findWrapping(a.type))&&(!i||!p.length||p[p.length-1]!=i.type)){for(;this.open.length-1>u;)this.closeNode();for(var f=0;f<p.length;f++)h.match=h.match.matchType(p[f]),u++,h={parent:p[f].create(),match:p[f].contentMatch,content:r.c.empty,wrapper:!0,openEnd:0,depth:u+f},this.open.push(h)}var d=h.match.matchType(a.type);if(!d){var v=h.match.fillBefore(r.c.from(a));if(!v){if(i&&h.match.matchType(i.type))break;continue}for(var m=0;m<v.childCount;m++){var g=v.child(m);this.addNode(h,g,0),d=h.match.matchFragment(g)}}for(;this.open.length-1>u;)this.closeNode();a=a.mark(h.parent.type.allowedMarks(a.marks)),e&&(a=_(a,e,l?n:0),e=0),this.addNode(h,a,l?n:0),h.match=d,l&&(n=0),c=!0;break}if(!c)break}return this.open.length>1&&(s>0&&s==t.childCount||i&&this.open[this.open.length-1].parent.type==i.type)&&this.closeNode(),new r.i(t.cutByIndex(s),e,n)},z.prototype.addNode=function(t,e,n){var o,i;t.content=(o=t.content,i=t.openEnd,i?o.replaceChild(o.childCount-1,function t(e,n){var o=e.content;if(n>1){var i=t(e.lastChild,n-1);o=e.content.replaceChild(e.childCount-1,i)}var s=e.contentMatchAt(e.childCount).fillBefore(r.c.empty,!0);return e.copy(o.append(s))}(o.lastChild,i)):o).addToEnd(e),t.openEnd=n},z.prototype.closeNode=function(){var t=this.open.pop();0==t.content.size||(t.wrapper?this.addNode(this.open[this.open.length-1],t.parent.copy(t.content),t.openEnd+1):this.placed[t.depth]={depth:t.depth,content:t.content,openEnd:t.openEnd})},u.prototype.replaceRange=function(t,e,n){if(!n.size)return this.deleteRange(t,e);var o=this.doc.resolve(t),i=this.doc.resolve(e);if(R(o,i,n))return this.step(new m(t,e,n));var s=B(o,this.doc.resolve(e));0==s[s.length-1]&&s.pop();var a=-(o.depth+1);s.unshift(a);for(var c=o.depth,l=o.pos-1;c>0;c--,l--){var u=o.node(c).type.spec;if(u.defining||u.isolating)break;s.indexOf(c)>-1?a=c:o.before(c)==l&&s.splice(1,0,-c)}for(var h=s.indexOf(a),p=[],f=n.openStart,d=n.content,v=0;;v++){var g=d.firstChild;if(p.push(g),v==n.openStart)break;d=g.content}f>0&&p[f-1].type.spec.defining&&o.node(h).type!=p[f-1].type?f-=1:f>=2&&p[f-1].isTextblock&&p[f-2].type.spec.defining&&o.node(h).type!=p[f-2].type&&(f-=2);for(var y=n.openStart;y>=0;y--){var b=(y+f+1)%(n.openStart+1),w=p[b];if(w)for(var x=0;x<s.length;x++){var k=s[(x+h)%s.length],S=!0;k<0&&(S=!1,k=-k);var C=o.node(k-1),O=o.index(k-1);if(C.canReplaceWith(O,O,w.type,w.marks))return this.replace(o.before(k),S?i.after(k):e,new r.i($(n.content,0,n.openStart,b),b,n.openEnd))}}for(var N=this.steps.length,M=s.length-1;M>=0&&(this.replace(t,e,n),!(this.steps.length>N));M--){var T=s[M];M<0||(t=o.before(T),e=i.after(T))}return this},u.prototype.replaceRangeWith=function(t,e,n){if(!n.isInline&&t==e&&this.doc.resolve(t).parent.content.size){var o=function(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,t,n.type);null!=o&&(t=e=o)}return this.replaceRange(t,e,new r.i(r.c.from(n),0,0))},u.prototype.deleteRange=function(t,e){for(var n=this.doc.resolve(t),r=this.doc.resolve(e),o=B(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&r.end(c)-e!=r.depth-c)return this.delete(n.before(c),e);return this.delete(t,e)}},function(t,e,n){"use strict";var r=n(0);e.a={ctor:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=r.Obj.get(this.$vnode.componentOptions.Ctor,r.Arr.merge(["extendOptions"],t.split(".")),-1);return-1===o&&(o=r.Obj.get(this.$vnode.componentOptions.Ctor,r.Arr.merge(["options"],t.split(".")),-1)),-1===o&&(o=n),"function"!=typeof o?o:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return o.apply(e,n)}}}},function(t,e,n){"use strict";n.r(e),n.d(e,"CellSelection",(function(){return A})),n.d(e,"TableMap",(function(){return d})),n.d(e,"__clipCells",(function(){return B})),n.d(e,"__insertCells",(function(){return V})),n.d(e,"__pastedCells",(function(){return _})),n.d(e,"addColumn",(function(){return nt})),n.d(e,"addColumnAfter",(function(){return ot})),n.d(e,"addColumnBefore",(function(){return rt})),n.d(e,"addRow",(function(){return ct})),n.d(e,"addRowAfter",(function(){return ut})),n.d(e,"addRowBefore",(function(){return lt})),n.d(e,"cellAround",(function(){return g})),n.d(e,"colCount",(function(){return C})),n.d(e,"columnResizing",(function(){return Tt})),n.d(e,"columnResizingPluginKey",(function(){return Mt})),n.d(e,"deleteColumn",(function(){return st})),n.d(e,"deleteRow",(function(){return pt})),n.d(e,"deleteTable",(function(){return Ct})),n.d(e,"findCell",(function(){return S})),n.d(e,"fixTables",(function(){return tt})),n.d(e,"fixTablesKey",(function(){return Q})),n.d(e,"goToNextCell",(function(){return St})),n.d(e,"handlePaste",(function(){return K})),n.d(e,"inSameTable",(function(){return k})),n.d(e,"isInTable",(function(){return y})),n.d(e,"mergeCells",(function(){return dt})),n.d(e,"moveCellForward",(function(){return x})),n.d(e,"nextCell",(function(){return O})),n.d(e,"removeColumn",(function(){return it})),n.d(e,"removeRow",(function(){return ht})),n.d(e,"rowIsHeader",(function(){return at})),n.d(e,"selectedRect",(function(){return et})),n.d(e,"selectionCell",(function(){return b})),n.d(e,"setCellAttr",(function(){return gt})),n.d(e,"splitCell",(function(){return vt})),n.d(e,"splitCellWithType",(function(){return mt})),n.d(e,"tableEditing",(function(){return Rt})),n.d(e,"tableEditingKey",(function(){return m})),n.d(e,"tableNodes",(function(){return R})),n.d(e,"toggleHeader",(function(){return bt})),n.d(e,"toggleHeaderCell",(function(){return kt})),n.d(e,"toggleHeaderColumn",(function(){return xt})),n.d(e,"toggleHeaderRow",(function(){return wt})),n.d(e,"updateColumnsOnResize",(function(){return Nt}));var r,o,i=n(1),s=n(2),a=n(10),c=n(11),l=n(5);if("undefined"!=typeof WeakMap){var u=new WeakMap;r=function(t){return u.get(t)},o=function(t,e){return u.set(t,e),e}}else{var h=[],p=0;r=function(t){for(var e=0;e<h.length;e+=2)if(h[e]==t)return h[e+1]},o=function(t,e){return 10==p&&(p=0),h[p++]=t,h[p++]=e}}var f=function(t,e,n,r){this.left=t,this.top=e,this.right=n,this.bottom=r},d=function(t,e,n,r){this.width=t,this.height=e,this.map=n,this.problems=r};function v(t){if(t.colwidth)return t.colwidth.slice();for(var e=[],n=0;n<t.colspan;n++)e.push(0);return e}d.prototype.findCell=function(t){for(var e=0;e<this.map.length;e++){var n=this.map[e];if(n==t){for(var r=e%this.width,o=e/this.width|0,i=r+1,s=o+1,a=1;i<this.width&&this.map[e+a]==n;a++)i++;for(var c=1;s<this.height&&this.map[e+this.width*c]==n;c++)s++;return new f(r,o,i,s)}}throw new RangeError("No cell with offset "+t+" found")},d.prototype.colCount=function(t){for(var e=0;e<this.map.length;e++)if(this.map[e]==t)return e%this.width;throw new RangeError("No cell with offset "+t+" found")},d.prototype.nextCell=function(t,e,n){var r=this.findCell(t),o=r.left,i=r.right,s=r.top,a=r.bottom;return"horiz"==e?(n<0?0==o:i==this.width)?null:this.map[s*this.width+(n<0?o-1:i)]:(n<0?0==s:a==this.height)?null:this.map[o+this.width*(n<0?s-1:a)]},d.prototype.rectBetween=function(t,e){var n=this.findCell(t),r=n.left,o=n.right,i=n.top,s=n.bottom,a=this.findCell(e),c=a.left,l=a.right,u=a.top,h=a.bottom;return new f(Math.min(r,c),Math.min(i,u),Math.max(o,l),Math.max(s,h))},d.prototype.cellsInRect=function(t){for(var e=[],n={},r=t.top;r<t.bottom;r++)for(var o=t.left;o<t.right;o++){var i=r*this.width+o,s=this.map[i];n[s]||(n[s]=!0,o==t.left&&o&&this.map[i-1]==s||r==t.top&&r&&this.map[i-this.width]==s||e.push(s))}return e},d.prototype.positionAt=function(t,e,n){for(var r=0,o=0;;r++){var i=o+n.child(r).nodeSize;if(r==t){for(var s=e+t*this.width,a=(t+1)*this.width;s<a&&this.map[s]<o;)s++;return s==a?i-1:this.map[s]}o=i}},d.get=function(t){return r(t)||o(t,function(t){if("table"!=t.type.spec.tableRole)throw new RangeError("Not a table node: "+t.type.name);for(var e=function(t){for(var e=-1,n=!1,r=0;r<t.childCount;r++){var o=t.child(r),i=0;if(n)for(var s=0;s<r;s++)for(var a=t.child(s),c=0;c<a.childCount;c++){var l=a.child(c);s+l.attrs.rowspan>r&&(i+=l.attrs.colspan)}for(var u=0;u<o.childCount;u++){var h=o.child(u);i+=h.attrs.colspan,h.attrs.rowspan>1&&(n=!0)}-1==e?e=i:e!=i&&(e=Math.max(e,i))}return e}(t),n=t.childCount,r=[],o=0,i=null,s=[],a=0,c=e*n;a<c;a++)r[a]=0;for(var l=0,u=0;l<n;l++){var h=t.child(l);u++;for(var p=0;;p++){for(;o<r.length&&0!=r[o];)o++;if(p==h.childCount)break;for(var f=h.child(p),m=f.attrs,g=m.colspan,y=m.rowspan,b=m.colwidth,w=0;w<y;w++){if(w+l>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:u,n:y-w});break}for(var x=o+w*e,k=0;k<g;k++){0==r[x+k]?r[x+k]=u:(i||(i=[])).push({type:"collision",row:l,pos:u,n:g-k});var S=b&&b[k];if(S){var C=(x+k)%e*2,O=s[C];null==O||O!=S&&1==s[C+1]?(s[C]=S,s[C+1]=1):O==S&&s[C+1]++}}}o+=g,u+=f.nodeSize}for(var N=(l+1)*e,M=0;o<N;)0==r[o++]&&M++;M&&(i||(i=[])).push({type:"missing",row:l,n:M}),u++}for(var T=new d(e,n,r,i),A=!1,E=0;!A&&E<s.length;E+=2)null!=s[E]&&s[E+1]<n&&(A=!0);A&&function(t,e,n){t.problems||(t.problems=[]);for(var r=0,o={};r<t.map.length;r++){var i=t.map[r];if(!o[i]){o[i]=!0;for(var s=n.nodeAt(i),a=null,c=0;c<s.attrs.colspan;c++){var l=(r+c)%t.width,u=e[2*l];null==u||s.attrs.colwidth&&s.attrs.colwidth[c]==u||((a||(a=v(s.attrs)))[c]=u)}a&&t.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}}(T,s,t);return T}(t))};var m=new i.PluginKey("selectingCells");function g(t){for(var e=t.depth-1;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return t.node(0).resolve(t.before(e+1));return null}function y(t){for(var e=t.selection.$head,n=e.depth;n>0;n--)if("row"==e.node(n).type.spec.tableRole)return!0;return!1}function b(t){var e=t.selection;return e.$anchorCell?e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell:e.node&&"cell"==e.node.type.spec.tableRole?e.$anchor:g(e.$head)||function(t){for(var e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){var r=e.type.spec.tableRole;if("cell"==r||"header_cell"==r)return t.doc.resolve(n)}for(var o=t.nodeBefore,i=t.pos;o;o=o.lastChild,i--){var s=o.type.spec.tableRole;if("cell"==s||"header_cell"==s)return t.doc.resolve(i-o.nodeSize)}}(e.$head)}function w(t){return"row"==t.parent.type.spec.tableRole&&t.nodeAfter}function x(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function k(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function S(t){return d.get(t.node(-1)).findCell(t.pos-t.start(-1))}function C(t){return d.get(t.node(-1)).colCount(t.pos-t.start(-1))}function O(t,e,n){var r=t.start(-1),o=d.get(t.node(-1)).nextCell(t.pos-r,e,n);return null==o?null:t.node(0).resolve(r+o)}function N(t,e,n){var r={};for(var o in t)r[o]=t[o];return r[e]=n,r}function M(t,e,n){void 0===n&&(n=1);var r=N(t,"colspan",t.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some((function(t){return t>0}))||(r.colwidth=null)),r}function T(t,e,n){void 0===n&&(n=1);var r=N(t,"colspan",t.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(var o=0;o<n;o++)r.colwidth.splice(e,0,0)}return r}var A=function(t){function e(e,n){void 0===n&&(n=e);var r=e.node(-1),o=d.get(r),s=e.start(-1),a=o.rectBetween(e.pos-s,n.pos-s),c=e.node(0),l=o.cellsInRect(a).filter((function(t){return t!=n.pos-s}));l.unshift(n.pos-s);var u=l.map((function(t){var e=r.nodeAt(t),n=t+s+1;return new i.SelectionRange(c.resolve(n),c.resolve(n+e.content.size))}));t.call(this,u[0].$from,u[0].$to,u),this.$anchorCell=e,this.$headCell=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,n){var r=t.resolve(n.map(this.$anchorCell.pos)),o=t.resolve(n.map(this.$headCell.pos));if(w(r)&&w(o)&&k(r,o)){var s=this.$anchorCell.node(-1)!=r.node(-1);return s&&this.isRowSelection()?e.rowSelection(r,o):s&&this.isColSelection()?e.colSelection(r,o):new e(r,o)}return i.TextSelection.between(r,o)},e.prototype.content=function(){for(var t=this.$anchorCell.node(-1),e=d.get(t),n=this.$anchorCell.start(-1),r=e.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[],a=r.top;a<r.bottom;a++){for(var c=[],l=a*e.width+r.left,u=r.left;u<r.right;u++,l++){var h=e.map[l];if(!o[h]){o[h]=!0;var p=e.findCell(h),f=t.nodeAt(h),v=r.left-p.left,m=p.right-r.right;if(v>0||m>0){var g=f.attrs;v>0&&(g=M(g,0,v)),m>0&&(g=M(g,g.colspan-m,m)),f=p.left<r.left?f.type.createAndFill(g):f.type.create(g,f.content)}if(p.top<r.top||p.bottom>r.bottom){var y=N(f.attrs,"rowspan",Math.min(p.bottom,r.bottom)-Math.max(p.top,r.top));f=p.top<r.top?f.type.createAndFill(y):f.type.create(y,f.content)}c.push(f)}}i.push(t.child(a).copy(s.c.from(c)))}var b=this.isColSelection()&&this.isRowSelection()?t:i;return new s.i(s.c.from(b),1,1)},e.prototype.replace=function(e,n){void 0===n&&(n=s.i.empty);for(var r=e.steps.length,o=this.ranges,i=0;i<o.length;i++){var a=o[i],c=a.$from,l=a.$to,u=e.mapping.slice(r);e.replace(u.map(c.pos),u.map(l.pos),i?s.i.empty:n)}var h=t.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);h&&e.setSelection(h)},e.prototype.replaceWith=function(t,e){this.replace(t,new s.i(s.c.from(e),0,0))},e.prototype.forEachCell=function(t){for(var e=this.$anchorCell.node(-1),n=d.get(e),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r)),i=0;i<o.length;i++)t(e.nodeAt(o[i]),r+o[i])},e.prototype.isColSelection=function(){var t=this.$anchorCell.index(-1),e=this.$headCell.index(-1);if(Math.min(t,e)>0)return!1;var n=t+this.$anchorCell.nodeAfter.attrs.rowspan,r=e+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount},e.colSelection=function(t,n){void 0===n&&(n=t);var r=d.get(t.node(-1)),o=t.start(-1),i=r.findCell(t.pos-o),s=r.findCell(n.pos-o),a=t.node(0);return i.top<=s.top?(i.top>0&&(t=a.resolve(o+r.map[i.left])),s.bottom<r.height&&(n=a.resolve(o+r.map[r.width*(r.height-1)+s.right-1]))):(s.top>0&&(n=a.resolve(o+r.map[s.left])),i.bottom<r.height&&(t=a.resolve(o+r.map[r.width*(r.height-1)+i.right-1]))),new e(t,n)},e.prototype.isRowSelection=function(){var t=d.get(this.$anchorCell.node(-1)),e=this.$anchorCell.start(-1),n=t.colCount(this.$anchorCell.pos-e),r=t.colCount(this.$headCell.pos-e);if(Math.min(n,r)>0)return!1;var o=n+this.$anchorCell.nodeAfter.attrs.colspan,i=r+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==t.width},e.prototype.eq=function(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos},e.rowSelection=function(t,n){void 0===n&&(n=t);var r=d.get(t.node(-1)),o=t.start(-1),i=r.findCell(t.pos-o),s=r.findCell(n.pos-o),a=t.node(0);return i.left<=s.left?(i.left>0&&(t=a.resolve(o+r.map[i.top*r.width])),s.right<r.width&&(n=a.resolve(o+r.map[r.width*(s.top+1)-1]))):(s.left>0&&(n=a.resolve(o+r.map[s.top*r.width])),i.right<r.width&&(t=a.resolve(o+r.map[r.width*(i.top+1)-1]))),new e(t,n)},e.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},e.fromJSON=function(t,n){return new e(t.resolve(n.anchor),t.resolve(n.head))},e.create=function(t,n,r){return void 0===r&&(r=n),new e(t.resolve(n),t.resolve(r))},e.prototype.getBookmark=function(){return new E(this.$anchorCell.pos,this.$headCell.pos)},e}(i.Selection);A.prototype.visible=!1,i.Selection.jsonID("cell",A);var E=function(t,e){this.anchor=t,this.head=e};function D(t){if(!(t.selection instanceof A))return null;var e=[];return t.selection.forEachCell((function(t,n){e.push(c.a.node(n,n+t.nodeSize,{class:"selectedCell"}))})),c.b.create(t.doc,e)}function P(t,e){var n=t.getAttribute("data-colwidth"),r=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map((function(t){return Number(t)})):null,o=Number(t.getAttribute("colspan")||1),i={colspan:o,rowspan:Number(t.getAttribute("rowspan")||1),colwidth:r&&r.length==o?r:null};for(var s in e){var a=e[s].getFromDOM,c=a&&a(t);null!=c&&(i[s]=c)}return i}function I(t,e){var n={};for(var r in 1!=t.attrs.colspan&&(n.colspan=t.attrs.colspan),1!=t.attrs.rowspan&&(n.rowspan=t.attrs.rowspan),t.attrs.colwidth&&(n["data-colwidth"]=t.attrs.colwidth.join(",")),e){var o=e[r].setDOMAttr;o&&o(t.attrs[r],n)}return n}function R(t){var e=t.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(var r in e)n[r]={default:e[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:t.tableGroup,parseDOM:[{tag:"table"}],toDOM:function(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM:function(){return["tr",0]}},table_cell:{content:t.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:function(t){return P(t,e)}}],toDOM:function(t){return["td",I(t,e),0]}},table_header:{content:t.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:function(t){return P(t,e)}}],toDOM:function(t){return["th",I(t,e),0]}}}}function z(t){var e=t.cached.tableNodeTypes;if(!e)for(var n in e=t.cached.tableNodeTypes={},t.nodes){var r=t.nodes[n],o=r.spec.tableRole;o&&(e[o]=r)}return e}function _(t){if(!t.size)return null;for(var e=t.content,n=t.openStart,r=t.openEnd;1==e.childCount&&(n>0&&r>0||"table"==e.firstChild.type.spec.tableRole);)n--,r--,e=e.firstChild.content;var o=e.firstChild,i=o.type.spec.tableRole,a=o.type.schema,c=[];if("row"==i)for(var l=0;l<e.childCount;l++){var u=e.child(l).content,h=l?0:Math.max(0,n-1),p=l<e.childCount-1?0:Math.max(0,r-1);(h||p)&&(u=$(z(a).row,new s.i(u,h,p)).content),c.push(u)}else{if("cell"!=i&&"header_cell"!=i)return null;c.push(n||r?$(z(a).row,new s.i(e,n,r)).content:e)}return function(t,e){for(var n=[],r=0;r<e.length;r++)for(var o=e[r],i=o.childCount-1;i>=0;i--)for(var a=o.child(i).attrs,c=a.rowspan,l=a.colspan,u=r;u<r+c;u++)n[u]=(n[u]||0)+l;for(var h=0,p=0;p<n.length;p++)h=Math.max(h,n[p]);for(var f=0;f<n.length;f++)if(f>=e.length&&e.push(s.c.empty),n[f]<h){for(var d=z(t).cell.createAndFill(),v=[],m=n[f];m<h;m++)v.push(d);e[f]=e[f].append(s.c.from(v))}return{height:e.length,width:h,rows:e}}(a,c)}function $(t,e){var n=t.createAndFill();return new l.d(n).replace(0,n.content.size,e).doc}function B(t,e,n){var r=t.width,o=t.height,i=t.rows;if(r!=e){for(var a=[],c=[],l=0;l<i.length;l++){for(var u=i[l],h=[],p=a[l]||0,f=0;p<e;f++){var d=u.child(f%u.childCount);p+d.attrs.colspan>e&&(d=d.type.create(M(d.attrs,d.attrs.colspan,p+d.attrs.colspan-e),d.content)),h.push(d),p+=d.attrs.colspan;for(var v=1;v<d.attrs.rowspan;v++)a[l+v]=(a[l+v]||0)+d.attrs.colspan}c.push(s.c.from(h))}i=c,r=e}if(o!=n){for(var m=[],g=0,y=0;g<n;g++,y++){for(var b=[],w=i[y%o],x=0;x<w.childCount;x++){var k=w.child(x);g+k.attrs.rowspan>n&&(k=k.type.create(N(k.attrs,"rowspan",n-k.attrs.rowspan),k.content)),b.push(k)}m.push(s.c.from(b))}i=m,o=n}return{width:r,height:o,rows:i}}function j(t,e,n,r,o,i,s,a){if(0==s||s==e.height)return!1;for(var c=!1,l=o;l<i;l++){var u=s*e.width+l,h=e.map[u];if(e.map[u-e.width]==h){c=!0;var p=n.nodeAt(h),f=e.findCell(h),d=f.top,v=f.left;t.setNodeMarkup(t.mapping.slice(a).map(h+r),null,N(p.attrs,"rowspan",s-d)),t.insert(t.mapping.slice(a).map(e.positionAt(s,v,n)),p.type.createAndFill(N(p.attrs,"rowspan",d+p.attrs.rowspan-s))),l+=p.attrs.colspan-1}}return c}function F(t,e,n,r,o,i,s,a){if(0==s||s==e.width)return!1;for(var c=!1,l=o;l<i;l++){var u=l*e.width+s,h=e.map[u];if(e.map[u-1]==h){c=!0;var p=n.nodeAt(h),f=e.colCount(h),d=t.mapping.slice(a).map(h+r);t.setNodeMarkup(d,null,M(p.attrs,s-f,p.attrs.colspan-(s-f))),t.insert(d+p.nodeSize,p.type.createAndFill(M(p.attrs,0,s-f))),l+=p.attrs.rowspan-1}}return c}function V(t,e,n,r,o){var i=n?t.doc.nodeAt(n-1):t.doc,a=d.get(i),c=r.top,l=r.left,u=l+o.width,h=c+o.height,p=t.tr,f=0;function v(){i=n?p.doc.nodeAt(n-1):p.doc,a=d.get(i),f=p.mapping.maps.length}(function(t,e,n,r,o,i,a){var c,l,u=z(t.doc.type.schema);if(o>e.width)for(var h=0,p=0;h<e.height;h++){var f=n.child(h);p+=f.nodeSize;var d=[],v=void 0;v=null==f.lastChild||f.lastChild.type==u.cell?c||(c=u.cell.createAndFill()):l||(l=u.header_cell.createAndFill());for(var m=e.width;m<o;m++)d.push(v);t.insert(t.mapping.slice(a).map(p-1+r),d)}if(i>e.height){for(var g=[],y=0,b=(e.height-1)*e.width;y<Math.max(e.width,o);y++){var w=!(y>=e.width)&&n.nodeAt(e.map[b+y]).type==u.header_cell;g.push(w?l||(l=u.header_cell.createAndFill()):c||(c=u.cell.createAndFill()))}for(var x=u.row.create(null,s.c.from(g)),k=[],S=e.height;S<i;S++)k.push(x);t.insert(t.mapping.slice(a).map(r+n.nodeSize-2),k)}return!(!c&&!l)})(p,a,i,n,u,h,f)&&v(),j(p,a,i,n,l,u,c,f)&&v(),j(p,a,i,n,l,u,h,f)&&v(),F(p,a,i,n,c,h,l,f)&&v(),F(p,a,i,n,c,h,u,f)&&v();for(var m=c;m<h;m++){var g=a.positionAt(m,l,i),y=a.positionAt(m,u,i);p.replace(p.mapping.slice(f).map(g+n),p.mapping.slice(f).map(y+n),new s.i(o.rows[m-c],0,0))}v(),p.setSelection(new A(p.doc.resolve(n+a.positionAt(c,l,i)),p.doc.resolve(n+a.positionAt(h-1,u-1,i)))),e(p)}E.prototype.map=function(t){return new E(t.map(this.anchor),t.map(this.head))},E.prototype.resolve=function(t){var e=t.resolve(this.anchor),n=t.resolve(this.head);return"row"==e.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&e.index()<e.parent.childCount&&n.index()<n.parent.childCount&&k(e,n)?new A(e,n):i.Selection.near(n,1)};var L=Object(a.a)({ArrowLeft:J("horiz",-1),ArrowRight:J("horiz",1),ArrowUp:J("vert",-1),ArrowDown:J("vert",1),"Shift-ArrowLeft":W("horiz",-1),"Shift-ArrowRight":W("horiz",1),"Shift-ArrowUp":W("vert",-1),"Shift-ArrowDown":W("vert",1),Backspace:H,"Mod-Backspace":H,Delete:H,"Mod-Delete":H});function q(t,e,n){return!n.eq(t.selection)&&(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function J(t,e){return function(n,r,o){var s=n.selection;if(s instanceof A)return q(n,r,i.Selection.near(s.$headCell,e));if("horiz"!=t&&!s.empty)return!1;var a=Y(o,t,e);if(null==a)return!1;if("horiz"==t)return q(n,r,i.Selection.near(n.doc.resolve(s.head+e),e));var c,l=n.doc.resolve(a),u=O(l,t,e);return c=u?i.Selection.near(u,1):e<0?i.Selection.near(n.doc.resolve(l.before(-1)),-1):i.Selection.near(n.doc.resolve(l.after(-1)),1),q(n,r,c)}}function W(t,e){return function(n,r,o){var i=n.selection;if(!(i instanceof A)){var s=Y(o,t,e);if(null==s)return!1;i=new A(n.doc.resolve(s))}var a=O(i.$headCell,t,e);return!!a&&q(n,r,new A(i.$anchorCell,a))}}function H(t,e){var n=t.selection;if(!(n instanceof A))return!1;if(e){var r=t.tr,o=z(t.schema).cell.createAndFill().content;n.forEachCell((function(t,e){t.content.eq(o)||r.replace(r.mapping.map(e+1),r.mapping.map(e+t.nodeSize-1),new s.i(o,0,0))})),r.docChanged&&e(r)}return!0}function U(t,e){var n=g(t.state.doc.resolve(e));return!!n&&(t.dispatch(t.state.tr.setSelection(new A(n))),!0)}function K(t,e,n){if(!y(t.state))return!1;var r=_(n),o=t.state.selection;if(o instanceof A){r||(r={width:1,height:1,rows:[s.c.from($(z(t.state.schema).cell,n))]});var i=o.$anchorCell.node(-1),a=o.$anchorCell.start(-1),c=d.get(i).rectBetween(o.$anchorCell.pos-a,o.$headCell.pos-a);return r=B(r,c.right-c.left,c.bottom-c.top),V(t.state,t.dispatch,a,c,r),!0}if(r){var l=b(t.state),u=l.start(-1);return V(t.state,t.dispatch,u,d.get(l.node(-1)).findCell(l.pos-u),r),!0}return!1}function G(t,e){if(!e.ctrlKey&&!e.metaKey){var n,r=X(t,e.target);if(e.shiftKey&&t.state.selection instanceof A)o(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&null!=(n=g(t.state.selection.$anchor))&&Z(t,e).pos!=n.pos)o(n,e),e.preventDefault();else if(!r)return;t.root.addEventListener("mouseup",i),t.root.addEventListener("dragstart",i),t.root.addEventListener("mousemove",s)}function o(e,n){var r=Z(t,n),o=null==m.getState(t.state);if(!r||!k(e,r)){if(!o)return;r=e}var i=new A(e,r);if(o||!t.state.selection.eq(i)){var s=t.state.tr.setSelection(i);o&&s.setMeta(m,e.pos),t.dispatch(s)}}function i(){t.root.removeEventListener("mouseup",i),t.root.removeEventListener("dragstart",i),t.root.removeEventListener("mousemove",s),null!=m.getState(t.state)&&t.dispatch(t.state.tr.setMeta(m,-1))}function s(n){var s,a=m.getState(t.state);if(null!=a)s=t.state.doc.resolve(a);else if(X(t,n.target)!=r&&!(s=Z(t,e)))return i();s&&o(s,n)}}function Y(t,e,n){if(!(t.state.selection instanceof i.TextSelection))return null;for(var r=t.state.selection.$head,o=r.depth-1;o>=0;o--){var s=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:s.childCount))return null;if("cell"==s.type.spec.tableRole||"header_cell"==s.type.spec.tableRole){var a=r.before(o),c="vert"==e?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(c)?a:null}}return null}function X(t,e){for(;e&&e!=t.dom;e=e.parentNode)if("TD"==e.nodeName||"TH"==e.nodeName)return e}function Z(t,e){var n=t.posAtCoords({left:e.clientX,top:e.clientY});return n&&n?g(t.state.doc.resolve(n.pos)):null}var Q=new i.PluginKey("fix-tables");function tt(t,e){var n,r=function(e,r){"table"==e.type.spec.tableRole&&(n=function(t,e,n,r){var o=d.get(e);if(!o.problems)return r;r||(r=t.tr);for(var i,s,a=[],c=0;c<o.height;c++)a.push(0);for(var l=0;l<o.problems.length;l++){var u=o.problems[l];if("collision"==u.type){for(var h=e.nodeAt(u.pos),p=0;p<h.attrs.rowspan;p++)a[u.row+p]+=u.n;r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,M(h.attrs,h.attrs.colspan-u.n,u.n))}else if("missing"==u.type)a[u.row]+=u.n;else if("overlong_rowspan"==u.type){var f=e.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,N(f.attrs,"rowspan",f.attrs.rowspan-u.n))}else if("colwidth mismatch"==u.type){var v=e.nodeAt(u.pos);r.setNodeMarkup(r.mapping.map(n+1+u.pos),null,N(v.attrs,"colwidth",u.colwidth))}}for(var m=0;m<a.length;m++)a[m]&&(null==i&&(i=m),s=m);for(var g=0,y=n+1;g<o.height;g++){var b=e.child(g),w=y+b.nodeSize,x=a[g];if(x>0){var k="cell";b.firstChild&&(k=b.firstChild.type.spec.tableRole);for(var S=[],C=0;C<x;C++)S.push(z(t.schema)[k].createAndFill());var O=0!=g&&i!=g-1||s!=g?w-1:y+1;r.insert(r.mapping.map(O),S)}y=w}return r.setMeta(Q,{fixTables:!0})}(t,e,r,n))};return e?e.doc!=t.doc&&function t(e,n,r,o){var i=e.childCount,s=n.childCount;t:for(var a=0,c=0;a<s;a++){for(var l=n.child(a),u=c,h=Math.min(i,a+3);u<h;u++)if(e.child(u)==l){c=u+1,r+=l.nodeSize;continue t}o(l,r),c<i&&e.child(c).sameMarkup(l)?t(e.child(c),l,r+1,o):l.nodesBetween(0,l.content.size,o,r+1),r+=l.nodeSize}}(e.doc,t.doc,0,r):t.doc.descendants(r),n}function et(t){var e,n=t.selection,r=b(t),o=r.node(-1),i=r.start(-1),s=d.get(o);return(e=n instanceof A?s.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):s.findCell(r.pos-i)).tableStart=i,e.map=s,e.table=o,e}function nt(t,e,n){var r=e.map,o=e.tableStart,i=e.table,s=n>0?-1:0;(function(t,e,n){for(var r=z(e.type.schema).header_cell,o=0;o<t.height;o++)if(e.nodeAt(t.map[n+o*t.width]).type!=r)return!1;return!0})(r,i,n+s)&&(s=0==n||n==r.width?null:0);for(var a=0;a<r.height;a++){var c=a*r.width+n;if(n>0&&n<r.width&&r.map[c-1]==r.map[c]){var l=r.map[c],u=i.nodeAt(l);t.setNodeMarkup(t.mapping.map(o+l),null,T(u.attrs,n-r.colCount(l))),a+=u.attrs.rowspan-1}else{var h=null==s?z(i.type.schema).cell:i.nodeAt(r.map[c+s]).type,p=r.positionAt(a,n,i);t.insert(t.mapping.map(o+p),h.createAndFill())}}return t}function rt(t,e){if(!y(t))return!1;if(e){var n=et(t);e(nt(t.tr,n,n.left))}return!0}function ot(t,e){if(!y(t))return!1;if(e){var n=et(t);e(nt(t.tr,n,n.right))}return!0}function it(t,e,n){for(var r=e.map,o=e.table,i=e.tableStart,s=t.mapping.maps.length,a=0;a<r.height;){var c=a*r.width+n,l=r.map[c],u=o.nodeAt(l);if(n>0&&r.map[c-1]==l||n<r.width-1&&r.map[c+1]==l)t.setNodeMarkup(t.mapping.slice(s).map(i+l),null,M(u.attrs,n-r.colCount(l)));else{var h=t.mapping.slice(s).map(i+l);t.delete(h,h+u.nodeSize)}a+=u.attrs.rowspan}}function st(t,e){if(!y(t))return!1;if(e){var n=et(t),r=t.tr;if(0==n.left&&n.right==n.map.width)return!1;for(var o=n.right-1;it(r,n,o),o!=n.left;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=d.get(n.table);e(r)}return!0}function at(t,e,n){for(var r=z(e.type.schema).header_cell,o=0;o<t.width;o++)if(e.nodeAt(t.map[o+n*t.width]).type!=r)return!1;return!0}function ct(t,e,n){for(var r=e.map,o=e.tableStart,i=e.table,s=o,a=0;a<n;a++)s+=i.child(a).nodeSize;var c=[],l=n>0?-1:0;at(r,i,n+l)&&(l=0==n||n==r.height?null:0);for(var u=0,h=r.width*n;u<r.width;u++,h++)if(n>0&&n<r.height&&r.map[h]==r.map[h-r.width]){var p=r.map[h],f=i.nodeAt(p).attrs;t.setNodeMarkup(o+p,null,N(f,"rowspan",f.rowspan+1)),u+=f.colspan-1}else{var d=null==l?z(i.type.schema).cell:i.nodeAt(r.map[h+l*r.width]).type;c.push(d.createAndFill())}return t.insert(s,z(i.type.schema).row.create(null,c)),t}function lt(t,e){if(!y(t))return!1;if(e){var n=et(t);e(ct(t.tr,n,n.top))}return!0}function ut(t,e){if(!y(t))return!1;if(e){var n=et(t);e(ct(t.tr,n,n.bottom))}return!0}function ht(t,e,n){for(var r=e.map,o=e.table,i=e.tableStart,s=0,a=0;a<n;a++)s+=o.child(a).nodeSize;var c=s+o.child(n).nodeSize,l=t.mapping.maps.length;t.delete(s+i,c+i);for(var u=0,h=n*r.width;u<r.width;u++,h++){var p=r.map[h];if(n>0&&p==r.map[h-r.width]){var f=o.nodeAt(p).attrs;t.setNodeMarkup(t.mapping.slice(l).map(p+i),null,N(f,"rowspan",f.rowspan-1)),u+=f.colspan-1}else if(n<r.width&&p==r.map[h+r.width]){var d=o.nodeAt(p),v=d.type.create(N(d.attrs,"rowspan",d.attrs.rowspan-1),d.content),m=r.positionAt(n+1,u,o);t.insert(t.mapping.slice(l).map(i+m),v),u+=d.attrs.colspan-1}}}function pt(t,e){if(!y(t))return!1;if(e){var n=et(t),r=t.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(var o=n.bottom-1;ht(r,n,o),o!=n.top;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=d.get(n.table);e(r)}return!0}function ft(t){var e=t.content;return 1==e.childCount&&e.firstChild.isTextblock&&0==e.firstChild.childCount}function dt(t,e){var n=t.selection;if(!(n instanceof A)||n.$anchorCell.pos==n.$headCell.pos)return!1;var r=et(t),o=r.map;if(function(t,e){for(var n=t.width,r=t.height,o=t.map,i=e.top*n+e.left,s=i,a=(e.bottom-1)*n+e.left,c=i+(e.right-e.left-1),l=e.top;l<e.bottom;l++){if(e.left>0&&o[s]==o[s-1]||e.right<n&&o[c]==o[c+1])return!0;s+=n,c+=n}for(var u=e.left;u<e.right;u++){if(e.top>0&&o[i]==o[i-n]||e.bottom<r&&o[a]==o[a+n])return!0;i++,a++}return!1}(o,r))return!1;if(e){for(var i,a,c=t.tr,l={},u=s.c.empty,h=r.top;h<r.bottom;h++)for(var p=r.left;p<r.right;p++){var f=o.map[h*o.width+p],d=r.table.nodeAt(f);if(!l[f])if(l[f]=!0,null==i)i=f,a=d;else{ft(d)||(u=u.append(d.content));var v=c.mapping.map(f+r.tableStart);c.delete(v,v+d.nodeSize)}}if(c.setNodeMarkup(i+r.tableStart,null,N(T(a.attrs,a.attrs.colspan,r.right-r.left-a.attrs.colspan),"rowspan",r.bottom-r.top)),u.size){var m=i+1+a.content.size,g=ft(a)?i+1:m;c.replaceWith(g+r.tableStart,m+r.tableStart,u)}c.setSelection(new A(c.doc.resolve(i+r.tableStart))),e(c)}return!0}function vt(t,e){var n=z(t.schema);return mt((function(t){var e=t.node;return n[e.type.spec.tableRole]}))(t,e)}function mt(t){return function(e,n){var r,o,i=e.selection;if(i instanceof A){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;r=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(!(r=function(t){for(var e=t.depth;e>0;e--){var n=t.node(e).type.spec.tableRole;if("cell"===n||"header_cell"===n)return t.node(e)}return null}(i.$from)))return!1;o=g(i.$from).pos}if(1==r.attrs.colspan&&1==r.attrs.rowspan)return!1;if(n){var s=r.attrs,a=[],c=s.colwidth;s.rowspan>1&&(s=N(s,"rowspan",1)),s.colspan>1&&(s=N(s,"colspan",1));for(var l,u=et(e),h=e.tr,p=0;p<u.right-u.left;p++)a.push(c?N(s,"colwidth",c&&c[p]?[c[p]]:null):s);for(var f=u.top;f<u.bottom;f++){var d=u.map.positionAt(f,u.left,u.table);f==u.top&&(d+=r.nodeSize);for(var v=u.left,m=0;v<u.right;v++,m++)v==u.left&&f==u.top||h.insert(l=h.mapping.map(d+u.tableStart,1),t({node:r,row:f,col:v}).createAndFill(a[m]))}h.setNodeMarkup(o,t({node:r,row:u.top,col:u.left}),a[0]),i instanceof A&&h.setSelection(new A(h.doc.resolve(i.$anchorCell.pos),l&&h.doc.resolve(l))),n(h)}return!0}}function gt(t,e){return function(n,r){if(!y(n))return!1;var o=b(n);if(o.nodeAfter.attrs[t]===e)return!1;if(r){var i=n.tr;n.selection instanceof A?n.selection.forEachCell((function(n,r){n.attrs[t]!==e&&i.setNodeMarkup(r,null,N(n.attrs,t,e))})):i.setNodeMarkup(o.pos,null,N(o.nodeAfter.attrs,t,e)),r(i)}return!0}}function yt(t,e,n){for(var r=e.map.cellsInRect({left:0,top:0,right:"row"==t?e.map.width:1,bottom:"column"==t?e.map.height:1}),o=0;o<r.length;o++){var i=e.table.nodeAt(r[o]);if(i&&i.type!==n.header_cell)return!1}return!0}function bt(t,e){return(e=e||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(t){return function(e,n){if(!y(e))return!1;if(n){for(var r=z(e.schema),o=et(e),i=e.tr,s=o.map.cellsInRect("column"==t?new f(o.left,0,o.right,o.map.height):"row"==t?new f(0,o.top,o.map.width,o.bottom):o),a=s.map((function(t){return o.table.nodeAt(t)})),c=0;c<s.length;c++)a[c].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[c],r.cell,a[c].attrs);if(0==i.steps.length)for(var l=0;l<s.length;l++)i.setNodeMarkup(o.tableStart+s[l],r.header_cell,a[l].attrs);n(i)}return!0}}(t):function(e,n){if(!y(e))return!1;if(n){var r=z(e.schema),o=et(e),i=e.tr,s=yt("row",o,r),a=yt("column",o,r),c=("column"===t?s:"row"===t&&a)?1:0,l="column"==t?new f(0,c,1,o.map.height):"row"==t?new f(c,0,o.map.width,1):o,u="column"==t?a?r.cell:r.header_cell:"row"==t?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(l).forEach((function(t){var e=t+o.tableStart,n=i.doc.nodeAt(e);n&&i.setNodeMarkup(e,u,n.attrs)})),n(i)}return!0}}var wt=bt("row",{useDeprecatedLogic:!0}),xt=bt("column",{useDeprecatedLogic:!0}),kt=bt("cell",{useDeprecatedLogic:!0});function St(t){return function(e,n){if(!y(e))return!1;var r=function(t,e){if(e<0){var n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(var r=t.index(-1)-1,o=t.before();r>=0;r--){var i=t.node(-1).child(r);if(i.childCount)return o-1-i.lastChild.nodeSize;o-=i.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;for(var s=t.node(-1),a=t.indexAfter(-1),c=t.after();a<s.childCount;a++){var l=s.child(a);if(l.childCount)return c+1;c+=l.nodeSize}}}(b(e),t);if(null!=r){if(n){var o=e.doc.resolve(r);n(e.tr.setSelection(i.TextSelection.between(o,x(o))).scrollIntoView())}return!0}}}function Ct(t,e){for(var n=t.selection.$anchor,r=n.depth;r>0;r--){if("table"==n.node(r).type.spec.tableRole)return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0}return!1}var Ot=function(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Nt(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function Nt(t,e,n,r,o,i){for(var s=0,a=!0,c=e.firstChild,l=t.firstChild,u=0,h=0;u<l.childCount;u++)for(var p=l.child(u).attrs,f=p.colspan,d=p.colwidth,v=0;v<f;v++,h++){var m=o==h?i:d&&d[v],g=m?m+"px":"";s+=m||r,m||(a=!1),c?(c.style.width!=g&&(c.style.width=g),c=c.nextSibling):e.appendChild(document.createElement("col")).style.width=g}for(;c;){var y=c.nextSibling;c.parentNode.removeChild(c),c=y}a?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}Ot.prototype.update=function(t){return t.type==this.node.type&&(this.node=t,Nt(t,this.colgroup,this.table,this.cellMinWidth),!0)},Ot.prototype.ignoreMutation=function(t){return"attributes"==t.type&&(t.target==this.table||this.colgroup.contains(t.target))};var Mt=new i.PluginKey("tableColumnResizing");function Tt(t){void 0===t&&(t={});var e=t.handleWidth;void 0===e&&(e=5);var n=t.cellMinWidth;void 0===n&&(n=25);var r=t.View;void 0===r&&(r=Ot);var o=t.lastColumnResizable;return void 0===o&&(o=!0),new i.Plugin({key:Mt,state:{init:function(t,e){return this.spec.props.nodeViews[z(e.schema).table.name]=function(t,e){return new r(t,n,e)},new At(-1,!1)},apply:function(t,e){return e.apply(t)}},props:{attributes:function(t){return Mt.getState(t).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(t,n){!function(t,e,n,r,o){var i=Mt.getState(t.state);if(!i.dragging){var s=function(t){for(;t&&"TD"!=t.nodeName&&"TH"!=t.nodeName;)t=t.classList.contains("ProseMirror")?null:t.parentNode;return t}(e.target),a=-1;if(s){var c=s.getBoundingClientRect(),l=c.left,u=c.right;e.clientX-l<=n?a=Et(t,e,"left"):u-e.clientX<=n&&(a=Et(t,e,"right"))}if(a!=i.activeHandle){if(!o&&-1!==a){var h=t.state.doc.resolve(a),p=h.node(-1),f=d.get(p),v=h.start(-1);if(f.colCount(h.pos-v)+h.nodeAfter.attrs.colspan-1==f.width-1)return}Pt(t,a)}}}(t,n,e,0,o)},mouseleave:function(t){!function(t){var e=Mt.getState(t.state);e.activeHandle>-1&&!e.dragging&&Pt(t,-1)}(t)},mousedown:function(t,e){!function(t,e,n){var r=Mt.getState(t.state);if(-1==r.activeHandle||r.dragging)return!1;var o=t.state.doc.nodeAt(r.activeHandle),i=function(t,e,n){var r=n.colspan,o=n.colwidth,i=o&&o[o.length-1];if(i)return i;var s=t.domAtPos(e),a=s.node.childNodes[s.offset].offsetWidth,c=r;if(o)for(var l=0;l<r;l++)o[l]&&(a-=o[l],c--);return a/c}(t,r.activeHandle,o.attrs);function s(e){window.removeEventListener("mouseup",s),window.removeEventListener("mousemove",a);var r=Mt.getState(t.state);r.dragging&&(!function(t,e,n){for(var r=t.state.doc.resolve(e),o=r.node(-1),i=d.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,c=t.state.tr,l=0;l<i.height;l++){var u=l*i.width+a;if(!l||i.map[u]!=i.map[u-i.width]){var h=i.map[u],p=o.nodeAt(h).attrs,f=1==p.colspan?0:a-i.colCount(h);if(!p.colwidth||p.colwidth[f]!=n){var v=p.colwidth?p.colwidth.slice():It(p.colspan);v[f]=n,c.setNodeMarkup(s+h,null,N(p,"colwidth",v))}}}c.docChanged&&t.dispatch(c)}(t,r.activeHandle,Dt(r.dragging,e,n)),t.dispatch(t.state.tr.setMeta(Mt,{setDragging:null})))}function a(e){if(!e.which)return s(e);var r=Mt.getState(t.state),o=Dt(r.dragging,e,n);!function(t,e,n,r){var o=t.state.doc.resolve(e),i=o.node(-1),s=o.start(-1),a=d.get(i).colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1,c=t.domAtPos(o.start(-1)).node;for(;"TABLE"!=c.nodeName;)c=c.parentNode;Nt(i,c.firstChild,c,r,a,n)}(t,r.activeHandle,o,n)}t.dispatch(t.state.tr.setMeta(Mt,{setDragging:{startX:e.clientX,startWidth:i}})),window.addEventListener("mouseup",s),window.addEventListener("mousemove",a),e.preventDefault()}(t,e,n)}},decorations:function(t){var e=Mt.getState(t);if(e.activeHandle>-1)return function(t,e){for(var n=[],r=t.doc.resolve(e),o=r.node(-1),i=d.get(o),s=r.start(-1),a=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan,l=0;l<i.height;l++){var u=a+l*i.width-1;if(!(a!=i.width&&i.map[u]==i.map[u+1]||0!=l&&i.map[u-1]==i.map[u-1-i.width])){var h=i.map[u],p=s+h+o.nodeAt(h).nodeSize-1,f=document.createElement("div");f.className="column-resize-handle",n.push(c.a.widget(p,f))}}return c.b.create(t.doc,n)}(t,e.activeHandle)},nodeViews:{}}})}var At=function(t,e){this.activeHandle=t,this.dragging=e};function Et(t,e,n){var r=t.posAtCoords({left:e.clientX,top:e.clientY}).pos,o=g(t.state.doc.resolve(r));if(!o)return-1;if("right"==n)return o.pos;var i=d.get(o.node(-1)),s=o.start(-1),a=i.map.indexOf(o.pos-s);return a%i.width==0?-1:s+i.map[a-1]}function Dt(t,e,n){var r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function Pt(t,e){t.dispatch(t.state.tr.setMeta(Mt,{setHandle:e}))}function It(t){for(var e=[],n=0;n<t;n++)e.push(0);return e}function Rt(t){void 0===t&&(t={});var e=t.allowTableNodeSelection;return void 0===e&&(e=!1),new i.Plugin({key:m,state:{init:function(){return null},apply:function(t,e){var n=t.getMeta(m);if(null!=n)return-1==n?null:n;if(null==e||!t.docChanged)return e;var r=t.mapping.mapResult(e),o=r.deleted,i=r.pos;return o?null:i}},props:{decorations:D,handleDOMEvents:{mousedown:G},createSelectionBetween:function(t){if(null!=m.getState(t.state))return t.state.selection},handleTripleClick:U,handleKeyDown:L,handlePaste:K},appendTransaction:function(t,n,r){return function(t,e,n){var r,o,s=(e||t).selection,a=(e||t).doc;if(s instanceof i.NodeSelection&&(o=s.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)r=A.create(a,s.from);else if("row"==o){var c=a.resolve(s.from+1);r=A.rowSelection(c,c)}else if(!n){var l=d.get(s.node),u=s.from+1,h=u+l.map[l.width*l.height-1];r=A.create(a,u+1,h)}}else s instanceof i.TextSelection&&function(t){var e=t.$from,n=t.$to;if(e.pos==n.pos||e.pos<e.pos-6)return!1;for(var r=e.pos,o=n.pos,i=e.depth;i>=0&&!(e.after(i+1)<e.end(i));i--,r++);for(var s=n.depth;s>=0&&!(n.before(s+1)>n.start(s));s--,o--);return r==o&&/row|table/.test(e.node(i).type.spec.tableRole)}(s)?r=i.TextSelection.create(a,s.from):s instanceof i.TextSelection&&function(t){for(var e,n,r=t.$from,o=t.$to,i=r.depth;i>0;i--){var s=r.node(i);if("cell"===s.type.spec.tableRole||"header_cell"===s.type.spec.tableRole){e=s;break}}for(var a=o.depth;a>0;a--){var c=o.node(a);if("cell"===c.type.spec.tableRole||"header_cell"===c.type.spec.tableRole){n=c;break}}return e!==n&&0===o.parentOffset}(s)&&(r=i.TextSelection.create(a,s.$from.start(),s.$from.end()));return r&&(e||(e=t.tr)).setSelection(r),e}(r,tt(r,n),e)}})}At.prototype.apply=function(t){var e=this,n=t.getMeta(Mt);if(n&&null!=n.setHandle)return new At(n.setHandle,null);if(n&&void 0!==n.setDragging)return new At(e.activeHandle,n.setDragging);if(e.activeHandle>-1&&t.docChanged){var r=t.mapping.map(e.activeHandle,-1);w(t.doc.resolve(r))||(r=null),e=new At(r,e.dragging)}return e}},function(t,e,n){"use strict";function r(t){this.content=t}r.prototype={constructor:r,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return-1==e?void 0:this.content[e+1]},update:function(t,e,n){var o=n&&n!=t?this.remove(n):this,i=o.find(t),s=o.content.slice();return-1==i?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new r(s)},remove:function(t){var e=this.find(t);if(-1==e)return this;var n=this.content.slice();return n.splice(e,2),new r(n)},addToStart:function(t,e){return new r([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new r(n)},addBefore:function(t,e,n){var o=this.remove(e),i=o.content.slice(),s=o.find(t);return i.splice(-1==s?i.length:s,0,e,n),new r(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=r.from(t)).size?new r(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=r.from(t)).size?new r(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=r.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},get size(){return this.content.length>>1}},r.from=function(t){if(t instanceof r)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new r(e)};var o=r;e.a=o},function(t,e,n){"use strict";n.r(e),n.d(e,"ContentMatch",(function(){return P})),n.d(e,"DOMParser",(function(){return Q})),n.d(e,"DOMSerializer",(function(){return lt})),n.d(e,"Fragment",(function(){return o})),n.d(e,"Mark",(function(){return l})),n.d(e,"MarkType",(function(){return Y})),n.d(e,"Node",(function(){return T})),n.d(e,"NodeRange",(function(){return O})),n.d(e,"NodeType",(function(){return H})),n.d(e,"ReplaceError",(function(){return u})),n.d(e,"ResolvedPos",(function(){return w})),n.d(e,"Schema",(function(){return X})),n.d(e,"Slice",(function(){return h}));var r=n(8);var o=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},i={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};o.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},o.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},o.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},o.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)r.push(t.content[i]);return new o(r,this.size+t.size)},o.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;c>t&&((s<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-s),Math.min(a.text.length,e-s)):a.cut(Math.max(0,t-s-1),Math.min(a.content.size,e-s-1))),n.push(a),r+=a.nodeSize),s=c}return new o(n,r)},o.prototype.cutByIndex=function(t,e){return t==e?o.empty:0==t&&e==this.content.length?this:new o(this.content.slice(t,e))},o.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),i=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new o(r,i)},o.prototype.addToStart=function(t){return new o([t].concat(this.content),this.size+t.nodeSize)},o.prototype.addToEnd=function(t){return new o(this.content.concat(t),this.size+t.nodeSize)},o.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},i.firstChild.get=function(){return this.content.length?this.content[0]:null},i.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},i.childCount.get=function(){return this.content.length},o.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},o.prototype.maybeChild=function(t){return this.content[t]},o.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},o.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},o.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},o.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return a(0,t);if(t==this.size)return a(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?a(n+1,o):a(n,r);r=o}},o.prototype.toString=function(){return"<"+this.toStringInner()+">"},o.prototype.toStringInner=function(){return this.content.join(", ")},o.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},o.fromJSON=function(t,e){if(!e)return o.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new o(e.map(t.nodeFromJSON))},o.fromArray=function(t){if(!t.length)return o.empty;for(var e,n=0,r=0;r<t.length;r++){var i=t[r];n+=i.nodeSize,r&&i.isText&&t[r-1].sameMarkup(i)?(e||(e=t.slice(0,r)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new o(e||t,n)},o.from=function(t){if(!t)return o.empty;if(t instanceof o)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new o([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(o.prototype,i);var s={index:0,offset:0};function a(t,e){return s.index=t,s.offset=e,s}function c(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!c(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&c(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}o.empty=new o([],0);var l=function(t,e){this.type=t,this.attrs=e};function u(t){var e=Error.call(this,t);return e.__proto__=u.prototype,e}l.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},l.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},l.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},l.prototype.eq=function(t){return this==t||this.type==t.type&&c(this.attrs,t.attrs)},l.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},l.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},l.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},l.setFrom=function(t){if(!t||0==t.length)return l.none;if(t instanceof l)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},l.none=[],u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,u.prototype.name="ReplaceError";var h=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},p={size:{configurable:!0}};function f(t,e,n){if(n.openStart>t.depth)throw new u("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new u("Inconsistent open depths");return function t(e,n,r,i){var s=e.index(i),a=e.node(i);if(s==n.index(i)&&i<e.depth-r.openStart){var c=t(e,n,r,i+1);return a.copy(a.content.replaceChild(s,c))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=i||n.depth!=i){var l=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),i=n-1;i>=0;i--)r=e.node(i).copy(o.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),u=l.start,h=l.end;return y(a,function t(e,n,r,i,s){var a=e.depth>s&&v(e,n,s+1),c=i.depth>s&&v(r,i,s+1),l=[];g(null,e,s,l),a&&c&&n.index(s)==r.index(s)?(d(a,c),m(y(a,t(e,n,r,i,s+1)),l)):(a&&m(y(a,b(e,n,s+1)),l),g(n,r,s,l),c&&m(y(c,b(r,i,s+1)),l));return g(i,null,s,l),new o(l)}(e,u,h,n,i))}var p=e.parent,f=p.content;return y(p,f.cut(0,e.parentOffset).append(r.content).append(f.cut(n.parentOffset)))}return y(a,b(e,n,i))}(t,e,n,0)}function d(t,e){if(!e.type.compatibleContent(t.type))throw new u("Cannot join "+e.type.name+" onto "+t.type.name)}function v(t,e,n){var r=t.node(n);return d(r,e.node(n)),r}function m(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function g(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(m(t.nodeAfter,r),i++));for(var a=i;a<s;a++)m(o.child(a),r);e&&e.depth==n&&e.textOffset&&m(e.nodeBefore,r)}function y(t,e){if(!t.type.validContent(e))throw new u("Invalid content for node "+t.type.name);return t.copy(e)}function b(t,e,n){var r=[];(g(null,t,n,r),t.depth>n)&&m(y(v(t,e,n+1),b(t,e,n+1)),r);return g(e,null,n,r),new o(r)}p.size.get=function(){return this.content.size-this.openStart-this.openEnd},h.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new h(n,this.openStart,this.openEnd)},h.prototype.removeBetween=function(t,e){return new h(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},h.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},h.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},h.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},h.fromJSON=function(t,e){if(!e)return h.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new h(o.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},h.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new h(t,n,r)},Object.defineProperties(h.prototype,p),h.empty=new h(o.empty,0,0);var w=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},x={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};w.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},x.parent.get=function(){return this.node(this.depth)},x.doc.get=function(){return this.node(0)},w.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},w.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},w.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},w.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},w.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},w.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},w.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},x.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},x.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},x.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},w.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return l.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},w.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},w.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},w.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new O(this,t,n)},w.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},w.prototype.max=function(t){return t.pos>this.pos?t:this},w.prototype.min=function(t){return t.pos<this.pos?t:this},w.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},w.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new w(e,n,o)},w.resolveCached=function(t,e){for(var n=0;n<k.length;n++){var r=k[n];if(r.pos==e&&r.doc==t)return r}var o=k[S]=w.resolve(t,e);return S=(S+1)%C,o},Object.defineProperties(w.prototype,x);var k=[],S=0,C=12,O=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},N={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};N.start.get=function(){return this.$from.before(this.depth+1)},N.end.get=function(){return this.$to.after(this.depth+1)},N.parent.get=function(){return this.$from.node(this.depth)},N.startIndex.get=function(){return this.$from.index(this.depth)},N.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(O.prototype,N);var M=Object.create(null),T=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||o.empty,this.marks=r||l.none},A={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};A.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},A.childCount.get=function(){return this.content.childCount},T.prototype.child=function(t){return this.content.child(t)},T.prototype.maybeChild=function(t){return this.content.maybeChild(t)},T.prototype.forEach=function(t){this.content.forEach(t)},T.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},T.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},A.textContent.get=function(){return this.textBetween(0,this.content.size,"")},T.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},A.firstChild.get=function(){return this.content.firstChild},A.lastChild.get=function(){return this.content.lastChild},T.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},T.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},T.prototype.hasMarkup=function(t,e,n){return this.type==t&&c(this.attrs,e||t.defaultAttrs||M)&&l.sameSet(this.marks,n||l.none)},T.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},T.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},T.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},T.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return h.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new h(a,r.depth-i,o.depth-i)},T.prototype.replace=function(t,e,n){return f(this.resolve(t),this.resolve(e),n)},T.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},T.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},T.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},T.prototype.resolve=function(t){return w.resolveCached(this,t)},T.prototype.resolveNoCache=function(t){return w.resolve(this,t)},T.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},A.isBlock.get=function(){return this.type.isBlock},A.isTextblock.get=function(){return this.type.isTextblock},A.inlineContent.get=function(){return this.type.inlineContent},A.isInline.get=function(){return this.type.isInline},A.isText.get=function(){return this.type.isText},A.isLeaf.get=function(){return this.type.isLeaf},A.isAtom.get=function(){return this.type.isAtom},T.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),D(this.marks,t)},T.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},T.prototype.canReplace=function(t,e,n,r,i){void 0===n&&(n=o.empty),void 0===r&&(r=0),void 0===i&&(i=n.childCount);var s=this.contentMatchAt(t).matchFragment(n,r,i),a=s&&s.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<i;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},T.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},T.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},T.prototype.defaultContentType=function(t){return this.contentMatchAt(t).defaultType},T.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},T.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},T.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=o.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(T.prototype,A);var E=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):D(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(T);function D(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var P=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},I={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};P.parse=function(t,e){var n=new R(t,e);if(null==n.next)return P.empty;var r=_(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];L(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new P(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(V);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(L(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},P.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},P.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},I.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},I.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},P.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},P.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function i(s,a){var c=s.matchFragment(t,n);if(c&&(!e||c.validEnd))return o.from(a.map((function(t){return t.createAndFill()})));for(var l=0;l<s.next.length;l+=2){var u=s.next[l],h=s.next[l+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(h)){r.push(h);var p=i(h,a.concat(u));if(p)return p}}}(this,[])},P.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},P.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},I.edgeCount.get=function(){return this.next.length>>1},P.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},P.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(P.prototype,I),P.empty=new P(!0);var R=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},z={next:{configurable:!0}};function _(t){var e=[];do{e.push($(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function $(t){var e=[];do{e.push(B(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function B(t){for(var e=function(t){if(t.eat("(")){var e=_(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=F(t,e)}return e}function j(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function F(t,e){var n=j(t),r=n;return t.eat(",")&&(r="}"!=t.next?j(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function V(t,e){return e-t}function L(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(V)}function q(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function J(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function W(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new K(t[n]);return e}z.next.get=function(){return this.tokens[this.pos]},R.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},R.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(R.prototype,z);var H=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=W(n.attrs),this.defaultAttrs=q(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},U={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};U.isInline.get=function(){return!this.isBlock},U.isTextblock.get=function(){return this.isBlock&&this.inlineContent},U.isLeaf.get=function(){return this.contentMatch==P.empty},U.isAtom.get=function(){return this.isLeaf||this.spec.atom},H.prototype.hasRequiredAttrs=function(t){for(var e in this.attrs)if(this.attrs[e].isRequired&&(!t||!(e in t)))return!0;return!1},H.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},H.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:J(this.attrs,t)},H.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new T(this,this.computeAttrs(t),o.from(e),l.setFrom(n))},H.prototype.createChecked=function(t,e,n){if(e=o.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new T(this,this.computeAttrs(t),e,l.setFrom(n))},H.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=o.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var i=this.contentMatch.matchFragment(e).fillBefore(o.empty,!0);return i?new T(this,t,e.append(i),l.setFrom(n)):null},H.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},H.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},H.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},H.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:l.empty:t},H.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new H(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(H.prototype,U);var K=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},G={isRequired:{configurable:!0}};G.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(K.prototype,G);var Y=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=W(r.attrs),this.rank=e,this.excluded=null;var o=q(this.attrs);this.instance=o&&new l(this,o)};Y.prototype.create=function(t){return!t&&this.instance?this.instance:new l(this,J(this.attrs,t))},Y.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new Y(t,r++,e,o)})),n},Y.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},Y.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},Y.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var X=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=H.compile(this.spec.nodes,this),this.marks=Y.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=P.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?Z(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:Z(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Z(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}X.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof H))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},X.prototype.text=function(t,e){var n=this.nodes.text;return new E(n,n.defaultAttrs,t,l.setFrom(e))},X.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},X.prototype.nodeFromJSON=function(t){return T.fromJSON(this,t)},X.prototype.markFromJSON=function(t){return l.fromJSON(this,t)},X.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Q=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};Q.prototype.parse=function(t,e){void 0===e&&(e={});var n=new it(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Q.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new it(this,e,!0);return n.addAll(t,null,e.from,e.to),h.maxOpen(n.finish())},Q.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(at(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},Q.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Q.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=ct(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=ct(t)),t.node=s}));return e},Q.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Q(t,Q.schemaRules(t)))};var tt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},et={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nt={ol:!0,ul:!0};function rt(t){return(t?1:0)|("full"===t?2:0)}var ot=function(t,e,n,r,o,i){this.type=t,this.attrs=e,this.solid=r,this.match=o||(4&i?null:t.contentMatch),this.options=i,this.content=[],this.marks=n,this.activeMarks=l.none};ot.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(o.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},ot.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=o.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(o.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r};var it=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.pendingMarks=[];var r,o=e.topNode,i=rt(e.preserveWhitespace)|(n?4:0);r=o?new ot(o.type,o.attrs,l.none,!0,e.topMatch||o.type.contentMatch,i):new ot(n?null:t.schema.topNodeType,null,l.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},st={top:{configurable:!0},currentPos:{configurable:!0}};function at(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function ct(t){var e={};for(var n in t)e[n]=t[n];return e}st.top.get=function(){return this.nodes[this.open]},it.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null;if(null!=n)for(var r=0;r<n.length;r++)this.addPendingMark(n[r]);if(this.addElement(t),null!=n)for(var o=0;o<n.length;o++)this.removePendingMark(n[o])}},it.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},it.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();nt.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&nt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:et.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(tt.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},it.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},it.prototype.readStyles=function(t){for(var e=l.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},it.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o)},it.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&tt.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},it.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},it.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;this.applyPendingMarks(n),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},it.prototype.applyPendingMarks=function(t){for(var e=0;e<this.pendingMarks.length;e++){var n=this.pendingMarks[e];t.type&&!t.type.allowsMarkType(n.type)||n.isInSet(t.activeMarks)||(t.activeMarks=n.addToSet(t.activeMarks),this.pendingMarks.splice(e--,1))}},it.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&(this.applyPendingMarks(this.top),this.enterInner(t,e,!0,n)),r},it.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:rt(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new ot(t,e,o.activeMarks,n,null,i)),this.open++},it.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},it.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},it.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},it.prototype.addPendingMark=function(t){this.pendingMarks.push(t)},it.prototype.removePendingMark=function(t){var e=this.pendingMarks.lastIndexOf(t);if(e>-1)this.pendingMarks.splice(e,1);else{var n=this.top;n.activeMarks=t.removeFromSet(n.activeMarks)}},st.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},it.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},it.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},it.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},it.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},it.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},it.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Object.defineProperties(it.prototype,st);var lt=function(t,e){this.nodes=t||{},this.marks=e||{}};function ut(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function ht(t){return t.document||window.document}lt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=ht(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},lt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=lt.renderSpec(ht(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},lt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},lt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&lt.renderSpec(ht(n),r(t,e))},lt.renderSpec=function(t,e){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var n=t.createElement(e[0]),r=null,o=e[1],i=1;if(o&&"object"==typeof o&&null==o.nodeType&&!Array.isArray(o))for(var s in i=2,o)null!=o[s]&&n.setAttribute(s,o[s]);for(var a=i;a<e.length;a++){var c=e[a];if(0===c){if(a<e.length-1||a>i)throw new RangeError("Content hole must be the only child of its parent node");return{dom:n,contentDOM:n}}var l=lt.renderSpec(t,c),u=l.dom,h=l.contentDOM;if(n.appendChild(u),h){if(r)throw new RangeError("Multiple content holes");r=h}}return{dom:n,contentDOM:r}},lt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new lt(this.nodesFromSchema(t),this.marksFromSchema(t)))},lt.nodesFromSchema=function(t){var e=ut(t.nodes);return e.text||(e.text=function(t){return t.text}),e},lt.marksFromSchema=function(t){return ut(t.marks)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return b}));for(var r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},o=r,i={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:";",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},s="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),a="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),c="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),l="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),u="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),h=s&&(l||+s[1]<57)||c&&l,p=0;p<10;p++)r[48+p]=r[96+p]=String(p);for(p=1;p<=24;p++)r[p+111]="F"+p;for(p=65;p<=90;p++)r[p]=String.fromCharCode(p+32),i[p]=String.fromCharCode(p);for(var f in r)i.hasOwnProperty(f)||(i[f]=r[f]);var d=function(t){var e=!(h&&(t.ctrlKey||t.altKey||t.metaKey)||(a||u)&&t.shiftKey&&t.key&&1==t.key.length)&&t.key||(t.shiftKey?i:r)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e},v=n(1),m="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function g(t){var e,n,r,o,i=t.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(var a=0;a<i.length-1;a++){var c=i[a];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))e=!0;else if(/^(c|ctrl|control)$/i.test(c))n=!0;else if(/^s(hift)?$/i.test(c))r=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);m?o=!0:n=!0}}return e&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}function y(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==n&&e.shiftKey&&(t="Shift-"+t),t}function b(t){return new v.Plugin({props:{handleKeyDown:w(t)}})}function w(t){var e=function(t){var e=Object.create(null);for(var n in t)e[g(n)]=t[n];return e}(t);return function(t,n){var r,i=d(n),s=1==i.length&&" "!=i,a=e[y(i,n,!s)];if(a&&a(t.state,t.dispatch,t))return!0;if(s&&(n.shiftKey||n.altKey||n.metaKey)&&(r=o[n.keyCode])&&r!=i){var c=e[y(r,n,!0)];if(c&&c(t.state,t.dispatch,t))return!0}else if(s&&n.shiftKey){var l=e[y(i,n,!0)];if(l&&l(t.state,t.dispatch,t))return!0}return!1}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return we})),n.d(e,"b",(function(){return Ce}));var r=n(1),o=n(2),i=n(5),s={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var a=/Edge\/(\d+)/.exec(navigator.userAgent),c=/MSIE \d/.test(navigator.userAgent),l=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);s.mac=/Mac/.test(navigator.platform);var u=s.ie=!!(c||l||a);s.ie_version=c?document.documentMode||6:l?+l[1]:a?+a[1]:null,s.gecko=!u&&/gecko\/(\d+)/i.test(navigator.userAgent),s.gecko_version=s.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var h=!u&&/Chrome\/(\d+)/.exec(navigator.userAgent);s.chrome=!!h,s.chrome_version=h&&+h[1],s.ios=!u&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),s.android=/Android \d/.test(navigator.userAgent),s.webkit=!u&&"WebkitAppearance"in document.documentElement.style,s.safari=/Apple Computer/.test(navigator.vendor),s.webkit_version=s.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var p=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},f=function(t){var e=t.parentNode;return e&&11==e.nodeType?e.host:e},d=function(t,e,n){var r=document.createRange();return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},v=function(t,e,n,r){return n&&(g(t,e,n,r,-1)||g(t,e,n,r,1))},m=/^(img|br|input|textarea|hr)$/i;function g(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:y(t))){var i=t.parentNode;if(1!=i.nodeType||b(t)||m.test(t.nodeName)||"false"==t.contentEditable)return!1;e=p(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if("false"==(t=t.childNodes[e+(o<0?-1:0)]).contentEditable)return!1;e=o<0?y(t):0}}}function y(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function b(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var w=function(t){var e=t.isCollapsed;return e&&s.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function x(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function k(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function S(t,e){return"number"==typeof t?t:t[e]}function C(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,s=i.defaultView,a=n||t.dom;a;a=f(a))if(1==a.nodeType){var c=a==i.body||1!=a.nodeType,l=c?k(s):a.getBoundingClientRect(),u=0,h=0;if(e.top<l.top+S(r,"top")?h=-(l.top-e.top+S(o,"top")):e.bottom>l.bottom-S(r,"bottom")&&(h=e.bottom-l.bottom+S(o,"bottom")),e.left<l.left+S(r,"left")?u=-(l.left-e.left+S(o,"left")):e.right>l.right-S(r,"right")&&(u=e.right-l.right+S(o,"right")),(u||h)&&(c?s.scrollBy(u,h):(h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u),e={left:e.left-u,top:e.top-h,right:e.right-u,bottom:e.bottom-h})),c)break}}function O(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=f(t));return e}function N(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=s&&(o.scrollLeft=s)}}var M=null;function T(t,e){for(var n,r,o=2e8,i=0,s=e.top,a=e.top,c=t.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(1==c.nodeType)u=c.getClientRects();else{if(3!=c.nodeType)continue;u=d(c).getClientRects()}for(var h=0;h<u.length;h++){var p=u[h];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);var f=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(f<o){n=c,o=f,r=f&&3==n.nodeType?{left:p.right<e.left?p.right:p.left,top:e.top}:e,1==c.nodeType&&f&&(i=l+(e.left>=(p.left+p.right)/2?1:0));continue}}!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);var i=D(r,1);if(i.top!=i.bottom&&A(e,i))return{node:t,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:i}:T(n,r)}function A(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function E(t,e){var n,r,o,i,a=t.root;if(a.caretPositionFromPoint)try{var c=a.caretPositionFromPoint(e.left,e.top);c&&(o=(n=c).offsetNode,i=n.offset)}catch(t){}if(!o&&a.caretRangeFromPoint){var l=a.caretRangeFromPoint(e.left,e.top);l&&(o=(r=l).startContainer,i=r.startOffset)}var u,h=a.elementFromPoint(e.left,e.top+1);if(!h||!t.dom.contains(1!=h.nodeType?h.parentNode:h)){var p=t.dom.getBoundingClientRect();if(!A(e,p))return null;if(!(h=function t(e,n,r){var o=e.childNodes.length;if(o&&r.top<r.bottom)for(var i=Math.max(0,Math.min(o-1,Math.floor(o*(n.top-r.top)/(r.bottom-r.top))-2)),s=i;;){var a=e.childNodes[s];if(1==a.nodeType)for(var c=a.getClientRects(),l=0;l<c.length;l++){var u=c[l];if(A(n,u))return t(a,n,u)}if((s=(s+1)%o)==i)break}return e}(t.dom,e,p)))return null}if(h=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(h,e),o){if(s.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var f,d=o.childNodes[i];"IMG"==d.nodeName&&(f=d.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}o==t.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&e.top>o.lastChild.getBoundingClientRect().bottom?u=t.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(u=function(t,e,n,r){for(var o=-1,i=e;i!=t.dom;){var s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n)}(t,o,i,e))}null==u&&(u=function(t,e,n){var r=T(e,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(o,i,s)}(t,h,e));var v=t.docView.nearestDesc(h,!0);return{pos:u,inside:v?v.posAtStart-v.border:-1}}function D(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}function P(t,e){var n=t.docView.domFromPos(e),r=n.node,o=n.offset;if(3==r.nodeType&&(s.chrome||s.gecko)){var i=D(d(r,o,o),0);if(s.gecko&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){var a=D(d(r,o-1,o-1),-1);if(Math.abs(a.left-i.left)<1&&a.top==i.top){var c=D(d(r,o,o+1),-1);return I(c,c.left<a.left)}}return i}if(1==r.nodeType&&!t.state.doc.resolve(e).parent.inlineContent){var l,u=!0;if(o<r.childNodes.length){var h=r.childNodes[o];1==h.nodeType&&(l=h.getBoundingClientRect())}if(!l&&o){var p=r.childNodes[o-1];1==p.nodeType&&(l=p.getBoundingClientRect(),u=!1)}return function(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}(l||r.getBoundingClientRect(),u)}for(var f=-1;f<2;f+=2)if(f<0&&o){var v=void 0,m=3==r.nodeType?d(r,o-1,o):3==(v=r.childNodes[o-1]).nodeType?d(v):1==v.nodeType&&"BR"!=v.nodeName?v:null;if(m){var g=D(m,1);if(g.top<g.bottom)return I(g,!1)}}else if(f>0&&o<y(r)){var b=void 0,w=3==r.nodeType?d(r,o,o+1):3==(b=r.childNodes[o]).nodeType?d(b):1==b.nodeType?b:null;if(w){var x=D(w,-1);if(x.top<x.bottom)return I(x,!0)}}return I(D(3==r.nodeType?d(r):r,0),!1)}function I(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function R(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o.focus()}}var z=/[\u0590-\u08ac]/;var _=null,$=null,B=!1;function j(t,e,n){return _==e&&$==n?B:(_=e,$=n,B="up"==n||"down"==n?function(t,e,n){var r=e.selection,o="up"==n?r.$anchor.min(r.$head):r.$anchor.max(r.$head);return R(t,e,(function(){for(var e=t.docView.domFromPos(o.pos).node;;){var r=t.docView.nearestDesc(e,!0);if(!r)break;if(r.node.isBlock){e=r.dom;break}e=r.dom.parentNode}for(var i=P(t,o.pos),s=e.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=d(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top&&("up"==n?l.bottom<i.top+1:l.top>i.bottom-1))return!1}}return!0}))}(t,e,n):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=getSelection();return z.test(r.parent.textContent)&&a.modify?R(t,e,(function(){var e=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(e),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(t,e,n))}var F=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},V={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0}};F.prototype.matchesWidget=function(){return!1},F.prototype.matchesMark=function(){return!1},F.prototype.matchesNode=function(){return!1},F.prototype.matchesHack=function(){return!1},V.beforePosition.get=function(){return!1},F.prototype.parseRule=function(){return null},F.prototype.stopEvent=function(){return!1},V.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},V.border.get=function(){return 0},F.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},F.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},V.posBefore.get=function(){return this.parent.posBeforeChild(this)},V.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},V.posAfter.get=function(){return this.posBefore+this.size},V.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},F.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var l=t;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},F.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!e||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(t):o.nodeDOM==t))return o;n=!1}}},F.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},F.prototype.posFromDOM=function(t,e,n){for(var r=t;;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}},F.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(t<o)return r.descAt(t-n-r.border);n=o}},F.prototype.domFromPos=function(t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var e=0,n=0;;n++){if(e==t){for(;n<this.children.length&&(this.children[n].beforePosition||this.children[n].dom.parentNode!=this.contentDOM);)n++;return{node:this.contentDOM,offset:n==this.children.length?this.contentDOM.childNodes.length:p(this.children[n].dom)}}if(n==this.children.length)throw new Error("Invalid position "+t);var r=this.children[n],o=e+r.size;if(t<o)return r.domFromPos(t-e-r.border);e=o}},F.prototype.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&t<=c){var l=i+a.border;if(t>=l&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,l);t=i;for(var u=s;u>0;u--){var h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){r=p(h.dom)+1;break}t-=h.size}-1==r&&(r=0)}if(r>-1&&e<=c){e=c;for(var f=s+1;f<this.children.length;f++){var d=this.children[f];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=p(d.dom);break}e+=d.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},F.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},F.prototype.domAfterPos=function(t){var e=this.domFromPos(t),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},F.prototype.setSelection=function(t,e,n,r){for(var o=Math.min(t,e),i=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(o>a&&i<l)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=l}var u=this.domFromPos(t),h=this.domFromPos(e),p=n.getSelection(),f=document.createRange();if(r||!v(u.node,u.offset,p.anchorNode,p.anchorOffset)||!v(h.node,h.offset,p.focusNode,p.focusOffset)){if(p.extend)f.setEnd(u.node,u.offset),f.collapse(!1);else{if(t>e){var d=u;u=h,h=d}f.setEnd(h.node,h.offset),f.setStart(u.node,u.offset)}p.removeAllRanges(),p.addRange(f),p.extend&&p.extend(h.node,h.offset)}},F.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},V.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},F.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){var s=n+o.border,a=i-o.border;if(t>=s&&e<=a)return this.dirty=t==n||e==i?2:1,void(t!=s||e!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-s,e-s):o.dirty=3);o.dirty=3}n=i}this.dirty=2},F.prototype.markParentsDirty=function(){for(var t=this.parent;t;t=t.parent){t.dirty<2&&(t.dirty=2)}},Object.defineProperties(F.prototype,V);var L=[],q=function(t){function e(e,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}t.call(this,e,L,s,null),this.widget=n,i=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},e.prototype.ignoreMutation=function(t){return"selection"!=t.type||this.widget.spec.ignoreSelection},Object.defineProperties(e.prototype,n),e}(F),J=function(t){function e(e,n,r,o){t.call(this,e,L,n,null),this.textDOM=r,this.text=o}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(F),W=function(t){function e(e,n,r,o){t.call(this,e,[],r,o),this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,n,r,i){var s=i.nodeViews[n.type.name],a=s&&s(n,i,r);return a&&a.dom||(a=o.b.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,a.dom,a.contentDOM||a.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=at(i,n,s,r)),t>0&&(i=at(i,0,t,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},e}(F),H=function(t){function e(e,n,r,o,i,s,a,c,l){t.call(this,e,n.isLeaf?L:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0}};return e.create=function(t,n,r,i,s,a){var c,l,u=s.nodeViews[n.type.name],h=u&&u(n,s,(function(){return l?l.parent?l.parent.posBeforeChild(l):void 0:a}),r),p=h&&h.dom,f=h&&h.contentDOM;if(n.isText)if(p){if(3!=p.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else p=document.createTextNode(n.text);else p||(p=(c=o.b.renderSpec(document,n.type.spec.toDOM(n))).dom,f=c.contentDOM);f||n.isText||"BR"==p.nodeName||(p.hasAttribute("contenteditable")||(p.contentEditable=!1),n.type.spec.draggable&&(p.draggable=!0));var d=p;return p=nt(p,r,n),h?l=new Y(t,n,r,i,p,f,d,h,s,a+1):n.isText?new K(t,n,r,i,p,d,s):new e(t,n,r,i,p,f,d,s,a+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?o.c.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&rt(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,i=e,s=r&&t.composing&&this.localCompositionNode(t,e),a=new it(this,s&&s.node);!function(t,e,n,r){var o=e.locals(t),i=0;if(0==o.length){for(var s=0;s<t.childCount;s++){var a=t.child(s);r(a,o,e.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,l=[],u=null,h=0;;){if(c<o.length&&o[c].to==i){for(var p=o[c++],f=void 0;c<o.length&&o[c].to==i;)(f||(f=[p])).push(o[c++]);if(f){f.sort(st);for(var d=0;d<f.length;d++)n(f[d],h,!!u)}else n(p,h,!!u)}var v=void 0,m=void 0;if(u)m=-1,v=u,u=null;else{if(!(h<t.childCount))break;m=h,v=t.child(h++)}for(var g=0;g<l.length;g++)l[g].to<=i&&l.splice(g--,1);for(;c<o.length&&o[c].from==i;)l.push(o[c++]);var y=i+v.nodeSize;if(v.isText){var b=y;c<o.length&&o[c].from<b&&(b=o[c].from);for(var w=0;w<l.length;w++)l[w].to<b&&(b=l[w].to);b<y&&(u=v.cut(b-i),v=v.cut(0,b-i),y=b,m=-1)}r(v,l.length?l.slice():L,e.forChild(i,v),m),i=y}}(this.node,this.innerDeco,(function(e,s,c){e.spec.marks?a.syncToMarks(e.spec.marks,r,t):e.type.side>=0&&!c&&a.syncToMarks(s==n.node.childCount?o.d.none:n.node.child(s).marks,r,t),a.placeWidget(e,t,i)}),(function(e,n,o,s){a.syncToMarks(e.marks,r,t),a.findNodeMatch(e,n,o,s)||a.updateNextNode(e,n,o,t,s)||a.addNode(e,n,o,t,i),i+=e.nodeSize})),a.syncToMarks(L,r,t),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(s&&this.protectLocalComposition(t,s),this.renderChildren())},e.prototype.renderChildren=function(){!function t(e,n){for(var r=e.firstChild,o=0;o<n.length;o++){var i=n[o],s=i.dom;if(s.parentNode==e){for(;s!=r;)r=ot(r);r=r.nextSibling}else e.insertBefore(s,r);if(i instanceof W){var a=r?r.previousSibling:e.lastChild;t(i.contentDOM,i.children),r=a?a.nextSibling:e.firstChild}}for(;r;)r=ot(r)}(this.contentDOM,this.children),s.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom)},e.prototype.localCompositionNode=function(t,e){var n=t.state.selection,o=n.from,i=n.to;if(!(!(t.state.selection instanceof r.TextSelection)||o<e||i>e+this.node.content.size)){var s=t.root.getSelection(),a=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];t=t.childNodes[e-1],e=y(t)}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(s.focusNode,s.focusOffset);if(a&&this.dom.contains(a.parentNode)){var c=a.nodeValue,l=function(t,e,n,r){for(var o=0,i=0;o<t.childCount&&i<=r;){var s=t.child(o++),a=i;if(i+=s.nodeSize,s.isText){for(var c=s.text;o<t.childCount;){var l=t.child(o++);if(i+=l.nodeSize,!l.isText)break;c+=l.text}if(i>=n){var u=c.lastIndexOf(e,r-a);if(u>=0&&u+e.length+a>=n)return a+u}}}return-1}(this.node.content,c,o-e,i-e);return l<0?null:{node:a,pos:l,text:c}}}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,o=e.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new J(this,i,n,o);t.compositionNodes.push(s),this.children=at(this.children,r,r+o.length,t,s)}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!rt(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=tt(this.dom,this.nodeDOM,Q(this.outerDeco,this.node,e),Q(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!1)},Object.defineProperties(e.prototype,n),e}(F);function U(t,e,n,r,o){return nt(r,e,t),new H(null,t,e,n,r,r,r,o,0)}var K=function(t){function e(e,n,r,o,i,s,a){t.call(this,e,n,r,o,i,null,s,a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{skip:this.nodeDOM.parentNode||!0}},e.prototype.update=function(t,e){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text),this.node=t,this.dirty=0,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){var o=this.node.cut(t,n),i=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},e}(H),G=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(){return 0==this.dirty},e}(F),Y=function(t){function e(e,n,r,o,i,s,a,c,l,u){t.call(this,e,n,r,o,i,s,a,l,u),this.spec=c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(e,n);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,o)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(H);function X(t){t&&(this.nodeName=t)}X.prototype=Object.create(null);var Z=[new X];function Q(t,e,n){if(0==t.length)return Z;for(var r=n?Z[0]:new X,o=[r],i=0;i<t.length;i++){var s=t[i].type.attrs,a=r;if(s)for(var c in s.nodeName&&o.push(a=new X(s.nodeName)),s){var l=s[c];null!=l&&(n&&1==o.length&&o.push(a=r=new X(e.isInline?"span":"div")),"class"==c?a.class=(a.class?a.class+" ":"")+l:"style"==c?a.style=(a.style?a.style+";":"")+l:"nodeName"!=c&&(a[c]=l))}}return o}function tt(t,e,n,r){if(n==Z&&r==Z)return e;for(var o=e,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=t&&(c=o.parentNode)&&c.tagName.toLowerCase()==s.nodeName||((c=document.createElement(s.nodeName)).appendChild(o),a=Z[0]),o=c}et(o,a||Z[0],s)}return o}function et(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" "):L,s=n.class?n.class.split(" "):L,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&t.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&t.classList.add(s[c])}if(e.style!=n.style){if(e.style)for(var l,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=u.exec(e.style);)t.style.removeProperty(l[1]);n.style&&(t.style.cssText+=n.style)}}function nt(t,e,n){return tt(t,t,Z,Q(e,n,1!=t.nodeType))}function rt(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function ot(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var it=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1;var n=function(t,e){for(var n=[],r=t.childCount,o=e.length-1;r>0&&o>=0;o--){var i=e[o],s=i.node;if(s){if(s!=t.child(r-1))break;n.push(i),--r}}return{nodes:n.reverse(),offset:r}}(t.node.content,t.children);this.preMatched=n.nodes,this.preMatchOffset=n.offset};function st(t,e){return t.type.side-e.type.side}function at(t,e,n,r,o){for(var i=[],s=0,a=0;s<t.length;s++){var c=t[s],l=a,u=a+=c.size;l>=n||u<=e?i.push(c):(l<e&&i.push(c.slice(0,e-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function ct(t,e){var n=t.selection,o=n.$anchor,i=n.$head,s=e>0?o.max(i):o.min(i),a=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return a&&r.Selection.findFrom(a,e)}function lt(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function ut(t,e,n){var o=t.state.selection;if(o instanceof r.TextSelection){if(!o.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){var i=ct(t.state,e);return!!(i&&i instanceof r.NodeSelection)&&lt(t,i)}var a,c=o.$head,l=c.textOffset?null:e<0?c.nodeBefore:c.nodeAfter;if(!l||l.isText)return!1;var u=e<0?c.pos-l.nodeSize:c.pos;return!!(l.isAtom||(a=t.docView.descAt(u))&&!a.contentDOM)&&(r.NodeSelection.isSelectable(l)?lt(t,new r.NodeSelection(e<0?t.state.doc.resolve(c.pos-l.nodeSize):c)):!!s.webkit&&lt(t,new r.TextSelection(t.state.doc.resolve(e<0?u:u+l.nodeSize))))}if(o instanceof r.NodeSelection&&o.node.isInline)return lt(t,new r.TextSelection(e>0?o.$to:o.$from));var h=ct(t.state,e);return!!h&&lt(t,h)}function ht(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function pt(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function ft(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,a=!1;for(s.gecko&&1==n.nodeType&&r<ht(n)&&pt(n.childNodes[r])&&(a=!0);;)if(r>0){if(1!=n.nodeType)break;var c=n.childNodes[r-1];if(pt(c))o=n,i=--r;else{if(3!=c.nodeType)break;r=(n=c).nodeValue.length}}else{if(vt(n))break;for(var l=n.previousSibling;l&&pt(l);)o=n.parentNode,i=p(l),l=l.previousSibling;if(l)r=ht(n=l);else{if((n=n.parentNode)==t.dom)break;r=0}}a?mt(t,e,n,r):o&&mt(t,e,o,i)}}function dt(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,s=ht(n);;)if(r<s){if(1!=n.nodeType)break;if(!pt(n.childNodes[r]))break;o=n,i=++r}else{if(vt(n))break;for(var a=n.nextSibling;a&&pt(a);)o=a.parentNode,i=p(a)+1,a=a.nextSibling;if(a)r=0,s=ht(n=a);else{if((n=n.parentNode)==t.dom)break;r=s=0}}o&&mt(t,e,o,i)}}function vt(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function mt(t,e,n,r){if(w(e)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),e.removeAllRanges(),e.addRange(o)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection()}function gt(t,e,n){var o=t.state.selection;if(o instanceof r.TextSelection&&!o.empty||n.indexOf("s")>-1)return!1;var i=o.$from,s=o.$to;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var a=ct(t.state,e);if(a&&a instanceof r.NodeSelection)return lt(t,a)}if(!i.parent.inlineContent){var c=r.Selection.findFrom(e<0?i:s,e);return!c||lt(t,c)}return!1}function yt(t,e){if(!(t.state.selection instanceof r.TextSelection))return!0;var n=t.state.selection,o=n.$head,i=n.$anchor,s=n.empty;if(!o.sameParent(i))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var a=!o.textOffset&&(e<0?o.nodeBefore:o.nodeAfter);if(a&&!a.isText){var c=t.state.tr;return e<0?c.delete(o.pos-a.nodeSize,o.pos):c.delete(o.pos,o.pos+a.nodeSize),t.dispatch(c),!0}return!1}function bt(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function wt(t,e){var n=e.keyCode,r=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||s.mac&&72==n&&"c"==r?yt(t,-1)||ft(t):46==n||s.mac&&68==n&&"c"==r?yt(t,1)||dt(t):13==n&&!s.ios||27==n||(37==n?ut(t,-1,r)||ft(t):39==n?ut(t,1,r)||dt(t):38==n?gt(t,-1,r)||ft(t):40==n?function(t){if(s.chrome&&!(t.state.selection.$head.parentOffset>0)){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;bt(t,o,!0),setTimeout((function(){return bt(t,o,!1)}),20)}}}(t)||gt(t,1,r)||dt(t):r==(s.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function xt(t,e){var n,o,i=t.root.getSelection(),s=t.state.doc,a=t.docView.nearestDesc(i.focusNode),c=a&&0==a.size,l=t.docView.posFromDOM(i.focusNode,i.focusOffset),u=s.resolve(l);if(w(i)){for(n=u;a&&!a.node;)a=a.parent;if(a&&a.node.isAtom&&r.NodeSelection.isSelectable(a.node)&&a.parent&&(!a.node.isInline||!function(t,e,n){for(var r=0==e,o=e==y(t);r||o;){if(t==n)return!0;var i=p(t);if(!(t=t.parentNode))return!1;r=r&&0==i,o=o&&i==y(t)}}(i.focusNode,i.focusOffset,a.dom))){var h=a.posBefore;o=new r.NodeSelection(l==h?u:s.resolve(h))}}else n=s.resolve(t.docView.posFromDOM(i.anchorNode,i.anchorOffset));o||(o=At(t,n,u,"pointer"==e||t.state.selection.head<u.pos&&!c?1:-1));return o}function kt(t,e){var n=t.state.selection;if(Mt(t,n),t.editable?t.hasFocus():Et(t)&&document.activeElement.contains(t.dom)){if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,p(r)+1):n.setEnd(r,0);n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&s.ie&&s.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{var o,i,a=n.anchor,c=n.head;!St||n instanceof r.TextSelection||(n.$from.parent.inlineContent||(o=Ct(t,n.from)),n.empty||n.$from.parent.inlineContent||(i=Ct(t,n.to))),t.docView.setSelection(a,c,t.root,e),St&&(o&&Nt(o),i&&Nt(i)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):a!=c&&(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.hideSelectionGuard),t.dom.classList.remove("ProseMirror-hideselection"))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}it.prototype.getPreMatch=function(t){return t>=this.preMatchOffset?this.preMatched[t-this.preMatchOffset]:null},it.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},it.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},it.prototype.syncToMarks=function(t,e,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,t.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(t[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=W.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},it.prototype.findNodeMatch=function(t,e,n,r){var o=-1,i=r<0?void 0:this.getPreMatch(r),s=this.top.children;if(i&&i.matchesNode(t,e,n))o=s.indexOf(i);else for(var a=this.index,c=Math.min(s.length,a+5);a<c;a++){var l=s[a];if(l.matchesNode(t,e,n)&&this.preMatched.indexOf(l)<0){o=a;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},it.prototype.updateNextNode=function(t,e,n,r,o){if(this.index==this.top.children.length)return!1;var i=this.top.children[this.index];if(i instanceof H){var s=this.preMatched.indexOf(i);if(s>-1&&s+this.preMatchOffset!=o)return!1;var a=i.dom;if(!(this.lock&&(a==this.lock||1==a.nodeType&&a.contains(this.lock.parentNode))&&!(t.isText&&i.node&&i.node.isText&&i.nodeDOM.nodeValue==t.text&&3!=i.dirty&&rt(e,i.outerDeco)))&&i.update(t,e,n,r))return i.dom!=a&&(this.changed=!0),this.index++,!0}return!1},it.prototype.addNode=function(t,e,n,r,o){this.top.children.splice(this.index++,0,H.create(this.top,t,e,n,r,o)),this.changed=!0},it.prototype.placeWidget=function(t,e,n){if(this.index<this.top.children.length&&this.top.children[this.index].matchesWidget(t))this.index++;else{var r=new q(this.top,t,e,n);this.top.children.splice(this.index++,0,r),this.changed=!0}},it.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof W;)t=t.children[t.children.length-1];if(!t||!(t instanceof K)||/\n$/.test(t.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var e=document.createElement("br");this.top.children.splice(this.index++,0,new G(this.top,L,e,null)),this.changed=!0}};var St=s.safari||s.chrome&&s.chrome_version<63;function Ct(t,e){var n=t.docView.domFromPos(e),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,a=o?r.childNodes[o-1]:null;if(s.safari&&i&&"false"==i.contentEditable)return Ot(i);if(!(i&&"false"!=i.contentEditable||a&&"false"!=a.contentEditable)){if(i)return Ot(i);if(a)return Ot(a)}}function Ot(t){return t.contentEditable="true",s.safari&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Nt(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function Mt(t,e){if(e instanceof r.NodeSelection){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Tt(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Tt(t)}function Tt(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function At(t,e,n,o){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||r.TextSelection.between(e,n,o)}function Et(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function Dt(t){var e=t.pmViewDesc;if(e)return e.parseRule();if("BR"==t.nodeName&&t.parentNode){if(s.safari&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(t.parentNode.lastChild==t||s.safari&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if("IMG"==t.nodeName&&t.getAttribute("mark-placeholder"))return{ignore:!0}}function Pt(t,e,n,i,a){if(e<0){var c=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,l=xt(t,c);if(!t.state.selection.eq(l)){var u=t.state.tr.setSelection(l);"pointer"==c?u.setMeta("pointer",!0):"key"==c&&u.scrollIntoView(),t.dispatch(u)}}else{var h=t.state.doc.resolve(e),p=h.sharedDepth(n);e=h.before(p+1),n=t.state.doc.resolve(n).after(p+1);var f,d,v=t.state.selection,m=function(t,e,n){var r=t.docView.parseRange(e,n),i=r.node,a=r.fromOffset,c=r.toOffset,l=r.from,u=r.to,h=t.root.getSelection(),p=null,f=h.anchorNode;if(f&&t.dom.contains(1==f.nodeType?f:f.parentNode)&&(p=[{node:f,offset:h.anchorOffset}],w(h)||p.push({node:h.focusNode,offset:h.focusOffset})),s.chrome&&8===t.lastKeyCode)for(var d=c;d>a;d--){var v=i.childNodes[d-1],m=v.pmViewDesc;if("BR"==v.nodeType&&!m){c=d;break}if(!m||m.size)break}var g=t.state.doc,y=t.someProp("domParser")||o.a.fromSchema(t.state.schema),b=g.resolve(l),x=null,k=y.parse(i,{topNode:b.parent,topMatch:b.parent.contentMatchAt(b.index()),topOpen:!0,from:a,to:c,preserveWhitespace:!b.parent.type.spec.code||"full",editableContent:!0,findPositions:p,ruleFromNode:Dt,context:b});if(p&&null!=p[0].pos){var S=p[0].pos,C=p[1]&&p[1].pos;null==C&&(C=S),x={anchor:S+l,head:C+l}}return{doc:k,sel:x,from:l,to:u}}(t,e,n),g=t.state.doc,y=g.slice(m.from,m.to);8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(f=t.state.selection.to,d="end"):(f=t.state.selection.from,d="start"),t.lastKeyCode=null;var b=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size),a=s.a,c=s.b;if("end"==o){var l=Math.max(0,i-Math.min(a,c));r-=a+l-i}if(a<i&&t.size<e.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(y.content,m.doc.content,m.from,f,d);if(!b){if(!(i&&v instanceof r.TextSelection&&!v.empty&&v.$head.sameParent(v.$anchor))||t.composing||m.sel&&m.sel.anchor!=m.sel.head){if(m.sel){var k=It(t,t.state.doc,m.sel);k&&!k.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(k))}return}b={start:v.from,endA:v.to,endB:v.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&b.start==b.endB&&t.state.selection instanceof r.TextSelection&&(b.start>t.state.selection.from&&b.start<=t.state.selection.from+2?b.start=t.state.selection.from:b.endA<t.state.selection.to&&b.endA>=t.state.selection.to-2&&(b.endB+=t.state.selection.to-b.endA,b.endA=t.state.selection.to)),s.ie&&s.ie_version<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>m.from&&" "==m.doc.textBetween(b.start-m.from-1,b.start-m.from+1)&&(b.start--,b.endA--,b.endB--);var S,C=m.doc.resolveNoCache(b.start-m.from),O=m.doc.resolveNoCache(b.endB-m.from);if((s.ios&&t.lastIOSEnter>Date.now()-100&&(!C.sameParent(O)||a.some((function(t){return"DIV"==t.nodeName})))||!C.sameParent(O)&&C.pos<m.doc.content.size&&(S=r.Selection.findFrom(m.doc.resolve(C.pos+1),1,!0))&&S.head==O.pos)&&t.someProp("handleKeyDown",(function(e){return e(t,x(13,"Enter"))})))t.lastIOSEnter=0;else if(t.state.selection.anchor>b.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||Rt(r,!0,!1)<o.pos)return!1;var i=t.resolve(e);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=t.resolve(Rt(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||Rt(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(g,b.start,b.endA,C,O)&&t.someProp("handleKeyDown",(function(e){return e(t,x(8,"Backspace"))})))s.android&&s.chrome&&t.domObserver.suppressSelectionUpdates();else{var N,M,T,A,E=b.start,D=b.endA;if(C.sameParent(O)&&C.parent.inlineContent)if(C.pos==O.pos)s.ie&&s.ie_version<=11&&0==C.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return kt(t)}),20)),N=t.state.tr.delete(E,D),M=g.resolve(b.start).marksAcross(g.resolve(b.endA));else if(b.endA==b.endB&&(A=g.resolve(b.start))&&(T=function(t,e){for(var n,r,i,s=t.firstChild.marks,a=e.firstChild.marks,c=s,l=a,u=0;u<a.length;u++)c=a[u].removeFromSet(c);for(var h=0;h<s.length;h++)l=s[h].removeFromSet(l);if(1==c.length&&0==l.length)r=c[0],n="add",i=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=c.length||1!=l.length)return null;r=l[0],n="remove",i=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var p=[],f=0;f<e.childCount;f++)p.push(i(e.child(f)));if(o.c.from(p).eq(t))return{mark:r,type:n}}(C.parent.content.cut(C.parentOffset,O.parentOffset),A.parent.content.cut(A.parentOffset,b.endA-A.start()))))N=t.state.tr,"add"==T.type?N.addMark(E,D,T.mark):N.removeMark(E,D,T.mark);else if(C.parent.child(C.index()).isText&&C.index()==O.index()-(O.textOffset?0:1)){var P=C.parent.textBetween(C.parentOffset,O.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,E,D,P)})))return;N=t.state.tr.insertText(P,E,D)}if(N||(N=t.state.tr.replace(E,D,m.doc.slice(b.start-m.from,b.endB-m.from))),m.sel){var I=It(t,N.doc,m.sel);I&&!(s.chrome&&s.android&&t.composing&&I.empty&&I.head==E||s.ie&&I.empty&&I.head==E)&&N.setSelection(I)}M&&N.ensureMarks(M),t.dispatch(N.scrollIntoView())}}}function It(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:At(t,e.resolve(n.anchor),e.resolve(n.head))}function Rt(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function zt(t,e){for(var n=[],r=e.content,i=e.openStart,s=e.openEnd;i>1&&s>1&&1==r.childCount&&1==r.firstChild.childCount;){i--,s--;var a=r.firstChild;n.push(a.type.name,a.type.hasRequiredAttrs()?a.attrs:null),r=a.content}var c=t.someProp("clipboardSerializer")||o.b.fromSchema(t.state.schema),l=Vt(),u=l.createElement("div");u.appendChild(c.serializeFragment(r,{document:l}));for(var h,p=u.firstChild;p&&1==p.nodeType&&(h=jt[p.nodeName.toLowerCase()]);){for(var f=h.length-1;f>=0;f--){for(var d=l.createElement(h[f]);u.firstChild;)d.appendChild(u.firstChild);u.appendChild(d)}p=u.firstChild}return p&&1==p.nodeType&&p.setAttribute("data-pm-slice",i+" "+s+" "+JSON.stringify(n)),{dom:u,text:t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n")}}function _t(t,e,n,r,i){var s,a,c=i.parent.type.spec.code;if(!n&&!e)return null;var l=e&&(r||c||!n);if(l){if(t.someProp("transformPastedText",(function(t){e=t(e)})),c)return new o.i(o.c.from(t.state.schema.text(e)),0,0);var u=t.someProp("clipboardTextParser",(function(t){return t(e,i)}));u?a=u:(s=document.createElement("div"),e.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){s.appendChild(document.createElement("p")).textContent=t})))}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),s=function(t){var e=/(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=Vt().createElement("div"),o=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(t),i=0;(n=o&&jt[o[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join(""),i=n.length);r.innerHTML=t;for(var s=0;s<i;s++)r=r.firstChild;return r}(n);var h=s&&s.querySelector("[data-pm-slice]"),p=h&&/^(\d+) (\d+) (.*)/.exec(h.getAttribute("data-pm-slice"));if(!a){var f=t.someProp("clipboardParser")||t.someProp("domParser")||o.a.fromSchema(t.state.schema);a=f.parseSlice(s,{preserveWhitespace:!(!l&&!p),context:i})}return a=p?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var i=t.content,s=t.openStart,a=t.openEnd,c=n.length-2;c>=0;c-=2){var l=r.nodes[n[c]];if(!l||l.hasRequiredAttrs())break;i=o.c.from(l.create(n[c+1],i)),s++,a++}return new o.i(i,s,a)}(function(t,e,n){e<t.openStart&&(t=new o.i(Bt(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd));n<t.openEnd&&(t=new o.i(Bt(t.content,1,n,t.openEnd,0,0),t.openStart,n));return t}(a,+p[1],+p[2]),p[3]):o.i.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),i=void 0,s=[];if(t.forEach((function(t){if(s){var e,n=r.findWrapping(t.type);if(!n)return s=null;if(e=s.length&&i.length&&function t(e,n,r,i,s){if(s<e.length&&s<n.length&&e[s]==n[s]){var a=t(e,n,r,i.lastChild,s+1);if(a)return i.copy(i.content.replaceChild(i.childCount-1,a));if(i.contentMatchAt(i.childCount).matchType(s==e.length-1?r.type:e[s+1]))return i.copy(i.content.append(o.c.from($t(r,e,s+1))))}}(n,i,t,s[s.length-1],0))s[s.length-1]=e;else{s.length&&(s[s.length-1]=function t(e,n){if(0==n)return e;var r=e.content.replaceChild(e.childCount-1,t(e.lastChild,n-1)),i=e.contentMatchAt(e.childCount).fillBefore(o.c.empty,!0);return e.copy(r.append(i))}(s[s.length-1],i.length));var a=$t(t,n);s.push(a),r=r.matchType(a.type,a.attrs),i=n}}})),s)return{v:o.c.from(s)}},r=e.depth;r>=0;r--){var i=n(r);if(i)return i.v}return t}(a.content,i),!1),t.someProp("transformPasted",(function(t){a=t(a)})),a}function $t(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,o.c.from(t));return t}function Bt(t,e,n,r,i,s){var a=e<0?t.firstChild:t.lastChild,c=a.content;return i<r-1&&(c=Bt(c,e,n,r,i+1,s)),i>=n&&(c=e<0?a.contentMatchAt(0).fillBefore(c,t.childCount>1||s<=i).append(c):c.append(a.contentMatchAt(a.childCount).fillBefore(o.c.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,a.copy(c))}var jt={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Ft=null;function Vt(){return Ft||(Ft=document.implementation.createHTMLDocument("title"))}var Lt={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},qt=s.ie&&s.ie_version<=11,Jt=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Jt.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},Jt.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var Wt=function(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=!1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);s.ie&&s.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Jt,qt&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Wt.prototype.flushSoon=function(){var t=this;this.flushingSoon||(this.flushingSoon=!0,window.setTimeout((function(){t.flushingSoon=!1,t.flush()}),20))},Wt.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Lt),qt&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Wt.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}qt&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Wt.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Wt.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Wt.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},Wt.prototype.onSelectionChange=function(){if((!(t=this.view).editable||t.root.activeElement==t.dom)&&Et(t)){var t;if(this.suppressingSelectionUpdates)return kt(this.view);if(s.ie&&s.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&v(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}},Wt.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Wt.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(e);return n&&n.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})?(this.setCurSelection(),!0):void 0},Wt.prototype.flush=function(){if(this.view.docView&&!this.flushingSoon){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&Et(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,i=!1,a=[];if(this.view.editable)for(var c=0;c<t.length;c++){var l=this.registerMutation(t[c],a);l&&(r=r<0?l.from:Math.min(l.from,r),o=o<0?l.to:Math.max(l.to,o),l.typeOver&&!this.view.composing&&(i=!0))}if(s.gecko&&a.length>1){var u=a.filter((function(t){return"BR"==t.nodeName}));if(2==u.length){var h=u[0],p=u[1];h.parentNode&&h.parentNode.parentNode==p.parentNode?p.remove():h.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(t){if(Ht)return;Ht=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i,a),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||kt(this.view))}},Wt.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){var r=t.previousSibling,o=t.nextSibling;if(s.ie&&s.ie_version<=11&&t.addedNodes.length)for(var i=0;i<t.addedNodes.length;i++){var a=t.addedNodes[i],c=a.previousSibling,l=a.nextSibling;(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(r=c),(!l||Array.prototype.indexOf.call(t.addedNodes,l)<0)&&(o=l)}for(var u=r&&r.parentNode==t.target?p(r)+1:0,h=n.localPosFromDOM(t.target,u,-1),f=o&&o.parentNode==t.target?p(o):t.target.childNodes.length,d=0;d<t.addedNodes.length;d++)e.push(t.addedNodes[d]);return{from:h,to:n.localPosFromDOM(t.target,f,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var Ht=!1;var Ut={},Kt={};function Gt(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function Yt(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return Xt(t,e)})}))}function Xt(t,e){return t.someProp("handleDOMEvents",(function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)}))}function Zt(t){return{left:t.clientX,top:t.clientY}}function Qt(t,e,n,r,o){if(-1==r)return!1;for(var i=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,(function(e){return r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function te(t,e,n){t.focused||t.focus();var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function ee(t,e,n,o,i){return Qt(t,"handleClickOn",e,n,o)||t.someProp("handleClick",(function(n){return n(t,e,o)}))||(i?function(t,e){if(-1==e)return!1;var n,o,i=t.state.selection;i instanceof r.NodeSelection&&(n=i.node);for(var s=t.state.doc.resolve(e),a=s.depth+1;a>0;a--){var c=a>s.depth?s.nodeAfter:s.node(a);if(r.NodeSelection.isSelectable(c)){o=n&&i.$from.depth>0&&a>=i.$from.depth&&s.before(i.$from.depth+1)==i.$from.pos?s.before(i.$from.depth):s.before(a);break}}return null!=o&&(te(t,r.NodeSelection.create(t.state.doc,o),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),o=n.nodeAfter;return!!(o&&o.isAtom&&r.NodeSelection.isSelectable(o))&&(te(t,new r.NodeSelection(n),"pointer"),!0)}(t,n))}function ne(t,e,n,r){return Qt(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}function re(t,e,n,o){return Qt(t,"handleTripleClickOn",e,n,o)||t.someProp("handleTripleClick",(function(n){return n(t,e,o)}))||function(t,e){var n=t.state.doc;if(-1==e)return!!n.inlineContent&&(te(t,r.TextSelection.create(n,0,n.content.size),"pointer"),!0);for(var o=n.resolve(e),i=o.depth+1;i>0;i--){var s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)te(t,r.TextSelection.create(n,a+1,a+1+s.content.size),"pointer");else{if(!r.NodeSelection.isSelectable(s))continue;te(t,r.NodeSelection.create(n,a),"pointer")}return!0}}(t,n)}function oe(t){return ue(t)}Kt.keydown=function(t,e){t.shiftKey=16==e.keyCode||e.shiftKey,ae(t,e)||(t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),!s.ios||13!=e.keyCode||e.ctrlKey||e.altKey||e.metaKey?t.someProp("handleKeyDown",(function(n){return n(t,e)}))||wt(t,e)?e.preventDefault():Gt(t,"key"):t.lastIOSEnter=Date.now())},Kt.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},Kt.keypress=function(t,e){if(!(ae(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||s.mac&&e.metaKey))if(t.someProp("handleKeyPress",(function(n){return n(t,e)})))e.preventDefault();else{var n=t.state.selection;if(!(n instanceof r.TextSelection&&n.$from.sameParent(n.$to))){var o=String.fromCharCode(e.charCode);t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,o)}))||t.dispatch(t.state.tr.insertText(o).scrollIntoView()),e.preventDefault()}}};var ie=s.mac?"metaKey":"ctrlKey";Ut.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n=oe(t),r=Date.now(),o="singleClick";r-t.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(e,t.lastClick)&&!e[ie]&&("singleClick"==t.lastClick.type?o="doubleClick":"doubleClick"==t.lastClick.type&&(o="tripleClick")),t.lastClick={time:r,x:e.clientX,y:e.clientY,type:o};var i=t.posAtCoords(Zt(e));i&&("singleClick"==o?t.mouseDown=new se(t,i,e,n):("doubleClick"==o?ne:re)(t,i.pos,i.inside,e)?e.preventDefault():Gt(t,"pointer"))};var se=function(t,e,n,o){var i,a,c=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=o,this.selectNode=n[ie],this.allowDefault=n.shiftKey,e.inside>-1)i=t.state.doc.nodeAt(e.inside),a=e.inside;else{var l=t.state.doc.resolve(e.pos);i=l.parent,a=l.depth?l.before():0}this.mightDrag=null;var u=o?null:n.target,h=u?t.docView.nearestDesc(u,!0):null;this.target=h?h.dom:null,(i.type.spec.draggable&&!1!==i.type.spec.selectable||t.state.selection instanceof r.NodeSelection&&a==t.state.selection.from)&&(this.mightDrag={node:i,pos:a,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&s.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){return c.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Gt(t,"pointer")};function ae(t,e){return!!t.composing||!!(s.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500)&&(t.compositionEndedAt=-2e8,!0)}se.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!1),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},se.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Zt(t))),this.allowDefault||!e?Gt(this.view,"pointer"):ee(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():!this.flushed&&(!s.chrome||this.view.state.selection instanceof r.TextSelection||e.pos!=this.view.state.selection.from&&e.pos!=this.view.state.selection.to)?Gt(this.view,"pointer"):(te(this.view,r.Selection.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault())}},se.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),Gt(this.view,"pointer")},Ut.touchdown=function(t){oe(t),Gt(t,"pointer")},Ut.contextmenu=function(t){return oe(t)};var ce=s.android?5e3:-1;function le(t,e){clearTimeout(t.composingTimeout),e>-1&&(t.composingTimeout=setTimeout((function(){return ue(t)}),e))}function ue(t,e){for(t.composing=!1;t.compositionNodes.length>0;)t.compositionNodes.pop().markParentsDirty();return!(!e&&!t.docView.dirty)&&(t.updateState(t.state),!0)}Kt.compositionstart=Kt.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),ue(t,!0),t.markCursor=null;else if(ue(t),s.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var a=i<0?o.lastChild:o.childNodes[i-1];if(!a)break;if(3==a.nodeType){r.collapse(a,a.nodeValue.length);break}o=a,i=-1}t.composing=!0}le(t,ce)},Kt.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,le(t,20))};var he=s.ie&&s.ie_version<15||s.ios&&s.webkit_version<604;function pe(t,e,n,r){var i=_t(t,e,n,t.shiftKey,t.state.selection.$from);if(!t.someProp("handlePaste",(function(e){return e(t,r,i||o.i.empty)}))&&i){var s=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(i),a=s?t.state.tr.replaceSelectionWith(s,t.shiftKey):t.state.tr.replaceSelection(i);t.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste"))}}Ut.copy=Kt.cut=function(t,e){var n=t.state.selection,r="cut"==e.type;if(!n.empty){var o=he?null:e.clipboardData,i=zt(t,n.content()),s=i.dom,a=i.text;o?(e.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(t,e){var n=t.dom.ownerDocument,r=n.body.appendChild(n.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";var o=getSelection(),i=n.createRange();i.selectNodeContents(e),t.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout((function(){n.body.removeChild(r),t.focus()}),50)}(t,s),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Kt.paste=function(t,e){var n=he?null:e.clipboardData,r=n&&n.getData("text/html"),o=n&&n.getData("text/plain");n&&(r||o||n.files.length)?(pe(t,o,r,e),e.preventDefault()):function(t,e){var n=t.dom.ownerDocument,r=t.shiftKey||t.state.selection.$from.parent.type.spec.code,o=n.body.appendChild(n.createElement(r?"textarea":"div"));r||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout((function(){t.focus(),n.body.removeChild(o),r?pe(t,o.value,null,e):pe(t,o.textContent,o.innerHTML,e)}),50)}(t,e)};var fe=function(t,e){this.slice=t,this.move=e},de=s.mac?"altKey":"ctrlKey";for(var ve in Ut.dragstart=function(t,e){var n=t.mouseDown;if(n&&n.done(),e.dataTransfer){var o=t.state.selection,i=o.empty?null:t.posAtCoords(Zt(e));if(i&&i.pos>=o.from&&i.pos<=(o instanceof r.NodeSelection?o.to-1:o.to));else if(n&&n.mightDrag)t.dispatch(t.state.tr.setSelection(r.NodeSelection.create(t.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var s=t.docView.nearestDesc(e.target,!0);if(!s||!s.node.type.spec.draggable||s==t.docView)return;t.dispatch(t.state.tr.setSelection(r.NodeSelection.create(t.state.doc,s.posBefore)))}var a=t.state.selection.content(),c=zt(t,a),l=c.dom,u=c.text;e.dataTransfer.clearData(),e.dataTransfer.setData(he?"Text":"text/html",l.innerHTML),he||e.dataTransfer.setData("text/plain",u),t.dragging=new fe(a,!e[de])}},Ut.dragend=function(t){window.setTimeout((function(){return t.dragging=null}),50)},Kt.dragover=Kt.dragenter=function(t,e){return e.preventDefault()},Kt.drop=function(t,e){var n=t.dragging;if(t.dragging=null,e.dataTransfer){var o=t.posAtCoords(Zt(e));if(o){var s=t.state.doc.resolve(o.pos);if(s){var a=n&&n.slice||_t(t,e.dataTransfer.getData(he?"Text":"text/plain"),he?null:e.dataTransfer.getData("text/html"),!1,s);if(a&&(e.preventDefault(),!t.someProp("handleDrop",(function(r){return r(t,e,a,n&&n.move)})))){var c=a?Object(i.g)(t.state.doc,s.pos,a):s.pos;null==c&&(c=s.pos);var l=t.state.tr;n&&n.move&&l.deleteSelection();var u=l.mapping.map(c),h=0==a.openStart&&0==a.openEnd&&1==a.content.childCount,p=l.doc;if(h?l.replaceRangeWith(u,u,a.content.firstChild):l.replaceRange(u,u,a),!l.doc.eq(p)){var f=l.doc.resolve(u);h&&r.NodeSelection.isSelectable(a.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(a.content.firstChild)?l.setSelection(new r.NodeSelection(f)):l.setSelection(At(t,f,l.doc.resolve(l.mapping.map(c)))),t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}}}}}},Ut.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout((function(){t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.root.getSelection())&&kt(t)}),20))},Ut.blur=function(t){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),t.domObserver.currentSelection.set({}),t.focused=!1)},Ut.beforeinput=function(t,e){if(s.chrome&&s.android&&"deleteContentBackward"==e.inputType){var n=t.domChangeCount;setTimeout((function(){if(t.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",(function(e){return e(t,x(8,"Backspace"))})))){var e=t.state.selection.$cursor;e&&e.pos>0&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView())}}),50)}},Kt)Ut[ve]=Kt[ve];function me(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var ge=function(t,e){this.spec=e||Se,this.side=this.spec.side||0,this.toDOM=t};ge.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new we(i-n,i-n,this)},ge.prototype.valid=function(){return!0},ge.prototype.eq=function(t){return this==t||t instanceof ge&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&me(this.spec,t.spec))};var ye=function(t,e){this.spec=e||Se,this.attrs=t};ye.prototype.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new we(o,i,this)},ye.prototype.valid=function(t,e){return e.from<e.to},ye.prototype.eq=function(t){return this==t||t instanceof ye&&me(this.attrs,t.attrs)&&me(this.spec,t.spec)},ye.is=function(t){return t.type instanceof ye};var be=function(t,e){this.spec=e||Se,this.attrs=t};be.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);if(o.deleted)return null;var i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new we(o.pos-n,i.pos-n,this)},be.prototype.valid=function(t,e){var n=t.content.findIndex(e.from),r=n.index,o=n.offset;return o==e.from&&o+t.child(r).nodeSize==e.to},be.prototype.eq=function(t){return this==t||t instanceof be&&me(this.attrs,t.attrs)&&me(this.spec,t.spec)};var we=function(t,e,n){this.from=t,this.to=e,this.type=n},xe={spec:{configurable:!0}};we.prototype.copy=function(t,e){return new we(t,e,this.type)},we.prototype.eq=function(t){return this.type.eq(t.type)&&this.from==t.from&&this.to==t.to},we.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},we.widget=function(t,e,n){return new we(t,t,new ge(e,n))},we.inline=function(t,e,n,r){return new we(t,e,new ye(n,r))},we.node=function(t,e,n,r){return new we(t,e,new be(n,r))},xe.spec.get=function(){return this.type.spec},Object.defineProperties(we.prototype,xe);var ke=[],Se={},Ce=function(t,e){this.local=t&&t.length?t:ke,this.children=e&&e.length?e:ke};Ce.create=function(t,e){return e.length?Ee(e,t,0,Se):Oe},Ce.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},Ce.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){var c=this.children[a]+1;this.children[a+2].findInner(t-c,e-c,n,r+c,o)}},Ce.prototype.map=function(t,e,n){return this==Oe||0==t.maps.length?this:this.mapInner(t,e,0,0,n||Se)},Ce.prototype.mapInner=function(t,e,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||t>c+i||(e>=a[s]+i?a[s+1]=-1:(l=r-n-(e-t)+(i-o))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,h=0;h<a.length;h+=3)if(-1==a[h+1]){var p=n.map(a[h]+i),f=p-o;if(f<0||f>=r.content.size){u=!0;continue}var d=n.map(t[h+1]+i,-1)-o,v=r.content.findIndex(f),m=v.index,g=v.offset,y=r.maybeChild(m);if(y&&g==f&&g+y.nodeSize==d){var b=a[h+2].mapInner(n,y,p+1,a[h]+i+1,s);b!=Oe?(a[h]=f,a[h+1]=d,a[h+2]=b):(a[h+1]=-2,u=!0)}else u=!0}if(u){var w=Ee(function(t,e,n,r,o,i,s){function a(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):s.onRemove&&s.onRemove(t.local[i].spec)}for(var l=0;l<t.children.length;l+=3)a(t.children[l+2],t.children[l]+e+1)}for(var c=0;c<t.length;c+=3)-1==t[c+1]&&a(t[c+2],e[c]+i+1);return n}(a,t,e||[],n,o,i,s),r,0,s);e=w.local;for(var x=0;x<a.length;x+=3)a[x+1]<0&&(a.splice(x,3),x-=3);for(var k=0,S=0;k<w.children.length;k+=3){for(var C=w.children[k];S<a.length&&a[S]<C;)S+=3;a.splice(S,0,w.children[k],w.children[k+1],w.children[k+2])}}return new Ce(e&&e.sort(De),a)}(this.children,i,t,e,n,r,o):i?new Ce(i.sort(De)):Oe},Ce.prototype.add=function(t,e){return e.length?this==Oe?Ce.create(t,e):this.addInner(t,e,0):this},Ce.prototype.addInner=function(t,e,n){var r,o=this,i=0;t.forEach((function(t,s){var a,c=s+n;if(a=Te(e,t,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(t,a,c+1):r.splice(i,0,s,s+t.nodeSize,Ee(a,t,c+1,Se)),i+=3}}));var s=Me(i?Ae(e):e,-n);return new Ce(s.length?this.local.concat(s).sort(De):this.local,r||this.children)},Ce.prototype.remove=function(t){return 0==t.length||this==Oe?this:this.removeInner(t,0)},Ce.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+e,a=n[o+1]+e,c=0,l=void 0;c<t.length;c++)(l=t[c])&&l.from>s&&l.to<a&&(t[c]=null,(i||(i=[])).push(l));if(i){n==this.children&&(n=this.children.slice());var u=n[o+2].removeInner(i,s+1);u!=Oe?n[o+2]=u:(n.splice(o,3),o-=3)}}if(r.length)for(var h=0,p=void 0;h<t.length;h++)if(p=t[h])for(var f=0;f<r.length;f++)r[f].type.eq(p.type)&&(r==this.local&&(r=this.local.slice()),r.splice(f--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Ce(r,n):Oe},Ce.prototype.forChild=function(t,e){if(this==Oe)return this;if(e.isLeaf)return Ce.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}for(var i=t+1,s=i+e.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof ye){var l=Math.max(i,c.from)-i,u=Math.min(s,c.to)-i;l<u&&(r||(r=[])).push(c.copy(l,u))}}if(r){var h=new Ce(r.sort(De));return n?new Ne([h,n]):h}return n||Oe},Ce.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof Ce)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},Ce.prototype.locals=function(t){return Pe(this.localsInner(t))},Ce.prototype.localsInner=function(t){if(this==Oe)return ke;if(t.inlineContent||!this.local.some(ye.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof ye||e.push(this.local[n]);return e};var Oe=new Ce;Ce.empty=Oe,Ce.removeOverlap=Pe;var Ne=function(t){this.members=t};function Me(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new we(o.from+e,o.to+e,o.type))}return n}function Te(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,s=void 0;i<t.length;i++)(s=t[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),t[i]=null);return o}function Ae(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function Ee(t,e,n,r){var o=[],i=!1;e.forEach((function(e,s){var a=Te(t,e,s+n);if(a){i=!0;var c=Ee(a,e,n+s+1,r);c!=Oe&&o.push(s,s+e.nodeSize,c)}}));for(var s=Me(i?Ae(t):t,-n).sort(De),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Ce(s,o):Oe}function De(t,e){return t.from-e.from||t.to-e.to}function Pe(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),Ie(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),Ie(e,o+1,i.copy(r.to,i.to)))}}return e}function Ie(t,e,n){for(;e<t.length&&De(n,t[e])>0;)e++;t.splice(e,0,n)}function Re(t){var e=[];return t.someProp("decorations",(function(n){var r=n(t.state);r&&r!=Oe&&e.push(r)})),t.cursorWrapper&&e.push(Ce.create(t.state.doc,[t.cursorWrapper.deco])),Ne.from(e)}Ne.prototype.forChild=function(t,e){if(e.isLeaf)return Ce.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(t,e);o!=Oe&&(o instanceof Ne?n=n.concat(o.members):n.push(o))}return Ne.from(n)},Ne.prototype.eq=function(t){if(!(t instanceof Ne)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},Ne.prototype.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(var i=0;i<o.length;i++)e.push(o[i])}else e=o}return e?Pe(n?e:e.sort(De)):ke},Ne.from=function(t){switch(t.length){case 0:return Oe;case 1:return t[0];default:return new Ne(t)}};var ze=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=je(this),this.markCursor=null,this.cursorWrapper=null,Be(this),this.nodeViews=Fe(this),this.docView=U(this.state.doc,$e(this),Re(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(t){t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.lastIOSEnter=0,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new Wt(t,(function(e,n,r,o){return Pt(t,e,n,r,o)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null);var e=function(e){var n=Ut[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,e)||Xt(t,e)||!t.editable&&e.type in Kt||n(t,e)})};for(var n in Ut)e(n);s.safari&&t.dom.addEventListener("input",(function(){return null})),Yt(t)}(this),this.pluginViews=[],this.updatePluginViews()},_e={props:{configurable:!0},root:{configurable:!0}};function $e(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r?e.class+=" "+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[we.node(0,t.state.doc.content.size,e)]}function Be(t){var e=t.state.selection,n=e.$head,r=e.$anchor,o=e.visible;if(t.markCursor){var i=document.createElement("img");i.setAttribute("mark-placeholder","true"),t.cursorWrapper={dom:i,deco:we.widget(n.pos,i,{raw:!0,marks:t.markCursor})}}else if(o||n.pos!=r.pos)t.cursorWrapper=null;else{var s;!t.cursorWrapper||t.cursorWrapper.dom.childNodes.length?((s=document.createElement("div")).style.position="absolute",s.style.left="-100000px"):t.cursorWrapper.deco.pos!=n.pos&&(s=t.cursorWrapper.dom),s&&(t.cursorWrapper={dom:s,deco:we.widget(n.pos,s,{raw:!0})})}}function je(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function Fe(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}_e.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},ze.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Yt(this),this._props=t,this.updateStateInner(t.state,!0)},ze.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},ze.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},ze.prototype.updateStateInner=function(t,e){var n=this,o=this.state,i=!1;if(this.state=t,e){var a=Fe(this);(function(t,e){var n=0,r=0;for(var o in t){if(t[o]!=e[o])return!0;n++}for(var i in e)r++;return n!=r})(a,this.nodeViews)&&(this.nodeViews=a,i=!0),Yt(this)}this.editable=je(this),Be(this);var c,l,u,h,p,f,d,m,g,y,b,w=Re(this),x=$e(this),k=e?"reset":t.scrollToSelection>o.scrollToSelection?"to selection":"preserve",S=i||!this.docView.matchesNode(t.doc,x,w),M=S||!t.selection.eq(o.selection),T="preserve"==k&&M&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(i,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:O(t.dom)}}(this);if(M){this.domObserver.stop();var A=S&&(s.ie||s.chrome)&&!o.selection.empty&&!t.selection.empty&&(h=o.selection,p=t.selection,f=Math.min(h.$anchor.sharedDepth(h.head),p.$anchor.sharedDepth(p.head)),h.$anchor.node(f)!=p.$anchor.node(f));S&&(!i&&this.docView.update(t.doc,x,w,this)||(this.docView.destroy(),this.docView=U(t.doc,x,w,this.dom,this))),A||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(c=this,l=c.docView.domFromPos(c.state.selection.anchor),u=c.root.getSelection(),v(l.node,l.offset,u.anchorNode,u.anchorOffset)))?kt(this,A):(Mt(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(o),"reset"==k)this.dom.scrollTop=0;else if("to selection"==k){var E=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof r.NodeSelection?C(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),E):C(this,this.coordsAtPos(t.selection.head),E))}else T&&(m=(d=T).refDOM,g=d.refTop,y=d.stack,b=m?m.getBoundingClientRect().top:0,N(y,0==b?0:b-g))},ze.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},ze.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},ze.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[t];if(null!=s&&(n=e?e(s):s))return n}},ze.prototype.hasFocus=function(){return this.root.activeElement==this.dom},ze.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(M)return t.focus(M);var e=O(t);t.focus(null==M?{get preventScroll(){return M={preventScroll:!0},!0}}:void 0),M||(M=!1,N(e,0))}(this.dom),kt(this),this.domObserver.start()},_e.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=function(){return document.getSelection()}),this._root=e;return t||document},ze.prototype.posAtCoords=function(t){return E(this,t)},ze.prototype.coordsAtPos=function(t){return P(this,t)},ze.prototype.domAtPos=function(t){return this.docView.domFromPos(t)},ze.prototype.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},ze.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},ze.prototype.endOfTextblock=function(t,e){return j(this,e||this.state,t)},ze.prototype.destroy=function(){this.docView&&(!function(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Re(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},ze.prototype.dispatchEvent=function(t){return function(t,e){Xt(t,e)||!Ut[e.type]||!t.editable&&e.type in Kt||Ut[e.type](t,e)}(this,t)},ze.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(ze.prototype,_e)},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return f}));var r=n(0);function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function i(t,e,n){return(i=o()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&s(o,n.prototype),o}).apply(null,arguments)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h={};void 0!==t&&(h=t),"undefined"!=typeof window&&(h=window);var p=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"primary",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a(this,t),u(this,"el",null),u(this,"text",""),u(this,"icon",""),u(this,"type",""),u(this,"options",{duration:3500,iconSuccess:h.NanoIcons.success,iconWarning:h.NanoIcons.warning,iconDanger:h.NanoIcons.danger,iconPrimary:h.NanoIcons.info}),this.text=e,this.type=n,this.options=r.Obj.assign(this.options,o),this.render()}return l(t,[{key:"getIcon",value:function(){return r.Obj.get(this.options,"icon"+r.Str.ucfirst(this.type))}},{key:"append",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return this.el.appendTo(e),setTimeout((function(){return t.el.addClass("n-notification--active")}),100),this}},{key:"remove",value:function(){return this.el.get(0).remove(),this}},{key:"render",value:function(){var t=["n-notification","n-notification--"+this.type];this.el=r.Dom.make("div",{classList:t.join(" ")});var e=r.Dom.make("div",{classList:"n-notification__icon"});e.appendTo(this.el),r.Dom.make("span",{classList:this.getIcon()}).appendTo(e),r.Dom.make("div",{classList:"n-notification__text"}).html(this.text).appendTo(this.el)}}]),t}(),f=function(){function t(){a(this,t)}return l(t,null,[{key:"handle",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=t.create.apply(t,[void 0].concat(n)),i=t.getWrapper();return t.notifications[o].append(i),setTimeout((function(){return t.remove(o)}),t.notifications[o].options.duration),o}},{key:"create",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(r.UUID)(),n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];return t.notifications[e]=i(p,o),e}},{key:"remove",value:function(e){void 0!==t.notifications[e]&&(t.notifications[e].remove(),delete t.notifications[e])}},{key:"getWrapper",value:function(){var t=["n-notification__wrapper","n-notification__wrapper--"+this.position];return!0===r.Dom.find(".n-notification__wrapper").empty()&&r.Dom.make("div",{classList:t.join(" ")}).appendTo(document.body),r.Dom.find(".n-notification__wrapper")}}]),t}();u(f,"alias","Notify"),u(f,"position","bottom-start"),u(f,"notifications",{})}).call(this,n(17))},function(t,e,n){var r;
/*!
* Optiscroll.js v3.2.1
* https://github.com/albertogasparin/Optiscroll/
* 
* @copyright 2018 Alberto Gasparin
* @license Released under MIT LICENSE
*/!function(o,i,s,a){"use strict";var c=function t(e,n){return new t.Instance(e,n||{})},l=c.globalSettings={scrollMinUpdateInterval:25,checkFrequency:1e3,pauseCheck:!1};c.defaults={preventParentScroll:!1,forceScrollbars:!1,scrollStopDelay:300,maxTrackSize:95,minTrackSize:5,draggableTracks:!0,autoUpdate:!0,classPrefix:"optiscroll-",wrapContent:!0,rtl:!1},(c.Instance=function(t,e){this.element=t,this.settings=y(y({},c.defaults),e||{}),"boolean"!=typeof e.rtl&&(this.settings.rtl="rtl"===o.getComputedStyle(t).direction),this.cache={},this.init()}).prototype={init:function(){var t=this.element,e=this.settings,n=!1,r=this.scrollEl=e.wrapContent?d.createWrapper(t):t.firstElementChild;g(r,e.classPrefix+"content",!0),g(t,"is-enabled"+(e.rtl?" is-rtl":""),!0),this.scrollbars={v:f("v",this),h:f("h",this)},(v.scrollbarSpec.width||e.forceScrollbars)&&(n=d.hideNativeScrollbars(r,e.rtl)),n&&b(this.scrollbars,"create"),v.isTouch&&e.preventParentScroll&&g(t,e.classPrefix+"prevent",!0),this.update(),this.bind(),e.autoUpdate&&v.instances.push(this),e.autoUpdate&&!v.checkTimer&&d.checkLoop()},bind:function(){var t,e,n,r,o=this.listeners={},i=this.scrollEl;for(var s in o.scroll=(t=p.scroll.bind(this),e=l.scrollMinUpdateInterval,function(){var o=this,i=Date.now(),s=arguments;n&&i<n+e?(clearTimeout(r),r=setTimeout((function(){n=i,t.apply(o,s)}),e)):(n=i,t.apply(o,s))}),v.isTouch&&(o.touchstart=p.touchstart.bind(this),o.touchend=p.touchend.bind(this)),o.mousewheel=o.wheel=p.wheel.bind(this),o)i.addEventListener(s,o[s],v.passiveEvent)},update:function(){var t=this.scrollEl,e=this.cache,n=e.clientH,r=t.scrollHeight,o=t.clientHeight,s=t.scrollWidth,a=t.clientWidth;if(r!==e.scrollH||o!==e.clientH||s!==e.scrollW||a!==e.clientW){if(e.scrollH=r,e.clientH=o,e.scrollW=s,e.clientW=a,void 0!==n){if(0===r&&0===o&&!i.body.contains(this.element))return this.destroy(),!1;this.fireCustomEvent("sizechange")}b(this.scrollbars,"update")}},scrollTo:function(t,e,n){var r,o,i,s,a=this.cache;v.pauseCheck=!0,this.update(),r=this.scrollEl.scrollLeft,o=this.scrollEl.scrollTop,i=+t,"left"===t&&(i=0),"right"===t&&(i=a.scrollW-a.clientW),!1===t&&(i=r),s=+e,"top"===e&&(s=0),"bottom"===e&&(s=a.scrollH-a.clientH),!1===e&&(s=o),this.animateScroll(r,i,o,s,+n)},scrollIntoView:function(t,e,n){var r,o,i,s,a,c,l,u,h,p,f,d,m=this.scrollEl;v.pauseCheck=!0,this.update(),"string"==typeof t?t=m.querySelector(t):t.length&&t.jquery&&(t=t[0]),"number"==typeof n&&(n={top:n,right:n,bottom:n,left:n}),n=n||{},r=t.getBoundingClientRect(),o=m.getBoundingClientRect(),h=f=m.scrollLeft,p=d=m.scrollTop,l=h+r.left-o.left,u=p+r.top-o.top,i=l-(n.left||0),s=u-(n.top||0),i<h&&(f=i),(a=l+r.width-this.cache.clientW+(n.right||0))>h&&(f=a),s<p&&(d=s),(c=u+r.height-this.cache.clientH+(n.bottom||0))>p&&(d=c),this.animateScroll(h,f,p,d,+e)},animateScroll:function(t,e,n,r,i){var a=this,c=this.scrollEl,l=Date.now();if(e!==t||r!==n){if(0===i)return c.scrollLeft=e,void(c.scrollTop=r);isNaN(i)&&(i=15*s.pow(s.max(s.abs(e-t),s.abs(r-n)),.54)),function u(){var h=s.min(1,(Date.now()-l)/i),p=d.easingFunction(h);r!==n&&(c.scrollTop=~~(p*(r-n))+n),e!==t&&(c.scrollLeft=~~(p*(e-t))+t),a.scrollAnimation=h<1?o.requestAnimationFrame(u):null}()}},destroy:function(){var t,e=this,n=this.element,r=this.scrollEl,i=this.listeners;if(this.scrollEl){for(var s in i)r.removeEventListener(s,i[s]);if(b(this.scrollbars,"remove"),this.settings.wrapContent){for(;t=r.childNodes[0];)n.insertBefore(t,r);n.removeChild(r),this.scrollEl=null}g(n,this.settings.classPrefix+"prevent",!1),g(n,"is-enabled",!1),o.requestAnimationFrame((function(){var t=v.instances.indexOf(e);t>-1&&v.instances.splice(t,1)}))}},fireCustomEvent:function(t){var e,n,r=this.cache,o=r.scrollH,s=r.scrollW;e={scrollbarV:y({},r.v),scrollbarH:y({},r.h),scrollTop:r.v.position*o,scrollLeft:r.h.position*s,scrollBottom:(1-r.v.position-r.v.size)*o,scrollRight:(1-r.h.position-r.h.size)*s,scrollWidth:s,scrollHeight:o,clientWidth:r.clientW,clientHeight:r.clientH},"function"==typeof CustomEvent?n=new CustomEvent(t,{detail:e}):(n=i.createEvent("CustomEvent")).initCustomEvent(t,!1,!1,e),this.element.dispatchEvent(n)}};var u,h,p={scroll:function(t){v.pauseCheck||this.fireCustomEvent("scrollstart"),v.pauseCheck=!0,this.scrollbars.v.update(),this.scrollbars.h.update(),this.fireCustomEvent("scroll"),clearTimeout(this.cache.timerStop),this.cache.timerStop=setTimeout(p.scrollStop.bind(this),this.settings.scrollStopDelay)},touchstart:function(t){v.pauseCheck=!1,this.scrollbars.v.update(),this.scrollbars.h.update(),p.wheel.call(this,t)},touchend:function(t){clearTimeout(this.cache.timerStop)},scrollStop:function(){this.fireCustomEvent("scrollstop"),v.pauseCheck=!1},wheel:function(t){var e=this.cache,n=e.v,r=e.h,i=this.settings.preventParentScroll&&v.isTouch;o.cancelAnimationFrame(this.scrollAnimation),i&&n.enabled&&n.percent%100==0&&(this.scrollEl.scrollTop=n.percent?e.scrollH-e.clientH-1:1),i&&r.enabled&&r.percent%100==0&&(this.scrollEl.scrollLeft=r.percent?e.scrollW-e.clientW-1:1)}},f=function(t,e){var n="v"===t,r=e.element,a=e.scrollEl,c=e.settings,l=e.cache,u=l[t]={},h=n?"H":"W",p="client"+h,f="scroll"+h,d=n?"scrollTop":"scrollLeft",m=n?["top","bottom"]:["left","right"],b=/^(mouse|touch|pointer)/,w=v.scrollbarSpec.rtl,x=!1,k=null,S=null,C={dragData:null,dragStart:function(t){t.preventDefault();var e=t.touches?t.touches[0]:t;C.dragData={x:e.pageX,y:e.pageY,scroll:a[d]},C.bind(!0,t.type.match(b)[1])},dragMove:function(t){var e,r=t.touches?t.touches[0]:t,o=c.rtl&&1===w&&!n?-1:1;t.preventDefault(),e=(n?r.pageY-C.dragData.y:r.pageX-C.dragData.x)/l[p],a[d]=C.dragData.scroll+e*l[f]*o},dragEnd:function(t){C.dragData=null,C.bind(!1,t.type.match(b)[1])},bind:function(t,e){var n=(t?"add":"remove")+"EventListener",r=e+"move",o=e+("touch"===e?"end":"up");i[n](r,C.dragMove),i[n](o,C.dragEnd),i[n](e+"cancel",C.dragEnd)}};return{toggle:function(e){x=e,S&&g(r,"has-"+t+"track",x),u.enabled=x},create:function(){(k=i.createElement("div"),S=i.createElement("b"),k.className=c.classPrefix+t,S.className=c.classPrefix+t+"track",k.appendChild(S),r.appendChild(k),c.draggableTracks)&&(o.PointerEvent?["pointerdown"]:["touchstart","mousedown"]).forEach((function(t){S.addEventListener(t,C.dragStart)}))},update:function(){var t,e,n,r,o;(x||l[p]!==l[f])&&(t=(n=this.calc()).size,e=u.size,r=1/t*n.position*100,o=s.abs(n.position-(u.position||0))*l[p],1===t&&x&&this.toggle(!1),t<1&&!x&&this.toggle(!0),S&&x&&this.style(r,o,t,e),u=y(u,n),x&&this.fireEdgeEv())},style:function(t,e,r,o){r!==o&&(S.style[n?"height":"width"]=100*r+"%",c.rtl&&!n&&(S.style.marginRight=100*(1-r)+"%")),S.style[v.cssTransform]="translate("+(n?"0%,"+t+"%":t+"%,0%")+")"},calc:function(){var t,e=a[d],r=l[p],o=l[f],i=r/o,u=o-r;return i>=1||!o?{position:0,size:1,percent:0}:(!n&&c.rtl&&w&&(e=u-e*w),t=100*e/u,e<=1&&(t=0),e>=u-1&&(t=100),i=s.max(i,c.minTrackSize/100),{position:t/100*(1-(i=s.min(i,c.maxTrackSize/100))),size:i,percent:t})},fireEdgeEv:function(){var t=u.percent;u.was!==t&&t%100==0&&(e.fireCustomEvent("scrollreachedge"),e.fireCustomEvent("scrollreach"+m[t/100])),u.was=t},remove:function(){this.toggle(!1),k&&(k.parentNode.removeChild(k),k=null)}}},d={hideNativeScrollbars:function(t,e){var n=v.scrollbarSpec.width,r=t.style;if(0===n){var o=Date.now();return t.setAttribute("data-scroll",o),d.addCssRule('[data-scroll="'+o+'"]::-webkit-scrollbar',"display:none;width:0;height:0;")}return r[e?"left":"right"]=-n+"px",r.bottom=-n+"px",!0},addCssRule:function(t,e){var n=i.getElementById("scroll-sheet");n||((n=i.createElement("style")).id="scroll-sheet",n.appendChild(i.createTextNode("")),i.head.appendChild(n));try{return n.sheet.insertRule(t+" {"+e+"}",0),!0}catch(t){return}},createWrapper:function(t,e){for(var n,r=i.createElement("div");n=t.childNodes[0];)r.appendChild(n);return t.appendChild(r)},checkLoop:function(){v.instances.length?(v.pauseCheck||b(v.instances,"update"),l.checkFrequency&&(v.checkTimer=setTimeout((function(){d.checkLoop()}),l.checkFrequency))):v.checkTimer=null},easingFunction:function(t){return--t*t*t+1}},v=c.G={isTouch:"ontouchstart"in o,cssTransition:m("transition"),cssTransform:m("transform"),scrollbarSpec:function(){var t,e,n,r=i.documentElement,o=1;(t=i.createElement("div")).style.cssText="overflow:scroll;width:50px;height:50px;position:absolute;left:-100px;direction:rtl",(e=i.createElement("div")).style.cssText="width:100px;height:100px",t.appendChild(e),r.appendChild(t),n=t.offsetWidth-t.clientWidth,t.scrollLeft>0?o=0:(t.scrollLeft=1,0===t.scrollLeft&&(o=-1));return r.removeChild(t),{width:n,rtl:o}}(),passiveEvent:(u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}}),o.addEventListener("test",null,h),!!u&&{capture:!1,passive:!0}),instances:[],checkTimer:null,pauseCheck:!1};function m(t){var e=t.charAt(0).toUpperCase()+t.slice(1),n=i.createElement("test"),r=[t,"Webkit"+e];for(var o in r)if(void 0!==n.style[r[o]])return r[o];return""}function g(t,e,n){var r=t.className.split(/\s+/),o=r.indexOf(e);n?~o||r.push(e):~o&&r.splice(o,1),t.className=r.join(" ")}function y(t,e,n){for(var r in e)!e.hasOwnProperty(r)||void 0!==t[r]&&n||(t[r]=e[r]);return t}function b(t,e,n){var r,o;if(t.length)for(r=0,o=t.length;r<o;r++)t[r][e].apply(t[r],n);else for(r in t)t[r][e].apply(t[r],n)}void 0===(r=function(){return c}.call(e,n,e,t))||(t.exports=r),t.exports&&(t.exports=c),o.Optiscroll=c}(window,document,Math)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(22),i=n(7),s=function(t,e){return function(n){Array.isArray(t)||(t=[t]);for(var r=0,o=t.length;r<o;r++){var i=P(t[r])(n.selection);if(i){var s=v(i.pos,e)(n);if(s!==n)return s}}return n}},a=function(t){return function(e){if(p(e.selection)){var n=e.selection,i=n.$from,s=n.$to;if(t instanceof o.Fragment&&i.parent.canReplace(i.index(),i.indexAfter(),t)||i.parent.canReplaceWith(i.index(),i.indexAfter(),t.type))return d(e.replaceWith(i.pos,s.pos,t).setSelection(new r.NodeSelection(e.doc.resolve(i.pos))))}return e}},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(n){var o=r.Selection.findFrom(n.doc.resolve(t),e,!0);return o?n.setSelection(o):n}},l=function(t){return t.type&&t.type.spec.selectable},u=function(t,e,n){return function(t){return l(t)&&t.type.isLeaf}(t)?n.setSelection(new r.NodeSelection(n.doc.resolve(e))):c(e)(n)},h=function(t,e,n){return function(r){var o="number"==typeof e,i=r.selection.$from,c=o?r.doc.resolve(e):p(r.selection)?r.doc.resolve(i.pos+1):i,h=c.parent;if(p(r.selection)&&n&&r!==(r=a(t)(r)))return r;if(w(h)&&r!==(r=s(h.type,t)(r))){var f=l(t)?c.before(c.depth):c.pos;return u(t,f,r)}if(b(c,t)){r.insert(c.pos,t);var v=o?c.pos:l(t)?r.selection.$anchor.pos-1:r.selection.$anchor.pos;return d(u(t,v,r))}for(var m=c.depth;m>0;m--){var g=c.after(m),y=r.doc.resolve(g);if(b(y,t))return r.insert(g,t),d(u(t,g,r))}return r}},p=function(t){return t instanceof r.NodeSelection},f=function(t,e){return Array.isArray(t)&&t.indexOf(e.type)>-1||e.type===t},d=function(t){return Object.assign(Object.create(t),t).setTime(Date.now())},v=function(t,e){return function(n){var r=n.doc.nodeAt(t),o=n.doc.resolve(t);if(m(o,e)){var i=(n=n.replaceWith(t,t+r.nodeSize,e)).selection.$from.pos-1;return n=c(Math.max(i,0),-1)(n),n=c(n.selection.$from.start())(n),d(n)}return n}},m=function(t,e){var n=t.node(t.depth);return n&&n.type.validContent(e instanceof o.Fragment?e:o.Fragment.from(e))},g=function(t){return function(e){var n=e.doc.nodeAt(t);return d(e.delete(t,t+n.nodeSize))}},y=function(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;var e={};return Object.keys(t.nodes).forEach((function(n){var r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)})),t.cached.tableNodeTypes=e,e},b=function(t,e){var n=t.index();return e instanceof o.Fragment?t.parent.canReplace(n,n,e):e instanceof o.Node&&t.parent.canReplaceWith(n,n,e.type)},w=function(t){return!t||"paragraph"===t.type.name&&2===t.nodeSize},x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?t.createChecked(null,e):t.createAndFill()},k=function(t){return function(e){for(var n=i.TableMap.get(e.$anchorCell.node(-1)),r=e.$anchorCell.start(-1),o=n.cellsInRect(t),s=n.cellsInRect(n.rectBetween(e.$anchorCell.pos-r,e.$headCell.pos-r)),a=0,c=o.length;a<c;a++)if(-1===s.indexOf(o[a]))return!1;return!0}},S=function(t){return t[0].map((function(e,n){return t.map((function(t){return t[n]}))}))},C=function(t){for(var e=i.TableMap.get(t),n=[],r=0;r<e.height;r++){for(var o=[],s={},a=0;a<e.width;a++){var c=e.map[r*e.width+a],l=t.nodeAt(c),u=e.findCell(c);s[c]||u.top!==r?o.push(null):(s[c]=!0,o.push(l))}n.push(o)}return n},O=function(t,e){for(var n=[],r=i.TableMap.get(t),o=0;o<r.height;o++){for(var s=t.child(o),a=[],c=0;c<r.width;c++)if(e[o][c]){var l=r.map[o*r.width+c],u=e[o][c],h=t.nodeAt(l).type.createChecked(Object.assign({},u.attrs),u.content,u.marks);a.push(h)}n.push(s.type.createChecked(s.attrs,a,s.marks))}return t.type.createChecked(t.attrs,n,t.marks)},N=function(t,e,n,r){var o=e[0]>n[0]?-1:1,i=t.splice(e[0],e.length),s=i.length%2==0?1:0,a=void 0;return a=-1===r&&1===o?n[0]-1:1===r&&-1===o?n[n.length-1]-s+1:-1===o?n[0]:n[n.length-1]-s,t.splice.apply(t,[a,0].concat(i)),t},M=function(t,e,n,r){var o="Target position is invalid, you can't move the "+r+" "+t+" to "+e+", the target can't be split. You could use tryToFit option.";if(1===(t>e?-1:1)){if(-1!==n.slice(0,n.length-1).indexOf(e))throw new Error(o)}else if(-1!==n.slice(1).indexOf(e))throw new Error(o);return!0},T=function(t){return function(e){var n=e.$from;return A(n,t)}},A=function(t,e){for(var n=t.depth;n>0;n--){var r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}},E=function(t,e){return function(n){var r=T(t)(n);if(r)return R(r.pos,e)}},D=function(t){return function(e){return!!T(t)(e)}},P=function(t){return function(e){return T((function(e){return f(t,e)}))(e)}},I=function(t){var e=t.$from.nodeBefore,n=r.Selection.findFrom(t.$from,-1);if(n&&e){var o=P(e.type)(n);return o?o.pos:n.$from.pos}},R=function(t,e){var n=e(t),r=n.node.childNodes[n.offset];return n.node.nodeType===Node.TEXT_NODE?n.node.parentNode:r&&r.nodeType!==Node.TEXT_NODE?r:n.node},z=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t)throw new Error('Invalid "node" parameter');var n=[];return t.descendants((function(t,r){if(n.push({node:t,pos:r}),!e)return!1})),n},_=function(t,e,n){if(!t)throw new Error('Invalid "node" parameter');if(!e)throw new Error('Invalid "predicate" parameter');return z(t,n).filter((function(t){return e(t.node)}))},$=function(t,e,n){return _(t,(function(t){return t.type===e}),n)};var B=function(t){return T((function(t){return t.type.spec.tableRole&&"table"===t.type.spec.tableRole}))(t)},j=function(t){return t instanceof i.CellSelection},F=function(t){if(j(t)){var e=i.TableMap.get(t.$anchorCell.node(-1));return k({left:0,right:e.width,top:0,bottom:e.height})(t)}return!1},V=function(t){return function(e){var n=B(e);if(n){var r=i.TableMap.get(n.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=r.width-1){var o=r.cellsInRect({left:e,right:e+1,top:0,bottom:r.height});return t.concat(o.map((function(t){var e=n.node.nodeAt(t),r=t+n.start;return{pos:r,start:r+1,node:e}})))}}),[])}}},L=function(t){return function(e){var n=B(e);if(n){var r=i.TableMap.get(n.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=r.height-1){var o=r.cellsInRect({left:0,right:r.width,top:e,bottom:e+1});return t.concat(o.map((function(t){var e=n.node.nodeAt(t),r=t+n.start;return{pos:r,start:r+1,node:e}})))}}),[])}}},q=function(t){return function(e,n){return function(r){var o=B(r.selection),s="row"===t;if(o){var a=i.TableMap.get(o.node);if(e>=0&&e<(s?a.height:a.width)){var c=s?0:e,l=s?e:0,u=s?a.width:e+1,h=s?e+1:a.height;if(n){var p=X(r.selection.$from);if(!p)return r;var f=a.findCell(p.pos-o.start);s?(l=Math.min(l,f.top),h=Math.max(h,f.bottom)):(c=Math.min(c,f.left),u=Math.max(u,f.right))}var v=a.cellsInRect({left:c,top:l,right:s?u:c+1,bottom:s?l+1:h}),m=h-l==1?v:a.cellsInRect({left:s?c:u-1,top:s?h-1:l,right:u,bottom:h}),g=o.start+v[0],y=o.start+m[m.length-1],b=r.doc.resolve(g),w=r.doc.resolve(y);return d(r.setSelection(new i.CellSelection(w,b)))}}return r}}},J=q("column"),W=q("row"),H=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(t>=0&&t<=r.height){for(var o=n.node,s=y(o.type.schema),a=n.start,c=0;c<t+1;c++)a+=o.child(c).nodeSize;var l=o.child(t),u=[],p=0;if(l.forEach((function(t){1===t.attrs.rowspan&&(p+=t.attrs.colspan,u.push(s[t.type.spec.tableRole].createAndFill(t.attrs,t.marks)))})),p<r.width){for(var f=[],d=function(n){var r=Q(n,(function(e,r){var o=e.node.attrs.rowspan;return o>1&&n+o>t}))(e);f.push.apply(f,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(r))},v=t;v>=0;v--)d(v);f.length&&f.forEach((function(t){e=Y(t,{rowspan:t.node.attrs.rowspan+1})(e)}))}return h(s.row.create(l.attrs,u),a)(e)}}return e}},U=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(0===t&&1===r.width)return G(e);if(t>=0&&t<=r.width)return i.removeColumn(e,{map:r,tableStart:n.start,table:n.node},t),d(e)}return e}},K=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(0===t&&1===r.height)return G(e);if(t>=0&&t<=r.height)return i.removeRow(e,{map:r,tableStart:n.start,table:n.node},t),d(e)}return e}},G=function(t){for(var e=t.selection.$from,n=e.depth;n>0;n--){if("table"===e.node(n).type.spec.tableRole)return d(t.delete(e.before(n),e.after(n)))}return t},Y=function(t,e){return function(n){return t?(n.setNodeMarkup(t.pos,null,Object.assign({},t.node.attrs,e)),d(n)):n}},X=function(t){return A(t,(function(t){return t.type.spec.tableRole&&/cell/i.test(t.type.spec.tableRole)}))},Z=function(t){var e=X(t);if(e){var n=function(t){return A(t,(function(t){return t.type.spec.tableRole&&/table/i.test(t.type.spec.tableRole)}))}(t),r=i.TableMap.get(n.node),o=e.pos-n.start;return r.rectBetween(o,o)}},Q=function(t,e){return function(n){var r=[],o=L(t)(n.selection);if(o)for(var i=o.length-1;i>=0;i--)e(o[i],n)&&r.push(o[i]);return r}},tt=function(t){return function(e){for(var n=t,r=t,o=function(t){var o=V(t)(e.selection);o&&o.forEach((function(e){var o=e.node.attrs.colspan+t-1;o>=n&&(n=t),o>r&&(r=o)}))},i=t;i>=0;i--)o(i);var s=function(t){var n=V(t)(e.selection);n&&n.forEach((function(e){var n=e.node.attrs.colspan+t-1;e.node.attrs.colspan>1&&n>r&&(r=n)}))};for(i=t;i<=r;i++)s(i);var a=[];for(i=n;i<=r;i++){var c=V(i)(e.selection);c&&c.length&&a.push(i)}n=a[0],r=a[a.length-1];for(var l=V(n)(e.selection),u=L(0)(e.selection),h=e.doc.resolve(l[l.length-1].pos),p=void 0,f=r;f>=n;f--){var d=V(f)(e.selection);if(d&&d.length){for(var v=u.length-1;v>=0;v--)if(u[v].pos===d[0].pos){p=d[0];break}if(p)break}}return{$anchor:h,$head:e.doc.resolve(p.pos),indexes:a}}},et=function(t){return function(e){for(var n=t,r=t,o=function(t){L(t)(e.selection).forEach((function(e){var o=e.node.attrs.rowspan+t-1;o>=n&&(n=t),o>r&&(r=o)}))},i=t;i>=0;i--)o(i);var s=function(t){L(t)(e.selection).forEach((function(e){var n=e.node.attrs.rowspan+t-1;e.node.attrs.rowspan>1&&n>r&&(r=n)}))};for(i=t;i<=r;i++)s(i);var a=[];for(i=n;i<=r;i++){var c=L(i)(e.selection);c&&c.length&&a.push(i)}n=a[0],r=a[a.length-1];for(var l=L(n)(e.selection),u=V(0)(e.selection),h=e.doc.resolve(l[l.length-1].pos),p=void 0,f=r;f>=n;f--){var d=L(f)(e.selection);if(d&&d.length){for(var v=u.length-1;v>=0;v--)if(u[v].pos===d[0].pos){p=d[0];break}if(p)break}}return{$anchor:h,$head:e.doc.resolve(p.pos),indexes:a}}};e.isNodeSelection=p,e.canInsert=b,e.convertTableNodeToArrayOfRows=C,e.convertArrayOfRowsToTableNode=O,e.findParentNode=T,e.findParentNodeClosestToPos=A,e.findParentDomRef=E,e.hasParentNode=D,e.findParentNodeOfType=P,e.findParentNodeOfTypeClosestToPos=function(t,e){return A(t,(function(t){return f(e,t)}))},e.hasParentNodeOfType=function(t){return function(e){return D((function(e){return f(t,e)}))(e)}},e.findParentDomRefOfType=function(t,e){return function(n){return E((function(e){return f(t,e)}),e)(n)}},e.findSelectedNodeOfType=function(t){return function(e){if(p(e)){var n=e.node,r=e.$from;if(f(t,n))return{node:n,pos:r.pos,depth:r.depth}}}},e.findPositionOfNodeBefore=I,e.findDomRefAtPos=R,e.flatten=z,e.findChildren=_,e.findTextNodes=function(t,e){return _(t,(function(t){return t.isText}),e)},e.findInlineNodes=function(t,e){return _(t,(function(t){return t.isInline}),e)},e.findBlockNodes=function(t,e){return _(t,(function(t){return t.isBlock}),e)},e.findChildrenByAttr=function(t,e,n){return _(t,(function(t){return!!e(t.attrs)}),n)},e.findChildrenByType=$,e.findChildrenByMark=function(t,e,n){return _(t,(function(t){return e.isInSet(t.marks)}),n)},e.contains=function(t,e){return!!$(t,e).length},e.findTable=B,e.isCellSelection=j,e.getSelectionRect=function(t){if(j(t)){var e=t.$anchorCell.start(-1);return i.TableMap.get(t.$anchorCell.node(-1)).rectBetween(t.$anchorCell.pos-e,t.$headCell.pos-e)}},e.isColumnSelected=function(t){return function(e){if(j(e)){var n=i.TableMap.get(e.$anchorCell.node(-1));return k({left:t,right:t+1,top:0,bottom:n.height})(e)}return!1}},e.isRowSelected=function(t){return function(e){if(j(e)){var n=i.TableMap.get(e.$anchorCell.node(-1));return k({left:0,right:n.width,top:t,bottom:t+1})(e)}return!1}},e.isTableSelected=F,e.getCellsInColumn=V,e.getCellsInRow=L,e.getCellsInTable=function(t){var e=B(t);if(e){var n=i.TableMap.get(e.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map((function(t){var n=e.node.nodeAt(t),r=t+e.start;return{pos:r,start:r+1,node:n}}))}},e.selectColumn=J,e.selectRow=W,e.selectTable=function(t){var e=B(t.selection);if(e){var n=i.TableMap.get(e.node).map;if(n&&n.length){var r=e.start+n[0],o=e.start+n[n.length-1],s=t.doc.resolve(r),a=t.doc.resolve(o);return d(t.setSelection(new i.CellSelection(a,s)))}}return t},e.emptyCell=function(t,e){return function(n){if(t){var r=y(e).cell.createAndFill().content;if(!t.node.content.eq(r))return n.replaceWith(t.pos+1,t.pos+t.node.nodeSize,r),d(n)}return n}},e.addColumnAt=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(t>=0&&t<=r.width)return d(i.addColumn(e,{map:r,tableStart:n.start,table:n.node},t))}return e}},e.moveRow=function(t,e,n){return function(r){var o=Object.assign({tryToFit:!1,direction:0},n),i=B(r.selection);if(!i)return r;var s=et(t)(r).indexes,a=et(e)(r).indexes;if(s.indexOf(e)>-1)return r;!o.tryToFit&&a.length>1&&M(t,e,a,"row");var c=function(t,e,n,r){var o=C(t.node);return o=N(o,e,n,r),O(t.node,o)}(i,s,a,o.direction);return d(r).replaceWith(i.pos,i.pos+i.node.nodeSize,c)}},e.moveColumn=function(t,e,n){return function(r){var o=Object.assign({tryToFit:!1,direction:0},n),i=B(r.selection);if(!i)return r;var s=tt(t)(r).indexes,a=tt(e)(r).indexes;if(s.indexOf(e)>-1)return r;!o.tryToFit&&a.length>1&&M(t,e,a,"column");var c=function(t,e,n,r){var o=S(C(t.node));return o=N(o,e,n,r),o=S(o),O(t.node,o)}(i,s,a,o.direction);return d(r).replaceWith(i.pos,i.pos+i.node.nodeSize,c)}},e.addRowAt=function(t,e){return function(n){var r=B(n.selection);if(r){var o=i.TableMap.get(r.node),s=t-1;if(e&&s>=0)return d(H(s)(n));if(t>=0&&t<=o.height)return d(i.addRow(n,{map:o,tableStart:r.start,table:r.node},t))}return n}},e.cloneRowAt=H,e.removeColumnAt=U,e.removeRowAt=K,e.removeTable=G,e.removeSelectedColumns=function(t){var e=t.selection;if(F(e))return G(t);if(j(e)){var n=B(e);if(n){var r=i.TableMap.get(n.node),o=r.rectBetween(e.$anchorCell.pos-n.start,e.$headCell.pos-n.start);if(0==o.left&&o.right==r.width)return!1;for(var s=Object.assign({},o,{map:r,table:n.node,tableStart:n.start}),a=s.right-1;i.removeColumn(t,s,a),a!==s.left;a--)s.table=s.tableStart?t.doc.nodeAt(s.tableStart-1):t.doc,s.map=i.TableMap.get(s.table);return d(t)}}return t},e.removeSelectedRows=function(t){var e=t.selection;if(F(e))return G(t);if(j(e)){var n=B(e);if(n){var r=i.TableMap.get(n.node),o=r.rectBetween(e.$anchorCell.pos-n.start,e.$headCell.pos-n.start);if(0==o.top&&o.bottom==r.height)return!1;for(var s=Object.assign({},o,{map:r,table:n.node,tableStart:n.start}),a=s.bottom-1;i.removeRow(t,s,a),a!==s.top;a--)s.table=s.tableStart?t.doc.nodeAt(s.tableStart-1):t.doc,s.map=i.TableMap.get(s.table);return d(t)}}return t},e.removeColumnClosestToPos=function(t){return function(e){var n=Z(t);return n?U(n.left)(c(t.pos)(e)):e}},e.removeRowClosestToPos=function(t){return function(e){var n=Z(t);return n?K(n.top)(c(t.pos)(e)):e}},e.forEachCellInColumn=function(t,e,n){return function(o){var i=V(t)(o.selection);if(i){for(var s=i.length-1;s>=0;s--)o=e(i[s],o);if(n){var a=o.doc.resolve(o.mapping.map(i[i.length-1].pos));o.setSelection(r.Selection.near(a))}return d(o)}return o}},e.forEachCellInRow=function(t,e,n){return function(o){var i=L(t)(o.selection);if(i){for(var s=i.length-1;s>=0;s--)o=e(i[s],o);if(n){var a=o.doc.resolve(o.mapping.map(i[i.length-1].pos));o.setSelection(r.Selection.near(a))}}return o}},e.setCellAttrs=Y,e.createTable=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=y(t),s=i.cell,a=i.header_cell,c=i.row,l=i.table,u=[],h=[],p=0;p<n;p++)u.push(x(s,o)),r&&h.push(x(a,o));for(var f=[],d=0;d<e;d++)f.push(c.createChecked(null,r&&0===d?h:u));return l.createChecked(null,f)},e.findCellClosestToPos=X,e.findCellRectClosestToPos=Z,e.getSelectionRangeInColumn=tt,e.getSelectionRangeInRow=et,e.removeParentNodeOfType=function(t){return function(e){var n=P(t)(e.selection);return n?g(n.pos)(e):e}},e.replaceParentNodeOfType=s,e.removeSelectedNode=function(t){if(p(t.selection)){var e=t.selection.$from.pos,n=t.selection.$to.pos;return d(t.delete(e,n))}return t},e.replaceSelectedNode=a,e.setTextSelection=c,e.safeInsert=h,e.setParentNodeMarkup=function(t,e,n,r){return function(o){var i=P(t)(o.selection);return i?d(o.setNodeMarkup(i.pos,e,Object.assign({},i.node.attrs,n),r)):o}},e.selectParentNodeOfType=function(t){return function(e){if(!p(e.selection)){var n=P(t)(e.selection);if(n)return d(e.setSelection(r.NodeSelection.create(e.doc,n.pos)))}return e}},e.removeNodeBefore=function(t){var e=I(t.selection);return"number"==typeof e?g(e)(t):t}},function(t,e,n){"use strict";var r=n(23),o=n(24);function i(){}i.prototype=r;var s=new i;t.exports=s,s.highlight=function(t,e,n){var r=(n||{}).prefix;null==r&&(r="hljs-");return y(v(t,e,!0,r))},s.highlightAuto=f,s.registerLanguage=function(t,e){var n=e(s);n.rawDefinition=e.bind(null,s),h[t]=n,u.push(t),n.aliases&&d(t,n.aliases)},s.listLanguages=function(){return u.concat()},s.registerAlias=d,s.getLanguage=b;var a=r.inherit,c={}.hasOwnProperty,l=["of","and","for","in","not","or","if","then"],u=[],h={},p={};function f(t,e){var n,r,i,s,a=e||{},c=a.subset||u,l=a.prefix,h=c.length,p=-1;if(null==l&&(l="hljs-"),"string"!=typeof t)throw o("Expected `string` for value, got `%s`",t);for(r=y({}),n=y({});++p<h;)b(s=c[p])&&((i=y(v(s,t,!1,l))).language=s,i.relevance>r.relevance&&(r=i),i.relevance>n.relevance&&(r=n,n=i));return r.language&&(n.secondBest=r),n}function d(t,e){var n,r,o,i,s=t;for(n in e&&((s={})[t]=e),s)for(o=(r="string"==typeof(r=s[n])?[r]:r).length,i=-1;++i<o;)p[r[i]]=n}function v(t,e,n,r,i){var s,a,l,u,p,d,y,w,x={},k={},S=[],C="",O=0;if("string"!=typeof t)throw o("Expected `string` for name, got `%s`",t);if("string"!=typeof e)throw o("Expected `string` for value, got `%s`",e);if(s=b(t),l=a=i||s,u=w=[],!s)throw o("Unknown language: `%s` is not registered",t);!function(t){function e(o,i){o.compiled||(o.compiled=!0,o.keywords=o.keywords||o.beginKeywords,o.keywords&&(o.keywords=function(t,e){var n,r={};if("string"==typeof t)o("keyword",t);else for(n in t)o(n,t[n]);return r;function o(t,n){!function(t,e){var n,o=e.length,i=-1;for(;++i<o;)n=e[i].split("|"),r[n[0]]=[t,Number(n[1])||m(n[0])?0:1]}(t,(e?n.toLowerCase():n).split(" "))}}(o.keywords,t.case_insensitive)),o.lexemesRe=n(o.lexemes||/\w+/,!0),i&&(o.beginKeywords&&(o.begin="\\b("+o.beginKeywords.split(" ").join("|")+")\\b"),o.begin||(o.begin=/\B|\b/),o.beginRe=n(o.begin),o.endSameAsBegin&&(o.end=o.begin),o.end||o.endsWithParent||(o.end=/\B|\b/),o.end&&(o.endRe=n(o.end)),o.terminator_end=r(o.end)||"",o.endsWithParent&&i.terminator_end&&(o.terminator_end+=(o.end?"|":"")+i.terminator_end)),o.illegal&&(o.illegalRe=n(o.illegal)),void 0===o.relevance&&(o.relevance=1),o.contains=function(t,n){var r,o=[],i=t.length,s=-1;for(;++s<i;)r=t[s],o=o.concat(g("self"===r?n:r));i=o.length,s=-1;for(;++s<i;)e(o[s],n);return o}(o.contains||[],o),o.starts&&e(o.starts,i),o.terminators=function(t){var e,o,i,s={},a=[],c=1,l=t.contains,u=l.length,h=-1,p=[];for(;++h<u;)d(i=l[h],i.beginKeywords?"\\.?(?:"+i.begin+")\\.?":i.begin);t.terminator_end&&d("end",t.terminator_end);t.illegal&&d("illegal",t.illegal);u=a.length,h=-1;for(;++h<u;)p[h]=a[h][1];return e=n(function(t,e){var n,o,i,s,a=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9]\d*)|\\./,c=0,l="",u=t.length,h=-1;for(;++h<u;){for(n=t[h],i=r(n),o=c+=1,0!==h&&(l+=e),l+="(";i.length>0;){if(null===(s=a.exec(i))){l+=i;break}l+=i.slice(0,s.index),i=i.slice(s.index+s[0].length),"\\"===s[0][0]&&s[1]?l+="\\"+String(Number(s[1])+o):(l+=s[0],"("===s[0]&&c++)}l+=")"}return l}(p,"|"),!0),o={lastIndex:0,exec:f};function f(n){var r,i,c,l;if(0===a.length)return null;if(e.lastIndex=o.lastIndex,!(l=e.exec(n)))return null;for(r=l.length,i=-1;++i<r;)if(void 0!==l[i]&&void 0!==s[i]){c=s[i];break}return"string"==typeof c?(l.type=c,l.extra=[t.illegal,t.terminator_end]):(l.type="begin",l.rule=c),l}function d(t,e){s[c]=t,a.push([t,e]),c+=new RegExp(e.toString()+"|").exec("").length}}(o))}function n(e,n){return new RegExp(r(e),"m"+(t.case_insensitive?"i":"")+(n?"g":""))}function r(t){return t&&t.source||t}e(t)}(s);try{for(a.terminators.lastIndex=0,p=0,y=a.terminators.exec(e);y;)d=T(e.slice(p,y.index),y),p=y.index+d,a.terminators.lastIndex=p,y=a.terminators.exec(e);for(T(e.slice(p)),l=a;l.parent;)l.className&&_(),l=l.parent;return{relevance:O,value:u,illegal:!1,language:t,top:a}}catch(t){if(-1===t.message.indexOf("Illegal"))throw t;return{relevance:0,illegal:!0,value:P(e,[])}}function N(t){var e=t[0],n=t.rule;return n&&n.endSameAsBegin&&(n.endRe=function(t){return new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}(e)),n.skip?C+=e:(n.excludeBegin&&(C+=e),D(E(),u),n.returnBegin||n.excludeBegin||(C=e)),A(n),n.returnBegin?0:e.length}function M(t){var n=t[0],r=e.slice(t.index),o=function t(e,n){if(function(t,e){var n=t&&t.exec(e);return n&&0===n.index}(e.endRe,n)){for(;e.endsParent&&e.parent;)e=e.parent;return e}if(e.endsWithParent)return t(e.parent,n)}(a,r);if(o){var i=a;i.skip?C+=n:(i.returnEnd||i.excludeEnd||(C+=n),D(E(),u),i.excludeEnd&&(C=n));do{a.className&&_(),a.skip||a.subLanguage||(O+=a.relevance),a=a.parent}while(a!==o.parent);return o.starts&&(o.endSameAsBegin&&(o.starts.endRe=o.endRe),A(o.starts)),i.returnEnd?0:n.length}}function T(t,r){var i,s=r&&r[0];if(C+=t,void 0===s)return D(E(),u),0;if("begin"===x.type&&"end"===r.type&&x.index===r.index&&""===s)return C+=e.slice(r.index,r.index+1),1;if(x=r,"begin"===r.type)return N(r);if("end"===r.type&&void 0!==(i=M(r)))return i;if("illegal"===r.type&&!n)throw o('Illegal lexeme "%s" for mode "%s"',s,a.className||"<unnamed>");return C+=s,s.length}function A(t){var e;t.className&&(e=R(t.className,[])),e&&(u.push(e),S.push(u),u=e.children),a=Object.create(t,{parent:{value:a}})}function E(){var t=a.subLanguage?function(){var t,e="string"==typeof a.subLanguage;if(e&&!h[a.subLanguage])return P(C,[]);t=e?v(a.subLanguage,C,!0,r,k[a.subLanguage]):f(C,{subset:0===a.subLanguage.length?void 0:a.subLanguage,prefix:r});if(!t.language)return[I(C)];a.relevance>0&&(O+=t.relevance);e&&(k[a.subLanguage]=t.top);return[R(t.language,t.value,!0)]}():function(){var t,e,n,r,o=[];if(!a.keywords)return P(C,o);t=0,a.lexemesRe.lastIndex=0,e=a.lexemesRe.exec(C);for(;e;)P(C.slice(t,e.index),o),(r=z(a,e))?(O+=r[1],n=R(r[0],[]),o.push(n),P(e[0],n.children)):P(e[0],o),t=a.lexemesRe.lastIndex,e=a.lexemesRe.exec(C);return P(C.slice(t),o),o}();return C="",t}function D(t,e){for(var n,r=t.length,o=-1;++o<r;)"text"===(n=t[o]).type?P(n.value,e):e.push(n)}function P(t,e){var n;return t&&((n=e[e.length-1])&&"text"===n.type?n.value+=t:e.push(I(t))),e}function I(t){return{type:"text",value:t}}function R(t,e,n){return{type:"element",tagName:"span",properties:{className:[(n?"":r)+t]},children:e}}function z(t,e){var n=e[0];return s.case_insensitive&&(n=n.toLowerCase()),c.call(t.keywords,n)&&t.keywords[n]}function _(){u=S.pop()||w}}function m(t){return-1!==l.indexOf(t.toLowerCase())}function g(t){var e,n,r,o;if(t.variants&&!t.cached_variants){for(e=(r=t.variants).length,n=-1,o=[];++n<e;)o[n]=a(t,{variants:null},r[n]);t.cached_variants=o}return t.cached_variants?t.cached_variants:function t(e){return!!e&&(e.endsWithParent||t(e.starts))}(t)?[a(t,{starts:t.starts?a(t.starts):null})]:[t]}function y(t){return{relevance:t.relevance||0,language:t.language||null,value:t.value||[]}}function b(t){return t=t.toLowerCase(),h[t]||h[p[t]]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(26),i=n(7),s=function(t,e){return function(n){Array.isArray(t)||(t=[t]);for(var r=0,o=t.length;r<o;r++){var i=P(t[r])(n.selection);if(i){var s=v(i.pos,e)(n);if(s!==n)return s}}return n}},a=function(t){return function(e){if(p(e.selection)){var n=e.selection,i=n.$from,s=n.$to;if(t instanceof o.Fragment&&i.parent.canReplace(i.index(),i.indexAfter(),t)||i.parent.canReplaceWith(i.index(),i.indexAfter(),t.type))return d(e.replaceWith(i.pos,s.pos,t).setSelection(new r.NodeSelection(e.doc.resolve(i.pos))))}return e}},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(n){var o=r.Selection.findFrom(n.doc.resolve(t),e,!0);return o?n.setSelection(o):n}},l=function(t){return t.type&&t.type.spec.selectable},u=function(t,e,n){return function(t){return l(t)&&t.type.isLeaf}(t)?n.setSelection(new r.NodeSelection(n.doc.resolve(e))):c(e)(n)},h=function(t,e,n){return function(r){var o="number"==typeof e,i=r.selection.$from,c=o?r.doc.resolve(e):p(r.selection)?r.doc.resolve(i.pos+1):i,h=c.parent;if(p(r.selection)&&n&&r!==(r=a(t)(r)))return r;if(w(h)&&r!==(r=s(h.type,t)(r))){var f=l(t)?c.before(c.depth):c.pos;return u(t,f,r)}if(b(c,t)){r.insert(c.pos,t);var v=o?c.pos:l(t)?r.selection.$anchor.pos-1:r.selection.$anchor.pos;return d(u(t,v,r))}for(var m=c.depth;m>0;m--){var g=c.after(m),y=r.doc.resolve(g);if(b(y,t))return r.insert(g,t),d(u(t,g,r))}return r}},p=function(t){return t instanceof r.NodeSelection},f=function(t,e){return Array.isArray(t)&&t.indexOf(e.type)>-1||e.type===t},d=function(t){return Object.assign(Object.create(t),t).setTime(Date.now())},v=function(t,e){return function(n){var r=n.doc.nodeAt(t),o=n.doc.resolve(t);if(m(o,e)){var i=(n=n.replaceWith(t,t+r.nodeSize,e)).selection.$from.pos-1;return n=c(Math.max(i,0),-1)(n),n=c(n.selection.$from.start())(n),d(n)}return n}},m=function(t,e){var n=t.node(t.depth);return n&&n.type.validContent(e instanceof o.Fragment?e:o.Fragment.from(e))},g=function(t){return function(e){var n=e.doc.nodeAt(t);return d(e.delete(t,t+n.nodeSize))}},y=function(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;var e={};return Object.keys(t.nodes).forEach((function(n){var r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)})),t.cached.tableNodeTypes=e,e},b=function(t,e){var n=t.index();return e instanceof o.Fragment?t.parent.canReplace(n,n,e):e instanceof o.Node&&t.parent.canReplaceWith(n,n,e.type)},w=function(t){return!t||"paragraph"===t.type.name&&2===t.nodeSize},x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?t.createChecked(null,e):t.createAndFill()},k=function(t){return function(e){for(var n=i.TableMap.get(e.$anchorCell.node(-1)),r=e.$anchorCell.start(-1),o=n.cellsInRect(t),s=n.cellsInRect(n.rectBetween(e.$anchorCell.pos-r,e.$headCell.pos-r)),a=0,c=o.length;a<c;a++)if(-1===s.indexOf(o[a]))return!1;return!0}},S=function(t){return t[0].map((function(e,n){return t.map((function(t){return t[n]}))}))},C=function(t){for(var e=i.TableMap.get(t),n=[],r=0;r<e.height;r++){for(var o=[],s={},a=0;a<e.width;a++){var c=e.map[r*e.width+a],l=t.nodeAt(c),u=e.findCell(c);s[c]||u.top!==r?o.push(null):(s[c]=!0,o.push(l))}n.push(o)}return n},O=function(t,e){for(var n=[],r=i.TableMap.get(t),o=0;o<r.height;o++){for(var s=t.child(o),a=[],c=0;c<r.width;c++)if(e[o][c]){var l=r.map[o*r.width+c],u=e[o][c],h=t.nodeAt(l).type.createChecked(Object.assign({},u.attrs),u.content,u.marks);a.push(h)}n.push(s.type.createChecked(s.attrs,a,s.marks))}return t.type.createChecked(t.attrs,n,t.marks)},N=function(t,e,n,r){var o=e[0]>n[0]?-1:1,i=t.splice(e[0],e.length),s=i.length%2==0?1:0,a=void 0;return a=-1===r&&1===o?n[0]-1:1===r&&-1===o?n[n.length-1]-s+1:-1===o?n[0]:n[n.length-1]-s,t.splice.apply(t,[a,0].concat(i)),t},M=function(t,e,n,r){var o="Target position is invalid, you can't move the "+r+" "+t+" to "+e+", the target can't be split. You could use tryToFit option.";if(1===(t>e?-1:1)){if(-1!==n.slice(0,n.length-1).indexOf(e))throw new Error(o)}else if(-1!==n.slice(1).indexOf(e))throw new Error(o);return!0},T=function(t){return function(e){var n=e.$from;return A(n,t)}},A=function(t,e){for(var n=t.depth;n>0;n--){var r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}},E=function(t,e){return function(n){var r=T(t)(n);if(r)return R(r.pos,e)}},D=function(t){return function(e){return!!T(t)(e)}},P=function(t){return function(e){return T((function(e){return f(t,e)}))(e)}},I=function(t){var e=t.$from.nodeBefore,n=r.Selection.findFrom(t.$from,-1);if(n&&e){var o=P(e.type)(n);return o?o.pos:n.$from.pos}},R=function(t,e){var n=e(t),r=n.node.childNodes[n.offset];return n.node.nodeType===Node.TEXT_NODE?n.node.parentNode:r&&r.nodeType!==Node.TEXT_NODE?r:n.node},z=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t)throw new Error('Invalid "node" parameter');var n=[];return t.descendants((function(t,r){if(n.push({node:t,pos:r}),!e)return!1})),n},_=function(t,e,n){if(!t)throw new Error('Invalid "node" parameter');if(!e)throw new Error('Invalid "predicate" parameter');return z(t,n).filter((function(t){return e(t.node)}))},$=function(t,e,n){return _(t,(function(t){return t.type===e}),n)};var B=function(t){return T((function(t){return t.type.spec.tableRole&&"table"===t.type.spec.tableRole}))(t)},j=function(t){return t instanceof i.CellSelection},F=function(t){if(j(t)){var e=i.TableMap.get(t.$anchorCell.node(-1));return k({left:0,right:e.width,top:0,bottom:e.height})(t)}return!1},V=function(t){return function(e){var n=B(e);if(n){var r=i.TableMap.get(n.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=r.width-1){var o=r.cellsInRect({left:e,right:e+1,top:0,bottom:r.height});return t.concat(o.map((function(t){var e=n.node.nodeAt(t),r=t+n.start;return{pos:r,start:r+1,node:e}})))}}),[])}}},L=function(t){return function(e){var n=B(e);if(n){var r=i.TableMap.get(n.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=r.height-1){var o=r.cellsInRect({left:0,right:r.width,top:e,bottom:e+1});return t.concat(o.map((function(t){var e=n.node.nodeAt(t),r=t+n.start;return{pos:r,start:r+1,node:e}})))}}),[])}}},q=function(t){return function(e,n){return function(r){var o=B(r.selection),s="row"===t;if(o){var a=i.TableMap.get(o.node);if(e>=0&&e<(s?a.height:a.width)){var c=s?0:e,l=s?e:0,u=s?a.width:e+1,h=s?e+1:a.height;if(n){var p=X(r.selection.$from);if(!p)return r;var f=a.findCell(p.pos-o.start);s?(l=Math.min(l,f.top),h=Math.max(h,f.bottom)):(c=Math.min(c,f.left),u=Math.max(u,f.right))}var v=a.cellsInRect({left:c,top:l,right:s?u:c+1,bottom:s?l+1:h}),m=h-l==1?v:a.cellsInRect({left:s?c:u-1,top:s?h-1:l,right:u,bottom:h}),g=o.start+v[0],y=o.start+m[m.length-1],b=r.doc.resolve(g),w=r.doc.resolve(y);return d(r.setSelection(new i.CellSelection(w,b)))}}return r}}},J=q("column"),W=q("row"),H=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(t>=0&&t<=r.height){for(var o=n.node,s=y(o.type.schema),a=n.start,c=0;c<t+1;c++)a+=o.child(c).nodeSize;var l=o.child(t),u=[],p=0;if(l.forEach((function(t){1===t.attrs.rowspan&&(p+=t.attrs.colspan,u.push(s[t.type.spec.tableRole].createAndFill(t.attrs,t.marks)))})),p<r.width){for(var f=[],d=function(n){var r=Q(n,(function(e,r){var o=e.node.attrs.rowspan;return o>1&&n+o>t}))(e);f.push.apply(f,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(r))},v=t;v>=0;v--)d(v);f.length&&f.forEach((function(t){e=Y(t,{rowspan:t.node.attrs.rowspan+1})(e)}))}return h(s.row.create(l.attrs,u),a)(e)}}return e}},U=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(0===t&&1===r.width)return G(e);if(t>=0&&t<=r.width)return i.removeColumn(e,{map:r,tableStart:n.start,table:n.node},t),d(e)}return e}},K=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(0===t&&1===r.height)return G(e);if(t>=0&&t<=r.height)return i.removeRow(e,{map:r,tableStart:n.start,table:n.node},t),d(e)}return e}},G=function(t){for(var e=t.selection.$from,n=e.depth;n>0;n--){if("table"===e.node(n).type.spec.tableRole)return d(t.delete(e.before(n),e.after(n)))}return t},Y=function(t,e){return function(n){return t?(n.setNodeMarkup(t.pos,null,Object.assign({},t.node.attrs,e)),d(n)):n}},X=function(t){return A(t,(function(t){return t.type.spec.tableRole&&/cell/i.test(t.type.spec.tableRole)}))},Z=function(t){var e=X(t);if(e){var n=function(t){return A(t,(function(t){return t.type.spec.tableRole&&/table/i.test(t.type.spec.tableRole)}))}(t),r=i.TableMap.get(n.node),o=e.pos-n.start;return r.rectBetween(o,o)}},Q=function(t,e){return function(n){var r=[],o=L(t)(n.selection);if(o)for(var i=o.length-1;i>=0;i--)e(o[i],n)&&r.push(o[i]);return r}},tt=function(t){return function(e){for(var n=t,r=t,o=function(t){var o=V(t)(e.selection);o&&o.forEach((function(e){var o=e.node.attrs.colspan+t-1;o>=n&&(n=t),o>r&&(r=o)}))},i=t;i>=0;i--)o(i);var s=function(t){var n=V(t)(e.selection);n&&n.forEach((function(e){var n=e.node.attrs.colspan+t-1;e.node.attrs.colspan>1&&n>r&&(r=n)}))};for(i=t;i<=r;i++)s(i);var a=[];for(i=n;i<=r;i++){var c=V(i)(e.selection);c&&c.length&&a.push(i)}n=a[0],r=a[a.length-1];for(var l=V(n)(e.selection),u=L(0)(e.selection),h=e.doc.resolve(l[l.length-1].pos),p=void 0,f=r;f>=n;f--){var d=V(f)(e.selection);if(d&&d.length){for(var v=u.length-1;v>=0;v--)if(u[v].pos===d[0].pos){p=d[0];break}if(p)break}}return{$anchor:h,$head:e.doc.resolve(p.pos),indexes:a}}},et=function(t){return function(e){for(var n=t,r=t,o=function(t){L(t)(e.selection).forEach((function(e){var o=e.node.attrs.rowspan+t-1;o>=n&&(n=t),o>r&&(r=o)}))},i=t;i>=0;i--)o(i);var s=function(t){L(t)(e.selection).forEach((function(e){var n=e.node.attrs.rowspan+t-1;e.node.attrs.rowspan>1&&n>r&&(r=n)}))};for(i=t;i<=r;i++)s(i);var a=[];for(i=n;i<=r;i++){var c=L(i)(e.selection);c&&c.length&&a.push(i)}n=a[0],r=a[a.length-1];for(var l=L(n)(e.selection),u=V(0)(e.selection),h=e.doc.resolve(l[l.length-1].pos),p=void 0,f=r;f>=n;f--){var d=L(f)(e.selection);if(d&&d.length){for(var v=u.length-1;v>=0;v--)if(u[v].pos===d[0].pos){p=d[0];break}if(p)break}}return{$anchor:h,$head:e.doc.resolve(p.pos),indexes:a}}};e.isNodeSelection=p,e.canInsert=b,e.convertTableNodeToArrayOfRows=C,e.convertArrayOfRowsToTableNode=O,e.findParentNode=T,e.findParentNodeClosestToPos=A,e.findParentDomRef=E,e.hasParentNode=D,e.findParentNodeOfType=P,e.findParentNodeOfTypeClosestToPos=function(t,e){return A(t,(function(t){return f(e,t)}))},e.hasParentNodeOfType=function(t){return function(e){return D((function(e){return f(t,e)}))(e)}},e.findParentDomRefOfType=function(t,e){return function(n){return E((function(e){return f(t,e)}),e)(n)}},e.findSelectedNodeOfType=function(t){return function(e){if(p(e)){var n=e.node,r=e.$from;if(f(t,n))return{node:n,pos:r.pos,depth:r.depth}}}},e.findPositionOfNodeBefore=I,e.findDomRefAtPos=R,e.flatten=z,e.findChildren=_,e.findTextNodes=function(t,e){return _(t,(function(t){return t.isText}),e)},e.findInlineNodes=function(t,e){return _(t,(function(t){return t.isInline}),e)},e.findBlockNodes=function(t,e){return _(t,(function(t){return t.isBlock}),e)},e.findChildrenByAttr=function(t,e,n){return _(t,(function(t){return!!e(t.attrs)}),n)},e.findChildrenByType=$,e.findChildrenByMark=function(t,e,n){return _(t,(function(t){return e.isInSet(t.marks)}),n)},e.contains=function(t,e){return!!$(t,e).length},e.findTable=B,e.isCellSelection=j,e.getSelectionRect=function(t){if(j(t)){var e=t.$anchorCell.start(-1);return i.TableMap.get(t.$anchorCell.node(-1)).rectBetween(t.$anchorCell.pos-e,t.$headCell.pos-e)}},e.isColumnSelected=function(t){return function(e){if(j(e)){var n=i.TableMap.get(e.$anchorCell.node(-1));return k({left:t,right:t+1,top:0,bottom:n.height})(e)}return!1}},e.isRowSelected=function(t){return function(e){if(j(e)){var n=i.TableMap.get(e.$anchorCell.node(-1));return k({left:0,right:n.width,top:t,bottom:t+1})(e)}return!1}},e.isTableSelected=F,e.getCellsInColumn=V,e.getCellsInRow=L,e.getCellsInTable=function(t){var e=B(t);if(e){var n=i.TableMap.get(e.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map((function(t){var n=e.node.nodeAt(t),r=t+e.start;return{pos:r,start:r+1,node:n}}))}},e.selectColumn=J,e.selectRow=W,e.selectTable=function(t){var e=B(t.selection);if(e){var n=i.TableMap.get(e.node).map;if(n&&n.length){var r=e.start+n[0],o=e.start+n[n.length-1],s=t.doc.resolve(r),a=t.doc.resolve(o);return d(t.setSelection(new i.CellSelection(a,s)))}}return t},e.emptyCell=function(t,e){return function(n){if(t){var r=y(e).cell.createAndFill().content;if(!t.node.content.eq(r))return n.replaceWith(t.pos+1,t.pos+t.node.nodeSize,r),d(n)}return n}},e.addColumnAt=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(t>=0&&t<=r.width)return d(i.addColumn(e,{map:r,tableStart:n.start,table:n.node},t))}return e}},e.moveRow=function(t,e,n){return function(r){var o=Object.assign({tryToFit:!1,direction:0},n),i=B(r.selection);if(!i)return r;var s=et(t)(r).indexes,a=et(e)(r).indexes;if(s.indexOf(e)>-1)return r;!o.tryToFit&&a.length>1&&M(t,e,a,"row");var c=function(t,e,n,r){var o=C(t.node);return o=N(o,e,n,r),O(t.node,o)}(i,s,a,o.direction);return d(r).replaceWith(i.pos,i.pos+i.node.nodeSize,c)}},e.moveColumn=function(t,e,n){return function(r){var o=Object.assign({tryToFit:!1,direction:0},n),i=B(r.selection);if(!i)return r;var s=tt(t)(r).indexes,a=tt(e)(r).indexes;if(s.indexOf(e)>-1)return r;!o.tryToFit&&a.length>1&&M(t,e,a,"column");var c=function(t,e,n,r){var o=S(C(t.node));return o=N(o,e,n,r),o=S(o),O(t.node,o)}(i,s,a,o.direction);return d(r).replaceWith(i.pos,i.pos+i.node.nodeSize,c)}},e.addRowAt=function(t,e){return function(n){var r=B(n.selection);if(r){var o=i.TableMap.get(r.node),s=t-1;if(e&&s>=0)return d(H(s)(n));if(t>=0&&t<=o.height)return d(i.addRow(n,{map:o,tableStart:r.start,table:r.node},t))}return n}},e.cloneRowAt=H,e.removeColumnAt=U,e.removeRowAt=K,e.removeTable=G,e.removeSelectedColumns=function(t){var e=t.selection;if(F(e))return G(t);if(j(e)){var n=B(e);if(n){var r=i.TableMap.get(n.node),o=r.rectBetween(e.$anchorCell.pos-n.start,e.$headCell.pos-n.start);if(0==o.left&&o.right==r.width)return!1;for(var s=Object.assign({},o,{map:r,table:n.node,tableStart:n.start}),a=s.right-1;i.removeColumn(t,s,a),a!==s.left;a--)s.table=s.tableStart?t.doc.nodeAt(s.tableStart-1):t.doc,s.map=i.TableMap.get(s.table);return d(t)}}return t},e.removeSelectedRows=function(t){var e=t.selection;if(F(e))return G(t);if(j(e)){var n=B(e);if(n){var r=i.TableMap.get(n.node),o=r.rectBetween(e.$anchorCell.pos-n.start,e.$headCell.pos-n.start);if(0==o.top&&o.bottom==r.height)return!1;for(var s=Object.assign({},o,{map:r,table:n.node,tableStart:n.start}),a=s.bottom-1;i.removeRow(t,s,a),a!==s.top;a--)s.table=s.tableStart?t.doc.nodeAt(s.tableStart-1):t.doc,s.map=i.TableMap.get(s.table);return d(t)}}return t},e.removeColumnClosestToPos=function(t){return function(e){var n=Z(t);return n?U(n.left)(c(t.pos)(e)):e}},e.removeRowClosestToPos=function(t){return function(e){var n=Z(t);return n?K(n.top)(c(t.pos)(e)):e}},e.forEachCellInColumn=function(t,e,n){return function(o){var i=V(t)(o.selection);if(i){for(var s=i.length-1;s>=0;s--)o=e(i[s],o);if(n){var a=o.doc.resolve(o.mapping.map(i[i.length-1].pos));o.setSelection(r.Selection.near(a))}return d(o)}return o}},e.forEachCellInRow=function(t,e,n){return function(o){var i=L(t)(o.selection);if(i){for(var s=i.length-1;s>=0;s--)o=e(i[s],o);if(n){var a=o.doc.resolve(o.mapping.map(i[i.length-1].pos));o.setSelection(r.Selection.near(a))}}return o}},e.setCellAttrs=Y,e.createTable=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=y(t),s=i.cell,a=i.header_cell,c=i.row,l=i.table,u=[],h=[],p=0;p<n;p++)u.push(x(s,o)),r&&h.push(x(a,o));for(var f=[],d=0;d<e;d++)f.push(c.createChecked(null,r&&0===d?h:u));return l.createChecked(null,f)},e.findCellClosestToPos=X,e.findCellRectClosestToPos=Z,e.getSelectionRangeInColumn=tt,e.getSelectionRangeInRow=et,e.removeParentNodeOfType=function(t){return function(e){var n=P(t)(e.selection);return n?g(n.pos)(e):e}},e.replaceParentNodeOfType=s,e.removeSelectedNode=function(t){if(p(t.selection)){var e=t.selection.$from.pos,n=t.selection.$to.pos;return d(t.delete(e,n))}return t},e.replaceSelectedNode=a,e.setTextSelection=c,e.safeInsert=h,e.setParentNodeMarkup=function(t,e,n,r){return function(o){var i=P(t)(o.selection);return i?d(o.setNodeMarkup(i.pos,e,Object.assign({},i.node.attrs,n),r)):o}},e.selectParentNodeOfType=function(t){return function(e){if(!p(e.selection)){var n=P(t)(e.selection);if(n)return d(e.setSelection(r.NodeSelection.create(e.doc,n.pos)))}return e}},e.removeNodeBefore=function(t){var e=I(t.selection);return"number"==typeof e?g(e)(t):t}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(9),i=n(7),s=function(t,e){return function(n){Array.isArray(t)||(t=[t]);for(var r=0,o=t.length;r<o;r++){var i=P(t[r])(n.selection);if(i){var s=v(i.pos,e)(n);if(s!==n)return s}}return n}},a=function(t){return function(e){if(p(e.selection)){var n=e.selection,i=n.$from,s=n.$to;if(t instanceof o.Fragment&&i.parent.canReplace(i.index(),i.indexAfter(),t)||i.parent.canReplaceWith(i.index(),i.indexAfter(),t.type))return d(e.replaceWith(i.pos,s.pos,t).setSelection(new r.NodeSelection(e.doc.resolve(i.pos))))}return e}},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(n){var o=r.Selection.findFrom(n.doc.resolve(t),e,!0);return o?n.setSelection(o):n}},l=function(t){return t.type&&t.type.spec.selectable},u=function(t,e,n){return function(t){return l(t)&&t.type.isLeaf}(t)?n.setSelection(new r.NodeSelection(n.doc.resolve(e))):c(e)(n)},h=function(t,e,n){return function(r){var o="number"==typeof e,i=r.selection.$from,c=o?r.doc.resolve(e):p(r.selection)?r.doc.resolve(i.pos+1):i,h=c.parent;if(p(r.selection)&&n&&r!==(r=a(t)(r)))return r;if(w(h)&&r!==(r=s(h.type,t)(r))){var f=l(t)?c.before(c.depth):c.pos;return u(t,f,r)}if(b(c,t)){r.insert(c.pos,t);var v=o?c.pos:l(t)?r.selection.$anchor.pos-1:r.selection.$anchor.pos;return d(u(t,v,r))}for(var m=c.depth;m>0;m--){var g=c.after(m),y=r.doc.resolve(g);if(b(y,t))return r.insert(g,t),d(u(t,g,r))}return r}},p=function(t){return t instanceof r.NodeSelection},f=function(t,e){return Array.isArray(t)&&t.indexOf(e.type)>-1||e.type===t},d=function(t){return Object.assign(Object.create(t),t).setTime(Date.now())},v=function(t,e){return function(n){var r=n.doc.nodeAt(t),o=n.doc.resolve(t);if(m(o,e)){var i=(n=n.replaceWith(t,t+r.nodeSize,e)).selection.$from.pos-1;return n=c(Math.max(i,0),-1)(n),n=c(n.selection.$from.start())(n),d(n)}return n}},m=function(t,e){var n=t.node(t.depth);return n&&n.type.validContent(e instanceof o.Fragment?e:o.Fragment.from(e))},g=function(t){return function(e){var n=e.doc.nodeAt(t);return d(e.delete(t,t+n.nodeSize))}},y=function(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;var e={};return Object.keys(t.nodes).forEach((function(n){var r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)})),t.cached.tableNodeTypes=e,e},b=function(t,e){var n=t.index();return e instanceof o.Fragment?t.parent.canReplace(n,n,e):e instanceof o.Node&&t.parent.canReplaceWith(n,n,e.type)},w=function(t){return!t||"paragraph"===t.type.name&&2===t.nodeSize},x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?t.createChecked(null,e):t.createAndFill()},k=function(t){return function(e){for(var n=i.TableMap.get(e.$anchorCell.node(-1)),r=e.$anchorCell.start(-1),o=n.cellsInRect(t),s=n.cellsInRect(n.rectBetween(e.$anchorCell.pos-r,e.$headCell.pos-r)),a=0,c=o.length;a<c;a++)if(-1===s.indexOf(o[a]))return!1;return!0}},S=function(t){return t[0].map((function(e,n){return t.map((function(t){return t[n]}))}))},C=function(t){for(var e=i.TableMap.get(t),n=[],r=0;r<e.height;r++){for(var o=[],s={},a=0;a<e.width;a++){var c=e.map[r*e.width+a],l=t.nodeAt(c),u=e.findCell(c);s[c]||u.top!==r?o.push(null):(s[c]=!0,o.push(l))}n.push(o)}return n},O=function(t,e){for(var n=[],r=i.TableMap.get(t),o=0;o<r.height;o++){for(var s=t.child(o),a=[],c=0;c<r.width;c++)if(e[o][c]){var l=r.map[o*r.width+c],u=e[o][c],h=t.nodeAt(l).type.createChecked(Object.assign({},u.attrs),u.content,u.marks);a.push(h)}n.push(s.type.createChecked(s.attrs,a,s.marks))}return t.type.createChecked(t.attrs,n,t.marks)},N=function(t,e,n,r){var o=e[0]>n[0]?-1:1,i=t.splice(e[0],e.length),s=i.length%2==0?1:0,a=void 0;return a=-1===r&&1===o?n[0]-1:1===r&&-1===o?n[n.length-1]-s+1:-1===o?n[0]:n[n.length-1]-s,t.splice.apply(t,[a,0].concat(i)),t},M=function(t,e,n,r){var o="Target position is invalid, you can't move the "+r+" "+t+" to "+e+", the target can't be split. You could use tryToFit option.";if(1===(t>e?-1:1)){if(-1!==n.slice(0,n.length-1).indexOf(e))throw new Error(o)}else if(-1!==n.slice(1).indexOf(e))throw new Error(o);return!0},T=function(t){return function(e){var n=e.$from;return A(n,t)}},A=function(t,e){for(var n=t.depth;n>0;n--){var r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}},E=function(t,e){return function(n){var r=T(t)(n);if(r)return R(r.pos,e)}},D=function(t){return function(e){return!!T(t)(e)}},P=function(t){return function(e){return T((function(e){return f(t,e)}))(e)}},I=function(t){var e=t.$from.nodeBefore,n=r.Selection.findFrom(t.$from,-1);if(n&&e){var o=P(e.type)(n);return o?o.pos:n.$from.pos}},R=function(t,e){var n=e(t),r=n.node.childNodes[n.offset];return n.node.nodeType===Node.TEXT_NODE?n.node.parentNode:r&&r.nodeType!==Node.TEXT_NODE?r:n.node},z=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t)throw new Error('Invalid "node" parameter');var n=[];return t.descendants((function(t,r){if(n.push({node:t,pos:r}),!e)return!1})),n},_=function(t,e,n){if(!t)throw new Error('Invalid "node" parameter');if(!e)throw new Error('Invalid "predicate" parameter');return z(t,n).filter((function(t){return e(t.node)}))},$=function(t,e,n){return _(t,(function(t){return t.type===e}),n)};var B=function(t){return T((function(t){return t.type.spec.tableRole&&"table"===t.type.spec.tableRole}))(t)},j=function(t){return t instanceof i.CellSelection},F=function(t){if(j(t)){var e=i.TableMap.get(t.$anchorCell.node(-1));return k({left:0,right:e.width,top:0,bottom:e.height})(t)}return!1},V=function(t){return function(e){var n=B(e);if(n){var r=i.TableMap.get(n.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=r.width-1){var o=r.cellsInRect({left:e,right:e+1,top:0,bottom:r.height});return t.concat(o.map((function(t){var e=n.node.nodeAt(t),r=t+n.start;return{pos:r,start:r+1,node:e}})))}}),[])}}},L=function(t){return function(e){var n=B(e);if(n){var r=i.TableMap.get(n.node);return(Array.isArray(t)?t:Array.from([t])).reduce((function(t,e){if(e>=0&&e<=r.height-1){var o=r.cellsInRect({left:0,right:r.width,top:e,bottom:e+1});return t.concat(o.map((function(t){var e=n.node.nodeAt(t),r=t+n.start;return{pos:r,start:r+1,node:e}})))}}),[])}}},q=function(t){return function(e,n){return function(r){var o=B(r.selection),s="row"===t;if(o){var a=i.TableMap.get(o.node);if(e>=0&&e<(s?a.height:a.width)){var c=s?0:e,l=s?e:0,u=s?a.width:e+1,h=s?e+1:a.height;if(n){var p=X(r.selection.$from);if(!p)return r;var f=a.findCell(p.pos-o.start);s?(l=Math.min(l,f.top),h=Math.max(h,f.bottom)):(c=Math.min(c,f.left),u=Math.max(u,f.right))}var v=a.cellsInRect({left:c,top:l,right:s?u:c+1,bottom:s?l+1:h}),m=h-l==1?v:a.cellsInRect({left:s?c:u-1,top:s?h-1:l,right:u,bottom:h}),g=o.start+v[0],y=o.start+m[m.length-1],b=r.doc.resolve(g),w=r.doc.resolve(y);return d(r.setSelection(new i.CellSelection(w,b)))}}return r}}},J=q("column"),W=q("row"),H=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(t>=0&&t<=r.height){for(var o=n.node,s=y(o.type.schema),a=n.start,c=0;c<t+1;c++)a+=o.child(c).nodeSize;var l=o.child(t),u=[],p=0;if(l.forEach((function(t){1===t.attrs.rowspan&&(p+=t.attrs.colspan,u.push(s[t.type.spec.tableRole].createAndFill(t.attrs,t.marks)))})),p<r.width){for(var f=[],d=function(n){var r=Q(n,(function(e,r){var o=e.node.attrs.rowspan;return o>1&&n+o>t}))(e);f.push.apply(f,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(r))},v=t;v>=0;v--)d(v);f.length&&f.forEach((function(t){e=Y(t,{rowspan:t.node.attrs.rowspan+1})(e)}))}return h(s.row.create(l.attrs,u),a)(e)}}return e}},U=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(0===t&&1===r.width)return G(e);if(t>=0&&t<=r.width)return i.removeColumn(e,{map:r,tableStart:n.start,table:n.node},t),d(e)}return e}},K=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(0===t&&1===r.height)return G(e);if(t>=0&&t<=r.height)return i.removeRow(e,{map:r,tableStart:n.start,table:n.node},t),d(e)}return e}},G=function(t){for(var e=t.selection.$from,n=e.depth;n>0;n--){if("table"===e.node(n).type.spec.tableRole)return d(t.delete(e.before(n),e.after(n)))}return t},Y=function(t,e){return function(n){return t?(n.setNodeMarkup(t.pos,null,Object.assign({},t.node.attrs,e)),d(n)):n}},X=function(t){return A(t,(function(t){return t.type.spec.tableRole&&/cell/i.test(t.type.spec.tableRole)}))},Z=function(t){var e=X(t);if(e){var n=function(t){return A(t,(function(t){return t.type.spec.tableRole&&/table/i.test(t.type.spec.tableRole)}))}(t),r=i.TableMap.get(n.node),o=e.pos-n.start;return r.rectBetween(o,o)}},Q=function(t,e){return function(n){var r=[],o=L(t)(n.selection);if(o)for(var i=o.length-1;i>=0;i--)e(o[i],n)&&r.push(o[i]);return r}},tt=function(t){return function(e){for(var n=t,r=t,o=function(t){var o=V(t)(e.selection);o&&o.forEach((function(e){var o=e.node.attrs.colspan+t-1;o>=n&&(n=t),o>r&&(r=o)}))},i=t;i>=0;i--)o(i);var s=function(t){var n=V(t)(e.selection);n&&n.forEach((function(e){var n=e.node.attrs.colspan+t-1;e.node.attrs.colspan>1&&n>r&&(r=n)}))};for(i=t;i<=r;i++)s(i);var a=[];for(i=n;i<=r;i++){var c=V(i)(e.selection);c&&c.length&&a.push(i)}n=a[0],r=a[a.length-1];for(var l=V(n)(e.selection),u=L(0)(e.selection),h=e.doc.resolve(l[l.length-1].pos),p=void 0,f=r;f>=n;f--){var d=V(f)(e.selection);if(d&&d.length){for(var v=u.length-1;v>=0;v--)if(u[v].pos===d[0].pos){p=d[0];break}if(p)break}}return{$anchor:h,$head:e.doc.resolve(p.pos),indexes:a}}},et=function(t){return function(e){for(var n=t,r=t,o=function(t){L(t)(e.selection).forEach((function(e){var o=e.node.attrs.rowspan+t-1;o>=n&&(n=t),o>r&&(r=o)}))},i=t;i>=0;i--)o(i);var s=function(t){L(t)(e.selection).forEach((function(e){var n=e.node.attrs.rowspan+t-1;e.node.attrs.rowspan>1&&n>r&&(r=n)}))};for(i=t;i<=r;i++)s(i);var a=[];for(i=n;i<=r;i++){var c=L(i)(e.selection);c&&c.length&&a.push(i)}n=a[0],r=a[a.length-1];for(var l=L(n)(e.selection),u=V(0)(e.selection),h=e.doc.resolve(l[l.length-1].pos),p=void 0,f=r;f>=n;f--){var d=L(f)(e.selection);if(d&&d.length){for(var v=u.length-1;v>=0;v--)if(u[v].pos===d[0].pos){p=d[0];break}if(p)break}}return{$anchor:h,$head:e.doc.resolve(p.pos),indexes:a}}};e.isNodeSelection=p,e.canInsert=b,e.convertTableNodeToArrayOfRows=C,e.convertArrayOfRowsToTableNode=O,e.findParentNode=T,e.findParentNodeClosestToPos=A,e.findParentDomRef=E,e.hasParentNode=D,e.findParentNodeOfType=P,e.findParentNodeOfTypeClosestToPos=function(t,e){return A(t,(function(t){return f(e,t)}))},e.hasParentNodeOfType=function(t){return function(e){return D((function(e){return f(t,e)}))(e)}},e.findParentDomRefOfType=function(t,e){return function(n){return E((function(e){return f(t,e)}),e)(n)}},e.findSelectedNodeOfType=function(t){return function(e){if(p(e)){var n=e.node,r=e.$from;if(f(t,n))return{node:n,pos:r.pos,depth:r.depth}}}},e.findPositionOfNodeBefore=I,e.findDomRefAtPos=R,e.flatten=z,e.findChildren=_,e.findTextNodes=function(t,e){return _(t,(function(t){return t.isText}),e)},e.findInlineNodes=function(t,e){return _(t,(function(t){return t.isInline}),e)},e.findBlockNodes=function(t,e){return _(t,(function(t){return t.isBlock}),e)},e.findChildrenByAttr=function(t,e,n){return _(t,(function(t){return!!e(t.attrs)}),n)},e.findChildrenByType=$,e.findChildrenByMark=function(t,e,n){return _(t,(function(t){return e.isInSet(t.marks)}),n)},e.contains=function(t,e){return!!$(t,e).length},e.findTable=B,e.isCellSelection=j,e.getSelectionRect=function(t){if(j(t)){var e=t.$anchorCell.start(-1);return i.TableMap.get(t.$anchorCell.node(-1)).rectBetween(t.$anchorCell.pos-e,t.$headCell.pos-e)}},e.isColumnSelected=function(t){return function(e){if(j(e)){var n=i.TableMap.get(e.$anchorCell.node(-1));return k({left:t,right:t+1,top:0,bottom:n.height})(e)}return!1}},e.isRowSelected=function(t){return function(e){if(j(e)){var n=i.TableMap.get(e.$anchorCell.node(-1));return k({left:0,right:n.width,top:t,bottom:t+1})(e)}return!1}},e.isTableSelected=F,e.getCellsInColumn=V,e.getCellsInRow=L,e.getCellsInTable=function(t){var e=B(t);if(e){var n=i.TableMap.get(e.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map((function(t){var n=e.node.nodeAt(t),r=t+e.start;return{pos:r,start:r+1,node:n}}))}},e.selectColumn=J,e.selectRow=W,e.selectTable=function(t){var e=B(t.selection);if(e){var n=i.TableMap.get(e.node).map;if(n&&n.length){var r=e.start+n[0],o=e.start+n[n.length-1],s=t.doc.resolve(r),a=t.doc.resolve(o);return d(t.setSelection(new i.CellSelection(a,s)))}}return t},e.emptyCell=function(t,e){return function(n){if(t){var r=y(e).cell.createAndFill().content;if(!t.node.content.eq(r))return n.replaceWith(t.pos+1,t.pos+t.node.nodeSize,r),d(n)}return n}},e.addColumnAt=function(t){return function(e){var n=B(e.selection);if(n){var r=i.TableMap.get(n.node);if(t>=0&&t<=r.width)return d(i.addColumn(e,{map:r,tableStart:n.start,table:n.node},t))}return e}},e.moveRow=function(t,e,n){return function(r){var o=Object.assign({tryToFit:!1,direction:0},n),i=B(r.selection);if(!i)return r;var s=et(t)(r).indexes,a=et(e)(r).indexes;if(s.indexOf(e)>-1)return r;!o.tryToFit&&a.length>1&&M(t,e,a,"row");var c=function(t,e,n,r){var o=C(t.node);return o=N(o,e,n,r),O(t.node,o)}(i,s,a,o.direction);return d(r).replaceWith(i.pos,i.pos+i.node.nodeSize,c)}},e.moveColumn=function(t,e,n){return function(r){var o=Object.assign({tryToFit:!1,direction:0},n),i=B(r.selection);if(!i)return r;var s=tt(t)(r).indexes,a=tt(e)(r).indexes;if(s.indexOf(e)>-1)return r;!o.tryToFit&&a.length>1&&M(t,e,a,"column");var c=function(t,e,n,r){var o=S(C(t.node));return o=N(o,e,n,r),o=S(o),O(t.node,o)}(i,s,a,o.direction);return d(r).replaceWith(i.pos,i.pos+i.node.nodeSize,c)}},e.addRowAt=function(t,e){return function(n){var r=B(n.selection);if(r){var o=i.TableMap.get(r.node),s=t-1;if(e&&s>=0)return d(H(s)(n));if(t>=0&&t<=o.height)return d(i.addRow(n,{map:o,tableStart:r.start,table:r.node},t))}return n}},e.cloneRowAt=H,e.removeColumnAt=U,e.removeRowAt=K,e.removeTable=G,e.removeSelectedColumns=function(t){var e=t.selection;if(F(e))return G(t);if(j(e)){var n=B(e);if(n){var r=i.TableMap.get(n.node),o=r.rectBetween(e.$anchorCell.pos-n.start,e.$headCell.pos-n.start);if(0==o.left&&o.right==r.width)return!1;for(var s=Object.assign({},o,{map:r,table:n.node,tableStart:n.start}),a=s.right-1;i.removeColumn(t,s,a),a!==s.left;a--)s.table=s.tableStart?t.doc.nodeAt(s.tableStart-1):t.doc,s.map=i.TableMap.get(s.table);return d(t)}}return t},e.removeSelectedRows=function(t){var e=t.selection;if(F(e))return G(t);if(j(e)){var n=B(e);if(n){var r=i.TableMap.get(n.node),o=r.rectBetween(e.$anchorCell.pos-n.start,e.$headCell.pos-n.start);if(0==o.top&&o.bottom==r.height)return!1;for(var s=Object.assign({},o,{map:r,table:n.node,tableStart:n.start}),a=s.bottom-1;i.removeRow(t,s,a),a!==s.top;a--)s.table=s.tableStart?t.doc.nodeAt(s.tableStart-1):t.doc,s.map=i.TableMap.get(s.table);return d(t)}}return t},e.removeColumnClosestToPos=function(t){return function(e){var n=Z(t);return n?U(n.left)(c(t.pos)(e)):e}},e.removeRowClosestToPos=function(t){return function(e){var n=Z(t);return n?K(n.top)(c(t.pos)(e)):e}},e.forEachCellInColumn=function(t,e,n){return function(o){var i=V(t)(o.selection);if(i){for(var s=i.length-1;s>=0;s--)o=e(i[s],o);if(n){var a=o.doc.resolve(o.mapping.map(i[i.length-1].pos));o.setSelection(r.Selection.near(a))}return d(o)}return o}},e.forEachCellInRow=function(t,e,n){return function(o){var i=L(t)(o.selection);if(i){for(var s=i.length-1;s>=0;s--)o=e(i[s],o);if(n){var a=o.doc.resolve(o.mapping.map(i[i.length-1].pos));o.setSelection(r.Selection.near(a))}}return o}},e.setCellAttrs=Y,e.createTable=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=y(t),s=i.cell,a=i.header_cell,c=i.row,l=i.table,u=[],h=[],p=0;p<n;p++)u.push(x(s,o)),r&&h.push(x(a,o));for(var f=[],d=0;d<e;d++)f.push(c.createChecked(null,r&&0===d?h:u));return l.createChecked(null,f)},e.findCellClosestToPos=X,e.findCellRectClosestToPos=Z,e.getSelectionRangeInColumn=tt,e.getSelectionRangeInRow=et,e.removeParentNodeOfType=function(t){return function(e){var n=P(t)(e.selection);return n?g(n.pos)(e):e}},e.replaceParentNodeOfType=s,e.removeSelectedNode=function(t){if(p(t.selection)){var e=t.selection.$from.pos,n=t.selection.$to.pos;return d(t.delete(e,n))}return t},e.replaceSelectedNode=a,e.setTextSelection=c,e.safeInsert=h,e.setParentNodeMarkup=function(t,e,n,r){return function(o){var i=P(t)(o.selection);return i?d(o.setNodeMarkup(i.pos,e,Object.assign({},i.node.attrs,n),r)):o}},e.selectParentNodeOfType=function(t){return function(e){if(!p(e.selection)){var n=P(t)(e.selection);if(n)return d(e.setSelection(r.NodeSelection.create(e.doc,n.pos)))}return e}},e.removeNodeBefore=function(t){var e=I(t.selection);return"number"==typeof e?g(e)(t):t}},function(t,e,n){t.exports=n(20)},function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"Install",(function(){return i}));var r=n(6),o={};function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===o.Nano)return console.error("Nano JS is not available in window scope.");o.Nano.install(t),t.prototype.ctor=r.a.ctor,t.prototype.trans=o.Nano.Locale.trans,t.prototype.choice=o.Nano.Locale.choice,t.prototype.icons=t.Obj.assign(o.NanoIcons,e),n(21),n(39),n(40),n(33),n(41),n(30),n(34),n(45),n(47),n(37),n(49),n(50),n(51),n(52),n(48),n(32),n(42),n(43),n(44),n(28),n(46),n(36),n(35),n(29),n(31),n(38),n(27)}void 0!==t&&(o=t),"undefined"!=typeof window&&(o=window),o.NanoIcons={checked:"fa fa-check",intermediate:"fa fa-minus",clock:"fa fa-clock",calendar:"fa fa-calendar",times:"fa fa-times",primary:"fa fa-info-circle",success:"fa fa-check-circle",warning:"fa fa-exclamation-circle",danger:"fa fa-times-circle",info:"fa fa-info-circle",angleUp:"fa fa-angle-up",angleRight:"fa fa-angle-right",angleDown:"fa fa-angle-down",angleLeft:"fa fa-angle-left"},void 0!==o.Vue&&i(o.Vue),e.default=i}.call(this,n(17))},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(12);o.a[i.a.alias]=o.a.prototype[i.a.alias]=i.a.handle},function(t,e,n){"use strict";n.r(e),n.d(e,"ContentMatch",(function(){return P})),n.d(e,"DOMParser",(function(){return Q})),n.d(e,"DOMSerializer",(function(){return lt})),n.d(e,"Fragment",(function(){return o})),n.d(e,"Mark",(function(){return l})),n.d(e,"MarkType",(function(){return Y})),n.d(e,"Node",(function(){return T})),n.d(e,"NodeRange",(function(){return O})),n.d(e,"NodeType",(function(){return H})),n.d(e,"ReplaceError",(function(){return u})),n.d(e,"ResolvedPos",(function(){return w})),n.d(e,"Schema",(function(){return X})),n.d(e,"Slice",(function(){return h}));var r=n(8);var o=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},i={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};o.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},o.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},o.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},o.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)r.push(t.content[i]);return new o(r,this.size+t.size)},o.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;c>t&&((s<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-s),Math.min(a.text.length,e-s)):a.cut(Math.max(0,t-s-1),Math.min(a.content.size,e-s-1))),n.push(a),r+=a.nodeSize),s=c}return new o(n,r)},o.prototype.cutByIndex=function(t,e){return t==e?o.empty:0==t&&e==this.content.length?this:new o(this.content.slice(t,e))},o.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),i=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new o(r,i)},o.prototype.addToStart=function(t){return new o([t].concat(this.content),this.size+t.nodeSize)},o.prototype.addToEnd=function(t){return new o(this.content.concat(t),this.size+t.nodeSize)},o.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},i.firstChild.get=function(){return this.content.length?this.content[0]:null},i.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},i.childCount.get=function(){return this.content.length},o.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},o.prototype.maybeChild=function(t){return this.content[t]},o.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},o.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},o.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},o.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return a(0,t);if(t==this.size)return a(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?a(n+1,o):a(n,r);r=o}},o.prototype.toString=function(){return"<"+this.toStringInner()+">"},o.prototype.toStringInner=function(){return this.content.join(", ")},o.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},o.fromJSON=function(t,e){if(!e)return o.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new o(e.map(t.nodeFromJSON))},o.fromArray=function(t){if(!t.length)return o.empty;for(var e,n=0,r=0;r<t.length;r++){var i=t[r];n+=i.nodeSize,r&&i.isText&&t[r-1].sameMarkup(i)?(e||(e=t.slice(0,r)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new o(e||t,n)},o.from=function(t){if(!t)return o.empty;if(t instanceof o)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new o([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(o.prototype,i);var s={index:0,offset:0};function a(t,e){return s.index=t,s.offset=e,s}function c(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!c(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&c(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}o.empty=new o([],0);var l=function(t,e){this.type=t,this.attrs=e};function u(t){var e=Error.call(this,t);return e.__proto__=u.prototype,e}l.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},l.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},l.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},l.prototype.eq=function(t){return this==t||this.type==t.type&&c(this.attrs,t.attrs)},l.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},l.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},l.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},l.setFrom=function(t){if(!t||0==t.length)return l.none;if(t instanceof l)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},l.none=[],u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,u.prototype.name="ReplaceError";var h=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},p={size:{configurable:!0}};function f(t,e,n){if(n.openStart>t.depth)throw new u("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new u("Inconsistent open depths");return function t(e,n,r,i){var s=e.index(i),a=e.node(i);if(s==n.index(i)&&i<e.depth-r.openStart){var c=t(e,n,r,i+1);return a.copy(a.content.replaceChild(s,c))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=i||n.depth!=i){var l=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),i=n-1;i>=0;i--)r=e.node(i).copy(o.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),u=l.start,h=l.end;return y(a,function t(e,n,r,i,s){var a=e.depth>s&&v(e,n,s+1),c=i.depth>s&&v(r,i,s+1),l=[];g(null,e,s,l),a&&c&&n.index(s)==r.index(s)?(d(a,c),m(y(a,t(e,n,r,i,s+1)),l)):(a&&m(y(a,b(e,n,s+1)),l),g(n,r,s,l),c&&m(y(c,b(r,i,s+1)),l));return g(i,null,s,l),new o(l)}(e,u,h,n,i))}var p=e.parent,f=p.content;return y(p,f.cut(0,e.parentOffset).append(r.content).append(f.cut(n.parentOffset)))}return y(a,b(e,n,i))}(t,e,n,0)}function d(t,e){if(!e.type.compatibleContent(t.type))throw new u("Cannot join "+e.type.name+" onto "+t.type.name)}function v(t,e,n){var r=t.node(n);return d(r,e.node(n)),r}function m(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function g(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(m(t.nodeAfter,r),i++));for(var a=i;a<s;a++)m(o.child(a),r);e&&e.depth==n&&e.textOffset&&m(e.nodeBefore,r)}function y(t,e){if(!t.type.validContent(e))throw new u("Invalid content for node "+t.type.name);return t.copy(e)}function b(t,e,n){var r=[];(g(null,t,n,r),t.depth>n)&&m(y(v(t,e,n+1),b(t,e,n+1)),r);return g(e,null,n,r),new o(r)}p.size.get=function(){return this.content.size-this.openStart-this.openEnd},h.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new h(n,this.openStart,this.openEnd)},h.prototype.removeBetween=function(t,e){return new h(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},h.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},h.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},h.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},h.fromJSON=function(t,e){if(!e)return h.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new h(o.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},h.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new h(t,n,r)},Object.defineProperties(h.prototype,p),h.empty=new h(o.empty,0,0);var w=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},x={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};w.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},x.parent.get=function(){return this.node(this.depth)},x.doc.get=function(){return this.node(0)},w.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},w.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},w.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},w.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},w.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},w.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},w.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},x.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},x.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},x.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},w.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return l.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},w.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},w.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},w.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new O(this,t,n)},w.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},w.prototype.max=function(t){return t.pos>this.pos?t:this},w.prototype.min=function(t){return t.pos<this.pos?t:this},w.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},w.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new w(e,n,o)},w.resolveCached=function(t,e){for(var n=0;n<k.length;n++){var r=k[n];if(r.pos==e&&r.doc==t)return r}var o=k[S]=w.resolve(t,e);return S=(S+1)%C,o},Object.defineProperties(w.prototype,x);var k=[],S=0,C=12,O=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},N={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};N.start.get=function(){return this.$from.before(this.depth+1)},N.end.get=function(){return this.$to.after(this.depth+1)},N.parent.get=function(){return this.$from.node(this.depth)},N.startIndex.get=function(){return this.$from.index(this.depth)},N.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(O.prototype,N);var M=Object.create(null),T=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||o.empty,this.marks=r||l.none},A={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};A.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},A.childCount.get=function(){return this.content.childCount},T.prototype.child=function(t){return this.content.child(t)},T.prototype.maybeChild=function(t){return this.content.maybeChild(t)},T.prototype.forEach=function(t){this.content.forEach(t)},T.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},T.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},A.textContent.get=function(){return this.textBetween(0,this.content.size,"")},T.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},A.firstChild.get=function(){return this.content.firstChild},A.lastChild.get=function(){return this.content.lastChild},T.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},T.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},T.prototype.hasMarkup=function(t,e,n){return this.type==t&&c(this.attrs,e||t.defaultAttrs||M)&&l.sameSet(this.marks,n||l.none)},T.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},T.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},T.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},T.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return h.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new h(a,r.depth-i,o.depth-i)},T.prototype.replace=function(t,e,n){return f(this.resolve(t),this.resolve(e),n)},T.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},T.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},T.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},T.prototype.resolve=function(t){return w.resolveCached(this,t)},T.prototype.resolveNoCache=function(t){return w.resolve(this,t)},T.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},A.isBlock.get=function(){return this.type.isBlock},A.isTextblock.get=function(){return this.type.isTextblock},A.inlineContent.get=function(){return this.type.inlineContent},A.isInline.get=function(){return this.type.isInline},A.isText.get=function(){return this.type.isText},A.isLeaf.get=function(){return this.type.isLeaf},A.isAtom.get=function(){return this.type.isAtom},T.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),D(this.marks,t)},T.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},T.prototype.canReplace=function(t,e,n,r,i){void 0===n&&(n=o.empty),void 0===r&&(r=0),void 0===i&&(i=n.childCount);var s=this.contentMatchAt(t).matchFragment(n,r,i),a=s&&s.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<i;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},T.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},T.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},T.prototype.defaultContentType=function(t){return this.contentMatchAt(t).defaultType},T.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},T.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},T.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=o.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(T.prototype,A);var E=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):D(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(T);function D(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var P=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},I={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};P.parse=function(t,e){var n=new R(t,e);if(null==n.next)return P.empty;var r=_(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];L(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new P(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(V);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(L(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},P.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},P.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},I.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},I.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},P.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},P.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function i(s,a){var c=s.matchFragment(t,n);if(c&&(!e||c.validEnd))return o.from(a.map((function(t){return t.createAndFill()})));for(var l=0;l<s.next.length;l+=2){var u=s.next[l],h=s.next[l+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(h)){r.push(h);var p=i(h,a.concat(u));if(p)return p}}}(this,[])},P.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},P.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},I.edgeCount.get=function(){return this.next.length>>1},P.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},P.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(P.prototype,I),P.empty=new P(!0);var R=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},z={next:{configurable:!0}};function _(t){var e=[];do{e.push($(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function $(t){var e=[];do{e.push(B(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function B(t){for(var e=function(t){if(t.eat("(")){var e=_(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=F(t,e)}return e}function j(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function F(t,e){var n=j(t),r=n;return t.eat(",")&&(r="}"!=t.next?j(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function V(t,e){return e-t}function L(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(V)}function q(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function J(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function W(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new K(t[n]);return e}z.next.get=function(){return this.tokens[this.pos]},R.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},R.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(R.prototype,z);var H=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=W(n.attrs),this.defaultAttrs=q(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},U={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};U.isInline.get=function(){return!this.isBlock},U.isTextblock.get=function(){return this.isBlock&&this.inlineContent},U.isLeaf.get=function(){return this.contentMatch==P.empty},U.isAtom.get=function(){return this.isLeaf||this.spec.atom},H.prototype.hasRequiredAttrs=function(t){for(var e in this.attrs)if(this.attrs[e].isRequired&&(!t||!(e in t)))return!0;return!1},H.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},H.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:J(this.attrs,t)},H.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new T(this,this.computeAttrs(t),o.from(e),l.setFrom(n))},H.prototype.createChecked=function(t,e,n){if(e=o.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new T(this,this.computeAttrs(t),e,l.setFrom(n))},H.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=o.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var i=this.contentMatch.matchFragment(e).fillBefore(o.empty,!0);return i?new T(this,t,e.append(i),l.setFrom(n)):null},H.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},H.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},H.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},H.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:l.empty:t},H.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new H(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(H.prototype,U);var K=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},G={isRequired:{configurable:!0}};G.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(K.prototype,G);var Y=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=W(r.attrs),this.rank=e,this.excluded=null;var o=q(this.attrs);this.instance=o&&new l(this,o)};Y.prototype.create=function(t){return!t&&this.instance?this.instance:new l(this,J(this.attrs,t))},Y.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new Y(t,r++,e,o)})),n},Y.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},Y.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},Y.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var X=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=H.compile(this.spec.nodes,this),this.marks=Y.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=P.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?Z(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:Z(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Z(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}X.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof H))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},X.prototype.text=function(t,e){var n=this.nodes.text;return new E(n,n.defaultAttrs,t,l.setFrom(e))},X.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},X.prototype.nodeFromJSON=function(t){return T.fromJSON(this,t)},X.prototype.markFromJSON=function(t){return l.fromJSON(this,t)},X.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Q=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};Q.prototype.parse=function(t,e){void 0===e&&(e={});var n=new it(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Q.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new it(this,e,!0);return n.addAll(t,null,e.from,e.to),h.maxOpen(n.finish())},Q.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(at(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},Q.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Q.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=ct(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=ct(t)),t.node=s}));return e},Q.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Q(t,Q.schemaRules(t)))};var tt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},et={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nt={ol:!0,ul:!0};function rt(t){return(t?1:0)|("full"===t?2:0)}var ot=function(t,e,n,r,o,i){this.type=t,this.attrs=e,this.solid=r,this.match=o||(4&i?null:t.contentMatch),this.options=i,this.content=[],this.marks=n,this.activeMarks=l.none};ot.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(o.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},ot.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=o.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(o.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r};var it=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.pendingMarks=[];var r,o=e.topNode,i=rt(e.preserveWhitespace)|(n?4:0);r=o?new ot(o.type,o.attrs,l.none,!0,e.topMatch||o.type.contentMatch,i):new ot(n?null:t.schema.topNodeType,null,l.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},st={top:{configurable:!0},currentPos:{configurable:!0}};function at(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function ct(t){var e={};for(var n in t)e[n]=t[n];return e}st.top.get=function(){return this.nodes[this.open]},it.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null;if(null!=n)for(var r=0;r<n.length;r++)this.addPendingMark(n[r]);if(this.addElement(t),null!=n)for(var o=0;o<n.length;o++)this.removePendingMark(n[o])}},it.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},it.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();nt.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&nt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:et.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(tt.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},it.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},it.prototype.readStyles=function(t){for(var e=l.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},it.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o)},it.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&tt.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},it.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},it.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;this.applyPendingMarks(n),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},it.prototype.applyPendingMarks=function(t){for(var e=0;e<this.pendingMarks.length;e++){var n=this.pendingMarks[e];t.type&&!t.type.allowsMarkType(n.type)||n.isInSet(t.activeMarks)||(t.activeMarks=n.addToSet(t.activeMarks),this.pendingMarks.splice(e--,1))}},it.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&(this.applyPendingMarks(this.top),this.enterInner(t,e,!0,n)),r},it.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:rt(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new ot(t,e,o.activeMarks,n,null,i)),this.open++},it.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},it.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},it.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},it.prototype.addPendingMark=function(t){this.pendingMarks.push(t)},it.prototype.removePendingMark=function(t){var e=this.pendingMarks.lastIndexOf(t);if(e>-1)this.pendingMarks.splice(e,1);else{var n=this.top;n.activeMarks=t.removeFromSet(n.activeMarks)}},st.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},it.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},it.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},it.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},it.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},it.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},it.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Object.defineProperties(it.prototype,st);var lt=function(t,e){this.nodes=t||{},this.marks=e||{}};function ut(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function ht(t){return t.document||window.document}lt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=ht(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},lt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=lt.renderSpec(ht(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},lt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},lt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&lt.renderSpec(ht(n),r(t,e))},lt.renderSpec=function(t,e){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var n=t.createElement(e[0]),r=null,o=e[1],i=1;if(o&&"object"==typeof o&&null==o.nodeType&&!Array.isArray(o))for(var s in i=2,o)null!=o[s]&&n.setAttribute(s,o[s]);for(var a=i;a<e.length;a++){var c=e[a];if(0===c){if(a<e.length-1||a>i)throw new RangeError("Content hole must be the only child of its parent node");return{dom:n,contentDOM:n}}var l=lt.renderSpec(t,c),u=l.dom,h=l.contentDOM;if(n.appendChild(u),h){if(r)throw new RangeError("Multiple content holes");r=h}}return{dom:n,contentDOM:r}},lt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new lt(this.nodesFromSchema(t),this.marksFromSchema(t)))},lt.nodesFromSchema=function(t){var e=ut(t.nodes);return e.text||(e.text=function(t){return t.text}),e},lt.marksFromSchema=function(t){return ut(t.marks)}},function(t,e,n){var r,o,i;o=function(t){var e=[],n=Object.keys,r={},o={},i=/^(no-?highlight|plain|text)$/i,s=/\blang(?:uage)?-([\w-]+)\b/i,a=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,c={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},l="of and for in not or if then".split(" ");function u(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(t){return t.nodeName.toLowerCase()}function p(t){return i.test(t)}function f(t){var e,n={},r=Array.prototype.slice.call(arguments,1);for(e in t)n[e]=t[e];return r.forEach((function(t){for(e in t)n[e]=t[e]})),n}function d(t){var e=[];return function t(n,r){for(var o=n.firstChild;o;o=o.nextSibling)3===o.nodeType?r+=o.nodeValue.length:1===o.nodeType&&(e.push({event:"start",offset:r,node:o}),r=t(o,r),h(o).match(/br|hr|img|input/)||e.push({event:"stop",offset:r,node:o}));return r}(t,0),e}function v(t){return t.variants&&!t.cached_variants&&(t.cached_variants=t.variants.map((function(e){return f(t,{variants:null},e)}))),t.cached_variants?t.cached_variants:function t(e){return!!e&&(e.endsWithParent||t(e.starts))}(t)?[f(t,{starts:t.starts?f(t.starts):null})]:[t]}function m(t,e){return e?Number(e):(n=t,-1!=l.indexOf(n.toLowerCase())?0:1);var n}function g(t){function e(t){return t&&t.source||t}function r(n,r){return new RegExp(e(n),"m"+(t.case_insensitive?"i":"")+(r?"g":""))}function o(t){var n,o,i={},s=[],a={},c=1;function l(t,e){i[c]=t,s.push([t,e]),c+=function(t){return new RegExp(t.toString()+"|").exec("").length-1}(e)+1}for(var u=0;u<t.contains.length;u++)l(o=t.contains[u],o.beginKeywords?"\\.?(?:"+o.begin+")\\.?":o.begin);t.terminator_end&&l("end",t.terminator_end),t.illegal&&l("illegal",t.illegal);var h=s.map((function(t){return t[1]}));return n=r(function(t,n){for(var r=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./,o=0,i="",s=0;s<t.length;s++){var a=o+=1,c=e(t[s]);for(s>0&&(i+=n),i+="(";c.length>0;){var l=r.exec(c);if(null==l){i+=c;break}i+=c.substring(0,l.index),c=c.substring(l.index+l[0].length),"\\"==l[0][0]&&l[1]?i+="\\"+String(Number(l[1])+a):(i+=l[0],"("==l[0]&&o++)}i+=")"}return i}(h,"|"),!0),a.lastIndex=0,a.exec=function(e){var r;if(0===s.length)return null;n.lastIndex=a.lastIndex;var o=n.exec(e);if(!o)return null;for(var c=0;c<o.length;c++)if(null!=o[c]&&null!=i[""+c]){r=i[""+c];break}return"string"==typeof r?(o.type=r,o.extra=[t.illegal,t.terminator_end]):(o.type="begin",o.rule=r),o},a}!function i(s,a){s.compiled||(s.compiled=!0,s.keywords=s.keywords||s.beginKeywords,s.keywords&&(s.keywords=function(t,e){var r={};return"string"==typeof t?o("keyword",t):n(t).forEach((function(e){o(e,t[e])})),r;function o(t,n){e&&(n=n.toLowerCase()),n.split(" ").forEach((function(e){var n=e.split("|");r[n[0]]=[t,m(n[0],n[1])]}))}}(s.keywords,t.case_insensitive)),s.lexemesRe=r(s.lexemes||/\w+/,!0),a&&(s.beginKeywords&&(s.begin="\\b("+s.beginKeywords.split(" ").join("|")+")\\b"),s.begin||(s.begin=/\B|\b/),s.beginRe=r(s.begin),s.endSameAsBegin&&(s.end=s.begin),s.end||s.endsWithParent||(s.end=/\B|\b/),s.end&&(s.endRe=r(s.end)),s.terminator_end=e(s.end)||"",s.endsWithParent&&a.terminator_end&&(s.terminator_end+=(s.end?"|":"")+a.terminator_end)),s.illegal&&(s.illegalRe=r(s.illegal)),null==s.relevance&&(s.relevance=1),s.contains||(s.contains=[]),s.contains=Array.prototype.concat.apply([],s.contains.map((function(t){return v("self"===t?s:t)}))),s.contains.forEach((function(t){i(t,s)})),s.starts&&i(s.starts,a),s.terminators=o(s))}(t)}function y(t,e,n,o){function i(t,e){var n=v.case_insensitive?e[0].toLowerCase():e[0];return t.keywords.hasOwnProperty(n)&&t.keywords[n]}function s(t,e,n,r){if(!n&&""===e)return"";if(!t)return e;var o='<span class="'+(r?"":c.classPrefix);return(o+=t+'">')+e+(n?"":"</span>")}function a(){k+=null!=w.subLanguage?function(){var t="string"==typeof w.subLanguage;if(t&&!r[w.subLanguage])return u(C);var e=t?y(w.subLanguage,C,!0,x[w.subLanguage]):b(C,w.subLanguage.length?w.subLanguage:void 0);return w.relevance>0&&(O+=e.relevance),t&&(x[w.subLanguage]=e.top),s(e.language,e.value,!1,!0)}():function(){var t,e,n,r;if(!w.keywords)return u(C);for(r="",e=0,w.lexemesRe.lastIndex=0,n=w.lexemesRe.exec(C);n;)r+=u(C.substring(e,n.index)),(t=i(w,n))?(O+=t[1],r+=s(t[0],u(n[0]))):r+=u(n[0]),e=w.lexemesRe.lastIndex,n=w.lexemesRe.exec(C);return r+u(C.substr(e))}(),C=""}function l(t){k+=t.className?s(t.className,"",!0):"",w=Object.create(t,{parent:{value:w}})}function h(t){var e=t[0],n=t.rule;return n&&n.endSameAsBegin&&(n.endRe=function(t){return new RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}(e)),n.skip?C+=e:(n.excludeBegin&&(C+=e),a(),n.returnBegin||n.excludeBegin||(C=e)),l(n),n.returnBegin?0:e.length}function p(t){var e=t[0],n=function t(e,n){if(function(t,e){var n=t&&t.exec(e);return n&&0===n.index}(e.endRe,n)){for(;e.endsParent&&e.parent;)e=e.parent;return e}if(e.endsWithParent)return t(e.parent,n)}(w,e);if(n){var r=w;r.skip?C+=e:(r.returnEnd||r.excludeEnd||(C+=e),a(),r.excludeEnd&&(C=e));do{w.className&&(k+="</span>"),w.skip||w.subLanguage||(O+=w.relevance),w=w.parent}while(w!==n.parent);return n.starts&&(n.endSameAsBegin&&(n.starts.endRe=n.endRe),l(n.starts)),r.returnEnd?0:e.length}}var f={};function d(t,r){var o=r&&r[0];if(C+=t,null==o)return a(),0;if("begin"==f.type&&"end"==r.type&&f.index==r.index&&""===o)return C+=e.slice(r.index,r.index+1),1;if(f=r,"begin"===r.type)return h(r);if("illegal"===r.type&&!n)throw new Error('Illegal lexeme "'+o+'" for mode "'+(w.className||"<unnamed>")+'"');if("end"===r.type){var i=p(r);if(null!=i)return i}return C+=o,o.length}var v=S(t);if(!v)throw new Error('Unknown language: "'+t+'"');g(v);var m,w=o||v,x={},k="";for(m=w;m!==v;m=m.parent)m.className&&(k=s(m.className,"",!0)+k);var C="",O=0;try{for(var N,M,T=0;w.terminators.lastIndex=T,N=w.terminators.exec(e);)M=d(e.substring(T,N.index),N),T=N.index+M;for(d(e.substr(T)),m=w;m.parent;m=m.parent)m.className&&(k+="</span>");return{relevance:O,value:k,illegal:!1,language:t,top:w}}catch(t){if(t.message&&-1!==t.message.indexOf("Illegal"))return{illegal:!0,relevance:0,value:u(e)};throw t}}function b(t,e){e=e||c.languages||n(r);var o={relevance:0,value:u(t)},i=o;return e.filter(S).filter(C).forEach((function(e){var n=y(e,t,!1);n.language=e,n.relevance>i.relevance&&(i=n),n.relevance>o.relevance&&(i=o,o=n)})),i.language&&(o.second_best=i),o}function w(t){return c.tabReplace||c.useBR?t.replace(a,(function(t,e){return c.useBR&&"\n"===t?"<br>":c.tabReplace?e.replace(/\t/g,c.tabReplace):""})):t}function x(t){var n,r,i,a,l,f=function(t){var e,n,r,o,i=t.className+" ";if(i+=t.parentNode?t.parentNode.className:"",n=s.exec(i))return S(n[1])?n[1]:"no-highlight";for(e=0,r=(i=i.split(/\s+/)).length;e<r;e++)if(p(o=i[e])||S(o))return o}(t);p(f)||(c.useBR?(n=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=t.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):n=t,l=n.textContent,i=f?y(f,l,!0):b(l),(r=d(n)).length&&((a=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=i.value,i.value=function(t,n,r){var o=0,i="",s=[];function a(){return t.length&&n.length?t[0].offset!==n[0].offset?t[0].offset<n[0].offset?t:n:"start"===n[0].event?t:n:t.length?t:n}function c(t){i+="<"+h(t)+e.map.call(t.attributes,(function(t){return" "+t.nodeName+'="'+u(t.value).replace('"',"&quot;")+'"'})).join("")+">"}function l(t){i+="</"+h(t)+">"}function p(t){("start"===t.event?c:l)(t.node)}for(;t.length||n.length;){var f=a();if(i+=u(r.substring(o,f[0].offset)),o=f[0].offset,f===t){s.reverse().forEach(l);do{p(f.splice(0,1)[0]),f=a()}while(f===t&&f.length&&f[0].offset===o);s.reverse().forEach(c)}else"start"===f[0].event?s.push(f[0].node):s.pop(),p(f.splice(0,1)[0])}return i+u(r.substr(o))}(r,d(a),l)),i.value=w(i.value),t.innerHTML=i.value,t.className=function(t,e,n){var r=e?o[e]:n,i=[t.trim()];return t.match(/\bhljs\b/)||i.push("hljs"),-1===t.indexOf(r)&&i.push(r),i.join(" ").trim()}(t.className,f,i.language),t.result={language:i.language,re:i.relevance},i.second_best&&(t.second_best={language:i.second_best.language,re:i.second_best.relevance}))}function k(){if(!k.called){k.called=!0;var t=document.querySelectorAll("pre code");e.forEach.call(t,x)}}function S(t){return t=(t||"").toLowerCase(),r[t]||r[o[t]]}function C(t){var e=S(t);return e&&!e.disableAutodetect}return t.highlight=y,t.highlightAuto=b,t.fixMarkup=w,t.highlightBlock=x,t.configure=function(t){c=f(c,t)},t.initHighlighting=k,t.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",k,!1),addEventListener("load",k,!1)},t.registerLanguage=function(e,n){var i=r[e]=n(t);i.rawDefinition=n.bind(null,t),i.aliases&&i.aliases.forEach((function(t){o[t]=e}))},t.listLanguages=function(){return n(r)},t.getLanguage=S,t.autoDetection=C,t.inherit=f,t.IDENT_RE="[a-zA-Z]\\w*",t.UNDERSCORE_IDENT_RE="[a-zA-Z_]\\w*",t.NUMBER_RE="\\b\\d+(\\.\\d+)?",t.C_NUMBER_RE="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",t.BINARY_NUMBER_RE="\\b(0b[01]+)",t.RE_STARTERS_RE="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",t.BACKSLASH_ESCAPE={begin:"\\\\[\\s\\S]",relevance:0},t.APOS_STRING_MODE={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},t.QUOTE_STRING_MODE={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},t.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},t.COMMENT=function(e,n,r){var o=t.inherit({className:"comment",begin:e,end:n,contains:[]},r||{});return o.contains.push(t.PHRASAL_WORDS_MODE),o.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|XXX):",relevance:0}),o},t.C_LINE_COMMENT_MODE=t.COMMENT("//","$"),t.C_BLOCK_COMMENT_MODE=t.COMMENT("/\\*","\\*/"),t.HASH_COMMENT_MODE=t.COMMENT("#","$"),t.NUMBER_MODE={className:"number",begin:t.NUMBER_RE,relevance:0},t.C_NUMBER_MODE={className:"number",begin:t.C_NUMBER_RE,relevance:0},t.BINARY_NUMBER_MODE={className:"number",begin:t.BINARY_NUMBER_RE,relevance:0},t.CSS_NUMBER_MODE={className:"number",begin:t.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},t.REGEXP_MODE={className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[t.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[t.BACKSLASH_ESCAPE]}]},t.TITLE_MODE={className:"title",begin:t.IDENT_RE,relevance:0},t.UNDERSCORE_TITLE_MODE={className:"title",begin:t.UNDERSCORE_IDENT_RE,relevance:0},t.METHOD_GUARD={begin:"\\.\\s*"+t.UNDERSCORE_IDENT_RE,relevance:0},t},i="object"==typeof window&&window||"object"==typeof self&&self,e.nodeType?i&&(i.hljs=o({}),void 0===(r=function(){return i.hljs}.apply(e,[]))||(t.exports=r)):o(e)},function(t,e,n){"use strict";var r=n(25),o=i(Error);function i(t){return e.displayName=t.displayName||t.name,e;function e(e){return e&&(e=r.apply(null,arguments)),new t(e)}}t.exports=o,o.eval=i(EvalError),o.range=i(RangeError),o.reference=i(ReferenceError),o.syntax=i(SyntaxError),o.type=i(TypeError),o.uri=i(URIError),o.create=i},function(t,e,n){!function(){var e;function n(t){for(var e,n,r,o,i=1,s=[].slice.call(arguments),a=0,c=t.length,l="",u=!1,h=!1,p=function(){return s[i++]},f=function(){for(var n="";/\d/.test(t[a]);)n+=t[a++],e=t[a];return n.length>0?parseInt(n):null};a<c;++a)if(e=t[a],u)switch(u=!1,"."==e?(h=!1,e=t[++a]):"0"==e&&"."==t[a+1]?(h=!0,e=t[a+=2]):h=!0,o=f(),e){case"b":l+=parseInt(p(),10).toString(2);break;case"c":l+="string"==typeof(n=p())||n instanceof String?n:String.fromCharCode(parseInt(n,10));break;case"d":l+=parseInt(p(),10);break;case"f":r=String(parseFloat(p()).toFixed(o||6)),l+=h?r:r.replace(/^0/,"");break;case"j":l+=JSON.stringify(p());break;case"o":l+="0"+parseInt(p(),10).toString(8);break;case"s":l+=p();break;case"x":l+="0x"+parseInt(p(),10).toString(16);break;case"X":l+="0x"+parseInt(p(),10).toString(16).toUpperCase();break;default:l+=e}else"%"===e?u=!0:l+=e;return l}(e=t.exports=n).format=n,e.vsprintf=function(t,e){return n.apply(null,[t].concat(e))},"undefined"!=typeof console&&"function"==typeof console.log&&(e.printf=function(){console.log(n.apply(null,arguments))})}()},function(t,e,n){"use strict";n.r(e),n.d(e,"ContentMatch",(function(){return P})),n.d(e,"DOMParser",(function(){return Q})),n.d(e,"DOMSerializer",(function(){return lt})),n.d(e,"Fragment",(function(){return o})),n.d(e,"Mark",(function(){return l})),n.d(e,"MarkType",(function(){return Y})),n.d(e,"Node",(function(){return T})),n.d(e,"NodeRange",(function(){return O})),n.d(e,"NodeType",(function(){return H})),n.d(e,"ReplaceError",(function(){return u})),n.d(e,"ResolvedPos",(function(){return w})),n.d(e,"Schema",(function(){return X})),n.d(e,"Slice",(function(){return h}));var r=n(8);var o=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},i={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};o.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},o.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},o.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},o.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),i=1);i<t.content.length;i++)r.push(t.content[i]);return new o(r,this.size+t.size)},o.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;c>t&&((s<t||c>e)&&(a=a.isText?a.cut(Math.max(0,t-s),Math.min(a.text.length,e-s)):a.cut(Math.max(0,t-s-1),Math.min(a.content.size,e-s-1))),n.push(a),r+=a.nodeSize),s=c}return new o(n,r)},o.prototype.cutByIndex=function(t,e){return t==e?o.empty:0==t&&e==this.content.length?this:new o(this.content.slice(t,e))},o.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),i=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new o(r,i)},o.prototype.addToStart=function(t){return new o([t].concat(this.content),this.size+t.nodeSize)},o.prototype.addToEnd=function(t){return new o(this.content.concat(t),this.size+t.nodeSize)},o.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},i.firstChild.get=function(){return this.content.length?this.content[0]:null},i.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},i.childCount.get=function(){return this.content.length},o.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},o.prototype.maybeChild=function(t){return this.content[t]},o.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},o.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},o.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},o.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return a(0,t);if(t==this.size)return a(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?a(n+1,o):a(n,r);r=o}},o.prototype.toString=function(){return"<"+this.toStringInner()+">"},o.prototype.toStringInner=function(){return this.content.join(", ")},o.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},o.fromJSON=function(t,e){if(!e)return o.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new o(e.map(t.nodeFromJSON))},o.fromArray=function(t){if(!t.length)return o.empty;for(var e,n=0,r=0;r<t.length;r++){var i=t[r];n+=i.nodeSize,r&&i.isText&&t[r-1].sameMarkup(i)?(e||(e=t.slice(0,r)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new o(e||t,n)},o.from=function(t){if(!t)return o.empty;if(t instanceof o)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new o([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(o.prototype,i);var s={index:0,offset:0};function a(t,e){return s.index=t,s.offset=e,s}function c(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!c(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&c(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}o.empty=new o([],0);var l=function(t,e){this.type=t,this.attrs=e};function u(t){var e=Error.call(this,t);return e.__proto__=u.prototype,e}l.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},l.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},l.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},l.prototype.eq=function(t){return this==t||this.type==t.type&&c(this.attrs,t.attrs)},l.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},l.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},l.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},l.setFrom=function(t){if(!t||0==t.length)return l.none;if(t instanceof l)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},l.none=[],u.prototype=Object.create(Error.prototype),u.prototype.constructor=u,u.prototype.name="ReplaceError";var h=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},p={size:{configurable:!0}};function f(t,e,n){if(n.openStart>t.depth)throw new u("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new u("Inconsistent open depths");return function t(e,n,r,i){var s=e.index(i),a=e.node(i);if(s==n.index(i)&&i<e.depth-r.openStart){var c=t(e,n,r,i+1);return a.copy(a.content.replaceChild(s,c))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=i||n.depth!=i){var l=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),i=n-1;i>=0;i--)r=e.node(i).copy(o.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),u=l.start,h=l.end;return y(a,function t(e,n,r,i,s){var a=e.depth>s&&v(e,n,s+1),c=i.depth>s&&v(r,i,s+1),l=[];g(null,e,s,l),a&&c&&n.index(s)==r.index(s)?(d(a,c),m(y(a,t(e,n,r,i,s+1)),l)):(a&&m(y(a,b(e,n,s+1)),l),g(n,r,s,l),c&&m(y(c,b(r,i,s+1)),l));return g(i,null,s,l),new o(l)}(e,u,h,n,i))}var p=e.parent,f=p.content;return y(p,f.cut(0,e.parentOffset).append(r.content).append(f.cut(n.parentOffset)))}return y(a,b(e,n,i))}(t,e,n,0)}function d(t,e){if(!e.type.compatibleContent(t.type))throw new u("Cannot join "+e.type.name+" onto "+t.type.name)}function v(t,e,n){var r=t.node(n);return d(r,e.node(n)),r}function m(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function g(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(m(t.nodeAfter,r),i++));for(var a=i;a<s;a++)m(o.child(a),r);e&&e.depth==n&&e.textOffset&&m(e.nodeBefore,r)}function y(t,e){if(!t.type.validContent(e))throw new u("Invalid content for node "+t.type.name);return t.copy(e)}function b(t,e,n){var r=[];(g(null,t,n,r),t.depth>n)&&m(y(v(t,e,n+1),b(t,e,n+1)),r);return g(e,null,n,r),new o(r)}p.size.get=function(){return this.content.size-this.openStart-this.openEnd},h.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new h(n,this.openStart,this.openEnd)},h.prototype.removeBetween=function(t,e){return new h(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},h.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},h.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},h.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},h.fromJSON=function(t,e){if(!e)return h.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new h(o.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},h.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new h(t,n,r)},Object.defineProperties(h.prototype,p),h.empty=new h(o.empty,0,0);var w=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},x={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};w.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},x.parent.get=function(){return this.node(this.depth)},x.doc.get=function(){return this.node(0)},w.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},w.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},w.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},w.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},w.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},w.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},w.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},x.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},x.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},x.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},w.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return l.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},w.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},w.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},w.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new O(this,t,n)},w.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},w.prototype.max=function(t){return t.pos>this.pos?t:this},w.prototype.min=function(t){return t.pos<this.pos?t:this},w.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},w.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new w(e,n,o)},w.resolveCached=function(t,e){for(var n=0;n<k.length;n++){var r=k[n];if(r.pos==e&&r.doc==t)return r}var o=k[S]=w.resolve(t,e);return S=(S+1)%C,o},Object.defineProperties(w.prototype,x);var k=[],S=0,C=12,O=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},N={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};N.start.get=function(){return this.$from.before(this.depth+1)},N.end.get=function(){return this.$to.after(this.depth+1)},N.parent.get=function(){return this.$from.node(this.depth)},N.startIndex.get=function(){return this.$from.index(this.depth)},N.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(O.prototype,N);var M=Object.create(null),T=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||o.empty,this.marks=r||l.none},A={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};A.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},A.childCount.get=function(){return this.content.childCount},T.prototype.child=function(t){return this.content.child(t)},T.prototype.maybeChild=function(t){return this.content.maybeChild(t)},T.prototype.forEach=function(t){this.content.forEach(t)},T.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},T.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},A.textContent.get=function(){return this.textBetween(0,this.content.size,"")},T.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},A.firstChild.get=function(){return this.content.firstChild},A.lastChild.get=function(){return this.content.lastChild},T.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},T.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},T.prototype.hasMarkup=function(t,e,n){return this.type==t&&c(this.attrs,e||t.defaultAttrs||M)&&l.sameSet(this.marks,n||l.none)},T.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},T.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},T.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},T.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return h.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new h(a,r.depth-i,o.depth-i)},T.prototype.replace=function(t,e,n){return f(this.resolve(t),this.resolve(e),n)},T.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},T.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},T.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},T.prototype.resolve=function(t){return w.resolveCached(this,t)},T.prototype.resolveNoCache=function(t){return w.resolve(this,t)},T.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},A.isBlock.get=function(){return this.type.isBlock},A.isTextblock.get=function(){return this.type.isTextblock},A.inlineContent.get=function(){return this.type.inlineContent},A.isInline.get=function(){return this.type.isInline},A.isText.get=function(){return this.type.isText},A.isLeaf.get=function(){return this.type.isLeaf},A.isAtom.get=function(){return this.type.isAtom},T.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),D(this.marks,t)},T.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},T.prototype.canReplace=function(t,e,n,r,i){void 0===n&&(n=o.empty),void 0===r&&(r=0),void 0===i&&(i=n.childCount);var s=this.contentMatchAt(t).matchFragment(n,r,i),a=s&&s.matchFragment(this.content,e);if(!a||!a.validEnd)return!1;for(var c=r;c<i;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},T.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},T.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},T.prototype.defaultContentType=function(t){return this.contentMatchAt(t).defaultType},T.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},T.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},T.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=o.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(T.prototype,A);var E=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):D(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(T);function D(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var P=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},I={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};P.parse=function(t,e){var n=new R(t,e);if(null==n.next)return P.empty;var r=_(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];L(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new P(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(V);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(L(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},P.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},P.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},I.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},I.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},P.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},P.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function i(s,a){var c=s.matchFragment(t,n);if(c&&(!e||c.validEnd))return o.from(a.map((function(t){return t.createAndFill()})));for(var l=0;l<s.next.length;l+=2){var u=s.next[l],h=s.next[l+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(h)){r.push(h);var p=i(h,a.concat(u));if(p)return p}}}(this,[])},P.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},P.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},I.edgeCount.get=function(){return this.next.length>>1},P.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},P.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(P.prototype,I),P.empty=new P(!0);var R=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},z={next:{configurable:!0}};function _(t){var e=[];do{e.push($(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function $(t){var e=[];do{e.push(B(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function B(t){for(var e=function(t){if(t.eat("(")){var e=_(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=F(t,e)}return e}function j(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function F(t,e){var n=j(t),r=n;return t.eat(",")&&(r="}"!=t.next?j(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function V(t,e){return e-t}function L(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(V)}function q(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function J(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function W(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new K(t[n]);return e}z.next.get=function(){return this.tokens[this.pos]},R.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},R.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(R.prototype,z);var H=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=W(n.attrs),this.defaultAttrs=q(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},U={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};U.isInline.get=function(){return!this.isBlock},U.isTextblock.get=function(){return this.isBlock&&this.inlineContent},U.isLeaf.get=function(){return this.contentMatch==P.empty},U.isAtom.get=function(){return this.isLeaf||this.spec.atom},H.prototype.hasRequiredAttrs=function(t){for(var e in this.attrs)if(this.attrs[e].isRequired&&(!t||!(e in t)))return!0;return!1},H.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},H.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:J(this.attrs,t)},H.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new T(this,this.computeAttrs(t),o.from(e),l.setFrom(n))},H.prototype.createChecked=function(t,e,n){if(e=o.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new T(this,this.computeAttrs(t),e,l.setFrom(n))},H.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=o.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var i=this.contentMatch.matchFragment(e).fillBefore(o.empty,!0);return i?new T(this,t,e.append(i),l.setFrom(n)):null},H.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},H.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},H.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},H.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:l.empty:t},H.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new H(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(H.prototype,U);var K=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},G={isRequired:{configurable:!0}};G.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(K.prototype,G);var Y=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=W(r.attrs),this.rank=e,this.excluded=null;var o=q(this.attrs);this.instance=o&&new l(this,o)};Y.prototype.create=function(t){return!t&&this.instance?this.instance:new l(this,J(this.attrs,t))},Y.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new Y(t,r++,e,o)})),n},Y.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},Y.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},Y.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var X=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=r.a.from(t.nodes),this.spec.marks=r.a.from(t.marks),this.nodes=H.compile(this.spec.nodes,this),this.marks=Y.compile(this.spec.marks,this);var n=Object.create(null);for(var o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");var i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=n[s]||(n[s]=P.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?Z(this,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:Z(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Z(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}X.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof H))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},X.prototype.text=function(t,e){var n=this.nodes.text;return new E(n,n.defaultAttrs,t,l.setFrom(e))},X.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},X.prototype.nodeFromJSON=function(t){return T.fromJSON(this,t)},X.prototype.markFromJSON=function(t){return l.fromJSON(this,t)},X.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Q=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};Q.prototype.parse=function(t,e){void 0===e&&(e={});var n=new it(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Q.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new it(this,e,!0);return n.addAll(t,null,e.from,e.to),h.maxOpen(n.finish())},Q.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(at(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},Q.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Q.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=ct(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=ct(t)),t.node=s}));return e},Q.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Q(t,Q.schemaRules(t)))};var tt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},et={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},nt={ol:!0,ul:!0};function rt(t){return(t?1:0)|("full"===t?2:0)}var ot=function(t,e,n,r,o,i){this.type=t,this.attrs=e,this.solid=r,this.match=o||(4&i?null:t.contentMatch),this.options=i,this.content=[],this.marks=n,this.activeMarks=l.none};ot.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(o.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},ot.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=o.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(o.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r};var it=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.pendingMarks=[];var r,o=e.topNode,i=rt(e.preserveWhitespace)|(n?4:0);r=o?new ot(o.type,o.attrs,l.none,!0,e.topMatch||o.type.contentMatch,i):new ot(n?null:t.schema.topNodeType,null,l.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},st={top:{configurable:!0},currentPos:{configurable:!0}};function at(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function ct(t){var e={};for(var n in t)e[n]=t[n];return e}st.top.get=function(){return this.nodes[this.open]},it.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null;if(null!=n)for(var r=0;r<n.length;r++)this.addPendingMark(n[r]);if(this.addElement(t),null!=n)for(var o=0;o<n.length;o++)this.removePendingMark(n[o])}},it.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},it.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();nt.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&nt.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:et.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(tt.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},it.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},it.prototype.readStyles=function(t){for(var e=l.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},it.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o)},it.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&tt.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},it.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},it.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;this.applyPendingMarks(n),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},it.prototype.applyPendingMarks=function(t){for(var e=0;e<this.pendingMarks.length;e++){var n=this.pendingMarks[e];t.type&&!t.type.allowsMarkType(n.type)||n.isInSet(t.activeMarks)||(t.activeMarks=n.addToSet(t.activeMarks),this.pendingMarks.splice(e--,1))}},it.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&(this.applyPendingMarks(this.top),this.enterInner(t,e,!0,n)),r},it.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:rt(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new ot(t,e,o.activeMarks,n,null,i)),this.open++},it.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},it.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},it.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},it.prototype.addPendingMark=function(t){this.pendingMarks.push(t)},it.prototype.removePendingMark=function(t){var e=this.pendingMarks.lastIndexOf(t);if(e>-1)this.pendingMarks.splice(e,1);else{var n=this.top;n.activeMarks=t.removeFromSet(n.activeMarks)}},st.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},it.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},it.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},it.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},it.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},it.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},it.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Object.defineProperties(it.prototype,st);var lt=function(t,e){this.nodes=t||{},this.marks=e||{}};function ut(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function ht(t){return t.document||window.document}lt.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=ht(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},lt.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=lt.renderSpec(ht(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},lt.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},lt.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&lt.renderSpec(ht(n),r(t,e))},lt.renderSpec=function(t,e){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var n=t.createElement(e[0]),r=null,o=e[1],i=1;if(o&&"object"==typeof o&&null==o.nodeType&&!Array.isArray(o))for(var s in i=2,o)null!=o[s]&&n.setAttribute(s,o[s]);for(var a=i;a<e.length;a++){var c=e[a];if(0===c){if(a<e.length-1||a>i)throw new RangeError("Content hole must be the only child of its parent node");return{dom:n,contentDOM:n}}var l=lt.renderSpec(t,c),u=l.dom,h=l.contentDOM;if(n.appendChild(u),h){if(r)throw new RangeError("Multiple content holes");r=h}}return{dom:n,contentDOM:r}},lt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new lt(this.nodesFromSchema(t),this.marksFromSchema(t)))},lt.nodesFromSchema=function(t){var e=ut(t.nodes);return e.text||(e.text=function(t){return t.text}),e},lt.marksFromSchema=function(t){return ut(t.marks)}},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(1),s=n(8);var a=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},c={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};a.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},a.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},a.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},a.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new a(r,this.size+t.size)},a.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],c=i+s.nodeSize;c>t&&((i<t||c>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=c}return new a(n,r)},a.prototype.cutByIndex=function(t,e){return t==e?a.empty:0==t&&e==this.content.length?this:new a(this.content.slice(t,e))},a.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new a(r,o)},a.prototype.addToStart=function(t){return new a([t].concat(this.content),this.size+t.nodeSize)},a.prototype.addToEnd=function(t){return new a(this.content.concat(t),this.size+t.nodeSize)},a.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},c.firstChild.get=function(){return this.content.length?this.content[0]:null},c.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},c.childCount.get=function(){return this.content.length},a.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},a.prototype.maybeChild=function(t){return this.content[t]},a.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},a.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},a.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},a.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return u(0,t);if(t==this.size)return u(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?u(n+1,o):u(n,r);r=o}},a.prototype.toString=function(){return"<"+this.toStringInner()+">"},a.prototype.toStringInner=function(){return this.content.join(", ")},a.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},a.fromJSON=function(t,e){if(!e)return a.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new a(e.map(t.nodeFromJSON))},a.fromArray=function(t){if(!t.length)return a.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new a(e||t,n)},a.from=function(t){if(!t)return a.empty;if(t instanceof a)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new a([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(a.prototype,c);var l={index:0,offset:0};function u(t,e){return l.index=t,l.offset=e,l}function h(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!h(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&h(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}a.empty=new a([],0);var p=function(t,e){this.type=t,this.attrs=e};function f(t){var e=Error.call(this,t);return e.__proto__=f.prototype,e}p.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},p.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},p.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},p.prototype.eq=function(t){return this==t||this.type==t.type&&h(this.attrs,t.attrs)},p.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},p.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},p.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},p.setFrom=function(t){if(!t||0==t.length)return p.none;if(t instanceof p)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},p.none=[],f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="ReplaceError";var d=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},v={size:{configurable:!0}};function m(t,e,n){if(n.openStart>t.depth)throw new f("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new f("Inconsistent open depths");return function t(e,n,r,o){var i=e.index(o),s=e.node(o);if(i==n.index(o)&&o<e.depth-r.openStart){var c=t(e,n,r,o+1);return s.copy(s.content.replaceChild(i,c))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=o||n.depth!=o){var l=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(a.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),u=l.start,h=l.end;return x(s,function t(e,n,r,o,i){var s=e.depth>i&&y(e,n,i+1),c=o.depth>i&&y(r,o,i+1),l=[];w(null,e,i,l),s&&c&&n.index(i)==r.index(i)?(g(s,c),b(x(s,t(e,n,r,o,i+1)),l)):(s&&b(x(s,k(e,n,i+1)),l),w(n,r,i,l),c&&b(x(c,k(r,o,i+1)),l));return w(o,null,i,l),new a(l)}(e,u,h,n,o))}var p=e.parent,f=p.content;return x(p,f.cut(0,e.parentOffset).append(r.content).append(f.cut(n.parentOffset)))}return x(s,k(e,n,o))}(t,e,n,0)}function g(t,e){if(!e.type.compatibleContent(t.type))throw new f("Cannot join "+e.type.name+" onto "+t.type.name)}function y(t,e,n){var r=t.node(n);return g(r,e.node(n)),r}function b(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function w(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(b(t.nodeAfter,r),i++));for(var a=i;a<s;a++)b(o.child(a),r);e&&e.depth==n&&e.textOffset&&b(e.nodeBefore,r)}function x(t,e){if(!t.type.validContent(e))throw new f("Invalid content for node "+t.type.name);return t.copy(e)}function k(t,e,n){var r=[];(w(null,t,n,r),t.depth>n)&&b(x(y(t,e,n+1),k(t,e,n+1)),r);return w(e,null,n,r),new a(r)}v.size.get=function(){return this.content.size-this.openStart-this.openEnd},d.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new d(n,this.openStart,this.openEnd)},d.prototype.removeBetween=function(t,e){return new d(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},d.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},d.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},d.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},d.fromJSON=function(t,e){if(!e)return d.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new d(a.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},d.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new d(t,n,r)},Object.defineProperties(d.prototype,v),d.empty=new d(a.empty,0,0);var S=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},C={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};S.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},C.parent.get=function(){return this.node(this.depth)},C.doc.get=function(){return this.node(0)},S.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},S.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},S.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},S.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},S.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},S.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},S.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},C.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},C.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},C.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},S.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return p.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},S.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},S.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},S.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new T(this,t,n)},S.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},S.prototype.max=function(t){return t.pos>this.pos?t:this},S.prototype.min=function(t){return t.pos<this.pos?t:this},S.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},S.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new S(e,n,o)},S.resolveCached=function(t,e){for(var n=0;n<O.length;n++){var r=O[n];if(r.pos==e&&r.doc==t)return r}var o=O[N]=S.resolve(t,e);return N=(N+1)%M,o},Object.defineProperties(S.prototype,C);var O=[],N=0,M=12,T=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},A={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};A.start.get=function(){return this.$from.before(this.depth+1)},A.end.get=function(){return this.$to.after(this.depth+1)},A.parent.get=function(){return this.$from.node(this.depth)},A.startIndex.get=function(){return this.$from.index(this.depth)},A.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(T.prototype,A);var E=Object.create(null),D=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||a.empty,this.marks=r||p.none},P={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};P.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},P.childCount.get=function(){return this.content.childCount},D.prototype.child=function(t){return this.content.child(t)},D.prototype.maybeChild=function(t){return this.content.maybeChild(t)},D.prototype.forEach=function(t){this.content.forEach(t)},D.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},D.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},P.textContent.get=function(){return this.textBetween(0,this.content.size,"")},D.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},P.firstChild.get=function(){return this.content.firstChild},P.lastChild.get=function(){return this.content.lastChild},D.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},D.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},D.prototype.hasMarkup=function(t,e,n){return this.type==t&&h(this.attrs,e||t.defaultAttrs||E)&&p.sameSet(this.marks,n||p.none)},D.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},D.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},D.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},D.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return d.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new d(a,r.depth-i,o.depth-i)},D.prototype.replace=function(t,e,n){return m(this.resolve(t),this.resolve(e),n)},D.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},D.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},D.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},D.prototype.resolve=function(t){return S.resolveCached(this,t)},D.prototype.resolveNoCache=function(t){return S.resolve(this,t)},D.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},P.isBlock.get=function(){return this.type.isBlock},P.isTextblock.get=function(){return this.type.isTextblock},P.inlineContent.get=function(){return this.type.inlineContent},P.isInline.get=function(){return this.type.isInline},P.isText.get=function(){return this.type.isText},P.isLeaf.get=function(){return this.type.isLeaf},P.isAtom.get=function(){return this.type.isAtom},D.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),R(this.marks,t)},D.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},D.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=a.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var c=r;c<o;c++)if(!this.type.allowsMarks(n.child(c).marks))return!1;return!0},D.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},D.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},D.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},D.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},D.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=a.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(D.prototype,P);var I=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):R(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(D);function R(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var z=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},_={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};z.parse=function(t,e){var n=new $(t,e);if(null==n.next)return z.empty;var r=j(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];W(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new z(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(J);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(W(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},z.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},z.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},_.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},_.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},z.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},z.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var c=i.matchFragment(t,n);if(c&&(!e||c.validEnd))return a.from(s.map((function(t){return t.createAndFill()})));for(var l=0;l<i.next.length;l+=2){var u=i.next[l],h=i.next[l+1];if(!u.isText&&!u.hasRequiredAttrs()&&-1==r.indexOf(h)){r.push(h);var p=o(h,s.concat(u));if(p)return p}}}(this,[])},z.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},z.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},_.edgeCount.get=function(){return this.next.length>>1},z.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},z.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(z.prototype,_),z.empty=new z(!0);var $=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},B={next:{configurable:!0}};function j(t){var e=[];do{e.push(F(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function F(t){var e=[];do{e.push(V(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function V(t){for(var e=function(t){if(t.eat("(")){var e=j(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=q(t,e)}return e}function L(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function q(t,e){var n=L(t),r=n;return t.eat(",")&&(r="}"!=t.next?L(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function J(t,e){return e-t}function W(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(J)}function H(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function U(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function K(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new X(t[n]);return e}B.next.get=function(){return this.tokens[this.pos]},$.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},$.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties($.prototype,B);var G=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=K(n.attrs),this.defaultAttrs=H(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Y={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Y.isInline.get=function(){return!this.isBlock},Y.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Y.isLeaf.get=function(){return this.contentMatch==z.empty},Y.isAtom.get=function(){return this.isLeaf||this.spec.atom},G.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},G.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},G.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:U(this.attrs,t)},G.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new D(this,this.computeAttrs(t),a.from(e),p.setFrom(n))},G.prototype.createChecked=function(t,e,n){if(e=a.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new D(this,this.computeAttrs(t),e,p.setFrom(n))},G.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=a.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(a.empty,!0);return o?new D(this,t,e.append(o),p.setFrom(n)):null},G.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},G.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},G.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},G.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:p.empty:t},G.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new G(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(G.prototype,Y);var X=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},Z={isRequired:{configurable:!0}};Z.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(X.prototype,Z);var Q=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=K(r.attrs),this.rank=e,this.excluded=null;var o=H(this.attrs);this.instance=o&&new p(this,o)};Q.prototype.create=function(t){return!t&&this.instance?this.instance:new p(this,U(this.attrs,t))},Q.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new Q(t,r++,e,o)})),n},Q.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},Q.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},Q.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var tt=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=s.a.from(t.nodes),this.spec.marks=s.a.from(t.marks),this.nodes=G.compile(this.spec.nodes,this),this.marks=Q.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",a=o.spec.marks;o.contentMatch=n[i]||(n[i]=z.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==a?null:a?et(this,a.split(" ")):""!=a&&o.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:et(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function et(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}tt.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof G))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},tt.prototype.text=function(t,e){var n=this.nodes.text;return new I(n,n.defaultAttrs,t,p.setFrom(e))},tt.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},tt.prototype.nodeFromJSON=function(t){return D.fromJSON(this,t)},tt.prototype.markFromJSON=function(t){return p.fromJSON(this,t)},tt.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var nt=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};nt.prototype.parse=function(t,e){void 0===e&&(e={});var n=new ct(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},nt.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new ct(this,e,!0);return n.addAll(t,null,e.from,e.to),d.maxOpen(n.finish())},nt.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(ut(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},nt.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},nt.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=ht(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=ht(t)),t.node=s}));return e},nt.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new nt(t,nt.schemaRules(t)))};var rt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ot={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},it={ol:!0,ul:!0};function st(t){return(t?1:0)|("full"===t?2:0)}var at=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=p.none,this.pendingMarks=r};at.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(a.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},at.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=a.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(a.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},at.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):pt(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var ct=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=st(e.preserveWhitespace)|(n?4:0);r=o?new at(o.type,o.attrs,p.none,p.none,!0,e.topMatch||o.type.contentMatch,i):new at(n?null:t.schema.topNodeType,null,p.none,p.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},lt={top:{configurable:!0},currentPos:{configurable:!0}};function ut(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function ht(t){var e={};for(var n in t)e[n]=t[n];return e}function pt(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[],s=function(t){i.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),o=r.type,a=r.next;if(o==e)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}lt.top.get=function(){return this.nodes[this.open]},ct.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},ct.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},ct.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();it.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&it.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:ot.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(rt.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},ct.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},ct.prototype.readStyles=function(t){for(var e=p.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},ct.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o,s)},ct.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&rt.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},ct.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},ct.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},ct.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},ct.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:st(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new at(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},ct.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},ct.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},ct.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},lt.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},ct.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},ct.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},ct.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},ct.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},ct.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},ct.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},ct.prototype.addPendingMark=function(t){this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},ct.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1?r.pendingMarks=t.removeFromSet(r.pendingMarks):r.activeMarks=t.removeFromSet(r.activeMarks),r==e)break}},Object.defineProperties(ct.prototype,lt);var ft=function(t,e){this.nodes=t||{},this.marks=e||{}};function dt(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function vt(t){return t.document||window.document}ft.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=vt(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},ft.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=ft.renderSpec(vt(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},ft.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},ft.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&ft.renderSpec(vt(n),r(t,e))},ft.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var h=c;h<e.length;h++){var p=e[h];if(0===p){if(h<e.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var f=ft.renderSpec(t,p,n),d=f.dom,v=f.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},ft.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new ft(this.nodesFromSchema(t),this.marksFromSchema(t)))},ft.nodesFromSchema=function(t){var e=dt(t.nodes);return e.text||(e.text=function(t){return t.text}),e},ft.marksFromSchema=function(t){return dt(t.marks)};var mt=n(5),gt={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var yt=/Edge\/(\d+)/.exec(navigator.userAgent),bt=/MSIE \d/.test(navigator.userAgent),wt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);gt.mac=/Mac/.test(navigator.platform);var xt=gt.ie=!!(bt||wt||yt);gt.ie_version=bt?document.documentMode||6:wt?+wt[1]:yt?+yt[1]:null,gt.gecko=!xt&&/gecko\/(\d+)/i.test(navigator.userAgent),gt.gecko_version=gt.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var kt=!xt&&/Chrome\/(\d+)/.exec(navigator.userAgent);gt.chrome=!!kt,gt.chrome_version=kt&&+kt[1],gt.ios=!xt&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),gt.android=/Android \d/.test(navigator.userAgent),gt.webkit=!xt&&"WebkitAppearance"in document.documentElement.style,gt.safari=/Apple Computer/.test(navigator.vendor),gt.webkit_version=gt.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var St=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},Ct=function(t){var e=t.parentNode;return e&&11==e.nodeType?e.host:e},Ot=function(t,e,n){var r=document.createRange();return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},Nt=function(t,e,n,r){return n&&(Tt(t,e,n,r,-1)||Tt(t,e,n,r,1))},Mt=/^(img|br|input|textarea|hr)$/i;function Tt(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:At(t))){var i=t.parentNode;if(1!=i.nodeType||Et(t)||Mt.test(t.nodeName)||"false"==t.contentEditable)return!1;e=St(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType)return!1;t=t.childNodes[e+(o<0?-1:0)],e=o<0?At(t):0}}}function At(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Et(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var Dt=function(t){var e=t.isCollapsed;return e&&gt.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function Pt(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function It(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function Rt(t,e){return"number"==typeof t?t:t[e]}function zt(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,s=i.defaultView,a=n||t.dom;a;a=Ct(a))if(1==a.nodeType){var c=a==i.body||1!=a.nodeType,l=c?It(s):a.getBoundingClientRect(),u=0,h=0;if(e.top<l.top+Rt(r,"top")?h=-(l.top-e.top+Rt(o,"top")):e.bottom>l.bottom-Rt(r,"bottom")&&(h=e.bottom-l.bottom+Rt(o,"bottom")),e.left<l.left+Rt(r,"left")?u=-(l.left-e.left+Rt(o,"left")):e.right>l.right-Rt(r,"right")&&(u=e.right-l.right+Rt(o,"right")),(u||h)&&(c?s.scrollBy(u,h):(h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u))),c)break}}function _t(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=Ct(t));return e}function $t(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=s&&(o.scrollLeft=s)}}var Bt=null;function jt(t,e){for(var n,r,o=2e8,i=0,s=e.top,a=e.top,c=t.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(1==c.nodeType)u=c.getClientRects();else{if(3!=c.nodeType)continue;u=Ot(c).getClientRects()}for(var h=0;h<u.length;h++){var p=u[h];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);var f=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(f<o){n=c,o=f,r=f&&3==n.nodeType?{left:p.right<e.left?p.right:p.left,top:e.top}:e,1==c.nodeType&&f&&(i=l+(e.left>=(p.left+p.right)/2?1:0));continue}}!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);var i=Lt(r,1);if(i.top!=i.bottom&&Ft(e,i))return{node:t,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:i}:jt(n,r)}function Ft(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function Vt(t,e){var n,r,o,i,s=t.root;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(e.left,e.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(t){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(e.left,e.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var l,u=s.elementFromPoint(e.left,e.top+1);if(!u||!t.dom.contains(1!=u.nodeType?u.parentNode:u)){var h=t.dom.getBoundingClientRect();if(!Ft(e,h))return null;if(!(u=function t(e,n,r){var o=e.childNodes.length;if(o&&r.top<r.bottom)for(var i=Math.max(0,Math.min(o-1,Math.floor(o*(n.top-r.top)/(r.bottom-r.top))-2)),s=i;;){var a=e.childNodes[s];if(1==a.nodeType)for(var c=a.getClientRects(),l=0;l<c.length;l++){var u=c[l];if(Ft(n,u))return t(a,n,u)}if((s=(s+1)%o)==i)break}return e}(t.dom,e,h)))return null}if(u=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(u,e),o){if(gt.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var p,f=o.childNodes[i];"IMG"==f.nodeName&&(p=f.getBoundingClientRect()).right<=e.left&&p.bottom>e.top&&i++}o==t.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&e.top>o.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(l=function(t,e,n,r){for(var o=-1,i=e;i!=t.dom;){var s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n)}(t,o,i,e))}null==l&&(l=function(t,e,n){var r=jt(e,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(o,i,s)}(t,u,e));var d=t.docView.nearestDesc(u,!0);return{pos:l,inside:d?d.posAtStart-d.border:-1}}function Lt(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}function qt(t,e){var n=t.docView.domFromPos(e),r=n.node,o=n.offset;if(3==r.nodeType&&(gt.chrome||gt.gecko)){var i=Lt(Ot(r,o,o),0);if(gt.gecko&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){var s=Lt(Ot(r,o-1,o-1),-1);if(Math.abs(s.left-i.left)<1&&s.top==i.top){var a=Lt(Ot(r,o,o+1),-1);return Jt(a,a.left<s.left)}}return i}if(1==r.nodeType&&!t.state.doc.resolve(e).parent.inlineContent){var c,l=!0;if(o<r.childNodes.length){var u=r.childNodes[o];1==u.nodeType&&(c=u.getBoundingClientRect())}if(!c&&o){var h=r.childNodes[o-1];1==h.nodeType&&(c=h.getBoundingClientRect(),l=!1)}return function(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}(c||r.getBoundingClientRect(),l)}for(var p=-1;p<2;p+=2)if(p<0&&o){var f=void 0,d=3==r.nodeType?Ot(r,o-1,o):3==(f=r.childNodes[o-1]).nodeType?Ot(f):1==f.nodeType&&"BR"!=f.nodeName?f:null;if(d){var v=Lt(d,1);if(v.top<v.bottom)return Jt(v,!1)}}else if(p>0&&o<At(r)){var m=void 0,g=3==r.nodeType?Ot(r,o,o+1):3==(m=r.childNodes[o]).nodeType?Ot(m):1==m.nodeType?m:null;if(g){var y=Lt(g,-1);if(y.top<y.bottom)return Jt(y,!0)}}return Jt(Lt(3==r.nodeType?Ot(r):r,0),!1)}function Jt(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Wt(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o.focus()}}var Ht=/[\u0590-\u08ac]/;var Ut=null,Kt=null,Gt=!1;function Yt(t,e,n){return Ut==e&&Kt==n?Gt:(Ut=e,Kt=n,Gt="up"==n||"down"==n?function(t,e,n){var r=e.selection,o="up"==n?r.$anchor.min(r.$head):r.$anchor.max(r.$head);return Wt(t,e,(function(){for(var e=t.docView.domFromPos(o.pos).node;;){var r=t.docView.nearestDesc(e,!0);if(!r)break;if(r.node.isBlock){e=r.dom;break}e=r.dom.parentNode}for(var i=qt(t,o.pos),s=e.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=Ot(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top&&("up"==n?l.bottom<i.top+1:l.top>i.bottom-1))return!1}}return!0}))}(t,e,n):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=getSelection();return Ht.test(r.parent.textContent)&&a.modify?Wt(t,e,(function(){var e=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(e),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(t,e,n))}var Xt=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},Zt={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0}};Xt.prototype.matchesWidget=function(){return!1},Xt.prototype.matchesMark=function(){return!1},Xt.prototype.matchesNode=function(){return!1},Xt.prototype.matchesHack=function(){return!1},Zt.beforePosition.get=function(){return!1},Xt.prototype.parseRule=function(){return null},Xt.prototype.stopEvent=function(){return!1},Zt.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},Zt.border.get=function(){return 0},Xt.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},Xt.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},Zt.posBefore.get=function(){return this.parent.posBeforeChild(this)},Zt.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Zt.posAfter.get=function(){return this.posBefore+this.size},Zt.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Xt.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var l=t;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},Xt.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!e||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(t):o.nodeDOM==t))return o;n=!1}}},Xt.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},Xt.prototype.posFromDOM=function(t,e,n){for(var r=t;;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}},Xt.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(t<o)return r.descAt(t-n-r.border);n=o}},Xt.prototype.domFromPos=function(t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var e=0,n=0;;n++){if(e==t){for(;n<this.children.length&&(this.children[n].beforePosition||this.children[n].dom.parentNode!=this.contentDOM);)n++;return{node:this.contentDOM,offset:n==this.children.length?this.contentDOM.childNodes.length:St(this.children[n].dom)}}if(n==this.children.length)throw new Error("Invalid position "+t);var r=this.children[n],o=e+r.size;if(t<o)return r.domFromPos(t-e-r.border);e=o}},Xt.prototype.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&t<=c){var l=i+a.border;if(t>=l&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,l);t=i;for(var u=s;u>0;u--){var h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){r=St(h.dom)+1;break}t-=h.size}-1==r&&(r=0)}if(r>-1&&e<=c){e=c;for(var p=s+1;p<this.children.length;p++){var f=this.children[p];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=St(f.dom);break}e+=f.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},Xt.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},Xt.prototype.domAfterPos=function(t){var e=this.domFromPos(t),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},Xt.prototype.setSelection=function(t,e,n,r){for(var o=Math.min(t,e),i=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(o>a&&i<l)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=l}var u=this.domFromPos(t),h=this.domFromPos(e),p=n.getSelection(),f=document.createRange();if(r||!Nt(u.node,u.offset,p.anchorNode,p.anchorOffset)||!Nt(h.node,h.offset,p.focusNode,p.focusOffset)){if(p.extend)f.setEnd(u.node,u.offset),f.collapse(!1);else{if(t>e){var d=u;u=h,h=d}f.setEnd(h.node,h.offset),f.setStart(u.node,u.offset)}p.removeAllRanges(),p.addRange(f),p.extend&&p.extend(h.node,h.offset)}},Xt.prototype.ignoreMutation=function(t){return!this.contentDOM},Zt.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Xt.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){var s=n+o.border,a=i-o.border;if(t>=s&&e<=a)return this.dirty=t==n||e==i?2:1,void(t!=s||e!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-s,e-s):o.dirty=3);o.dirty=3}n=i}this.dirty=2},Xt.prototype.markParentsDirty=function(){for(var t=this.parent;t;t=t.parent){t.dirty<2&&(t.dirty=2)}},Object.defineProperties(Xt.prototype,Zt);var Qt=[],te=function(t){function e(e,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}t.call(this,e,Qt,s,null),this.widget=n,i=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},Object.defineProperties(e.prototype,n),e}(Xt),ee=function(t){function e(e,n,r,o){t.call(this,e,Qt,n,null),this.textDOM=r,this.text=o}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(Xt),ne=function(t){function e(e,n,r,o){t.call(this,e,[],r,o),this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=ft.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,s.dom,s.contentDOM||s.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=ye(i,n,s,r)),t>0&&(i=ye(i,0,t,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},e}(Xt),re=function(t){function e(e,n,r,o,i,s,a,c,l){t.call(this,e,n.isLeaf?Qt:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0}};return e.create=function(t,n,r,o,i,s){var a,c,l=i.nodeViews[n.type.name],u=l&&l(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r),h=u&&u.dom,p=u&&u.contentDOM;if(n.isText)if(h){if(3!=h.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else h=document.createTextNode(n.text);else h||(h=(a=ft.renderSpec(document,n.type.spec.toDOM(n))).dom,p=a.contentDOM);p||n.isText||"BR"==h.nodeName||(h.hasAttribute("contenteditable")||(h.contentEditable=!1),n.type.spec.draggable&&(h.draggable=!0));var f=h;return h=fe(h,r,n),u?c=new ae(t,n,r,o,h,p,f,u,i,s+1):n.isText?new ie(t,n,r,o,h,f,i):new e(t,n,r,o,h,p,f,i,s+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?a.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&de(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,o=e,i=r&&t.composing&&this.localCompositionNode(t,e),s=new me(this,i&&i.node);!function(t,e,n,r){var o=e.locals(t),i=0;if(0==o.length){for(var s=0;s<t.childCount;s++){var a=t.child(s);r(a,o,e.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,l=[],u=null,h=0;;){if(c<o.length&&o[c].to==i){for(var p=o[c++],f=void 0;c<o.length&&o[c].to==i;)(f||(f=[p])).push(o[c++]);if(f){f.sort(ge);for(var d=0;d<f.length;d++)n(f[d],h)}else n(p,h)}var v=void 0,m=void 0;if(u)m=-1,v=u,u=null;else{if(!(h<t.childCount))break;m=h,v=t.child(h++)}for(var g=0;g<l.length;g++)l[g].to<=i&&l.splice(g--,1);for(;c<o.length&&o[c].from==i;)l.push(o[c++]);var y=i+v.nodeSize;if(v.isText){var b=y;c<o.length&&o[c].from<b&&(b=o[c].from);for(var w=0;w<l.length;w++)l[w].to<b&&(b=l[w].to);b<y&&(u=v.cut(b-i),v=v.cut(0,b-i),y=b,m=-1)}r(v,l.length?l.slice():Qt,e.forChild(i,v),m),i=y}}(this.node,this.innerDeco,(function(e,i){e.spec.marks?s.syncToMarks(e.spec.marks,r,t):e.type.side>=0&&s.syncToMarks(i==n.node.childCount?p.none:n.node.child(i).marks,r,t),s.placeWidget(e,t,o)}),(function(e,n,i,a){s.syncToMarks(e.marks,r,t),s.findNodeMatch(e,n,i,a)||s.updateNextNode(e,n,i,t,a)||s.addNode(e,n,i,t,o),o+=e.nodeSize})),s.syncToMarks(Qt,r,t),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(t,i),this.renderChildren())},e.prototype.renderChildren=function(){!function t(e,n){for(var r=e.firstChild,o=0;o<n.length;o++){var i=n[o],s=i.dom;if(s.parentNode==e){for(;s!=r;)r=ve(r);r=r.nextSibling}else e.insertBefore(s,r);if(i instanceof ne){var a=r?r.previousSibling:e.lastChild;t(i.contentDOM,i.children),r=a?a.nextSibling:e.firstChild}}for(;r;)r=ve(r)}(this.contentDOM,this.children),gt.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom)},e.prototype.localCompositionNode=function(t,e){var n=t.state.selection,r=n.from,o=n.to;if(!(!(t.state.selection instanceof i.TextSelection)||r<e||o>e+this.node.content.size)){var s=t.root.getSelection(),a=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];t=t.childNodes[e-1],e=At(t)}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(s.focusNode,s.focusOffset);if(a&&this.dom.contains(a.parentNode)){var c=a.nodeValue,l=function(t,e,n,r){for(var o="",i=0,s=0;i<t.childCount;i++){var a=t.child(i),c=s+a.nodeSize;if(a.isText){if(o+=a.text,c>=r){for(var l=c-o.length,u=o.lastIndexOf(e);u>-1&&l+u>n;)u=o.lastIndexOf(e,u-1);if(u>-1&&l+u+e.length>=r)return l+u;if(c>r)break}}else o="";s=c}return-1}(this.node.content,c,r-e,o-e);return l<0?null:{node:a,pos:l,text:c}}}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,o=e.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new ee(this,i,n,o);t.compositionNodes.push(s),this.children=ye(this.children,r,r+o.length,t,s)}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!de(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=he(this.dom,this.nodeDOM,ue(this.outerDeco,this.node,e),ue(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!1)},Object.defineProperties(e.prototype,n),e}(Xt);function oe(t,e,n,r,o){return fe(r,e,t),new re(null,t,e,n,r,r,r,o,0)}var ie=function(t){function e(e,n,r,o,i,s,a){t.call(this,e,n,r,o,i,null,s,a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{skip:this.nodeDOM.parentNode||!0}},e.prototype.update=function(t,e){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text),this.node=t,this.dirty=0,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){var o=this.node.cut(t,n),i=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},e}(re),se=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(){return 0==this.dirty},e}(Xt),ae=function(t){function e(e,n,r,o,i,s,a,c,l,u){t.call(this,e,n,r,o,i,s,a,l,u),this.spec=c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(e,n);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,o)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(re);function ce(t){t&&(this.nodeName=t)}ce.prototype=Object.create(null);var le=[new ce];function ue(t,e,n){if(0==t.length)return le;for(var r=n?le[0]:new ce,o=[r],i=0;i<t.length;i++){var s=t[i].type.attrs,a=r;if(s)for(var c in s.nodeName&&o.push(a=new ce(s.nodeName)),s){var l=s[c];null!=l&&(n&&1==o.length&&o.push(a=r=new ce(e.isInline?"span":"div")),"class"==c?a.class=(a.class?a.class+" ":"")+l:"style"==c?a.style=(a.style?a.style+";":"")+l:"nodeName"!=c&&(a[c]=l))}}return o}function he(t,e,n,r){if(n==le&&r==le)return e;for(var o=e,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=t&&(c=e.parentNode)&&c.tagName.toLowerCase()==s.nodeName||(c=document.createElement(s.nodeName)).appendChild(o),o=c}pe(o,a||le[0],s)}return o}function pe(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" "):Qt,s=n.class?n.class.split(" "):Qt,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&t.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&t.classList.add(s[c])}if(e.style!=n.style){if(e.style)for(var l,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=u.exec(e.style);)t.style[l[1].toLowerCase()]="";n.style&&(t.style.cssText+=n.style)}}function fe(t,e,n){return he(t,t,le,ue(e,n,1!=t.nodeType))}function de(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function ve(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var me=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1;var n=function(t,e){for(var n=[],r=t.childCount,o=e.length-1;r>0&&o>=0;o--){var i=e[o],s=i.node;if(s){if(s!=t.child(r-1))break;n.push(i),--r}}return{nodes:n.reverse(),offset:r}}(t.node.content,t.children);this.preMatched=n.nodes,this.preMatchOffset=n.offset};function ge(t,e){return t.type.side-e.type.side}function ye(t,e,n,r,o){for(var i=[],s=0,a=0;s<t.length;s++){var c=t[s],l=a,u=a+=c.size;l>=n||u<=e?i.push(c):(l<e&&i.push(c.slice(0,e-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function be(t,e){var n=t.selection,r=n.$anchor,o=n.$head,s=e>0?r.max(o):r.min(o),a=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return a&&i.Selection.findFrom(a,e)}function we(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function xe(t,e,n){var r=t.state.selection;if(r instanceof i.TextSelection){if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){var o=be(t.state,e);return!!(o&&o instanceof i.NodeSelection)&&we(t,o)}var s,a=r.$head,c=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var l=e<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=t.docView.descAt(l))&&!s.contentDOM)&&(i.NodeSelection.isSelectable(c)?we(t,new i.NodeSelection(e<0?t.state.doc.resolve(a.pos-c.nodeSize):a)):!!gt.webkit&&we(t,new i.TextSelection(t.state.doc.resolve(e<0?l:l+c.nodeSize))))}if(r instanceof i.NodeSelection&&r.node.isInline)return we(t,new i.TextSelection(e>0?r.$to:r.$from));var u=be(t.state,e);return!!u&&we(t,u)}function ke(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Se(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function Ce(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,s=!1;for(gt.gecko&&1==n.nodeType&&r<ke(n)&&Se(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(Se(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(Ne(n))break;for(var c=n.previousSibling;c&&Se(c);)o=n.parentNode,i=St(c),c=c.previousSibling;if(c)r=ke(n=c);else{if((n=n.parentNode)==t.dom)break;r=0}}s?Me(t,e,n,r):o&&Me(t,e,o,i)}}function Oe(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,s=ke(n);;)if(r<s){if(1!=n.nodeType)break;if(!Se(n.childNodes[r]))break;o=n,i=++r}else{if(Ne(n))break;for(var a=n.nextSibling;a&&Se(a);)o=a.parentNode,i=St(a)+1,a=a.nextSibling;if(a)r=0,s=ke(n=a);else{if((n=n.parentNode)==t.dom)break;r=s=0}}o&&Me(t,e,o,i)}}function Ne(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Me(t,e,n,r){if(Dt(e)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),e.removeAllRanges(),e.addRange(o)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection()}function Te(t,e,n){var r=t.state.selection;if(r instanceof i.TextSelection&&!r.empty||n.indexOf("s")>-1)return!1;var o=r.$from,s=r.$to;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var a=be(t.state,e);if(a&&a instanceof i.NodeSelection)return we(t,a)}if(!o.parent.inlineContent){var c=i.Selection.findFrom(e<0?o:s,e);return!c||we(t,c)}return!1}function Ae(t,e){if(!(t.state.selection instanceof i.TextSelection))return!0;var n=t.state.selection,r=n.$head,o=n.$anchor,s=n.empty;if(!r.sameParent(o))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var a=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){var c=t.state.tr;return e<0?c.delete(r.pos-a.nodeSize,r.pos):c.delete(r.pos,r.pos+a.nodeSize),t.dispatch(c),!0}return!1}function Ee(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function De(t,e){var n=e.keyCode,r=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||gt.mac&&72==n&&"c"==r?Ae(t,-1)||Ce(t):46==n||gt.mac&&68==n&&"c"==r?Ae(t,1)||Oe(t):13==n||27==n||(37==n?xe(t,-1,r)||Ce(t):39==n?xe(t,1,r)||Oe(t):38==n?Te(t,-1,r)||Ce(t):40==n?function(t){if(gt.chrome&&!(t.state.selection.$head.parentOffset>0)){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;Ee(t,o,!0),setTimeout((function(){return Ee(t,o,!1)}),20)}}}(t)||Te(t,1,r)||Oe(t):r==(gt.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function Pe(t,e){var n=t.state.selection;if(ze(t,n),t.editable?t.hasFocus():Be(t)&&document.activeElement.contains(t.dom)){if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,St(r)+1):n.setEnd(r,0);n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&gt.ie&&gt.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{var r,o,s=n.anchor,a=n.head;!Ie||n instanceof i.TextSelection||(n.$from.parent.inlineContent||(r=Re(t,n.from)),n.empty||n.$from.parent.inlineContent||(o=Re(t,n.to))),t.docView.setSelection(s,a,t.root,e),Ie&&(r&&(r.contentEditable="false"),o&&(o.contentEditable="false")),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):s!=a&&(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.hideSelectionGuard),t.dom.classList.remove("ProseMirror-hideselection"))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}me.prototype.getPreMatch=function(t){return t>=this.preMatchOffset?this.preMatched[t-this.preMatchOffset]:null},me.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},me.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},me.prototype.syncToMarks=function(t,e,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,t.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(t[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=ne.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},me.prototype.findNodeMatch=function(t,e,n,r){var o=-1,i=r<0?void 0:this.getPreMatch(r),s=this.top.children;if(i&&i.matchesNode(t,e,n))o=s.indexOf(i);else for(var a=this.index,c=Math.min(s.length,a+5);a<c;a++){var l=s[a];if(l.matchesNode(t,e,n)&&this.preMatched.indexOf(l)<0){o=a;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},me.prototype.updateNextNode=function(t,e,n,r,o){if(this.index==this.top.children.length)return!1;var i=this.top.children[this.index];if(i instanceof re){var s=this.preMatched.indexOf(i);if(s>-1&&s+this.preMatchOffset!=o)return!1;var a=i.dom;if(!(this.lock&&(a==this.lock||1==a.nodeType&&a.contains(this.lock.parentNode))&&!(t.isText&&i.node&&i.node.isText&&i.nodeDOM.nodeValue==t.text&&3!=i.dirty&&de(e,i.outerDeco)))&&i.update(t,e,n,r))return i.dom!=a&&(this.changed=!0),this.index++,!0}return!1},me.prototype.addNode=function(t,e,n,r,o){this.top.children.splice(this.index++,0,re.create(this.top,t,e,n,r,o)),this.changed=!0},me.prototype.placeWidget=function(t,e,n){if(this.index<this.top.children.length&&this.top.children[this.index].matchesWidget(t))this.index++;else{var r=new te(this.top,t,e,n);this.top.children.splice(this.index++,0,r),this.changed=!0}},me.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof ne;)t=t.children[t.children.length-1];if(!t||!(t instanceof ie)||/\n$/.test(t.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var e=document.createElement("br");this.top.children.splice(this.index++,0,new se(this.top,Qt,e,null)),this.changed=!0}};var Ie=gt.safari||gt.chrome&&gt.chrome_version<63;function Re(t,e){var n=t.docView.domFromPos(e),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return i.contentEditable="true",i;if(s)return s.contentEditable="true",s}}function ze(t,e){if(e instanceof i.NodeSelection){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(_e(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else _e(t)}function _e(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function $e(t,e,n,r){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||i.TextSelection.between(e,n,r)}function Be(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function je(t,e){return function(n){var r=n.pmViewDesc;if(r)return r.parseRule();if("BR"==n.nodeName&&n.parentNode){if(gt.safari&&/^(ul|ol)$/i.test(n.parentNode.nodeName))return t.matchTag(document.createElement("li"),e);if(n.parentNode.lastChild==n||gt.safari&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0}}}function Fe(t,e,n,r){if(e<0){var o=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,s=function(t,e){var n,r,o=t.root.getSelection(),s=t.state.doc,a=t.docView.nearestDesc(o.focusNode),c=a&&0==a.size,l=t.docView.posFromDOM(o.focusNode,o.focusOffset),u=s.resolve(l);if(Dt(o)){for(n=u;a&&!a.node;)a=a.parent;if(a&&a.node.isAtom&&i.NodeSelection.isSelectable(a.node)&&a.parent){var h=a.posBefore;r=new i.NodeSelection(l==h?u:s.resolve(h))}}else n=s.resolve(t.docView.posFromDOM(o.anchorNode,o.anchorOffset));return r||(r=$e(t,n,u,"pointer"==e||t.state.selection.head<u.pos&&!c?1:-1)),r}(t,o);if(!t.state.selection.eq(s)){var c=t.state.tr.setSelection(s);"pointer"==o?c.setMeta("pointer",!0):"key"==o&&c.scrollIntoView(),t.dispatch(c)}}else{var l=t.state.doc.resolve(e),u=l.sharedDepth(n);e=l.before(u+1),n=t.state.doc.resolve(n).after(u+1);var h,p,f=t.state.selection,d=function(t,e,n){var r=t.docView.parseRange(e,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,l=t.root.getSelection(),u=null,h=l.anchorNode;if(h&&t.dom.contains(1==h.nodeType?h:h.parentNode)&&(u=[{node:h,offset:l.anchorOffset}],Dt(l)||u.push({node:l.focusNode,offset:l.focusOffset})),gt.chrome&&8===t.lastKeyCode)for(var p=s;p>i;p--){var f=o.childNodes[p-1],d=f.pmViewDesc;if("BR"==f.nodeType&&!d){s=p;break}if(!d||d.size)break}var v=t.state.doc,m=t.someProp("domParser")||nt.fromSchema(t.state.schema),g=v.resolve(a),y=null,b=m.parse(o,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!g.parent.type.spec.code||"full",editableContent:!0,findPositions:u,ruleFromNode:je(m,g),context:g});if(u&&null!=u[0].pos){var w=u[0].pos,x=u[1]&&u[1].pos;null==x&&(x=w),y={anchor:w+a,head:x+a}}return{doc:b,sel:y,from:a,to:c}}(t,e,n),v=t.state.doc,m=v.slice(d.from,d.to);8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(h=t.state.selection.to,p="end"):(h=t.state.selection.from,p="start"),t.lastKeyCode=null;var g=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size),a=s.a,c=s.b;if("end"==o){var l=Math.max(0,i-Math.min(a,c));r-=a+l-i}if(a<i&&t.size<e.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(m.content,d.doc.content,d.from,h,p);if(!g){if(!(r&&f instanceof i.TextSelection&&!f.empty&&f.$head.sameParent(f.$anchor))||t.composing||d.sel&&d.sel.anchor!=d.sel.head){if(d.sel){var y=Ve(t,t.state.doc,d.sel);y&&!y.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(y))}return}g={start:f.from,endA:f.to,endB:f.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&g.start==g.endB&&t.state.selection instanceof i.TextSelection&&(g.start>t.state.selection.from&&g.start<=t.state.selection.from+2?g.start=t.state.selection.from:g.endA<t.state.selection.to&&g.endA>=t.state.selection.to-2&&(g.endB+=t.state.selection.to-g.endA,g.endA=t.state.selection.to)),gt.ie&&gt.ie_version<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>d.from&&" "==d.doc.textBetween(g.start-d.from-1,g.start-d.from+1)&&(g.start--,g.endA--,g.endB--);var b,w=d.doc.resolveNoCache(g.start-d.from),x=d.doc.resolveNoCache(g.endB-d.from);if(!(!w.sameParent(x)&&w.pos<d.doc.content.size&&(b=i.Selection.findFrom(d.doc.resolve(w.pos+1),1,!0))&&b.head==x.pos&&t.someProp("handleKeyDown",(function(e){return e(t,Pt(13,"Enter"))}))))if(t.state.selection.anchor>g.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||Le(r,!0,!1)<o.pos)return!1;var i=t.resolve(e);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=t.resolve(Le(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||Le(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(v,g.start,g.endA,w,x)&&t.someProp("handleKeyDown",(function(e){return e(t,Pt(8,"Backspace"))})))gt.android&&gt.chrome&&t.domObserver.suppressSelectionUpdates();else{var k,S,C,O,N=g.start,M=g.endA;if(w.sameParent(x)&&w.parent.inlineContent)if(w.pos==x.pos)gt.ie&&gt.ie_version<=11&&0==w.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return Pe(t)}),20)),k=t.state.tr.delete(N,M),S=v.resolve(g.start).marksAcross(v.resolve(g.endA));else if(g.endA==g.endB&&(O=v.resolve(g.start))&&(C=function(t,e){for(var n,r,o,i=t.firstChild.marks,s=e.firstChild.marks,c=i,l=s,u=0;u<s.length;u++)c=s[u].removeFromSet(c);for(var h=0;h<i.length;h++)l=i[h].removeFromSet(l);if(1==c.length&&0==l.length)r=c[0],n="add",o=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=c.length||1!=l.length)return null;r=l[0],n="remove",o=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var p=[],f=0;f<e.childCount;f++)p.push(o(e.child(f)));if(a.from(p).eq(t))return{mark:r,type:n}}(w.parent.content.cut(w.parentOffset,x.parentOffset),O.parent.content.cut(O.parentOffset,g.endA-O.start()))))k=t.state.tr,"add"==C.type?k.addMark(N,M,C.mark):k.removeMark(N,M,C.mark);else if(w.parent.child(w.index()).isText&&w.index()==x.index()-(x.textOffset?0:1)){var T=w.parent.textBetween(w.parentOffset,x.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,N,M,T)})))return;k=t.state.tr.insertText(T,N,M)}if(k||(k=t.state.tr.replace(N,M,d.doc.slice(g.start-d.from,g.endB-d.from))),d.sel){var A=Ve(t,k.doc,d.sel);A&&!(gt.chrome&&gt.android&&t.composing&&A.empty&&A.head==N||gt.ie&&A.empty&&A.head==N)&&k.setSelection(A)}S&&k.ensureMarks(S),t.dispatch(k.scrollIntoView())}}}function Ve(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:$e(t,e.resolve(n.anchor),e.resolve(n.head))}function Le(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function qe(t,e){for(var n=[],r=e.content,o=e.openStart,i=e.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.type.hasRequiredAttrs()?s.attrs:null),r=s.content}var a=t.someProp("clipboardSerializer")||ft.fromSchema(t.state.schema),c=Ge(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var u,h=l.firstChild;h&&1==h.nodeType&&(u=Ue[h.nodeName.toLowerCase()]);){for(var p=u.length-1;p>=0;p--){for(var f=c.createElement(u[p]);l.firstChild;)f.appendChild(l.firstChild);l.appendChild(f)}h=l.firstChild}return h&&1==h.nodeType&&h.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:l,text:t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n")}}function Je(t,e,n,r,o){var i,s,c=o.parent.type.spec.code;if(!n&&!e)return null;var l=e&&(r||c||!n);if(l){if(t.someProp("transformPastedText",(function(t){e=t(e)})),c)return new d(a.from(t.state.schema.text(e)),0,0);var u=t.someProp("clipboardTextParser",(function(t){return t(e,o)}));u?s=u:(i=document.createElement("div"),e.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){i.appendChild(document.createElement("p")).textContent=t})))}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),i=function(t){var e=/(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=Ge().createElement("div"),o=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(t),i=0;(n=o&&Ue[o[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join(""),i=n.length);r.innerHTML=t;for(var s=0;s<i;s++)r=r.firstChild;return r}(n);var h=i&&i.querySelector("[data-pm-slice]"),p=h&&/^(\d+) (\d+) (.*)/.exec(h.getAttribute("data-pm-slice"));if(!s){var f=t.someProp("clipboardParser")||t.someProp("domParser")||nt.fromSchema(t.state.schema);s=f.parseSlice(i,{preserveWhitespace:!(!l&&!p),context:o})}return s=p?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var o=t.content,i=t.openStart,s=t.openEnd,c=n.length-2;c>=0;c-=2){var l=r.nodes[n[c]];if(!l||l.hasRequiredAttrs())break;o=a.from(l.create(n[c+1],o)),i++,s++}return new d(o,i,s)}(function(t,e,n){e<t.openStart&&(t=new d(He(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd));n<t.openEnd&&(t=new d(He(t.content,1,n,t.openEnd,0,0),t.openStart,n));return t}(s,+p[1],+p[2]),p[3]):d.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,i=[];if(t.forEach((function(t){if(i){var e,n=r.findWrapping(t.type);if(!n)return i=null;if(e=i.length&&o.length&&function t(e,n,r,o,i){if(i<e.length&&i<n.length&&e[i]==n[i]){var s=t(e,n,r,o.lastChild,i+1);if(s)return o.copy(o.content.replaceChild(o.childCount-1,s));if(o.contentMatchAt(o.childCount).matchType(i==e.length-1?r.type:e[i+1]))return o.copy(o.content.append(a.from(We(r,e,i+1))))}}(n,o,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=function t(e,n){if(0==n)return e;var r=e.content.replaceChild(e.childCount-1,t(e.lastChild,n-1)),o=e.contentMatchAt(e.childCount).fillBefore(a.empty,!0);return e.copy(r.append(o))}(i[i.length-1],o.length));var s=We(t,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:a.from(i)}},r=e.depth;r>=0;r--){var o=n(r);if(o)return o.v}return t}(s.content,o),!1),t.someProp("transformPasted",(function(t){s=t(s)})),s}function We(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,a.from(t));return t}function He(t,e,n,r,o,i){var s=e<0?t.firstChild:t.lastChild,c=s.content;return o<r-1&&(c=He(c,e,n,r,o+1,i)),o>=n&&(c=e<0?s.contentMatchAt(0).fillBefore(c,t.childCount>1||i<=o).append(c):c.append(s.contentMatchAt(s.childCount).fillBefore(a.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(c))}var Ue={thead:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Ke=null;function Ge(){return Ke||(Ke=document.implementation.createHTMLDocument("title"))}var Ye={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Xe=gt.ie&&gt.ie_version<=11,Ze=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Ze.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},Ze.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var Qe=function(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=!1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);gt.ie&&gt.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Ze,Xe&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Qe.prototype.flushSoon=function(){var t=this;this.flushingSoon||(this.flushingSoon=!0,window.setTimeout((function(){t.flushingSoon=!1,t.flush()}),20))},Qe.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,Ye),Xe&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Qe.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}Xe&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Qe.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Qe.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Qe.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},Qe.prototype.onSelectionChange=function(){if((!(t=this.view).editable||t.root.activeElement==t.dom)&&Be(t)){var t;if(this.suppressingSelectionUpdates)return Pe(this.view);if(gt.ie&&gt.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&Nt(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}},Qe.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Qe.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(e);return n&&n.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})},Qe.prototype.flush=function(){if(this.view.docView&&!this.flushingSoon){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&Be(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<t.length;a++){var c=this.registerMutation(t[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&!this.view.composing&&(i=!0))}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(t){if(tn)return;tn=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Pe(this.view))}},Qe.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){var r=t.previousSibling,o=t.nextSibling;if(gt.ie&&gt.ie_version<=11&&t.addedNodes.length)for(var i=0;i<t.addedNodes.length;i++){var s=t.addedNodes[i],a=s.previousSibling,c=s.nextSibling;(!a||Array.prototype.indexOf.call(t.addedNodes,a)<0)&&(r=a),(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(o=c)}for(var l=r&&r.parentNode==t.target?St(r)+1:0,u=n.localPosFromDOM(t.target,l,-1),h=o&&o.parentNode==t.target?St(o):t.target.childNodes.length,p=0;p<t.addedNodes.length;p++)e.push(t.addedNodes[p]);return{from:u,to:n.localPosFromDOM(t.target,h,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var tn=!1;var en={},nn={};function rn(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function on(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return sn(t,e)})}))}function sn(t,e){return t.someProp("handleDOMEvents",(function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)}))}function an(t){return{left:t.clientX,top:t.clientY}}function cn(t,e,n,r,o){if(-1==r)return!1;for(var i=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,(function(e){return r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function ln(t,e,n){t.focused||t.focus();var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function un(t,e,n,r,o){return cn(t,"handleClickOn",e,n,r)||t.someProp("handleClick",(function(n){return n(t,e,r)}))||(o?function(t,e){if(-1==e)return!1;var n,r,o=t.state.selection;o instanceof i.NodeSelection&&(n=o.node);for(var s=t.state.doc.resolve(e),a=s.depth+1;a>0;a--){var c=a>s.depth?s.nodeAfter:s.node(a);if(i.NodeSelection.isSelectable(c)){r=n&&o.$from.depth>0&&a>=o.$from.depth&&s.before(o.$from.depth+1)==o.$from.pos?s.before(o.$from.depth):s.before(a);break}}return null!=r&&(ln(t,i.NodeSelection.create(t.state.doc,r),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&i.NodeSelection.isSelectable(r))&&(ln(t,new i.NodeSelection(n),"pointer"),!0)}(t,n))}function hn(t,e,n,r){return cn(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}function pn(t,e,n,r){return cn(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",(function(n){return n(t,e,r)}))||function(t,e){var n=t.state.doc;if(-1==e)return!!n.inlineContent&&(ln(t,i.TextSelection.create(n,0,n.content.size),"pointer"),!0);for(var r=n.resolve(e),o=r.depth+1;o>0;o--){var s=o>r.depth?r.nodeAfter:r.node(o),a=r.before(o);if(s.inlineContent)ln(t,i.TextSelection.create(n,a+1,a+1+s.content.size),"pointer");else{if(!i.NodeSelection.isSelectable(s))continue;ln(t,i.NodeSelection.create(n,a),"pointer")}return!0}}(t,n)}function fn(t){return bn(t)}nn.keydown=function(t,e){t.shiftKey=16==e.keyCode||e.shiftKey,mn(t,e)||(t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),t.someProp("handleKeyDown",(function(n){return n(t,e)}))||De(t,e)?e.preventDefault():rn(t,"key"))},nn.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},nn.keypress=function(t,e){if(!(mn(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||gt.mac&&e.metaKey))if(t.someProp("handleKeyPress",(function(n){return n(t,e)})))e.preventDefault();else{var n=t.state.selection;if(!(n instanceof i.TextSelection&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(e.charCode);t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,r)}))||t.dispatch(t.state.tr.insertText(r).scrollIntoView()),e.preventDefault()}}};var dn=gt.mac?"metaKey":"ctrlKey";en.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n=fn(t),r=Date.now(),o="singleClick";r-t.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(e,t.lastClick)&&!e[dn]&&("singleClick"==t.lastClick.type?o="doubleClick":"doubleClick"==t.lastClick.type&&(o="tripleClick")),t.lastClick={time:r,x:e.clientX,y:e.clientY,type:o};var i=t.posAtCoords(an(e));i&&("singleClick"==o?t.mouseDown=new vn(t,i,e,n):("doubleClick"==o?hn:pn)(t,i.pos,i.inside,e)?e.preventDefault():rn(t,"pointer"))};var vn=function(t,e,n,r){var o,s,a=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=r,this.selectNode=n[dn],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),s=e.inside;else{var c=t.state.doc.resolve(e.pos);o=c.parent,s=c.depth?c.before():0}this.mightDrag=null;var l=r?null:n.target,u=l?t.docView.nearestDesc(l,!0):null;this.target=u?u.dom:null,(o.type.spec.draggable&&!1!==o.type.spec.selectable||t.state.selection instanceof i.NodeSelection&&s==t.state.selection.from)&&(this.mightDrag={node:o,pos:s,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&gt.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){return a.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),rn(t,"pointer")};function mn(t,e){return!!t.composing||!!(gt.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500)&&(t.compositionEndedAt=-2e8,!0)}vn.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!1),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},vn.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(an(t))),this.allowDefault||!e?rn(this.view,"pointer"):un(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():!this.flushed&&(!gt.chrome||this.view.state.selection instanceof i.TextSelection||e.pos!=this.view.state.selection.from&&e.pos!=this.view.state.selection.to)?rn(this.view,"pointer"):(ln(this.view,i.Selection.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault())}},vn.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),rn(this.view,"pointer")},en.touchdown=function(t){fn(t),rn(t,"pointer")},en.contextmenu=function(t){return fn(t)};var gn=gt.android?5e3:-1;function yn(t,e){clearTimeout(t.composingTimeout),e>-1&&(t.composingTimeout=setTimeout((function(){return bn(t)}),e))}function bn(t,e){for(t.composing=!1;t.compositionNodes.length>0;)t.compositionNodes.pop().markParentsDirty();return!(!e&&!t.docView.dirty)&&(t.updateState(t.state),!0)}nn.compositionstart=nn.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),bn(t,!0),t.markCursor=null;else if(bn(t),gt.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}t.composing=!0}yn(t,gn)},nn.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,yn(t,20))};var wn=gt.ie&&gt.ie_version<15||gt.ios&&gt.webkit_version<604;function xn(t,e,n,r){var o=Je(t,e,n,t.shiftKey,t.state.selection.$from);if(!t.someProp("handlePaste",(function(e){return e(t,r,o||d.empty)}))&&o){var i=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(o),s=i?t.state.tr.replaceSelectionWith(i,t.shiftKey):t.state.tr.replaceSelection(o);t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste"))}}en.copy=nn.cut=function(t,e){var n=t.state.selection,r="cut"==e.type;if(!n.empty){var o=wn?null:e.clipboardData,i=qe(t,n.content()),s=i.dom,a=i.text;o?(e.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(t,e){var n=t.dom.ownerDocument,r=n.body.appendChild(n.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";var o=getSelection(),i=n.createRange();i.selectNodeContents(e),t.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout((function(){n.body.removeChild(r),t.focus()}),50)}(t,s),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},nn.paste=function(t,e){var n=wn?null:e.clipboardData,r=n&&n.getData("text/html"),o=n&&n.getData("text/plain");n&&(r||o||n.files.length)?(xn(t,o,r,e),e.preventDefault()):function(t,e){var n=t.dom.ownerDocument,r=t.shiftKey||t.state.selection.$from.parent.type.spec.code,o=n.body.appendChild(n.createElement(r?"textarea":"div"));r||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout((function(){t.focus(),n.body.removeChild(o),r?xn(t,o.value,null,e):xn(t,o.textContent,o.innerHTML,e)}),50)}(t,e)};var kn=function(t,e){this.slice=t,this.move=e},Sn=gt.mac?"altKey":"ctrlKey";for(var Cn in en.dragstart=function(t,e){var n=t.mouseDown;if(n&&n.done(),e.dataTransfer){var r=t.state.selection,o=r.empty?null:t.posAtCoords(an(e));if(o&&o.pos>=r.from&&o.pos<=(r instanceof i.NodeSelection?r.to-1:r.to));else if(n&&n.mightDrag)t.dispatch(t.state.tr.setSelection(i.NodeSelection.create(t.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var s=t.docView.nearestDesc(e.target,!0);if(!s||!s.node.type.spec.draggable||s==t.docView)return;t.dispatch(t.state.tr.setSelection(i.NodeSelection.create(t.state.doc,s.posBefore)))}var a=t.state.selection.content(),c=qe(t,a),l=c.dom,u=c.text;e.dataTransfer.clearData(),e.dataTransfer.setData(wn?"Text":"text/html",l.innerHTML),wn||e.dataTransfer.setData("text/plain",u),t.dragging=new kn(a,!e[Sn])}},en.dragend=function(t){window.setTimeout((function(){return t.dragging=null}),50)},nn.dragover=nn.dragenter=function(t,e){return e.preventDefault()},nn.drop=function(t,e){var n=t.dragging;if(t.dragging=null,e.dataTransfer){var r=t.posAtCoords(an(e));if(r){var o=t.state.doc.resolve(r.pos);if(o){var s=n&&n.slice||Je(t,e.dataTransfer.getData(wn?"Text":"text/plain"),wn?null:e.dataTransfer.getData("text/html"),!1,o);if(s&&(e.preventDefault(),!t.someProp("handleDrop",(function(r){return r(t,e,s,n&&n.move)})))){var a=s?Object(mt.g)(t.state.doc,o.pos,s):o.pos;null==a&&(a=o.pos);var c=t.state.tr;n&&n.move&&c.deleteSelection();var l=c.mapping.map(a),u=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=c.doc;if(u?c.replaceRangeWith(l,l,s.content.firstChild):c.replaceRange(l,l,s),!c.doc.eq(h)){var p=c.doc.resolve(l);u&&i.NodeSelection.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild)?c.setSelection(new i.NodeSelection(p)):c.setSelection($e(t,p,c.doc.resolve(c.mapping.map(a)))),t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))}}}}}},en.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0)},en.blur=function(t){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),t.domObserver.currentSelection.set({}),t.focused=!1)},en.beforeinput=function(t,e){if(gt.chrome&&gt.android&&"deleteContentBackward"==e.inputType){var n=t.domChangeCount;setTimeout((function(){if(t.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",(function(e){return e(t,Pt(8,"Backspace"))})))){var e=t.state.selection.$cursor;e&&e.pos>0&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView())}}),50)}},nn)en[Cn]=nn[Cn];function On(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var Nn=function(t,e){this.spec=e||Pn,this.side=this.spec.side||0,this.toDOM=t};Nn.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new An(i-n,i-n,this)},Nn.prototype.valid=function(){return!0},Nn.prototype.eq=function(t){return this==t||t instanceof Nn&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&On(this.spec,t.spec))};var Mn=function(t,e){this.spec=e||Pn,this.attrs=t};Mn.prototype.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new An(o,i,this)},Mn.prototype.valid=function(t,e){return e.from<e.to},Mn.prototype.eq=function(t){return this==t||t instanceof Mn&&On(this.attrs,t.attrs)&&On(this.spec,t.spec)},Mn.is=function(t){return t.type instanceof Mn};var Tn=function(t,e){this.spec=e||Pn,this.attrs=t};Tn.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);if(o.deleted)return null;var i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new An(o.pos-n,i.pos-n,this)},Tn.prototype.valid=function(t,e){var n=t.content.findIndex(e.from),r=n.index,o=n.offset;return o==e.from&&o+t.child(r).nodeSize==e.to},Tn.prototype.eq=function(t){return this==t||t instanceof Tn&&On(this.attrs,t.attrs)&&On(this.spec,t.spec)};var An=function(t,e,n){this.from=t,this.to=e,this.type=n},En={spec:{configurable:!0}};An.prototype.copy=function(t,e){return new An(t,e,this.type)},An.prototype.eq=function(t){return this.type.eq(t.type)&&this.from==t.from&&this.to==t.to},An.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},An.widget=function(t,e,n){return new An(t,t,new Nn(e,n))},An.inline=function(t,e,n,r){return new An(t,e,new Mn(n,r))},An.node=function(t,e,n,r){return new An(t,e,new Tn(n,r))},En.spec.get=function(){return this.type.spec},Object.defineProperties(An.prototype,En);var Dn=[],Pn={},In=function(t,e){this.local=t&&t.length?t:Dn,this.children=e&&e.length?e:Dn};In.create=function(t,e){return e.length?jn(e,t,0,Pn):Rn},In.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},In.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){var c=this.children[a]+1;this.children[a+2].findInner(t-c,e-c,n,r+c,o)}},In.prototype.map=function(t,e,n){return this==Rn||0==t.maps.length?this:this.mapInner(t,e,0,0,n||Pn)},In.prototype.mapInner=function(t,e,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||t>c+i||(e>=a[s]+i?a[s+1]=-1:(l=r-n-(e-t)+(i-o))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,h=0;h<a.length;h+=3)if(-1==a[h+1]){var p=n.map(a[h]+i),f=p-o;if(f<0||f>=r.content.size){u=!0;continue}var d=n.map(t[h+1]+i,-1)-o,v=r.content.findIndex(f),m=v.index,g=v.offset,y=r.maybeChild(m);if(y&&g==f&&g+y.nodeSize==d){var b=a[h+2].mapInner(n,y,p+1,a[h]+i+1,s);b!=Rn?(a[h]=f,a[h+1]=d,a[h+2]=b):(a[h+1]=-2,u=!0)}else u=!0}if(u){var w=jn(function(t,e,n,r,o,i,s){function a(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):s.onRemove&&s.onRemove(t.local[i].spec)}for(var l=0;l<t.children.length;l+=3)a(t.children[l+2],t.children[l]+e+1)}for(var c=0;c<t.length;c+=3)-1==t[c+1]&&a(t[c+2],e[c]+i+1);return n}(a,t,e||[],n,o,i,s),r,0,s);e=w.local;for(var x=0;x<a.length;x+=3)a[x+1]<0&&(a.splice(x,3),x-=3);for(var k=0,S=0;k<w.children.length;k+=3){for(var C=w.children[k];S<a.length&&a[S]<C;)S+=3;a.splice(S,0,w.children[k],w.children[k+1],w.children[k+2])}}return new In(e&&e.sort(Fn),a)}(this.children,i,t,e,n,r,o):i?new In(i.sort(Fn)):Rn},In.prototype.add=function(t,e){return e.length?this==Rn?In.create(t,e):this.addInner(t,e,0):this},In.prototype.addInner=function(t,e,n){var r,o=this,i=0;t.forEach((function(t,s){var a,c=s+n;if(a=$n(e,t,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(t,a,c+1):r.splice(i,0,s,s+t.nodeSize,jn(a,t,c+1,Pn)),i+=3}}));var s=_n(i?Bn(e):e,-n);return new In(s.length?this.local.concat(s).sort(Fn):this.local,r||this.children)},In.prototype.remove=function(t){return 0==t.length||this==Rn?this:this.removeInner(t,0)},In.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+e,a=n[o+1]+e,c=0,l=void 0;c<t.length;c++)(l=t[c])&&l.from>s&&l.to<a&&(t[c]=null,(i||(i=[])).push(l));if(i){n==this.children&&(n=this.children.slice());var u=n[o+2].removeInner(i,s+1);u!=Rn?n[o+2]=u:(n.splice(o,3),o-=3)}}if(r.length)for(var h=0,p=void 0;h<t.length;h++)if(p=t[h])for(var f=0;f<r.length;f++)r[f].type.eq(p.type)&&(r==this.local&&(r=this.local.slice()),r.splice(f--,1));return n==this.children&&r==this.local?this:r.length||n.length?new In(r,n):Rn},In.prototype.forChild=function(t,e){if(this==Rn)return this;if(e.isLeaf)return In.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}for(var i=t+1,s=i+e.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof Mn){var l=Math.max(i,c.from)-i,u=Math.min(s,c.to)-i;l<u&&(r||(r=[])).push(c.copy(l,u))}}if(r){var h=new In(r.sort(Fn));return n?new zn([h,n]):h}return n||Rn},In.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof In)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},In.prototype.locals=function(t){return Vn(this.localsInner(t))},In.prototype.localsInner=function(t){if(this==Rn)return Dn;if(t.inlineContent||!this.local.some(Mn.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof Mn||e.push(this.local[n]);return e};var Rn=new In;In.empty=Rn,In.removeOverlap=Vn;var zn=function(t){this.members=t};function _n(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new An(o.from+e,o.to+e,o.type))}return n}function $n(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,s=void 0;i<t.length;i++)(s=t[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),t[i]=null);return o}function Bn(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function jn(t,e,n,r){var o=[],i=!1;e.forEach((function(e,s){var a=$n(t,e,s+n);if(a){i=!0;var c=jn(a,e,n+s+1,r);c!=Rn&&o.push(s,s+e.nodeSize,c)}}));for(var s=_n(i?Bn(t):t,-n).sort(Fn),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new In(s,o):Rn}function Fn(t,e){return t.from-e.from||t.to-e.to}function Vn(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),Ln(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),Ln(e,o+1,i.copy(r.to,i.to)))}}return e}function Ln(t,e,n){for(;e<t.length&&Fn(n,t[e])>0;)e++;t.splice(e,0,n)}function qn(t){var e=[];return t.someProp("decorations",(function(n){var r=n(t.state);r&&r!=Rn&&e.push(r)})),t.cursorWrapper&&e.push(In.create(t.state.doc,[t.cursorWrapper.deco])),zn.from(e)}zn.prototype.forChild=function(t,e){if(e.isLeaf)return In.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(t,e);o!=Rn&&(o instanceof zn?n=n.concat(o.members):n.push(o))}return zn.from(n)},zn.prototype.eq=function(t){if(!(t instanceof zn)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},zn.prototype.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(var i=0;i<o.length;i++)e.push(o[i])}else e=o}return e?Vn(n?e:e.sort(Fn)):Dn},zn.from=function(t){switch(t.length){case 0:return Rn;case 1:return t[0];default:return new zn(t)}};var Jn=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Kn(this),this.markCursor=null,this.cursorWrapper=null,Un(this),this.nodeViews=Yn(this),this.docView=oe(this.state.doc,Hn(this),qn(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(t){t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new Qe(t,(function(e,n,r){return Fe(t,e,n,r)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null);var e=function(e){var n=en[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,e)||sn(t,e)||!t.editable&&e.type in nn||n(t,e)})};for(var n in en)e(n);gt.safari&&t.dom.addEventListener("input",(function(){return null})),on(t)}(this),this.pluginViews=[],this.updatePluginViews()},Wn={props:{configurable:!0},root:{configurable:!0}};function Hn(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r?e.class+=" "+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[An.node(0,t.state.doc.content.size,e)]}function Un(t){var e=t.state.selection,n=e.$head,r=e.$anchor,o=e.visible;if(t.markCursor){var i=document.createElement("img");i.setAttribute("mark-placeholder","true"),t.cursorWrapper={dom:i,deco:An.widget(n.pos,i,{raw:!0,marks:t.markCursor})}}else if(o||n.pos!=r.pos)t.cursorWrapper=null;else{var s;!t.cursorWrapper||t.cursorWrapper.dom.childNodes.length?((s=document.createElement("div")).style.position="absolute",s.style.left="-100000px"):t.cursorWrapper.deco.pos!=n.pos&&(s=t.cursorWrapper.dom),s&&(t.cursorWrapper={dom:s,deco:An.widget(n.pos,s,{raw:!0})})}}function Kn(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function Gn(t){var e=t.getSelection(),n=e.focusOffset,r=e.focusNode;return r&&3!=r.nodeType?[r,n,1==r.nodeType?r.childNodes[n-1]:null,1==r.nodeType?r.childNodes[n]:null]:null}function Yn(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}Wn.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},Jn.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&on(this),this._props=t,this.updateStateInner(t.state,!0)},Jn.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},Jn.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},Jn.prototype.updateStateInner=function(t,e){var n=this,r=this.state,o=!1;if(this.state=t,e){var s=Yn(this);(function(t,e){var n=0,r=0;for(var o in t){if(t[o]!=e[o])return!0;n++}for(var i in e)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),on(this)}this.editable=Kn(this),Un(this);var a,c,l,u,h,p,f,d,v=qn(this),m=Hn(this),g=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",y=o||!this.docView.matchesNode(t.doc,m,v),b=y||!t.selection.eq(r.selection),w="preserve"==g&&b&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(i,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:_t(t.dom)}}(this);if(b){this.domObserver.stop();var x=!1;if(y){var k=gt.chrome&&Gn(this.root);!o&&this.docView.update(t.doc,m,v,this)||(this.docView.destroy(),this.docView=oe(t.doc,m,v,this.dom,this)),k&&(x=!this.composing&&function(t,e){var n=Gn(e);if(!n||3==n[0].nodeType)return!1;for(var r=0;r<t.length;r++)if(n[r]!=t[r])return!0;return!1}(k,this.root)),gt.ie&&gt.ie_version<=11&&!r.selection.empty&&t.selection.empty&&t.doc.content.size<r.doc.content.size&&(x=!0)}x||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(a=this,c=a.docView.domFromPos(a.state.selection.anchor),l=a.root.getSelection(),Nt(c.node,c.offset,l.anchorNode,l.anchorOffset)))?Pe(this,x):(ze(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==g)this.dom.scrollTop=0;else if("to selection"==g){var S=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof i.NodeSelection?zt(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),S):zt(this,this.coordsAtPos(t.selection.head),S))}else w&&(h=(u=w).refDOM,p=u.refTop,f=u.stack,d=h?h.getBoundingClientRect().top:0,$t(f,0==d?0:d-p))},Jn.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},Jn.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},Jn.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[t];if(null!=s&&(n=e?e(s):s))return n}},Jn.prototype.hasFocus=function(){return this.root.activeElement==this.dom},Jn.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(Bt)return t.focus(Bt);var e=_t(t);t.focus(null==Bt?{get preventScroll(){return Bt={preventScroll:!0},!0}}:void 0),Bt||(Bt=!1,$t(e,0))}(this.dom),Pe(this),this.domObserver.start()},Wn.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return this._root=e;return t||document},Jn.prototype.posAtCoords=function(t){return Vt(this,t)},Jn.prototype.coordsAtPos=function(t){return qt(this,t)},Jn.prototype.domAtPos=function(t){return this.docView.domFromPos(t)},Jn.prototype.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},Jn.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},Jn.prototype.endOfTextblock=function(t,e){return Yt(this,e||this.state,t)},Jn.prototype.destroy=function(){this.docView&&(!function(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],qn(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},Jn.prototype.dispatchEvent=function(t){return function(t,e){sn(t,e)||!en[e.type]||!t.editable&&e.type in nn||en[e.type](t,e)}(this,t)},Jn.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(Jn.prototype,Wn);var Xn=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},Zn={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};Xn.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},Xn.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},Xn.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},Xn.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new Xn(r,this.size+t.size)},Xn.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new Xn(n,r)},Xn.prototype.cutByIndex=function(t,e){return t==e?Xn.empty:0==t&&e==this.content.length?this:new Xn(this.content.slice(t,e))},Xn.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new Xn(r,o)},Xn.prototype.addToStart=function(t){return new Xn([t].concat(this.content),this.size+t.nodeSize)},Xn.prototype.addToEnd=function(t){return new Xn(this.content.concat(t),this.size+t.nodeSize)},Xn.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},Zn.firstChild.get=function(){return this.content.length?this.content[0]:null},Zn.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Zn.childCount.get=function(){return this.content.length},Xn.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},Xn.prototype.maybeChild=function(t){return this.content[t]},Xn.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},Xn.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},Xn.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},Xn.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return tr(0,t);if(t==this.size)return tr(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?tr(n+1,o):tr(n,r);r=o}},Xn.prototype.toString=function(){return"<"+this.toStringInner()+">"},Xn.prototype.toStringInner=function(){return this.content.join(", ")},Xn.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},Xn.fromJSON=function(t,e){if(!e)return Xn.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new Xn(e.map(t.nodeFromJSON))},Xn.fromArray=function(t){if(!t.length)return Xn.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new Xn(e||t,n)},Xn.from=function(t){if(!t)return Xn.empty;if(t instanceof Xn)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Xn([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(Xn.prototype,Zn);var Qn={index:0,offset:0};function tr(t,e){return Qn.index=t,Qn.offset=e,Qn}function er(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!er(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&er(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}Xn.empty=new Xn([],0);var nr=function(t,e){this.type=t,this.attrs=e};function rr(t){var e=Error.call(this,t);return e.__proto__=rr.prototype,e}nr.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},nr.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},nr.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},nr.prototype.eq=function(t){return this==t||this.type==t.type&&er(this.attrs,t.attrs)},nr.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},nr.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},nr.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},nr.setFrom=function(t){if(!t||0==t.length)return nr.none;if(t instanceof nr)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},nr.none=[],rr.prototype=Object.create(Error.prototype),rr.prototype.constructor=rr,rr.prototype.name="ReplaceError";var or=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},ir={size:{configurable:!0}};function sr(t,e,n){if(n.openStart>t.depth)throw new rr("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new rr("Inconsistent open depths");return function t(e,n,r,o){var i=e.index(o),s=e.node(o);if(i==n.index(o)&&o<e.depth-r.openStart){var a=t(e,n,r,o+1);return s.copy(s.content.replaceChild(i,a))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=o||n.depth!=o){var c=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(Xn.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),l=c.start,u=c.end;return hr(s,function t(e,n,r,o,i){var s=e.depth>i&&cr(e,n,i+1),a=o.depth>i&&cr(r,o,i+1),c=[];ur(null,e,i,c),s&&a&&n.index(i)==r.index(i)?(ar(s,a),lr(hr(s,t(e,n,r,o,i+1)),c)):(s&&lr(hr(s,pr(e,n,i+1)),c),ur(n,r,i,c),a&&lr(hr(a,pr(r,o,i+1)),c));return ur(o,null,i,c),new Xn(c)}(e,l,u,n,o))}var h=e.parent,p=h.content;return hr(h,p.cut(0,e.parentOffset).append(r.content).append(p.cut(n.parentOffset)))}return hr(s,pr(e,n,o))}(t,e,n,0)}function ar(t,e){if(!e.type.compatibleContent(t.type))throw new rr("Cannot join "+e.type.name+" onto "+t.type.name)}function cr(t,e,n){var r=t.node(n);return ar(r,e.node(n)),r}function lr(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function ur(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(lr(t.nodeAfter,r),i++));for(var a=i;a<s;a++)lr(o.child(a),r);e&&e.depth==n&&e.textOffset&&lr(e.nodeBefore,r)}function hr(t,e){if(!t.type.validContent(e))throw new rr("Invalid content for node "+t.type.name);return t.copy(e)}function pr(t,e,n){var r=[];(ur(null,t,n,r),t.depth>n)&&lr(hr(cr(t,e,n+1),pr(t,e,n+1)),r);return ur(e,null,n,r),new Xn(r)}ir.size.get=function(){return this.content.size-this.openStart-this.openEnd},or.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new or(n,this.openStart,this.openEnd)},or.prototype.removeBetween=function(t,e){return new or(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},or.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},or.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},or.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},or.fromJSON=function(t,e){if(!e)return or.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new or(Xn.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},or.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new or(t,n,r)},Object.defineProperties(or.prototype,ir),or.empty=new or(Xn.empty,0,0);var fr=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},dr={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};fr.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},dr.parent.get=function(){return this.node(this.depth)},dr.doc.get=function(){return this.node(0)},fr.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},fr.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},fr.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},fr.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},fr.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},fr.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},fr.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},dr.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},dr.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},dr.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},fr.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return nr.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},fr.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},fr.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},fr.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new yr(this,t,n)},fr.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},fr.prototype.max=function(t){return t.pos>this.pos?t:this},fr.prototype.min=function(t){return t.pos<this.pos?t:this},fr.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},fr.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new fr(e,n,o)},fr.resolveCached=function(t,e){for(var n=0;n<vr.length;n++){var r=vr[n];if(r.pos==e&&r.doc==t)return r}var o=vr[mr]=fr.resolve(t,e);return mr=(mr+1)%gr,o},Object.defineProperties(fr.prototype,dr);var vr=[],mr=0,gr=12,yr=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},br={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};br.start.get=function(){return this.$from.before(this.depth+1)},br.end.get=function(){return this.$to.after(this.depth+1)},br.parent.get=function(){return this.$from.node(this.depth)},br.startIndex.get=function(){return this.$from.index(this.depth)},br.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(yr.prototype,br);var wr=Object.create(null),xr=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||Xn.empty,this.marks=r||nr.none},kr={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};kr.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},kr.childCount.get=function(){return this.content.childCount},xr.prototype.child=function(t){return this.content.child(t)},xr.prototype.maybeChild=function(t){return this.content.maybeChild(t)},xr.prototype.forEach=function(t){this.content.forEach(t)},xr.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},xr.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},kr.textContent.get=function(){return this.textBetween(0,this.content.size,"")},xr.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},kr.firstChild.get=function(){return this.content.firstChild},kr.lastChild.get=function(){return this.content.lastChild},xr.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},xr.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},xr.prototype.hasMarkup=function(t,e,n){return this.type==t&&er(this.attrs,e||t.defaultAttrs||wr)&&nr.sameSet(this.marks,n||nr.none)},xr.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},xr.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},xr.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},xr.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return or.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new or(a,r.depth-i,o.depth-i)},xr.prototype.replace=function(t,e,n){return sr(this.resolve(t),this.resolve(e),n)},xr.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},xr.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},xr.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},xr.prototype.resolve=function(t){return fr.resolveCached(this,t)},xr.prototype.resolveNoCache=function(t){return fr.resolve(this,t)},xr.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},kr.isBlock.get=function(){return this.type.isBlock},kr.isTextblock.get=function(){return this.type.isTextblock},kr.inlineContent.get=function(){return this.type.inlineContent},kr.isInline.get=function(){return this.type.isInline},kr.isText.get=function(){return this.type.isText},kr.isLeaf.get=function(){return this.type.isLeaf},kr.isAtom.get=function(){return this.type.isAtom},xr.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Cr(this.marks,t)},xr.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},xr.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=Xn.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},xr.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},xr.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},xr.prototype.defaultContentType=function(t){return this.contentMatchAt(t).defaultType},xr.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},xr.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},xr.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=Xn.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(xr.prototype,kr);var Sr=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Cr(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(xr);function Cr(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var Or=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},Nr={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Or.parse=function(t,e){var n=new Mr(t,e);if(null==n.next)return Or.empty;var r=Ar(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];zr(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new Or(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Rr);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(zr(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},Or.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},Or.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},Nr.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},Nr.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},Or.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},Or.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return Xn.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(u)){r.push(u);var h=o(u,s.concat(l));if(h)return h}}}(this,[])},Or.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},Or.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},Nr.edgeCount.get=function(){return this.next.length>>1},Or.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},Or.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(Or.prototype,Nr),Or.empty=new Or(!0);var Mr=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},Tr={next:{configurable:!0}};function Ar(t){var e=[];do{e.push(Er(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Er(t){var e=[];do{e.push(Dr(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Dr(t){for(var e=function(t){if(t.eat("(")){var e=Ar(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Ir(t,e)}return e}function Pr(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Ir(t,e){var n=Pr(t),r=n;return t.eat(",")&&(r="}"!=t.next?Pr(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Rr(t,e){return e-t}function zr(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(Rr)}function _r(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function $r(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Br(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new Vr(t[n]);return e}Tr.next.get=function(){return this.tokens[this.pos]},Mr.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Mr.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Mr.prototype,Tr);var jr=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Br(n.attrs),this.defaultAttrs=_r(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Fr={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Fr.isInline.get=function(){return!this.isBlock},Fr.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Fr.isLeaf.get=function(){return this.contentMatch==Or.empty},Fr.isAtom.get=function(){return this.isLeaf||this.spec.atom},jr.prototype.hasRequiredAttrs=function(t){for(var e in this.attrs)if(this.attrs[e].isRequired&&(!t||!(e in t)))return!0;return!1},jr.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},jr.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:$r(this.attrs,t)},jr.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new xr(this,this.computeAttrs(t),Xn.from(e),nr.setFrom(n))},jr.prototype.createChecked=function(t,e,n){if(e=Xn.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new xr(this,this.computeAttrs(t),e,nr.setFrom(n))},jr.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=Xn.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(Xn.empty,!0);return o?new xr(this,t,e.append(o),nr.setFrom(n)):null},jr.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},jr.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},jr.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},jr.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:nr.empty:t},jr.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new jr(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(jr.prototype,Fr);var Vr=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},Lr={isRequired:{configurable:!0}};Lr.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Vr.prototype,Lr);var qr=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Br(r.attrs),this.rank=e,this.excluded=null;var o=_r(this.attrs);this.instance=o&&new nr(this,o)};qr.prototype.create=function(t){return!t&&this.instance?this.instance:new nr(this,$r(this.attrs,t))},qr.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new qr(t,r++,e,o)})),n},qr.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},qr.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},qr.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var Jr=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=s.a.from(t.nodes),this.spec.marks=s.a.from(t.marks),this.nodes=jr.compile(this.spec.nodes,this),this.marks=qr.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",a=o.spec.marks;o.contentMatch=n[i]||(n[i]=Or.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==a?null:a?Wr(this,a.split(" ")):""!=a&&o.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:Wr(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Wr(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}Jr.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof jr))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},Jr.prototype.text=function(t,e){var n=this.nodes.text;return new Sr(n,n.defaultAttrs,t,nr.setFrom(e))},Jr.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},Jr.prototype.nodeFromJSON=function(t){return xr.fromJSON(this,t)},Jr.prototype.markFromJSON=function(t){return nr.fromJSON(this,t)},Jr.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Hr=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};Hr.prototype.parse=function(t,e){void 0===e&&(e={});var n=new Zr(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Hr.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new Zr(this,e,!0);return n.addAll(t,null,e.from,e.to),or.maxOpen(n.finish())},Hr.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(to(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},Hr.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Hr.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=eo(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=eo(t)),t.node=s}));return e},Hr.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Hr(t,Hr.schemaRules(t)))};var Ur={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Kr={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Gr={ol:!0,ul:!0};function Yr(t){return(t?1:0)|("full"===t?2:0)}var Xr=function(t,e,n,r,o,i){this.type=t,this.attrs=e,this.solid=r,this.match=o||(4&i?null:t.contentMatch),this.options=i,this.content=[],this.marks=n,this.activeMarks=nr.none};Xr.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(Xn.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},Xr.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=Xn.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Xn.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r};var Zr=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n,this.pendingMarks=[];var r,o=e.topNode,i=Yr(e.preserveWhitespace)|(n?4:0);r=o?new Xr(o.type,o.attrs,nr.none,!0,e.topMatch||o.type.contentMatch,i):new Xr(n?null:t.schema.topNodeType,null,nr.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},Qr={top:{configurable:!0},currentPos:{configurable:!0}};function to(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function eo(t){var e={};for(var n in t)e[n]=t[n];return e}Qr.top.get=function(){return this.nodes[this.open]},Zr.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null;if(null!=n)for(var r=0;r<n.length;r++)this.addPendingMark(n[r]);if(this.addElement(t),null!=n)for(var o=0;o<n.length;o++)this.removePendingMark(n[o])}},Zr.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},Zr.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();Gr.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&Gr.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:Kr.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(Ur.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},Zr.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},Zr.prototype.readStyles=function(t){for(var e=nr.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},Zr.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o)},Zr.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&Ur.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},Zr.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},Zr.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;this.applyPendingMarks(n),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},Zr.prototype.applyPendingMarks=function(t){for(var e=0;e<this.pendingMarks.length;e++){var n=this.pendingMarks[e];t.type&&!t.type.allowsMarkType(n.type)||n.isInSet(t.activeMarks)||(t.activeMarks=n.addToSet(t.activeMarks),this.pendingMarks.splice(e--,1))}},Zr.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&(this.applyPendingMarks(this.top),this.enterInner(t,e,!0,n)),r},Zr.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:Yr(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new Xr(t,e,o.activeMarks,n,null,i)),this.open++},Zr.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},Zr.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Zr.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},Zr.prototype.addPendingMark=function(t){this.pendingMarks.push(t)},Zr.prototype.removePendingMark=function(t){var e=this.pendingMarks.lastIndexOf(t);if(e>-1)this.pendingMarks.splice(e,1);else{var n=this.top;n.activeMarks=t.removeFromSet(n.activeMarks)}},Qr.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},Zr.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},Zr.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},Zr.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},Zr.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},Zr.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},Zr.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Object.defineProperties(Zr.prototype,Qr);var no=function(t,e){this.nodes=t||{},this.marks=e||{}};function ro(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function oo(t){return t.document||window.document}no.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=oo(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},no.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=no.renderSpec(oo(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},no.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},no.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&no.renderSpec(oo(n),r(t,e))},no.renderSpec=function(t,e){if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var n=t.createElement(e[0]),r=null,o=e[1],i=1;if(o&&"object"==typeof o&&null==o.nodeType&&!Array.isArray(o))for(var s in i=2,o)null!=o[s]&&n.setAttribute(s,o[s]);for(var a=i;a<e.length;a++){var c=e[a];if(0===c){if(a<e.length-1||a>i)throw new RangeError("Content hole must be the only child of its parent node");return{dom:n,contentDOM:n}}var l=no.renderSpec(t,c),u=l.dom,h=l.contentDOM;if(n.appendChild(u),h){if(r)throw new RangeError("Multiple content holes");r=h}}return{dom:n,contentDOM:r}},no.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new no(this.nodesFromSchema(t),this.marksFromSchema(t)))},no.nodesFromSchema=function(t){var e=ro(t.nodes);return e.text||(e.text=function(t){return t.text}),e},no.marksFromSchema=function(t){return ro(t.marks)};var io=function(t,e){var n=this;this.editorView=t,this.width=e.width||1,this.color=e.color||"black",this.class=e.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){var r=function(t){return n[e](t)};return t.dom.addEventListener(e,r),{name:e,handler:r}}))};io.prototype.destroy=function(){var t=this;this.handlers.forEach((function(e){var n=e.name,r=e.handler;return t.editorView.dom.removeEventListener(n,r)}))},io.prototype.update=function(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&this.updateOverlay()},io.prototype.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},io.prototype.updateOverlay=function(){var t,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){var n=e.nodeBefore,r=e.nodeAfter;if(n||r){var o=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0)).getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:o.left,right:o.right,top:i-this.width/2,bottom:i+this.width/2}}}if(!t){var s=this.editorView.coordsAtPos(this.cursorPos);t={left:s.left-this.width/2,right:s.left+this.width/2,top:s.top,bottom:s.bottom}}var a=this.editorView.dom.offsetParent;this.element||(this.element=a.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color);var c=!a||a==document.body&&"static"==getComputedStyle(a).position?{left:-pageXOffset,top:-pageYOffset}:a.getBoundingClientRect();this.element.style.left=t.left-c.left+"px",this.element.style.top=t.top-c.top+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"},io.prototype.scheduleRemoval=function(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return e.setCursor(null)}),t)},io.prototype.dragover=function(t){if(this.editorView.editable){var e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY});if(e){var n=e.pos;this.editorView.dragging&&this.editorView.dragging.slice&&null==(n=Object(mt.g)(this.editorView.state.doc,n,this.editorView.dragging.slice))&&(n=e.pos),this.setCursor(n),this.scheduleRemoval(5e3)}}},io.prototype.dragend=function(){this.scheduleRemoval(20)},io.prototype.drop=function(){this.scheduleRemoval(20)},io.prototype.dragleave=function(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)};var so=n(10),ao=n(11),co=n(2),lo=function(t){function e(e){t.call(this,e,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));return e.valid(o)?new e(o):t.near(o)},e.prototype.content=function(){return co.i.empty},e.prototype.eq=function(t){return t instanceof e&&t.head==this.head},e.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},e.fromJSON=function(t,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new e(t.resolve(n.pos))},e.prototype.getBookmark=function(){return new uo(this.anchor)},e.valid=function(t){var e=t.parent;if(e.isTextblock||!function(t){for(var e=t.depth;e>=0;e--){var n=t.index(e);if(0!=n)for(var r=t.node(e).child(n-1);;r=r.lastChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}(t)||!function(t){for(var e=t.depth;e>=0;e--){var n=t.indexAfter(e),r=t.node(e);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(t))return!1;var n=e.type.spec.allowGapCursor;if(null!=n)return n;var r=e.contentMatchAt(t.index()).defaultType;return r&&r.isTextblock},e.findFrom=function(t,n,r){if(!r&&e.valid(t))return t;for(var o=t.pos,i=null,s=t.depth;;s--){var a=t.node(s);if(n>0?t.indexAfter(s)<a.childCount:t.index(s)>0){i=a.maybeChild(n>0?t.indexAfter(s):t.index(s)-1);break}if(0==s)return null;o+=n;var c=t.doc.resolve(o);if(e.valid(c))return c}for(;i=n>0?i.firstChild:i.lastChild;){o+=n;var l=t.doc.resolve(o);if(e.valid(l))return l}return null},e}(i.Selection);lo.prototype.visible=!1,i.Selection.jsonID("gapcursor",lo);var uo=function(t){this.pos=t};uo.prototype.map=function(t){return new uo(t.map(this.pos))},uo.prototype.resolve=function(t){var e=t.resolve(this.pos);return lo.valid(e)?new lo(e):i.Selection.near(e)};var ho=Object(so.a)({ArrowLeft:po("horiz",-1),ArrowRight:po("horiz",1),ArrowUp:po("vert",-1),ArrowDown:po("vert",1)});function po(t,e){var n="vert"==t?e>0?"down":"up":e>0?"right":"left";return function(t,r,o){var s=t.selection,a=e>0?s.$to:s.$from,c=s.empty;if(s instanceof i.TextSelection){if(!o.endOfTextblock(n))return!1;c=!1,a=t.doc.resolve(e>0?a.after():a.before())}var l=lo.findFrom(a,e,c);return!!l&&(r&&r(t.tr.setSelection(new lo(l))),!0)}}function fo(t,e,n){if(!t.editable)return!1;var r=t.state.doc.resolve(e);if(!lo.valid(r))return!1;var o=t.posAtCoords({left:n.clientX,top:n.clientY}).inside;return!(o>-1&&i.NodeSelection.isSelectable(t.state.doc.nodeAt(o)))&&(t.dispatch(t.state.tr.setSelection(new lo(r))),!0)}function vo(t){if(!(t.selection instanceof lo))return null;var e=document.createElement("div");return e.className="ProseMirror-gapcursor",ao.b.create(t.doc,[ao.a.widget(t.selection.head,e,{key:"gapcursor"})])}function mo(t,e){return!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0)}function go(t,e){for(;t;t="start"==e?t.firstChild:t.lastChild)if(t.isTextblock)return!0;return!1}function yo(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function bo(t){if(!t.parent.type.spec.isolating)for(var e=t.depth-1;e>=0;e--){var n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}function wo(t,e){var n=t.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var s=r.node(-1),a=r.indexAfter(-1),c=s.contentMatchAt(a).defaultType;if(!s.canReplaceWith(a,a,c))return!1;if(e){var l=r.after(),u=t.tr.replaceWith(l,l,c.createAndFill());u.setSelection(i.Selection.near(u.doc.resolve(l),1)),e(u.scrollIntoView())}return!0}function xo(t,e){var n=t.selection,r=n.$from,o=n.$to;if(t.selection instanceof i.NodeSelection&&t.selection.node.isBlock)return!(!r.parentOffset||!Object(mt.f)(t.doc,r.pos))&&(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(e){var s=o.parentOffset==o.parent.content.size,a=t.tr;t.selection instanceof i.TextSelection&&a.deleteSelection();var c=0==r.depth?null:r.node(-1).contentMatchAt(r.indexAfter(-1)).defaultType,l=s&&c?[{type:c}]:null,u=Object(mt.f)(a.doc,a.mapping.map(r.pos),1,l);l||u||!Object(mt.f)(a.doc,a.mapping.map(r.pos),1,c&&[{type:c}])||(l=[{type:c}],u=!0),u&&(a.split(a.mapping.map(r.pos),1,l),s||r.parentOffset||r.parent.type==c||!r.node(-1).canReplace(r.index(-1),r.indexAfter(-1),co.c.from(c.create(),r.parent))||a.setNodeMarkup(a.mapping.map(r.before()),c)),e(a.scrollIntoView())}return!0}function ko(t,e,n){var r,o,s=e.nodeBefore,a=e.nodeAfter;if(s.type.spec.isolating||a.type.spec.isolating)return!1;if(function(t,e,n){var r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!!(r&&o&&r.type.compatibleContent(o.type))&&(!r.content.size&&e.parent.canReplace(i-1,i)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!(!e.parent.canReplace(i,i+1)||!o.isTextblock&&!Object(mt.e)(t.doc,e.pos))&&(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0))}(t,e,n))return!0;if(e.parent.canReplace(e.index(),e.index()+1)&&(r=(o=s.contentMatchAt(s.childCount)).findWrapping(a.type))&&o.matchType(r[0]||a.type).validEnd){if(n){for(var c=e.pos+a.nodeSize,l=co.c.empty,u=r.length-1;u>=0;u--)l=co.c.from(r[u].create(null,l));l=co.c.from(s.copy(l));var h=t.tr.step(new mt.b(e.pos-1,c,e.pos,c,new co.i(l,1,0),r.length,!0)),p=c+2*r.length;Object(mt.e)(h.doc,p)&&h.join(p),n(h.scrollIntoView())}return!0}var f=i.Selection.findFrom(e,1),d=f&&f.$from.blockRange(f.$to),v=d&&Object(mt.j)(d);return null!=v&&v>=e.depth&&(n&&n(t.tr.lift(d,v).scrollIntoView()),!0)}function So(t,e){return function(n,r){var o=n.selection,i=o.from,s=o.to,a=!1;return n.doc.nodesBetween(i,s,(function(r,o){if(a)return!1;if(r.isTextblock&&!r.hasMarkup(t,e))if(r.type==t)a=!0;else{var i=n.doc.resolve(o),s=i.index();a=i.parent.canReplaceWith(s,s+1,t)}})),!!a&&(r&&r(n.tr.setBlockType(i,s,t,e).scrollIntoView()),!0)}}function Co(t,e){return function(n,r){var o=n.selection,i=o.empty,s=o.$cursor,a=o.ranges;if(i&&!s||!function(t,e,n){for(var r=function(r){var o=e[r],i=o.$from,s=o.$to,a=0==i.depth&&t.type.allowsMarkType(n);if(t.nodesBetween(i.pos,s.pos,(function(t){if(a)return!1;a=t.inlineContent&&t.type.allowsMarkType(n)})),a)return{v:!0}},o=0;o<e.length;o++){var i=r(o);if(i)return i.v}return!1}(n.doc,a,t))return!1;if(r)if(s)t.isInSet(n.storedMarks||s.marks())?r(n.tr.removeStoredMark(t)):r(n.tr.addStoredMark(t.create(e)));else{for(var c=!1,l=n.tr,u=0;!c&&u<a.length;u++){var h=a[u],p=h.$from,f=h.$to;c=n.doc.rangeHasMark(p.pos,f.pos,t)}for(var d=0;d<a.length;d++){var v=a[d],m=v.$from,g=v.$to;c?l.removeMark(m.pos,g.pos,t):l.addMark(m.pos,g.pos,t.create(e))}r(l.scrollIntoView())}return!0}}function Oo(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function(e,n,r){for(var o=0;o<t.length;o++)if(t[o](e,n,r))return!0;return!1}}var No=Oo(mo,(function(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",t):r.parentOffset>0))return!1;var o=yo(r);if(!o){var s=r.blockRange(),a=s&&Object(mt.j)(s);return null!=a&&(e&&e(t.tr.lift(s,a).scrollIntoView()),!0)}var c=o.nodeBefore;if(!c.type.spec.isolating&&ko(t,o,e))return!0;if(0==r.parent.content.size&&(go(c,"end")||i.NodeSelection.isSelectable(c))){if(e){var l=t.tr.deleteRange(r.before(),r.after());l.setSelection(go(c,"end")?i.Selection.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):i.NodeSelection.create(l.doc,o.pos-c.nodeSize)),e(l.scrollIntoView())}return!0}return!(!c.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos-c.nodeSize,o.pos).scrollIntoView()),!0)}),(function(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",t):r.parentOffset>0))return!1;var o=yo(r),s=o&&o.nodeBefore;return!(!s||!i.NodeSelection.isSelectable(s))&&(e&&e(t.tr.setSelection(i.NodeSelection.create(t.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)})),Mo=Oo(mo,(function(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size))return!1;var o=bo(r);if(!o)return!1;var s=o.nodeAfter;if(ko(t,o,e))return!0;if(0==r.parent.content.size&&(go(s,"start")||i.NodeSelection.isSelectable(s))){if(e){var a=t.tr.deleteRange(r.before(),r.after());a.setSelection(go(s,"start")?i.Selection.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):i.NodeSelection.create(a.doc,a.mapping.map(o.pos))),e(a.scrollIntoView())}return!0}return!(!s.isAtom||o.depth!=r.depth-1)&&(e&&e(t.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),!0)}),(function(t,e,n){var r=t.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size))return!1;var o=bo(r),s=o&&o.nodeAfter;return!(!s||!i.NodeSelection.isSelectable(s))&&(e&&e(t.tr.setSelection(i.NodeSelection.create(t.doc,o.pos)).scrollIntoView()),!0)})),To={Enter:Oo((function(t,e){var n=t.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)}),(function(t,e){var n=t.selection,r=n.$from,o=n.$to;if(r.parent.inlineContent||o.parent.inlineContent)return!1;var s=r.parent.contentMatchAt(o.indexAfter()).defaultType;if(!s||!s.isTextblock)return!1;if(e){var a=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,c=t.tr.insert(a,s.createAndFill());c.setSelection(i.TextSelection.create(c.doc,a+1)),e(c.scrollIntoView())}return!0}),(function(t,e){var n=t.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(Object(mt.f)(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&Object(mt.j)(o);return null!=i&&(e&&e(t.tr.lift(o,i).scrollIntoView()),!0)}),xo),"Mod-Enter":wo,Backspace:No,"Mod-Backspace":No,Delete:Mo,"Mod-Delete":Mo,"Mod-a":function(t,e){return e&&e(t.tr.setSelection(new i.AllSelection(t.doc))),!0}},Ao={"Ctrl-h":To.Backspace,"Alt-Backspace":To["Mod-Backspace"],"Ctrl-d":To.Delete,"Ctrl-Alt-Backspace":To["Mod-Delete"],"Alt-Delete":To["Mod-Delete"],"Alt-d":To["Mod-Delete"]};for(var Eo in To)Ao[Eo]=To[Eo];var Do=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?Ao:To,Po=function(t,e){var n;this.match=t,this.handler="string"==typeof e?(n=e,function(t,e,r,o){var i=n;if(e[1]){var s=e[0].lastIndexOf(e[1]);i+=e[0].slice(s+e[1].length);var a=(r+=s)-o;a>0&&(i=e[0].slice(s-a,s)+i,r=o)}return t.tr.insertText(i,r,o)}):e};function Io(t,e,n,r,o,i){if(t.composing)return!1;var s=t.state,a=s.doc.resolve(e);if(a.parent.type.spec.code)return!1;for(var c=a.parent.textBetween(Math.max(0,a.parentOffset-500),a.parentOffset,null,"")+r,l=0;l<o.length;l++){var u=o[l].match.exec(c),h=u&&o[l].handler(s,u,e-(u[0].length-r.length),n);if(h)return t.dispatch(h.setMeta(i,{transform:h,from:e,to:n,text:r})),!0}return!1}function Ro(t,e){for(var n=t.plugins,r=0;r<n.length;r++){var o=n[r],i=void 0;if(o.spec.isInputRules&&(i=o.getState(t))){if(e){for(var s=t.tr,a=i.transform,c=a.steps.length-1;c>=0;c--)s.step(a.steps[c].invert(a.docs[c]));var l=s.doc.resolve(i.from).marks();e(s.replaceWith(i.from,i.to,t.schema.text(i.text,l)))}return!0}}return!1}new Po(/--$/,""),new Po(/\.\.\.$/,""),new Po(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,""),new Po(/"$/,""),new Po(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,""),new Po(/'$/,"");var zo=n(14);
/*!
    * tiptap-utils v1.8.2
    * (c) 2019 Scrumpy UG (limited liability)
    * @license MIT
    */function _o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $o(t,e){var n=t.selection,r=n.from,o=n.to,i=[];t.doc.nodesBetween(r,o,(function(t){i=[].concat(_o(i),_o(t.marks))}));var s=i.find((function(t){return t.type.name===e.name}));return s?s.attrs:{}}function Bo(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t||!e)return!1;var n=t.parent.childAfter(t.parentOffset);if(!n.node)return!1;var r=n.node.marks.find((function(t){return t.type===e}));if(!r)return!1;for(var o=t.index(),i=t.start()+n.offset,s=o+1,a=i+n.node.nodeSize;o>0&&r.isInSet(t.parent.child(o-1).marks);)o-=1,i-=t.parent.child(o).nodeSize;for(;s<t.parent.childCount&&r.isInSet(t.parent.child(s).marks);)a+=t.parent.child(s).nodeSize,s+=1;return{from:i,to:a}}function jo(t,e){var n=t.selection,r=n.from,o=n.$from,i=n.to;return n.empty?!!e.isInSet(t.storedMarks||o.marks()):!!t.doc.rangeHasMark(r,i,e)}function Fo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(t){return t.type===e},o=Object(zo.findSelectedNodeOfType)(e)(t.selection)||Object(zo.findParentNode)(r)(t.selection);return Object.keys(n).length&&o?o.node.hasMarkup(e,n):!!o}var Vo=n(9);n(18);function Lo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function qo(t,e,n){return new Po(t,(function(t,r,o,i){var s=n instanceof Function?n(r):n,a=t.tr,c=r.length-1,l=i,u=o;if(r[c]){var h=o+r[0].indexOf(r[c-1]),p=h+r[c-1].length-1,f=h+r[c-1].lastIndexOf(r[c]),d=f+r[c].length;if(function(t,e,n){var r=[];return n.doc.nodesBetween(t,e,(function(t,e){r=[].concat(Lo(r),Lo(t.marks.map((function(n){return{start:e,end:e+t.nodeSize,mark:n}}))))})),r}(o,i,t).filter((function(t){return t.mark.type.excluded.find((function(t){return t.name===e.name}))})).filter((function(t){return t.end>h})).length)return!1;d<p&&a.delete(d,p),f>h&&a.delete(h,f),l=(u=h)+r[c].length}return a.addMark(u,l,e.create(s)),a.removeStoredMark(e),a}))}function Jo(t,e,n){return new i.Plugin({props:{transformPasted:function(r){return new Vo.Slice(function r(o){var i=[];return o.forEach((function(o){if(o.isText){var s,a=o.text,c=0;do{if(s=t.exec(a)){var l=s.index,u=l+s[0].length,h=n instanceof Function?n(s[0]):n;l>0&&i.push(o.cut(c,l)),i.push(o.cut(l,u).mark(e.create(h).addToSet(o.marks))),c=u}}while(s);c<a.length&&i.push(o.cut(c))}else i.push(o.copy(r(o.content)))})),Vo.Fragment.fromArray(i)}(r.content),r.openStart,r.openEnd)}}})}function Wo(t,e,n){return new i.Plugin({props:{transformPasted:function(r){return new Vo.Slice(function r(o){var i=[];return o.forEach((function(o){if(o.isText){for(var s,a=o.text,c=0,l=!!o.marks.filter((function(t){return"link"===t.type.name}))[0];!l&&null!==(s=t.exec(a));)if(s[1]){var u=s.index,h=u+s[0].length,p=u+s[0].indexOf(s[1]),f=p+s[1].length,d=n instanceof Function?n(s):n;u>0&&i.push(o.cut(c,u)),i.push(o.cut(p,f).mark(e.create(d).addToSet(o.marks))),c=h}c<a.length&&i.push(o.cut(c))}else i.push(o.copy(r(o.content)))})),Vo.Fragment.fromArray(i)}(r.content),r.openStart,r.openEnd)}}})}
/*!
    * tiptap v1.26.5
    * (c) 2019 Scrumpy UG (limited liability)
    * @license MIT
    */
function Ho(t){return(Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ko(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Go(t,e,n){return e&&Ko(t.prototype,e),n&&Ko(t,n),t}function Yo(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Zo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xo(Object(n),!0).forEach((function(e){Yo(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ei(t,e)}function ti(t){return(ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ei(t,e){return(ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ni(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ri(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(!(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ii(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(t,e){return 0===e?t.toLowerCase():t.toUpperCase()})).replace(/\s+/g,"")}var si=function(){function t(e,n){var r=n.editor,o=n.extension,i=n.parent,s=n.node,a=n.view,c=n.decorations,l=n.getPos;Uo(this,t),this.component=e,this.editor=r,this.extension=o,this.parent=i,this.node=s,this.view=a,this.decorations=c,this.isNode=!!this.node.marks,this.isMark=!this.isNode,this.getPos=this.isMark?this.getMarkPos:l,this.captureEvents=!0,this.dom=this.createDOM(),this.contentDOM=this.vm.$refs.content}return Go(t,[{key:"createDOM",value:function(){var t=this,e=o.a.extend(this.component),n={editor:this.editor,node:this.node,view:this.view,getPos:function(){return t.getPos()},decorations:this.decorations,selected:!1,options:this.extension.options,updateAttrs:function(e){return t.updateAttrs(e)}};return"function"==typeof this.extension.setSelection&&(this.setSelection=this.extension.setSelection),this.vm=new e({parent:this.parent,propsData:n}).$mount(),this.vm.$el}},{key:"update",value:function(t,e){return t.type===this.node.type&&(t===this.node&&this.decorations===e||(this.node=t,this.decorations=e,this.updateComponentProps({node:t,decorations:e})),!0)}},{key:"updateComponentProps",value:function(t){var e=this;if(this.vm._props){var n=o.a.config.silent;o.a.config.silent=!0,Object.entries(t).forEach((function(t){var n=ri(t,2),r=n[0],o=n[1];e.vm._props[r]=o})),o.a.config.silent=n}}},{key:"updateAttrs",value:function(t){if(this.view.editable){var e=this.view.state,n=this.node.type,r=this.getPos(),o=Zo({},this.node.attrs,{},t),i=this.isMark?e.tr.removeMark(r.from,r.to,n).addMark(r.from,r.to,n.create(o)):e.tr.setNodeMarkup(r,null,o);this.view.dispatch(i)}}},{key:"ignoreMutation",value:function(t){return"selection"!==t.type&&(!this.contentDOM||!this.contentDOM.contains(t.target))}},{key:"stopEvent",value:function(t){var e=this;if("function"==typeof this.extension.stopEvent)return this.extension.stopEvent(t);var n=!!this.extension.schema.draggable;if(n&&"mousedown"===t.type){var r=t.target.closest&&t.target.closest("[data-drag-handle]");r&&(this.dom===r||this.dom.contains(r))&&(this.captureEvents=!1,document.addEventListener("dragend",(function(){e.captureEvents=!0}),{once:!0}))}var o="copy"===t.type,i="paste"===t.type,s="cut"===t.type,a=t.type.startsWith("drag")||"drop"===t.type;return!(n&&a||o||i||s)&&this.captureEvents}},{key:"selectNode",value:function(){this.updateComponentProps({selected:!0})}},{key:"deselectNode",value:function(){this.updateComponentProps({selected:!1})}},{key:"getMarkPos",value:function(){var t=this.view.posAtDOM(this.dom);return Bo(this.view.state.doc.resolve(t),this.node.type)}},{key:"destroy",value:function(){this.vm.$destroy()}}]),t}(),ai=function(){function t(){Uo(this,t)}return Go(t,[{key:"on",value:function(t,e){return this._callbacks=this._callbacks||{},this._callbacks[t]||(this._callbacks[t]=[]),this._callbacks[t].push(e),this}},{key:"emit",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this._callbacks=this._callbacks||{};var i=this._callbacks[t];return i&&i.forEach((function(t){return t.apply(e,r)})),this}},{key:"off",value:function(t,e){if(arguments.length){var n=this._callbacks?this._callbacks[t]:null;n&&(e?this._callbacks[t]=n.filter((function(t){return t!==e})):delete this._callbacks[t])}else this._callbacks={};return this}}]),t}(),ci=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Uo(this,t),this.options=Zo({},this.defaultOptions,{},e)}return Go(t,[{key:"init",value:function(){return null}},{key:"bindEditor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.editor=t}},{key:"inputRules",value:function(){return[]}},{key:"pasteRules",value:function(){return[]}},{key:"keys",value:function(){return{}}},{key:"name",get:function(){return null}},{key:"type",get:function(){return"extension"}},{key:"update",get:function(){return function(){}}},{key:"defaultOptions",get:function(){return{}}},{key:"plugins",get:function(){return[]}}]),t}(),li=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;Uo(this,t),e.forEach((function(t){t.bindEditor(n),t.init()})),this.extensions=e}return Go(t,[{key:"keymaps",value:function(t){var e=t.schema,n=this.extensions.filter((function(t){return["extension"].includes(t.type)})).filter((function(t){return t.keys})).map((function(t){return t.keys({schema:e})})),r=this.extensions.filter((function(t){return["node","mark"].includes(t.type)})).filter((function(t){return t.keys})).map((function(t){return t.keys({type:e["".concat(t.type,"s")][t.name],schema:e})}));return[].concat(oi(n),oi(r)).map((function(t){return Object(so.b)(t)}))}},{key:"inputRules",value:function(t){var e=t.schema,n=t.excludedExtensions;if(!(n instanceof Array)&&n)return[];var r=n instanceof Array?this.extensions.filter((function(t){return!n.includes(t.name)})):this.extensions,o=r.filter((function(t){return["extension"].includes(t.type)})).filter((function(t){return t.inputRules})).map((function(t){return t.inputRules({schema:e})})),i=r.filter((function(t){return["node","mark"].includes(t.type)})).filter((function(t){return t.inputRules})).map((function(t){return t.inputRules({type:e["".concat(t.type,"s")][t.name],schema:e})}));return[].concat(oi(o),oi(i)).reduce((function(t,e){return[].concat(oi(t),oi(e))}),[])}},{key:"pasteRules",value:function(t){var e=t.schema,n=t.excludedExtensions;if(!(n instanceof Array)&&n)return[];var r=n instanceof Array?this.extensions.filter((function(t){return!n.includes(t.name)})):this.extensions,o=r.filter((function(t){return["extension"].includes(t.type)})).filter((function(t){return t.pasteRules})).map((function(t){return t.pasteRules({schema:e})})),i=r.filter((function(t){return["node","mark"].includes(t.type)})).filter((function(t){return t.pasteRules})).map((function(t){return t.pasteRules({type:e["".concat(t.type,"s")][t.name],schema:e})}));return[].concat(oi(o),oi(i)).reduce((function(t,e){return[].concat(oi(t),oi(e))}),[])}},{key:"commands",value:function(t){var e=t.schema,n=t.view;return this.extensions.filter((function(t){return t.commands})).reduce((function(t,r){var o=r.name,i=r.type,s={},a=r.commands(Zo({schema:e},["node","mark"].includes(i)?{type:e["".concat(i,"s")][o]}:{})),c=function(t,e){return!!n.editable&&(n.focus(),t(e)(n.state,n.dispatch,n))},l=function(t,e){Array.isArray(e)?s[t]=function(t){return e.forEach((function(e){return c(e,t)}))}:"function"==typeof e&&(s[t]=function(t){return c(e,t)})};return"object"===Ho(a)?Object.entries(a).forEach((function(t){var e=ri(t,2),n=e[0],r=e[1];l(n,r)})):l(o,a),Zo({},t,{},s)}),{})}},{key:"nodes",get:function(){return this.extensions.filter((function(t){return"node"===t.type})).reduce((function(t,e){return Zo({},t,Yo({},e.name,e.schema))}),{})}},{key:"options",get:function(){var t=this.view;return this.extensions.reduce((function(e,n){return Zo({},e,Yo({},n.name,new Proxy(n.options,{set:function(e,r,o){var i=e[r]!==o;return Object.assign(e,Yo({},r,o)),i&&n.update(t),!0}})))}),{})}},{key:"marks",get:function(){return this.extensions.filter((function(t){return"mark"===t.type})).reduce((function(t,e){return Zo({},t,Yo({},e.name,e.schema))}),{})}},{key:"plugins",get:function(){return this.extensions.filter((function(t){return t.plugins})).reduce((function(t,e){var n=e.plugins;return[].concat(oi(t),oi(n))}),[])}}]),t}();function ui(t){var e=document.createElement("style");e.type="text/css",e.textContent=t;var n=document.head,r=n.firstChild;r?n.insertBefore(e,r):n.appendChild(e)}var hi=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uo(this,e),ni(this,ti(e).call(this,t))}return Qo(e,t),Go(e,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"mark"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),e}(ci);function pi(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(parseInt(t,10),e),n)}var fi=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uo(this,e),ni(this,ti(e).call(this,t))}return Qo(e,t),Go(e,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"node"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),e}(ci),di=function(t){function e(){return Uo(this,e),ni(this,ti(e).apply(this,arguments))}return Qo(e,t),Go(e,[{key:"name",get:function(){return"doc"}},{key:"schema",get:function(){return{content:"block+"}}}]),e}(fi),vi=function(t){function e(){return Uo(this,e),ni(this,ti(e).apply(this,arguments))}return Qo(e,t),Go(e,[{key:"commands",value:function(t){var e=t.type;return function(){return So(e)}}},{key:"name",get:function(){return"paragraph"}},{key:"schema",get:function(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:function(){return["p",0]}}}}]),e}(fi),mi=function(t){function e(){return Uo(this,e),ni(this,ti(e).apply(this,arguments))}return Qo(e,t),Go(e,[{key:"name",get:function(){return"text"}},{key:"schema",get:function(){return{group:"inline"}}}]),e}(fi),gi='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n',yi=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Uo(this,e),(t=ni(this,ti(e).call(this))).defaultOptions={editorProps:{},editable:!0,autoFocus:null,extensions:[],content:"",topNode:"doc",emptyDocument:{type:"doc",content:[{type:"paragraph"}]},useBuiltInExtensions:!0,disableInputRules:!1,disablePasteRules:!1,dropCursor:{},parseOptions:{},injectCSS:!0,onInit:function(){},onTransaction:function(){},onUpdate:function(){},onFocus:function(){},onBlur:function(){},onPaste:function(){},onDrop:function(){}},t.events=["init","transaction","update","focus","blur","paste","drop"],t.init(n),t}return Qo(e,t),Go(e,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setOptions(Zo({},this.defaultOptions,{},e)),this.focused=!1,this.selection={from:0,to:0},this.element=document.createElement("div"),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.plugins=this.createPlugins(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),this.options.injectCSS&&ui(gi),null!==this.options.autoFocus&&this.focus(this.options.autoFocus),this.events.forEach((function(e){t.on(e,t.options[ii("on ".concat(e))]||function(){})})),this.emit("init",{view:this.view,state:this.state}),this.extensions.view=this.view}},{key:"setOptions",value:function(t){this.options=Zo({},this.options,{},t),this.view&&this.state&&this.view.updateState(this.state)}},{key:"createExtensions",value:function(){return new li([].concat(oi(this.builtInExtensions),oi(this.options.extensions)),this)}},{key:"createPlugins",value:function(){return this.extensions.plugins}},{key:"createKeymaps",value:function(){return this.extensions.keymaps({schema:this.schema})}},{key:"createInputRules",value:function(){return this.extensions.inputRules({schema:this.schema,excludedExtensions:this.options.disableInputRules})}},{key:"createPasteRules",value:function(){return this.extensions.pasteRules({schema:this.schema,excludedExtensions:this.options.disablePasteRules})}},{key:"createCommands",value:function(){return this.extensions.commands({schema:this.schema,view:this.view})}},{key:"createNodes",value:function(){return this.extensions.nodes}},{key:"createMarks",value:function(){return this.extensions.marks}},{key:"createSchema",value:function(){return new Jr({topNode:this.options.topNode,nodes:this.nodes,marks:this.marks})}},{key:"createState",value:function(){var t,e,n,r,o=this;return i.EditorState.create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:[].concat(oi(this.plugins),[(e={rules:this.inputRules},n=e.rules,r=new i.Plugin({state:{init:function(){return null},apply:function(t,e){var n=t.getMeta(this);return n||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:function(t,e,o,i){return Io(t,e,o,i,n,r)},handleDOMEvents:{compositionend:function(t){setTimeout((function(){var e=t.state.selection.$cursor;e&&Io(t,e.pos,e.pos,"",n,r)}))}}},isInputRules:!0}),r)],oi(this.pasteRules),oi(this.keymaps),[Object(so.b)({Backspace:Ro}),Object(so.b)(Do),(t=this.options.dropCursor,void 0===t&&(t={}),new i.Plugin({view:function(e){return new io(e,t)}})),new i.Plugin({props:{decorations:vo,createSelectionBetween:function(t,e,n){if(e.pos==n.pos&&lo.valid(n))return new lo(n)},handleClick:fo,handleKeyDown:ho}}),new i.Plugin({key:new i.PluginKey("editable"),props:{editable:function(){return o.options.editable}}}),new i.Plugin({props:{attributes:{tabindex:0},handleDOMEvents:{focus:function(t,e){o.focused=!0,o.emit("focus",{event:e,state:t.state,view:t});var n=o.state.tr.setMeta("focused",!0);o.view.dispatch(n)},blur:function(t,e){o.focused=!1,o.emit("blur",{event:e,state:t.state,view:t});var n=o.state.tr.setMeta("focused",!1);o.view.dispatch(n)}}}}),new i.Plugin({props:this.options.editorProps})])})}},{key:"createDocument",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.parseOptions;if(null===t)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"===Ho(t))try{return this.schema.nodeFromJSON(t)}catch(e){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",e),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"==typeof t){var n=document.createElement("div");return n.innerHTML=t.trim(),Hr.fromSchema(this.schema).parse(n,e)}return!1}},{key:"createView",value:function(){var t=this;return new Jn(this.element,{state:this.createState(),handlePaste:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.emit.apply(t,["paste"].concat(n))},handleDrop:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.emit.apply(t,["drop"].concat(n))},dispatchTransaction:this.dispatchTransaction.bind(this)})}},{key:"setParentComponent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&this.view.setProps({nodeViews:this.initNodeViews({parent:t,extensions:[].concat(oi(this.builtInExtensions),oi(this.options.extensions))})})}},{key:"initNodeViews",value:function(t){var e=this,n=t.parent;return t.extensions.filter((function(t){return["node","mark"].includes(t.type)})).filter((function(t){return t.view})).reduce((function(t,r){return Zo({},t,Yo({},r.name,(function(t,o,i,s){var a=r.view;return new si(a,{editor:e,extension:r,parent:n,node:t,view:o,getPos:i,decorations:s})})))}),{})}},{key:"dispatchTransaction",value:function(t){var e=this.state.apply(t);this.view.updateState(e),this.selection={from:this.state.selection.from,to:this.state.selection.to},this.setActiveNodesAndMarks(),this.emit("transaction",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emitUpdate(t)}},{key:"emitUpdate",value:function(t){this.emit("update",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:t})}},{key:"resolveSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.selection&&null===t)return this.selection;if("start"===t||!0===t)return{from:0,to:0};if("end"===t){var e=this.state.doc;return{from:e.content.size,to:e.content.size}}return{from:t,to:t}}},{key:"focus",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!(this.view.focused&&null===e||!1===e)){var n=this.resolveSelection(e),r=n.from,o=n.to;this.setSelection(r,o),setTimeout((function(){return t.view.focus()}),10)}}},{key:"setSelection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.state,r=n.doc,o=n.tr,s=pi(t,0,r.content.size),a=pi(e,0,r.content.size),c=i.TextSelection.create(r,s,a),l=o.setSelection(c);this.view.dispatch(l)}},{key:"blur",value:function(){this.view.dom.blur()}},{key:"getSchemaJSON",value:function(){return JSON.parse(JSON.stringify({nodes:this.extensions.nodes,marks:this.extensions.marks}))}},{key:"getHTML",value:function(){var t=document.createElement("div"),e=no.fromSchema(this.schema).serializeFragment(this.state.doc.content);return t.appendChild(e),t.innerHTML}},{key:"getJSON",value:function(){return this.state.doc.toJSON()}},{key:"setContent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.state,o=r.doc,s=r.tr,a=this.createDocument(t,n),c=i.TextSelection.create(o,0,o.content.size),l=s.setSelection(c).replaceSelectionWith(a,!1).setMeta("preventUpdate",!e);this.view.dispatch(l)}},{key:"clearContent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setContent(this.options.emptyDocument,t)}},{key:"setActiveNodesAndMarks",value:function(){var t=this;this.activeMarks=Object.entries(this.schema.marks).reduce((function(e,n){var r=ri(n,2),o=r[0],i=r[1];return Zo({},e,Yo({},o,(function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return jo(t.state,i)})))}),{}),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce((function(e,n){var r=ri(n,2),o=r[0],i=r[1];return Zo({},e,Yo({},o,$o(t.state,i)))}),{}),this.activeNodes=Object.entries(this.schema.nodes).reduce((function(e,n){var r=ri(n,2),o=r[0],i=r[1];return Zo({},e,Yo({},o,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Fo(t.state,i,e)})))}),{})}},{key:"getMarkAttrs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.activeMarkAttrs[t]}},{key:"registerPlugin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){var e=this.state.reconfigure({plugins:this.state.plugins.concat([t])});this.view.updateState(e)}}},{key:"unregisterPlugin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t&&this.view.docView){var e=this.state.reconfigure({plugins:this.state.plugins.filter((function(e){return!e.key.startsWith("".concat(t,"$"))}))});this.view.updateState(e)}}},{key:"destroy",value:function(){this.view&&this.view.destroy()}},{key:"builtInExtensions",get:function(){return this.options.useBuiltInExtensions?[new di,new mi,new vi]:[]}},{key:"state",get:function(){return this.view?this.view.state:null}},{key:"isActive",get:function(){return Object.entries(Zo({},this.activeMarks,{},this.activeNodes)).reduce((function(t,e){var n=ri(e,2),r=n[0],o=n[1];return Zo({},t,Yo({},r,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(t)})))}),{})}}]),e}(ai),bi={props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler:function(t){var e=this;t&&t.element&&this.$nextTick((function(){e.$el.appendChild(t.element.firstChild),t.setParentComponent(e)}))}}},render:function(t){return t("div")},beforeDestroy:function(){this.editor.element=this.$el}};Boolean;var wi=n(0),xi=n(6);function ki(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Si(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ci={name:"NWysiwyg",components:{EditorContent:bi},props:{value:{default:function(){return""},type:String},toolbar:{default:function(){return["NWysiwygPluginBold","NWysiwygPluginLink"]},type:[Array]}},data:function(){return{editor:null,extensions:[],plugins:[]}},provide:function(){return{NWysiwyg:this}},beforeMount:function(){this.initializeEditor()},beforeDestroy:function(){this.destroyEditor()},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ki(Object(n),!0).forEach((function(e){Si(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},xi.a,{initializeEditor:function(){var t=this;this.editor=new yi({content:this.value,extensions:this.extensions}),this.editor.on("update",(function(e){var n=e.getHTML;return t.$emit("input",n())}))},destroyEditor:function(){this.editor.destroy()},addExtension:function(t){this.extensions.push(t),this.editor.init({content:this.value,extensions:this.extensions}),this.editor.createExtensions()},addPlugin:function(t){this.plugins.push(t)},removePlugin:function(t){wi.Arr.remove(this.plugins,{_uid:t._uid})}}),renderToolbar:function(){var t=this;return(0,this.$createElement)("div",[wi.Arr.each(this.toolbar,(function(e){return t.h(e)}))])},render:function(t){return this.h=t,t("div",[this.ctor("renderToolbar")(),t(bi,{attrs:{editor:this.editor}})])}};function Oi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ni(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Mi={name:"NWysiwygPlugin",inject:{NWysiwyg:{default:void 0}},computed:{editor:function(){return this.NWysiwyg.editor},getMarkAttrs:function(){return this.editor.getMarkAttrs.bind(this.editor)}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oi(Object(n),!0).forEach((function(e){Ni(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},xi.a),created:function(){this.NWysiwyg.addPlugin(this)},beforeDestroy:function(){this.NWysiwyg.removePlugin(this)}};n(15);var Ti=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},Ai={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};Ti.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},Ti.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},Ti.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},Ti.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new Ti(r,this.size+t.size)},Ti.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new Ti(n,r)},Ti.prototype.cutByIndex=function(t,e){return t==e?Ti.empty:0==t&&e==this.content.length?this:new Ti(this.content.slice(t,e))},Ti.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new Ti(r,o)},Ti.prototype.addToStart=function(t){return new Ti([t].concat(this.content),this.size+t.nodeSize)},Ti.prototype.addToEnd=function(t){return new Ti(this.content.concat(t),this.size+t.nodeSize)},Ti.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},Ai.firstChild.get=function(){return this.content.length?this.content[0]:null},Ai.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Ai.childCount.get=function(){return this.content.length},Ti.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},Ti.prototype.maybeChild=function(t){return this.content[t]},Ti.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},Ti.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},Ti.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},Ti.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return Di(0,t);if(t==this.size)return Di(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?Di(n+1,o):Di(n,r);r=o}},Ti.prototype.toString=function(){return"<"+this.toStringInner()+">"},Ti.prototype.toStringInner=function(){return this.content.join(", ")},Ti.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},Ti.fromJSON=function(t,e){if(!e)return Ti.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ti(e.map(t.nodeFromJSON))},Ti.fromArray=function(t){if(!t.length)return Ti.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new Ti(e||t,n)},Ti.from=function(t){if(!t)return Ti.empty;if(t instanceof Ti)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Ti([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(Ti.prototype,Ai);var Ei={index:0,offset:0};function Di(t,e){return Ei.index=t,Ei.offset=e,Ei}function Pi(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!Pi(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&Pi(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}Ti.empty=new Ti([],0);var Ii=function(t,e){this.type=t,this.attrs=e};function Ri(t){var e=Error.call(this,t);return e.__proto__=Ri.prototype,e}Ii.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},Ii.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},Ii.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},Ii.prototype.eq=function(t){return this==t||this.type==t.type&&Pi(this.attrs,t.attrs)},Ii.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},Ii.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},Ii.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},Ii.setFrom=function(t){if(!t||0==t.length)return Ii.none;if(t instanceof Ii)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},Ii.none=[],Ri.prototype=Object.create(Error.prototype),Ri.prototype.constructor=Ri,Ri.prototype.name="ReplaceError";var zi=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},_i={size:{configurable:!0}};function $i(t,e,n){if(n.openStart>t.depth)throw new Ri("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Ri("Inconsistent open depths");return function t(e,n,r,o){var i=e.index(o),s=e.node(o);if(i==n.index(o)&&o<e.depth-r.openStart){var a=t(e,n,r,o+1);return s.copy(s.content.replaceChild(i,a))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=o||n.depth!=o){var c=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(Ti.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),l=c.start,u=c.end;return Li(s,function t(e,n,r,o,i){var s=e.depth>i&&ji(e,n,i+1),a=o.depth>i&&ji(r,o,i+1),c=[];Vi(null,e,i,c),s&&a&&n.index(i)==r.index(i)?(Bi(s,a),Fi(Li(s,t(e,n,r,o,i+1)),c)):(s&&Fi(Li(s,qi(e,n,i+1)),c),Vi(n,r,i,c),a&&Fi(Li(a,qi(r,o,i+1)),c));return Vi(o,null,i,c),new Ti(c)}(e,l,u,n,o))}var h=e.parent,p=h.content;return Li(h,p.cut(0,e.parentOffset).append(r.content).append(p.cut(n.parentOffset)))}return Li(s,qi(e,n,o))}(t,e,n,0)}function Bi(t,e){if(!e.type.compatibleContent(t.type))throw new Ri("Cannot join "+e.type.name+" onto "+t.type.name)}function ji(t,e,n){var r=t.node(n);return Bi(r,e.node(n)),r}function Fi(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Vi(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(Fi(t.nodeAfter,r),i++));for(var a=i;a<s;a++)Fi(o.child(a),r);e&&e.depth==n&&e.textOffset&&Fi(e.nodeBefore,r)}function Li(t,e){if(!t.type.validContent(e))throw new Ri("Invalid content for node "+t.type.name);return t.copy(e)}function qi(t,e,n){var r=[];(Vi(null,t,n,r),t.depth>n)&&Fi(Li(ji(t,e,n+1),qi(t,e,n+1)),r);return Vi(e,null,n,r),new Ti(r)}_i.size.get=function(){return this.content.size-this.openStart-this.openEnd},zi.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new zi(n,this.openStart,this.openEnd)},zi.prototype.removeBetween=function(t,e){return new zi(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},zi.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},zi.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},zi.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},zi.fromJSON=function(t,e){if(!e)return zi.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new zi(Ti.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},zi.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new zi(t,n,r)},Object.defineProperties(zi.prototype,_i),zi.empty=new zi(Ti.empty,0,0);var Ji=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},Wi={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};Ji.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},Wi.parent.get=function(){return this.node(this.depth)},Wi.doc.get=function(){return this.node(0)},Ji.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},Ji.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},Ji.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},Ji.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},Ji.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},Ji.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},Ji.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},Wi.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Wi.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},Wi.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},Ji.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return Ii.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},Ji.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},Ji.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},Ji.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new Gi(this,t,n)},Ji.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},Ji.prototype.max=function(t){return t.pos>this.pos?t:this},Ji.prototype.min=function(t){return t.pos<this.pos?t:this},Ji.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},Ji.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new Ji(e,n,o)},Ji.resolveCached=function(t,e){for(var n=0;n<Hi.length;n++){var r=Hi[n];if(r.pos==e&&r.doc==t)return r}var o=Hi[Ui]=Ji.resolve(t,e);return Ui=(Ui+1)%Ki,o},Object.defineProperties(Ji.prototype,Wi);var Hi=[],Ui=0,Ki=12,Gi=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},Yi={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Yi.start.get=function(){return this.$from.before(this.depth+1)},Yi.end.get=function(){return this.$to.after(this.depth+1)},Yi.parent.get=function(){return this.$from.node(this.depth)},Yi.startIndex.get=function(){return this.$from.index(this.depth)},Yi.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(Gi.prototype,Yi);var Xi=Object.create(null),Zi=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||Ti.empty,this.marks=r||Ii.none},Qi={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Qi.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Qi.childCount.get=function(){return this.content.childCount},Zi.prototype.child=function(t){return this.content.child(t)},Zi.prototype.maybeChild=function(t){return this.content.maybeChild(t)},Zi.prototype.forEach=function(t){this.content.forEach(t)},Zi.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},Zi.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},Qi.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Zi.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},Qi.firstChild.get=function(){return this.content.firstChild},Qi.lastChild.get=function(){return this.content.lastChild},Zi.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},Zi.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},Zi.prototype.hasMarkup=function(t,e,n){return this.type==t&&Pi(this.attrs,e||t.defaultAttrs||Xi)&&Ii.sameSet(this.marks,n||Ii.none)},Zi.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},Zi.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},Zi.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},Zi.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return zi.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new zi(a,r.depth-i,o.depth-i)},Zi.prototype.replace=function(t,e,n){return $i(this.resolve(t),this.resolve(e),n)},Zi.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},Zi.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},Zi.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},Zi.prototype.resolve=function(t){return Ji.resolveCached(this,t)},Zi.prototype.resolveNoCache=function(t){return Ji.resolve(this,t)},Zi.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},Qi.isBlock.get=function(){return this.type.isBlock},Qi.isTextblock.get=function(){return this.type.isTextblock},Qi.inlineContent.get=function(){return this.type.inlineContent},Qi.isInline.get=function(){return this.type.isInline},Qi.isText.get=function(){return this.type.isText},Qi.isLeaf.get=function(){return this.type.isLeaf},Qi.isAtom.get=function(){return this.type.isAtom},Zi.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),es(this.marks,t)},Zi.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},Zi.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=Ti.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},Zi.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},Zi.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},Zi.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},Zi.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},Zi.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=Ti.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(Zi.prototype,Qi);var ts=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):es(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(Zi);function es(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var ns=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},rs={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};ns.parse=function(t,e){var n=new is(t,e);if(null==n.next)return ns.empty;var r=as(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];fs(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new ns(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(ps);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(fs(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},ns.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},ns.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},rs.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},rs.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},ns.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},ns.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return Ti.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(u)){r.push(u);var h=o(u,s.concat(l));if(h)return h}}}(this,[])},ns.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},ns.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},rs.edgeCount.get=function(){return this.next.length>>1},ns.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},ns.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(ns.prototype,rs),ns.empty=new ns(!0);var is=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},ss={next:{configurable:!0}};function as(t){var e=[];do{e.push(cs(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function cs(t){var e=[];do{e.push(ls(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function ls(t){for(var e=function(t){if(t.eat("(")){var e=as(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=hs(t,e)}return e}function us(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function hs(t,e){var n=us(t),r=n;return t.eat(",")&&(r="}"!=t.next?us(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function ps(t,e){return e-t}function fs(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(ps)}function ds(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function vs(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function ms(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new bs(t[n]);return e}ss.next.get=function(){return this.tokens[this.pos]},is.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},is.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(is.prototype,ss);var gs=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=ms(n.attrs),this.defaultAttrs=ds(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},ys={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};ys.isInline.get=function(){return!this.isBlock},ys.isTextblock.get=function(){return this.isBlock&&this.inlineContent},ys.isLeaf.get=function(){return this.contentMatch==ns.empty},ys.isAtom.get=function(){return this.isLeaf||this.spec.atom},gs.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},gs.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},gs.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:vs(this.attrs,t)},gs.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Zi(this,this.computeAttrs(t),Ti.from(e),Ii.setFrom(n))},gs.prototype.createChecked=function(t,e,n){if(e=Ti.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new Zi(this,this.computeAttrs(t),e,Ii.setFrom(n))},gs.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=Ti.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(Ti.empty,!0);return o?new Zi(this,t,e.append(o),Ii.setFrom(n)):null},gs.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},gs.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},gs.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},gs.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:Ii.empty:t},gs.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new gs(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(gs.prototype,ys);var bs=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},ws={isRequired:{configurable:!0}};ws.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(bs.prototype,ws);var xs=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=ms(r.attrs),this.rank=e,this.excluded=null;var o=ds(this.attrs);this.instance=o&&new Ii(this,o)};xs.prototype.create=function(t){return!t&&this.instance?this.instance:new Ii(this,vs(this.attrs,t))},xs.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new xs(t,r++,e,o)})),n},xs.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},xs.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},xs.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var ks=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=s.a.from(t.nodes),this.spec.marks=s.a.from(t.marks),this.nodes=gs.compile(this.spec.nodes,this),this.marks=xs.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",a=o.spec.marks;o.contentMatch=n[i]||(n[i]=ns.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==a?null:a?Ss(this,a.split(" ")):""!=a&&o.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:Ss(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Ss(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}ks.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof gs))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},ks.prototype.text=function(t,e){var n=this.nodes.text;return new ts(n,n.defaultAttrs,t,Ii.setFrom(e))},ks.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},ks.prototype.nodeFromJSON=function(t){return Zi.fromJSON(this,t)},ks.prototype.markFromJSON=function(t){return Ii.fromJSON(this,t)},ks.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var Cs=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};Cs.prototype.parse=function(t,e){void 0===e&&(e={});var n=new Es(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},Cs.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new Es(this,e,!0);return n.addAll(t,null,e.from,e.to),zi.maxOpen(n.finish())},Cs.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(Ps(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},Cs.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},Cs.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Is(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=Is(t)),t.node=s}));return e},Cs.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Cs(t,Cs.schemaRules(t)))};var Os={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ns={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Ms={ol:!0,ul:!0};function Ts(t){return(t?1:0)|("full"===t?2:0)}var As=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=Ii.none,this.pendingMarks=r};As.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(Ti.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},As.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=Ti.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Ti.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},As.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):Rs(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var Es=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=Ts(e.preserveWhitespace)|(n?4:0);r=o?new As(o.type,o.attrs,Ii.none,Ii.none,!0,e.topMatch||o.type.contentMatch,i):new As(n?null:t.schema.topNodeType,null,Ii.none,Ii.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},Ds={top:{configurable:!0},currentPos:{configurable:!0}};function Ps(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Is(t){var e={};for(var n in t)e[n]=t[n];return e}function Rs(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[],s=function(t){i.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),o=r.type,a=r.next;if(o==e)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}Ds.top.get=function(){return this.nodes[this.open]},Es.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},Es.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},Es.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();Ms.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&Ms.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:Ns.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(Os.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},Es.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},Es.prototype.readStyles=function(t){for(var e=Ii.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},Es.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o,s)},Es.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&Os.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},Es.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},Es.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},Es.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},Es.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:Ts(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new As(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},Es.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},Es.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Es.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},Ds.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},Es.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},Es.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},Es.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},Es.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},Es.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},Es.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Es.prototype.addPendingMark=function(t){this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},Es.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1?r.pendingMarks=t.removeFromSet(r.pendingMarks):r.activeMarks=t.removeFromSet(r.activeMarks),r==e)break}},Object.defineProperties(Es.prototype,Ds);var zs=function(t,e){this.nodes=t||{},this.marks=e||{}};function _s(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function $s(t){return t.document||window.document}zs.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=$s(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},zs.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=zs.renderSpec($s(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},zs.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},zs.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&zs.renderSpec($s(n),r(t,e))},zs.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var h=c;h<e.length;h++){var p=e[h];if(0===p){if(h<e.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var f=zs.renderSpec(t,p,n),d=f.dom,v=f.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},zs.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new zs(this.nodesFromSchema(t),this.marksFromSchema(t)))},zs.nodesFromSchema=function(t){var e=_s(t.nodes);return e.text||(e.text=function(t){return t.text}),e},zs.marksFromSchema=function(t){return _s(t.marks)};var Bs=Math.pow(2,16);function js(t){return 65535&t}var Fs=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.pos=t,this.deleted=e,this.recover=n},Vs=function(t,e){void 0===e&&(e=!1),this.ranges=t,this.inverted=e};Vs.prototype.recover=function(t){var e=0,n=js(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/Bs}(t)},Vs.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},Vs.prototype.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},Vs.prototype._map=function(t,e,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;var c=this.ranges[s+o],l=this.ranges[s+i],u=a+c;if(t<=u){var h=a+r+((c?t==a?-1:t==u?1:e:e)<0?0:l);if(n)return h;var p=s/3+(t-a)*Bs;return new Fs(h,e<0?t!=a:t!=u,p)}r+=l-c}return n?t+r:new Fs(t+r)},Vs.prototype.touches=function(t,e){for(var n=0,r=js(e),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>t)break;var c=this.ranges[s+o];if(t<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},Vs.prototype.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+e],l=this.ranges[r+n];t(s,s+c,a,a+l),o+=l-c}},Vs.prototype.invert=function(){return new Vs(this.ranges,!this.inverted)},Vs.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},Vs.offset=function(t){return 0==t?Vs.empty:new Vs(t<0?[0,-t,0]:[0,0,t])},Vs.empty=new Vs([]);var Ls=function(t,e,n,r){this.maps=t||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=e};function qs(t){var e=Error.call(this,t);return e.__proto__=qs.prototype,e}Ls.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.maps.length),new Ls(this.maps,this.mirror,t,e)},Ls.prototype.copy=function(){return new Ls(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},Ls.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},Ls.prototype.appendMapping=function(t){for(var e=0,n=this.maps.length;e<t.maps.length;e++){var r=t.getMirror(e);this.appendMap(t.maps[e],null!=r&&r<e?n+r:null)}},Ls.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},Ls.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},Ls.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){var r=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=r&&r>e?n-r-1:null)}},Ls.prototype.invert=function(){var t=new Ls;return t.appendMappingInverted(this),t},Ls.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t},Ls.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},Ls.prototype._map=function(t,e,n){for(var r=!1,o=null,i=this.from;i<this.to;i++){var s=this.maps[i],a=o&&o[i];if(null!=a&&s.touches(t,a))t=s.recover(a);else{var c=s.mapResult(t,e);if(null!=c.recover){var l=this.getMirror(i);if(null!=l&&l>i&&l<this.to){if(c.deleted){i=l,t=this.maps[l].recover(c.recover);continue}(o||(o=Object.create(null)))[l]=c.recover}}c.deleted&&(r=!0),t=c.pos}}return n?t:new Fs(t,r)},qs.prototype=Object.create(Error.prototype),qs.prototype.constructor=qs,qs.prototype.name="TransformError";var Js=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new Ls},Ws={before:{configurable:!0},docChanged:{configurable:!0}};function Hs(){throw new Error("Override me")}Ws.before.get=function(){return this.docs.length?this.docs[0]:this.doc},Js.prototype.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new qs(e.failed);return this},Js.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},Ws.docChanged.get=function(){return this.steps.length>0},Js.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(Js.prototype,Ws);var Us=Object.create(null),Ks=function(){};Ks.prototype.apply=function(t){return Hs()},Ks.prototype.getMap=function(){return Vs.empty},Ks.prototype.invert=function(t){return Hs()},Ks.prototype.map=function(t){return Hs()},Ks.prototype.merge=function(t){return null},Ks.prototype.toJSON=function(){return Hs()},Ks.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=Us[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},Ks.jsonID=function(t,e){if(t in Us)throw new RangeError("Duplicate use of step JSON ID "+t);return Us[t]=e,e.prototype.jsonID=t,e};var Gs=function(t,e){this.doc=t,this.failed=e};Gs.ok=function(t){return new Gs(t,null)},Gs.fail=function(t){return new Gs(null,t)},Gs.fromReplace=function(t,e,n,r){try{return Gs.ok(t.replace(e,n,r))}catch(t){if(t instanceof Ri)return Gs.fail(t.message);throw t}};var Ys=function(t){function e(e,n,r,o){t.call(this),this.from=e,this.to=n,this.slice=r,this.structure=!!o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){return this.structure&&Zs(t,this.from,this.to)?Gs.fail("Structure replace would overwrite content"):Gs.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new Vs([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new e(n.pos,Math.max(n.pos,r.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure!=this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?zi.empty:new zi(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}var r=this.slice.size+t.slice.size==0?zi.empty:new zi(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),r,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,zi.fromJSON(t,n.slice),!!n.structure)},e}(Ks);Ks.jsonID("replace",Ys);var Xs=function(t){function e(e,n,r,o,i,s,a){t.call(this),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){if(this.structure&&(Zs(t,this.from,this.gapFrom)||Zs(t,this.gapTo,this.to)))return Gs.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Gs.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,e.content);return n?Gs.fromReplace(t,this.from,this.to,n):Gs.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new Vs([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),o=t.map(this.gapFrom,-1),i=t.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new e(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,zi.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(Ks);function Zs(t,e,n){for(var r=t.resolve(e),o=n-e,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function Qs(t,e,n){for(var r=[],o=0;o<t.childCount;o++){var i=t.child(o);i.content.size&&(i=i.copy(Qs(i.content,e,i))),i.isInline&&(i=e(i,n,o)),r.push(i)}return Ti.fromArray(r)}Ks.jsonID("replaceAround",Xs),Js.prototype.lift=function(t,e){for(var n=t.$from,r=t.$to,o=t.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=Ti.empty,u=0,h=o,p=!1;h>e;h--)p||n.index(h)>0?(p=!0,l=Ti.from(n.node(h).copy(l)),u++):a--;for(var f=Ti.empty,d=0,v=o,m=!1;v>e;v--)m||r.after(v+1)<r.end(v)?(m=!0,f=Ti.from(r.node(v).copy(f)),d++):c++;return this.step(new Xs(a,c,i,s,new zi(l.append(f),u,d),l.size-u,!0))},Js.prototype.wrap=function(t,e){for(var n=Ti.empty,r=e.length-1;r>=0;r--)n=Ti.from(e[r].type.create(e[r].attrs,n));var o=t.start,i=t.end;return this.step(new Xs(o,i,o,i,new zi(n,0,0),e.length,!0))},Js.prototype.setBlockType=function(t,e,n,r){var o=this;if(void 0===e&&(e=t),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(n,r)&&function(t,e,n){var r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(e),n)){o.clearIncompatible(o.mapping.slice(i).map(e,1),n);var s=o.mapping.slice(i),a=s.map(e,1),c=s.map(e+t.nodeSize,1);return o.step(new Xs(a,c,a+1,c-1,new zi(Ti.from(n.create(r,null,t.marks)),0,0),1,!0)),!1}})),this},Js.prototype.setNodeMarkup=function(t,e,n,r){var o=this.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");e||(e=o.type);var i=e.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(t,t+o.nodeSize,i);if(!e.validContent(o.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new Xs(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new zi(Ti.from(i),0,0),1,!0))},Js.prototype.split=function(t,e,n){void 0===e&&(e=1);for(var r=this.doc.resolve(t),o=Ti.empty,i=Ti.empty,s=r.depth,a=r.depth-e,c=e-1;s>a;s--,c--){o=Ti.from(r.node(s).copy(o));var l=n&&n[c];i=Ti.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new Ys(t,t,new zi(o.append(i),e,e),!0))},Js.prototype.join=function(t,e){void 0===e&&(e=1);var n=new Ys(t-e,t+e,zi.empty,!0);return this.step(n)};var ta=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=t.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new zi(Qs(n.content,(function(t,n){return n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),o),n.openStart,n.openEnd);return Gs.fromReplace(t,this.from,this.to,i)},e.prototype.invert=function(){return new ea(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Ks);Ks.jsonID("addMark",ta);var ea=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=new zi(Qs(n.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),n.openStart,n.openEnd);return Gs.fromReplace(t,this.from,this.to,r)},e.prototype.invert=function(){return new ta(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(Ks);function na(t,e,n,r){if(void 0===n&&(n=e),void 0===r&&(r=zi.empty),e==n&&!r.size)return null;var o=t.resolve(e),i=t.resolve(n);if(ia(o,i,r))return new Ys(e,n,r);var s=function(t,e){var n=function t(e,n,r,o){var i=Ti.empty,s=0,a=r[n];if(e.depth>n){var c=t(e,n+1,r,o||a);s=c.openEnd+1,i=Ti.from(e.node(n+1).copy(c.content))}a&&(i=i.append(a.content),s=a.openEnd);o&&(i=i.append(e.node(n).contentMatchAt(e.indexAfter(n)).fillBefore(Ti.empty,!0)),s=0);return{content:i,openEnd:s}}(t,0,e,!1),r=n.content,o=n.openEnd;return new zi(r,t.depth,o||0)}(o,function(t,e){for(var n=new sa(t),r=1;e.size&&r<=3;r++){var o=n.placeSlice(e.content,e.openStart,e.openEnd,r);3==r&&o!=e&&o.size&&(r=0),e=o}for(;n.open.length;)n.closeNode();return n.placed}(o,r)),a=oa(o,i,s);if(!a)return null;if(s.size!=a.size&&function(t,e,n){if(!e.parent.isTextblock)return!1;var r,o=n.openEnd?function(t,e){for(var n=1;n<e;n++)t=t.lastChild.content;return t.lastChild}(n.content,n.openEnd):t.node(t.depth-(n.openStart-n.openEnd));if(!o.isTextblock)return!1;for(var i=e.index();i<e.parent.childCount;i++)if(!o.type.allowsMarks(e.parent.child(i).marks))return!1;n.openEnd?r=o.contentMatchAt(o.childCount):(r=o.contentMatchAt(o.childCount),n.size&&(r=r.matchFragment(n.content,n.openStart?1:0)));return(r=r.matchFragment(e.parent.content,e.index()))&&r.validEnd}(o,i,s)){for(var c=i.depth,l=i.after(c);c>1&&l==i.end(--c);)++l;var u=oa(o,t.resolve(l),s);if(u)return new Xs(e,l,n,i.end(),u,s.size)}return a.size||e!=n?new Ys(e,n,a):null}function ra(t,e,n,r,o,i,s){var a,c=t.childCount,l=c-(s>0?1:0),u=i<0?e:n.node(o);a=i<0?u.contentMatchAt(l):1==c&&s>0?u.contentMatchAt(i?n.index(o):n.indexAfter(o)):u.contentMatchAt(n.indexAfter(o)).matchFragment(t,c>0&&i?1:0,l);var h=r.node(o);if(s>0&&o<r.depth){var p=h.content.cutByIndex(r.indexAfter(o)).addToStart(t.lastChild),f=a.fillBefore(p,!0);if(f&&f.size&&i>0&&1==c&&(f=null),f){var d=ra(t.lastChild.content,t.lastChild,n,r,o+1,1==c?i-1:-1,s-1);if(d){var v=t.lastChild.copy(d);return f.size?t.cutByIndex(0,c-1).append(f).addToEnd(v):t.replaceChild(c-1,v)}}}s>0&&(a=a.matchType((1==c&&i>0?n.node(o+1):t.lastChild).type));var m=r.index(o);if(m==h.childCount&&!h.type.compatibleContent(e.type))return null;for(var g=a.fillBefore(h.content,!0,m),y=m;g&&y<h.content.childCount;y++)u.type.allowsMarks(h.content.child(y).marks)||(g=null);if(!g)return null;if(s>0){var b=function t(e,n,r,o,i){var s,a=e.content,c=a.childCount;s=i>=0?r.node(o).contentMatchAt(r.indexAfter(o)).matchFragment(a,i>0?1:0,c):e.contentMatchAt(c);if(n>0){var l=t(a.lastChild,n-1,r,o+1,1==c?i-1:-1);a=a.replaceChild(c-1,l)}return e.copy(a.append(s.fillBefore(Ti.empty,!0)))}(t.lastChild,s-1,n,o+1,1==c?i-1:-1);t=t.replaceChild(c-1,b)}return t=t.append(g),r.depth>o&&(t=t.addToEnd(function t(e,n){var r=e.node(n),o=r.contentMatchAt(0).fillBefore(r.content,!0,e.index(n));e.depth>n&&(o=o.addToEnd(t(e,n+1)));return r.copy(o)}(r,o+1))),t}function oa(t,e,n){var r=ra(n.content,t.node(0),t,e,0,n.openStart,n.openEnd);return r?function(t,e,n){for(;e>0&&n>0&&1==t.childCount;)t=t.firstChild.content,e--,n--;return new zi(t,e,n)}(r,n.openStart,e.depth):null}function ia(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}Ks.jsonID("removeMark",ea),Js.prototype.addMark=function(t,e,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(t,e,(function(r,c,l){if(r.isInline){var u=r.marks;if(!n.isInSet(u)&&l.type.allowsMarkType(n.type)){for(var h=Math.max(c,t),p=Math.min(c+r.nodeSize,e),f=n.addToSet(u),d=0;d<u.length;d++)u[d].isInSet(f)||(s&&s.to==h&&s.mark.eq(u[d])?s.to=p:o.push(s=new ea(h,p,u[d])));a&&a.to==h?a.to=p:i.push(a=new ta(h,p,n))}}})),o.forEach((function(t){return r.step(t)})),i.forEach((function(t){return r.step(t)})),this},Js.prototype.removeMark=function(t,e,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(t,e,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof xs){var c=n.isInSet(r.marks);c&&(a=[c])}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var l=Math.min(s+r.nodeSize,e),u=0;u<a.length;u++){for(var h=a[u],p=void 0,f=0;f<o.length;f++){var d=o[f];d.step==i-1&&h.eq(o[f].style)&&(p=d)}p?(p.to=l,p.step=i):o.push({style:h,from:Math.max(s,t),to:l,step:i})}}})),o.forEach((function(t){return r.step(new ea(t.from,t.to,t.style))})),this},Js.prototype.clearIncompatible=function(t,e,n){void 0===n&&(n=e.contentMatch);for(var r=this.doc.nodeAt(t),o=[],i=t+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(l){n=l;for(var u=0;u<a.marks.length;u++)e.allowsMarkType(a.marks[u].type)||this.step(new ea(i,c,a.marks[u]))}else o.push(new Ys(i,c,zi.empty));i=c}if(!n.validEnd){var h=n.fillBefore(Ti.empty,!0);this.replace(i,i,new zi(h,0,0))}for(var p=o.length-1;p>=0;p--)this.step(o[p]);return this},Js.prototype.replace=function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=zi.empty);var r=na(this.doc,t,e,n);return r&&this.step(r),this},Js.prototype.replaceWith=function(t,e,n){return this.replace(t,e,new zi(Ti.from(n),0,0))},Js.prototype.delete=function(t,e){return this.replace(t,e,zi.empty)},Js.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var sa=function(t){this.open=[];for(var e=0;e<=t.depth;e++){var n=t.node(e),r=n.contentMatchAt(t.indexAfter(e));this.open.push({parent:n,match:r,content:Ti.empty,wrapper:!1,openEnd:0,depth:e})}this.placed=[]};function aa(t,e,n){var r=t.content;if(e>1){var o=aa(t.firstChild,e-1,1==t.childCount?n-1:0);r=t.content.replaceChild(0,o)}var i=t.type.contentMatch.fillBefore(r,0==n);return t.copy(i.append(r))}function ca(t,e,n,r,o){if(e<n){var i=t.firstChild;t=t.replaceChild(0,i.copy(ca(i.content,e+1,n,r,i)))}if(e>r){var s=o.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(Ti.empty,!0))}return t}function la(t,e){for(var n=[],r=Math.min(t.depth,e.depth);r>=0;r--){var o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;o==e.start(r)&&n.push(r)}return n}sa.prototype.placeSlice=function(t,e,n,r,o){if(e>0){var i=t.firstChild,s=this.placeSlice(i.content,Math.max(0,e-1),n&&1==t.childCount?n-1:0,r,i);s.content!=i.content&&(s.content.size?(t=t.replaceChild(0,i.copy(s.content)),e=s.openStart+1):(1==t.childCount&&(n=0),t=t.cutByIndex(1),e=0))}var a=this.placeContent(t,e,n,r,o);if(r>2&&a.size&&0==e){var c=a.content.firstChild,l=1==a.content.childCount;this.placeContent(c.content,0,n&&l?n-1:0,r,c),a=l?Ti.empty:new zi(a.content.cutByIndex(1),0,n)}return a},sa.prototype.placeContent=function(t,e,n,r,o){for(var i=0;i<t.childCount;i++){for(var s=t.child(i),a=!1,c=i==t.childCount-1,l=this.open.length-1;l>=0;l--){var u=this.open[l],h=void 0;if(r>1&&(h=u.match.findWrapping(s.type))&&(!o||!h.length||h[h.length-1]!=o.type)){for(;this.open.length-1>l;)this.closeNode();for(var p=0;p<h.length;p++)u.match=u.match.matchType(h[p]),l++,u={parent:h[p].create(),match:h[p].contentMatch,content:Ti.empty,wrapper:!0,openEnd:0,depth:l+p},this.open.push(u)}var f=u.match.matchType(s.type);if(!f){var d=u.match.fillBefore(Ti.from(s));if(!d){if(o&&u.match.matchType(o.type))break;continue}for(var v=0;v<d.childCount;v++){var m=d.child(v);this.addNode(u,m,0),f=u.match.matchFragment(m)}}for(;this.open.length-1>l;)this.closeNode();s=s.mark(u.parent.type.allowedMarks(s.marks)),e&&(s=aa(s,e,c?n:0),e=0),this.addNode(u,s,c?n:0),u.match=f,c&&(n=0),a=!0;break}if(!a)break}return this.open.length>1&&(i>0&&i==t.childCount||o&&this.open[this.open.length-1].parent.type==o.type)&&this.closeNode(),new zi(t.cutByIndex(i),e,n)},sa.prototype.addNode=function(t,e,n){var r,o;t.content=(r=t.content,o=t.openEnd,o?r.replaceChild(r.childCount-1,function t(e,n){var r=e.content;if(n>1){var o=t(e.lastChild,n-1);r=e.content.replaceChild(e.childCount-1,o)}var i=e.contentMatchAt(e.childCount).fillBefore(Ti.empty,!0);return e.copy(r.append(i))}(r.lastChild,o)):r).addToEnd(e),t.openEnd=n},sa.prototype.closeNode=function(){var t=this.open.pop();0==t.content.size||(t.wrapper?this.addNode(this.open[this.open.length-1],t.parent.copy(t.content),t.openEnd+1):this.placed[t.depth]={depth:t.depth,content:t.content,openEnd:t.openEnd})},Js.prototype.replaceRange=function(t,e,n){if(!n.size)return this.deleteRange(t,e);var r=this.doc.resolve(t),o=this.doc.resolve(e);if(ia(r,o,n))return this.step(new Ys(t,e,n));var i=la(r,this.doc.resolve(e));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),h=[],p=n.openStart,f=n.content,d=0;;d++){var v=f.firstChild;if(h.push(v),d==n.openStart)break;f=v.content}p>0&&h[p-1].type.spec.defining&&r.node(u).type!=h[p-1].type?p-=1:p>=2&&h[p-1].isTextblock&&h[p-2].type.spec.defining&&r.node(u).type!=h[p-2].type&&(p-=2);for(var m=n.openStart;m>=0;m--){var g=(m+p+1)%(n.openStart+1),y=h[g];if(y)for(var b=0;b<i.length;b++){var w=i[(b+u)%i.length],x=!0;w<0&&(x=!1,w=-w);var k=r.node(w-1),S=r.index(w-1);if(k.canReplaceWith(S,S,y.type,y.marks))return this.replace(r.before(w),x?o.after(w):e,new zi(ca(n.content,0,n.openStart,g),g,n.openEnd))}}for(var C=this.steps.length,O=i.length-1;O>=0&&(this.replace(t,e,n),!(this.steps.length>C));O--){var N=i[O];O<0||(t=r.before(N),e=o.after(N))}return this},Js.prototype.replaceRangeWith=function(t,e,n){if(!n.isInline&&t==e&&this.doc.resolve(t).parent.content.size){var r=function(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,t,n.type);null!=r&&(t=e=r)}return this.replaceRange(t,e,new zi(Ti.from(n),0,0))},Js.prototype.deleteRange=function(t,e){for(var n=this.doc.resolve(t),r=this.doc.resolve(e),o=la(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&r.end(c)-e!=r.depth-c)return this.delete(n.before(c),e);return this.delete(t,e)};var ua={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var ha=/Edge\/(\d+)/.exec(navigator.userAgent),pa=/MSIE \d/.test(navigator.userAgent),fa=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);ua.mac=/Mac/.test(navigator.platform);var da=ua.ie=!!(pa||fa||ha);ua.ie_version=pa?document.documentMode||6:fa?+fa[1]:ha?+ha[1]:null,ua.gecko=!da&&/gecko\/(\d+)/i.test(navigator.userAgent),ua.gecko_version=ua.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var va=!da&&/Chrome\/(\d+)/.exec(navigator.userAgent);ua.chrome=!!va,ua.chrome_version=va&&+va[1],ua.ios=!da&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),ua.android=/Android \d/.test(navigator.userAgent),ua.webkit=!da&&"WebkitAppearance"in document.documentElement.style,ua.safari=/Apple Computer/.test(navigator.vendor),ua.webkit_version=ua.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var ma=function(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e},ga=function(t){var e=t.parentNode;return e&&11==e.nodeType?e.host:e},ya=function(t,e,n){var r=document.createRange();return r.setEnd(t,null==n?t.nodeValue.length:n),r.setStart(t,e||0),r},ba=function(t,e,n,r){return n&&(xa(t,e,n,r,-1)||xa(t,e,n,r,1))},wa=/^(img|br|input|textarea|hr)$/i;function xa(t,e,n,r,o){for(;;){if(t==n&&e==r)return!0;if(e==(o<0?0:ka(t))){var i=t.parentNode;if(1!=i.nodeType||Sa(t)||wa.test(t.nodeName)||"false"==t.contentEditable)return!1;e=ma(t)+(o<0?0:1),t=i}else{if(1!=t.nodeType)return!1;t=t.childNodes[e+(o<0?-1:0)],e=o<0?ka(t):0}}}function ka(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Sa(t){for(var e,n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}var Ca=function(t){var e=t.isCollapsed;return e&&ua.chrome&&t.rangeCount&&!t.getRangeAt(0).collapsed&&(e=!1),e};function Oa(t,e){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function Na(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function Ma(t,e){return"number"==typeof t?t:t[e]}function Ta(t,e,n){for(var r=t.someProp("scrollThreshold")||0,o=t.someProp("scrollMargin")||5,i=t.dom.ownerDocument,s=i.defaultView,a=n||t.dom;a;a=ga(a))if(1==a.nodeType){var c=a==i.body||1!=a.nodeType,l=c?Na(s):a.getBoundingClientRect(),u=0,h=0;if(e.top<l.top+Ma(r,"top")?h=-(l.top-e.top+Ma(o,"top")):e.bottom>l.bottom-Ma(r,"bottom")&&(h=e.bottom-l.bottom+Ma(o,"bottom")),e.left<l.left+Ma(r,"left")?u=-(l.left-e.left+Ma(o,"left")):e.right>l.right-Ma(r,"right")&&(u=e.right-l.right+Ma(o,"right")),(u||h)&&(c?s.scrollBy(u,h):(h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u))),c)break}}function Aa(t){for(var e=[],n=t.ownerDocument;t&&(e.push({dom:t,top:t.scrollTop,left:t.scrollLeft}),t!=n);t=ga(t));return e}function Ea(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=r.dom,i=r.top,s=r.left;o.scrollTop!=i+e&&(o.scrollTop=i+e),o.scrollLeft!=s&&(o.scrollLeft=s)}}var Da=null;function Pa(t,e){for(var n,r,o=2e8,i=0,s=e.top,a=e.top,c=t.firstChild,l=0;c;c=c.nextSibling,l++){var u=void 0;if(1==c.nodeType)u=c.getClientRects();else{if(3!=c.nodeType)continue;u=ya(c).getClientRects()}for(var h=0;h<u.length;h++){var p=u[h];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);var f=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(f<o){n=c,o=f,r=f&&3==n.nodeType?{left:p.right<e.left?p.right:p.left,top:e.top}:e,1==c.nodeType&&f&&(i=l+(e.left>=(p.left+p.right)/2?1:0));continue}}!n&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=l+1)}}return n&&3==n.nodeType?function(t,e){for(var n=t.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(t,o+1),r.setStart(t,o);var i=za(r,1);if(i.top!=i.bottom&&Ia(e,i))return{node:t,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:t,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:t,offset:i}:Pa(n,r)}function Ia(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function Ra(t,e){var n,r,o,i,s=t.root;if(s.caretPositionFromPoint)try{var a=s.caretPositionFromPoint(e.left,e.top);a&&(o=(n=a).offsetNode,i=n.offset)}catch(t){}if(!o&&s.caretRangeFromPoint){var c=s.caretRangeFromPoint(e.left,e.top);c&&(o=(r=c).startContainer,i=r.startOffset)}var l,u=s.elementFromPoint(e.left,e.top+1);if(!u||!t.dom.contains(1!=u.nodeType?u.parentNode:u)){var h=t.dom.getBoundingClientRect();if(!Ia(e,h))return null;if(!(u=function t(e,n,r){var o=e.childNodes.length;if(o&&r.top<r.bottom)for(var i=Math.max(0,Math.min(o-1,Math.floor(o*(n.top-r.top)/(r.bottom-r.top))-2)),s=i;;){var a=e.childNodes[s];if(1==a.nodeType)for(var c=a.getClientRects(),l=0;l<c.length;l++){var u=c[l];if(Ia(n,u))return t(a,n,u)}if((s=(s+1)%o)==i)break}return e}(t.dom,e,h)))return null}if(u=function(t,e){var n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}(u,e),o){if(ua.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var p,f=o.childNodes[i];"IMG"==f.nodeName&&(p=f.getBoundingClientRect()).right<=e.left&&p.bottom>e.top&&i++}o==t.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&e.top>o.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(l=function(t,e,n,r){for(var o=-1,i=e;i!=t.dom;){var s=t.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:t.docView.posFromDOM(e,n)}(t,o,i,e))}null==l&&(l=function(t,e,n){var r=Pa(e,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return t.docView.posFromDOM(o,i,s)}(t,u,e));var d=t.docView.nearestDesc(u,!0);return{pos:l,inside:d?d.posAtStart-d.border:-1}}function za(t,e){var n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}function _a(t,e){var n=t.docView.domFromPos(e),r=n.node,o=n.offset;if(3==r.nodeType&&(ua.chrome||ua.gecko)){var i=za(ya(r,o,o),0);if(ua.gecko&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){var s=za(ya(r,o-1,o-1),-1);if(Math.abs(s.left-i.left)<1&&s.top==i.top){var a=za(ya(r,o,o+1),-1);return $a(a,a.left<s.left)}}return i}if(1==r.nodeType&&!t.state.doc.resolve(e).parent.inlineContent){var c,l=!0;if(o<r.childNodes.length){var u=r.childNodes[o];1==u.nodeType&&(c=u.getBoundingClientRect())}if(!c&&o){var h=r.childNodes[o-1];1==h.nodeType&&(c=h.getBoundingClientRect(),l=!1)}return function(t,e){if(0==t.height)return t;var n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}(c||r.getBoundingClientRect(),l)}for(var p=-1;p<2;p+=2)if(p<0&&o){var f=void 0,d=3==r.nodeType?ya(r,o-1,o):3==(f=r.childNodes[o-1]).nodeType?ya(f):1==f.nodeType&&"BR"!=f.nodeName?f:null;if(d){var v=za(d,1);if(v.top<v.bottom)return $a(v,!1)}}else if(p>0&&o<ka(r)){var m=void 0,g=3==r.nodeType?ya(r,o,o+1):3==(m=r.childNodes[o]).nodeType?ya(m):1==m.nodeType?m:null;if(g){var y=za(g,-1);if(y.top<y.bottom)return $a(y,!0)}}return $a(za(3==r.nodeType?ya(r):r,0),!1)}function $a(t,e){if(0==t.width)return t;var n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Ba(t,e,n){var r=t.state,o=t.root.activeElement;r!=e&&t.updateState(e),o!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),o!=t.dom&&o.focus()}}var ja=/[\u0590-\u08ac]/;var Fa=null,Va=null,La=!1;function qa(t,e,n){return Fa==e&&Va==n?La:(Fa=e,Va=n,La="up"==n||"down"==n?function(t,e,n){var r=e.selection,o="up"==n?r.$anchor.min(r.$head):r.$anchor.max(r.$head);return Ba(t,e,(function(){for(var e=t.docView.domFromPos(o.pos).node;;){var r=t.docView.nearestDesc(e,!0);if(!r)break;if(r.node.isBlock){e=r.dom;break}e=r.dom.parentNode}for(var i=_a(t,o.pos),s=e.firstChild;s;s=s.nextSibling){var a=void 0;if(1==s.nodeType)a=s.getClientRects();else{if(3!=s.nodeType)continue;a=ya(s,0,s.nodeValue.length).getClientRects()}for(var c=0;c<a.length;c++){var l=a[c];if(l.bottom>l.top&&("up"==n?l.bottom<i.top+1:l.top>i.bottom-1))return!1}}return!0}))}(t,e,n):function(t,e,n){var r=e.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=getSelection();return ja.test(r.parent.textContent)&&a.modify?Ba(t,e,(function(){var e=a.getRangeAt(0),o=a.focusNode,i=a.focusOffset,s=a.caretBidiLevel;a.modify("move",n,"character");var c=!(r.depth?t.docView.domAfterPos(r.before()):t.dom).contains(1==a.focusNode.nodeType?a.focusNode:a.focusNode.parentNode)||o==a.focusNode&&i==a.focusOffset;return a.removeAllRanges(),a.addRange(e),null!=s&&(a.caretBidiLevel=s),c})):"left"==n||"backward"==n?i:s}(t,e,n))}var Ja=function(t,e,n,r){this.parent=t,this.children=e,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},Wa={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0}};Ja.prototype.matchesWidget=function(){return!1},Ja.prototype.matchesMark=function(){return!1},Ja.prototype.matchesNode=function(){return!1},Ja.prototype.matchesHack=function(){return!1},Wa.beforePosition.get=function(){return!1},Ja.prototype.parseRule=function(){return null},Ja.prototype.stopEvent=function(){return!1},Wa.size.get=function(){for(var t=0,e=0;e<this.children.length;e++)t+=this.children[e].size;return t},Wa.border.get=function(){return 0},Ja.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},Ja.prototype.posBeforeChild=function(t){for(var e=0,n=this.posAtStart;e<this.children.length;e++){var r=this.children[e];if(r==t)return n;n+=r.size}},Wa.posBefore.get=function(){return this.parent.posBeforeChild(this)},Wa.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Wa.posAfter.get=function(){return this.posBefore+this.size},Wa.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Ja.prototype.localPosFromDOM=function(t,e,n){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(n<0){var r,o;if(t==this.contentDOM)r=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;r=t.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&(!(s=i.pmViewDesc)||s.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}var a;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==e)for(var c=t;;c=c.parentNode){if(c==this.dom){a=!1;break}if(c.parentNode.firstChild!=c)break}if(null==a&&e==t.childNodes.length)for(var l=t;;l=l.parentNode){if(l==this.dom){a=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==a?n>0:a)?this.posAtEnd:this.posAtStart},Ja.prototype.nearestDesc=function(t,e){for(var n=!0,r=t;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!e||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(t):o.nodeDOM==t))return o;n=!1}}},Ja.prototype.getDesc=function(t){for(var e=t.pmViewDesc,n=e;n;n=n.parent)if(n==this)return e},Ja.prototype.posFromDOM=function(t,e,n){for(var r=t;;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(t,e,n)}},Ja.prototype.descAt=function(t){for(var e=0,n=0;e<this.children.length;e++){var r=this.children[e],o=n+r.size;if(n==t&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(t<o)return r.descAt(t-n-r.border);n=o}},Ja.prototype.domFromPos=function(t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var e=0,n=0;;n++){if(e==t){for(;n<this.children.length&&(this.children[n].beforePosition||this.children[n].dom.parentNode!=this.contentDOM);)n++;return{node:this.contentDOM,offset:n==this.children.length?this.contentDOM.childNodes.length:ma(this.children[n].dom)}}if(n==this.children.length)throw new Error("Invalid position "+t);var r=this.children[n],o=e+r.size;if(t<o)return r.domFromPos(t-e-r.border);e=o}},Ja.prototype.parseRange=function(t,e,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,s=0;;s++){var a=this.children[s],c=i+a.size;if(-1==r&&t<=c){var l=i+a.border;if(t>=l&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,l);t=i;for(var u=s;u>0;u--){var h=this.children[u-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){r=ma(h.dom)+1;break}t-=h.size}-1==r&&(r=0)}if(r>-1&&e<=c){e=c;for(var p=s+1;p<this.children.length;p++){var f=this.children[p];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=ma(f.dom);break}e+=f.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=c}return{node:this.contentDOM,from:t,to:e,fromOffset:r,toOffset:o}},Ja.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var e=this.children[t<0?0:this.children.length-1];return 0==e.size||e.emptyChildAt(t)},Ja.prototype.domAfterPos=function(t){var e=this.domFromPos(t),n=e.node,r=e.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[r]},Ja.prototype.setSelection=function(t,e,n,r){for(var o=Math.min(t,e),i=Math.max(t,e),s=0,a=0;s<this.children.length;s++){var c=this.children[s],l=a+c.size;if(o>a&&i<l)return c.setSelection(t-a-c.border,e-a-c.border,n,r);a=l}var u=this.domFromPos(t),h=this.domFromPos(e),p=n.getSelection(),f=document.createRange();if(r||!ba(u.node,u.offset,p.anchorNode,p.anchorOffset)||!ba(h.node,h.offset,p.focusNode,p.focusOffset)){if(p.extend)f.setEnd(u.node,u.offset),f.collapse(!1);else{if(t>e){var d=u;u=h,h=d}f.setEnd(h.node,h.offset),f.setStart(u.node,u.offset)}p.removeAllRanges(),p.addRange(f),p.extend&&p.extend(h.node,h.offset)}},Ja.prototype.ignoreMutation=function(t){return!this.contentDOM},Wa.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Ja.prototype.markDirty=function(t,e){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?t<=i&&e>=n:t<i&&e>n){var s=n+o.border,a=i-o.border;if(t>=s&&e<=a)return this.dirty=t==n||e==i?2:1,void(t!=s||e!=a||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-s,e-s):o.dirty=3);o.dirty=3}n=i}this.dirty=2},Ja.prototype.markParentsDirty=function(){for(var t=this.parent;t;t=t.parent){t.dirty<2&&(t.dirty=2)}},Object.defineProperties(Ja.prototype,Wa);var Ha=[],Ua=function(t){function e(e,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}t.call(this,e,Ha,s,null),this.widget=n,i=this}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={beforePosition:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},e.prototype.matchesWidget=function(t){return 0==this.dirty&&t.type.eq(this.widget.type)},e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.stopEvent=function(t){var e=this.widget.spec.stopEvent;return!!e&&e(t)},Object.defineProperties(e.prototype,n),e}(Ja),Ka=function(t){function e(e,n,r,o){t.call(this,e,Ha,n,null),this.textDOM=r,this.text=o}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},e.prototype.localPosFromDOM=function(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e},e.prototype.domFromPos=function(t){return{node:this.textDOM,offset:t}},e.prototype.ignoreMutation=function(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue},Object.defineProperties(e.prototype,n),e}(Ja),Ga=function(t){function e(e,n,r,o){t.call(this,e,[],r,o),this.mark=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=zs.renderSpec(document,n.type.spec.toDOM(n,r))),new e(t,n,s.dom,s.contentDOM||s.dom)},e.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},e.prototype.matchesMark=function(t){return 3!=this.dirty&&this.mark.eq(t)},e.prototype.markDirty=function(e,n){if(t.prototype.markDirty.call(this,e,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},e.prototype.slice=function(t,n,r){var o=e.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=hc(i,n,s,r)),t>0&&(i=hc(i,0,t,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},e}(Ja),Ya=function(t){function e(e,n,r,o,i,s,a,c,l){t.call(this,e,n.isLeaf?Ha:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,l)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={size:{configurable:!0},border:{configurable:!0}};return e.create=function(t,n,r,o,i,s){var a,c,l=i.nodeViews[n.type.name],u=l&&l(n,i,(function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s}),r),h=u&&u.dom,p=u&&u.contentDOM;if(n.isText)if(h){if(3!=h.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else h=document.createTextNode(n.text);else h||(h=(a=zs.renderSpec(document,n.type.spec.toDOM(n))).dom,p=a.contentDOM);p||n.isText||"BR"==h.nodeName||(h.hasAttribute("contenteditable")||(h.contentEditable=!1),n.type.spec.draggable&&(h.draggable=!0));var f=h;return h=sc(h,r,n),u?c=new tc(t,n,r,o,h,p,f,u,i,s+1):n.isText?new Za(t,n,r,o,h,f,i):new e(t,n,r,o,h,p,f,i,s+1)},e.prototype.parseRule=function(){var t=this;if(this.node.type.spec.reparseInView)return null;var e={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(e.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?e.contentElement=this.contentDOM:e.getContent=function(){return t.contentDOM?Ti.empty:t.node.content},e},e.prototype.matchesNode=function(t,e,n){return 0==this.dirty&&t.eq(this.node)&&ac(e,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},e.prototype.updateChildren=function(t,e){var n=this,r=this.node.inlineContent,o=e,i=r&&t.composing&&this.localCompositionNode(t,e),s=new lc(this,i&&i.node);!function(t,e,n,r){var o=e.locals(t),i=0;if(0==o.length){for(var s=0;s<t.childCount;s++){var a=t.child(s);r(a,o,e.forChild(i,a),s),i+=a.nodeSize}return}for(var c=0,l=[],u=null,h=0;;){if(c<o.length&&o[c].to==i){for(var p=o[c++],f=void 0;c<o.length&&o[c].to==i;)(f||(f=[p])).push(o[c++]);if(f){f.sort(uc);for(var d=0;d<f.length;d++)n(f[d],h)}else n(p,h)}var v=void 0,m=void 0;if(u)m=-1,v=u,u=null;else{if(!(h<t.childCount))break;m=h,v=t.child(h++)}for(var g=0;g<l.length;g++)l[g].to<=i&&l.splice(g--,1);for(;c<o.length&&o[c].from==i;)l.push(o[c++]);var y=i+v.nodeSize;if(v.isText){var b=y;c<o.length&&o[c].from<b&&(b=o[c].from);for(var w=0;w<l.length;w++)l[w].to<b&&(b=l[w].to);b<y&&(u=v.cut(b-i),v=v.cut(0,b-i),y=b,m=-1)}r(v,l.length?l.slice():Ha,e.forChild(i,v),m),i=y}}(this.node,this.innerDeco,(function(e,i){e.spec.marks?s.syncToMarks(e.spec.marks,r,t):e.type.side>=0&&s.syncToMarks(i==n.node.childCount?Ii.none:n.node.child(i).marks,r,t),s.placeWidget(e,t,o)}),(function(e,n,i,a){s.syncToMarks(e.marks,r,t),s.findNodeMatch(e,n,i,a)||s.updateNextNode(e,n,i,t,a)||s.addNode(e,n,i,t,o),o+=e.nodeSize})),s.syncToMarks(Ha,r,t),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||2==this.dirty)&&(i&&this.protectLocalComposition(t,i),this.renderChildren())},e.prototype.renderChildren=function(){!function t(e,n){for(var r=e.firstChild,o=0;o<n.length;o++){var i=n[o],s=i.dom;if(s.parentNode==e){for(;s!=r;)r=cc(r);r=r.nextSibling}else e.insertBefore(s,r);if(i instanceof Ga){var a=r?r.previousSibling:e.lastChild;t(i.contentDOM,i.children),r=a?a.nextSibling:e.firstChild}}for(;r;)r=cc(r)}(this.contentDOM,this.children),ua.ios&&function(t){if("UL"==t.nodeName||"OL"==t.nodeName){var e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}(this.dom)},e.prototype.localCompositionNode=function(t,e){var n=t.state.selection,r=n.from,o=n.to;if(!(!(t.state.selection instanceof i.TextSelection)||r<e||o>e+this.node.content.size)){var s=t.root.getSelection(),a=function(t,e){for(;;){if(3==t.nodeType)return t;if(1==t.nodeType&&e>0){if(t.childNodes.length>e&&3==t.childNodes[e].nodeType)return t.childNodes[e];t=t.childNodes[e-1],e=ka(t)}else{if(!(1==t.nodeType&&e<t.childNodes.length))return null;t=t.childNodes[e],e=0}}}(s.focusNode,s.focusOffset);if(a&&this.dom.contains(a.parentNode)){var c=a.nodeValue,l=function(t,e,n,r){for(var o="",i=0,s=0;i<t.childCount;i++){var a=t.child(i),c=s+a.nodeSize;if(a.isText){if(o+=a.text,c>=r){for(var l=c-o.length,u=o.lastIndexOf(e);u>-1&&l+u>n;)u=o.lastIndexOf(e,u-1);if(u>-1&&l+u+e.length>=r)return l+u;if(c>r)break}}else o="";s=c}return-1}(this.node.content,c,r-e,o-e);return l<0?null:{node:a,pos:l,text:c}}}},e.prototype.protectLocalComposition=function(t,e){var n=e.node,r=e.pos,o=e.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var s=new Ka(this,i,n,o);t.compositionNodes.push(s),this.children=hc(this.children,r,r+o.length,t,s)}},e.prototype.update=function(t,e,n,r){return!(3==this.dirty||!t.sameMarkup(this.node))&&(this.updateInner(t,e,n,r),!0)},e.prototype.updateInner=function(t,e,n,r){this.updateOuterDeco(e),this.node=t,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},e.prototype.updateOuterDeco=function(t){if(!ac(t,this.outerDeco)){var e=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=oc(this.dom,this.nodeDOM,rc(this.outerDeco,this.node,e),rc(t,this.node,e)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=t}},e.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},e.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!1)},Object.defineProperties(e.prototype,n),e}(Ja);function Xa(t,e,n,r,o){return sc(r,e,t),new Ya(null,t,e,n,r,r,r,o,0)}var Za=function(t){function e(e,n,r,o,i,s,a){t.call(this,e,n,r,o,i,null,s,a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{skip:this.nodeDOM.parentNode||!0}},e.prototype.update=function(t,e){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node))&&(this.updateOuterDeco(e),0==this.dirty&&t.text==this.node.text||t.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=t.text),this.node=t,this.dirty=0,!0)},e.prototype.inParent=function(){for(var t=this.parent.contentDOM,e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1},e.prototype.domFromPos=function(t){return{node:this.nodeDOM,offset:t}},e.prototype.localPosFromDOM=function(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):t.prototype.localPosFromDOM.call(this,e,n,r)},e.prototype.ignoreMutation=function(t){return"characterData"!=t.type&&"selection"!=t.type},e.prototype.slice=function(t,n,r){var o=this.node.cut(t,n),i=document.createTextNode(o.text);return new e(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},e}(Ya),Qa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.parseRule=function(){return{ignore:!0}},e.prototype.matchesHack=function(){return 0==this.dirty},e}(Ja),tc=function(t){function e(e,n,r,o,i,s,a,c,l,u){t.call(this,e,n,r,o,i,s,a,l,u),this.spec=c}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(e,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(e,n);return i&&this.updateInner(e,n,r,o),i}return!(!this.contentDOM&&!e.isLeaf)&&t.prototype.update.call(this,e,n,r,o)},e.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():t.prototype.selectNode.call(this)},e.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():t.prototype.deselectNode.call(this)},e.prototype.setSelection=function(e,n,r,o){this.spec.setSelection?this.spec.setSelection(e,n,r):t.prototype.setSelection.call(this,e,n,r,o)},e.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),t.prototype.destroy.call(this)},e.prototype.stopEvent=function(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)},e.prototype.ignoreMutation=function(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):t.prototype.ignoreMutation.call(this,e)},e}(Ya);function ec(t){t&&(this.nodeName=t)}ec.prototype=Object.create(null);var nc=[new ec];function rc(t,e,n){if(0==t.length)return nc;for(var r=n?nc[0]:new ec,o=[r],i=0;i<t.length;i++){var s=t[i].type.attrs,a=r;if(s)for(var c in s.nodeName&&o.push(a=new ec(s.nodeName)),s){var l=s[c];null!=l&&(n&&1==o.length&&o.push(a=r=new ec(e.isInline?"span":"div")),"class"==c?a.class=(a.class?a.class+" ":"")+l:"style"==c?a.style=(a.style?a.style+";":"")+l:"nodeName"!=c&&(a[c]=l))}}return o}function oc(t,e,n,r){if(n==nc&&r==nc)return e;for(var o=e,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=t&&(c=e.parentNode)&&c.tagName.toLowerCase()==s.nodeName||(c=document.createElement(s.nodeName)).appendChild(o),o=c}ic(o,a||nc[0],s)}return o}function ic(t,e,n){for(var r in e)"class"==r||"style"==r||"nodeName"==r||r in n||t.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=e[o]&&t.setAttribute(o,n[o]);if(e.class!=n.class){for(var i=e.class?e.class.split(" "):Ha,s=n.class?n.class.split(" "):Ha,a=0;a<i.length;a++)-1==s.indexOf(i[a])&&t.classList.remove(i[a]);for(var c=0;c<s.length;c++)-1==i.indexOf(s[c])&&t.classList.add(s[c])}if(e.style!=n.style){if(e.style)for(var l,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;l=u.exec(e.style);)t.style[l[1].toLowerCase()]="";n.style&&(t.style.cssText+=n.style)}}function sc(t,e,n){return oc(t,t,nc,rc(e,n,1!=t.nodeType))}function ac(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function cc(t){var e=t.nextSibling;return t.parentNode.removeChild(t),e}var lc=function(t,e){this.top=t,this.lock=e,this.index=0,this.stack=[],this.changed=!1;var n=function(t,e){for(var n=[],r=t.childCount,o=e.length-1;r>0&&o>=0;o--){var i=e[o],s=i.node;if(s){if(s!=t.child(r-1))break;n.push(i),--r}}return{nodes:n.reverse(),offset:r}}(t.node.content,t.children);this.preMatched=n.nodes,this.preMatchOffset=n.offset};function uc(t,e){return t.type.side-e.type.side}function hc(t,e,n,r,o){for(var i=[],s=0,a=0;s<t.length;s++){var c=t[s],l=a,u=a+=c.size;l>=n||u<=e?i.push(c):(l<e&&i.push(c.slice(0,e-l,r)),o&&(i.push(o),o=null),u>n&&i.push(c.slice(n-l,c.size,r)))}return i}function pc(t,e){var n=t.selection,r=n.$anchor,o=n.$head,s=e>0?r.max(o):r.min(o),a=s.parent.inlineContent?s.depth?t.doc.resolve(e>0?s.after():s.before()):null:s;return a&&i.Selection.findFrom(a,e)}function fc(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function dc(t,e,n){var r=t.state.selection;if(r instanceof i.TextSelection){if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){var o=pc(t.state,e);return!!(o&&o instanceof i.NodeSelection)&&fc(t,o)}var s,a=r.$head,c=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!c||c.isText)return!1;var l=e<0?a.pos-c.nodeSize:a.pos;return!!(c.isAtom||(s=t.docView.descAt(l))&&!s.contentDOM)&&(i.NodeSelection.isSelectable(c)?fc(t,new i.NodeSelection(e<0?t.state.doc.resolve(a.pos-c.nodeSize):a)):!!ua.webkit&&fc(t,new i.TextSelection(t.state.doc.resolve(e<0?l:l+c.nodeSize))))}if(r instanceof i.NodeSelection&&r.node.isInline)return fc(t,new i.TextSelection(e>0?r.$to:r.$from));var u=pc(t.state,e);return!!u&&fc(t,u)}function vc(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function mc(t){var e=t.pmViewDesc;return e&&0==e.size&&(t.nextSibling||"BR"!=t.nodeName)}function gc(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){var o,i,s=!1;for(ua.gecko&&1==n.nodeType&&r<vc(n)&&mc(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(mc(a))o=n,i=--r;else{if(3!=a.nodeType)break;r=(n=a).nodeValue.length}}else{if(bc(n))break;for(var c=n.previousSibling;c&&mc(c);)o=n.parentNode,i=ma(c),c=c.previousSibling;if(c)r=vc(n=c);else{if((n=n.parentNode)==t.dom)break;r=0}}s?wc(t,e,n,r):o&&wc(t,e,o,i)}}function yc(t){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n){for(var o,i,s=vc(n);;)if(r<s){if(1!=n.nodeType)break;if(!mc(n.childNodes[r]))break;o=n,i=++r}else{if(bc(n))break;for(var a=n.nextSibling;a&&mc(a);)o=a.parentNode,i=ma(a)+1,a=a.nextSibling;if(a)r=0,s=vc(n=a);else{if((n=n.parentNode)==t.dom)break;r=s=0}}o&&wc(t,e,o,i)}}function bc(t){var e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function wc(t,e,n,r){if(Ca(e)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),e.removeAllRanges(),e.addRange(o)}else e.extend&&e.extend(n,r);t.domObserver.setCurSelection()}function xc(t,e,n){var r=t.state.selection;if(r instanceof i.TextSelection&&!r.empty||n.indexOf("s")>-1)return!1;var o=r.$from,s=r.$to;if(!o.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){var a=pc(t.state,e);if(a&&a instanceof i.NodeSelection)return fc(t,a)}if(!o.parent.inlineContent){var c=i.Selection.findFrom(e<0?o:s,e);return!c||fc(t,c)}return!1}function kc(t,e){if(!(t.state.selection instanceof i.TextSelection))return!0;var n=t.state.selection,r=n.$head,o=n.$anchor,s=n.empty;if(!r.sameParent(o))return!0;if(!s)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;var a=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){var c=t.state.tr;return e<0?c.delete(r.pos-a.nodeSize,r.pos):c.delete(r.pos,r.pos+a.nodeSize),t.dispatch(c),!0}return!1}function Sc(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function Cc(t,e){var n=e.keyCode,r=function(t){var e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}(e);return 8==n||ua.mac&&72==n&&"c"==r?kc(t,-1)||gc(t):46==n||ua.mac&&68==n&&"c"==r?kc(t,1)||yc(t):13==n||27==n||(37==n?dc(t,-1,r)||gc(t):39==n?dc(t,1,r)||yc(t):38==n?xc(t,-1,r)||gc(t):40==n?function(t){if(ua.chrome&&!(t.state.selection.$head.parentOffset>0)){var e=t.root.getSelection(),n=e.focusNode,r=e.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;Sc(t,o,!0),setTimeout((function(){return Sc(t,o,!1)}),20)}}}(t)||xc(t,1,r)||yc(t):r==(ua.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function Oc(t,e){var n=t.state.selection;if(Tc(t,n),t.editable?t.hasFocus():Dc(t)&&document.activeElement.contains(t.dom)){if(t.domObserver.disconnectSelection(),t.cursorWrapper)!function(t){var e=t.root.getSelection(),n=document.createRange(),r=t.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,ma(r)+1):n.setEnd(r,0);n.collapse(!1),e.removeAllRanges(),e.addRange(n),!o&&!t.state.selection.visible&&ua.ie&&ua.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(t);else{var r,o,s=n.anchor,a=n.head;!Nc||n instanceof i.TextSelection||(n.$from.parent.inlineContent||(r=Mc(t,n.from)),n.empty||n.$from.parent.inlineContent||(o=Mc(t,n.to))),t.docView.setSelection(s,a,t.root,e),Nc&&(r&&(r.contentEditable="false"),o&&(o.contentEditable="false")),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):s!=a&&(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(t){var e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.hideSelectionGuard);var n=t.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;e.addEventListener("selectionchange",t.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(e.removeEventListener("selectionchange",t.hideSelectionGuard),t.dom.classList.remove("ProseMirror-hideselection"))})}(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}lc.prototype.getPreMatch=function(t){return t>=this.preMatchOffset?this.preMatched[t-this.preMatchOffset]:null},lc.prototype.destroyBetween=function(t,e){if(t!=e){for(var n=t;n<e;n++)this.top.children[n].destroy();this.top.children.splice(t,e-t),this.changed=!0}},lc.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},lc.prototype.syncToMarks=function(t,e,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,t.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(t[r])&&!1!==t[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var s=-1,a=this.index;a<Math.min(this.index+3,this.top.children.length);a++)if(this.top.children[a].matchesMark(t[o])){s=a;break}if(s>-1)s>this.index&&(this.changed=!0,this.destroyBetween(this.index,s)),this.top=this.top.children[this.index];else{var c=Ga.create(this.top,t[o],e,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,o++}},lc.prototype.findNodeMatch=function(t,e,n,r){var o=-1,i=r<0?void 0:this.getPreMatch(r),s=this.top.children;if(i&&i.matchesNode(t,e,n))o=s.indexOf(i);else for(var a=this.index,c=Math.min(s.length,a+5);a<c;a++){var l=s[a];if(l.matchesNode(t,e,n)&&this.preMatched.indexOf(l)<0){o=a;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)},lc.prototype.updateNextNode=function(t,e,n,r,o){if(this.index==this.top.children.length)return!1;var i=this.top.children[this.index];if(i instanceof Ya){var s=this.preMatched.indexOf(i);if(s>-1&&s+this.preMatchOffset!=o)return!1;var a=i.dom;if(!(this.lock&&(a==this.lock||1==a.nodeType&&a.contains(this.lock.parentNode))&&!(t.isText&&i.node&&i.node.isText&&i.nodeDOM.nodeValue==t.text&&3!=i.dirty&&ac(e,i.outerDeco)))&&i.update(t,e,n,r))return i.dom!=a&&(this.changed=!0),this.index++,!0}return!1},lc.prototype.addNode=function(t,e,n,r,o){this.top.children.splice(this.index++,0,Ya.create(this.top,t,e,n,r,o)),this.changed=!0},lc.prototype.placeWidget=function(t,e,n){if(this.index<this.top.children.length&&this.top.children[this.index].matchesWidget(t))this.index++;else{var r=new Ua(this.top,t,e,n);this.top.children.splice(this.index++,0,r),this.changed=!0}},lc.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof Ga;)t=t.children[t.children.length-1];if(!t||!(t instanceof Za)||/\n$/.test(t.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var e=document.createElement("br");this.top.children.splice(this.index++,0,new Qa(this.top,Ha,e,null)),this.changed=!0}};var Nc=ua.safari||ua.chrome&&ua.chrome_version<63;function Mc(t,e){var n=t.docView.domFromPos(e),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return i.contentEditable="true",i;if(s)return s.contentEditable="true",s}}function Tc(t,e){if(e instanceof i.NodeSelection){var n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Ac(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Ac(t)}function Ac(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=null)}function Ec(t,e,n,r){return t.someProp("createSelectionBetween",(function(r){return r(t,e,n)}))||i.TextSelection.between(e,n,r)}function Dc(t){var e=t.root.getSelection();if(!e.anchorNode)return!1;try{return t.dom.contains(3==e.anchorNode.nodeType?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(3==e.focusNode.nodeType?e.focusNode.parentNode:e.focusNode))}catch(t){return!1}}function Pc(t,e){return function(n){var r=n.pmViewDesc;if(r)return r.parseRule();if("BR"==n.nodeName&&n.parentNode){if(ua.safari&&/^(ul|ol)$/i.test(n.parentNode.nodeName))return t.matchTag(document.createElement("li"),e);if(n.parentNode.lastChild==n||ua.safari&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0}}}function Ic(t,e,n,r){if(e<0){var o=t.lastSelectionTime>Date.now()-50?t.lastSelectionOrigin:null,s=function(t,e){var n,r,o=t.root.getSelection(),s=t.state.doc,a=t.docView.nearestDesc(o.focusNode),c=a&&0==a.size,l=t.docView.posFromDOM(o.focusNode,o.focusOffset),u=s.resolve(l);if(Ca(o)){for(n=u;a&&!a.node;)a=a.parent;if(a&&a.node.isAtom&&i.NodeSelection.isSelectable(a.node)&&a.parent){var h=a.posBefore;r=new i.NodeSelection(l==h?u:s.resolve(h))}}else n=s.resolve(t.docView.posFromDOM(o.anchorNode,o.anchorOffset));return r||(r=Ec(t,n,u,"pointer"==e||t.state.selection.head<u.pos&&!c?1:-1)),r}(t,o);if(!t.state.selection.eq(s)){var a=t.state.tr.setSelection(s);"pointer"==o?a.setMeta("pointer",!0):"key"==o&&a.scrollIntoView(),t.dispatch(a)}}else{var c=t.state.doc.resolve(e),l=c.sharedDepth(n);e=c.before(l+1),n=t.state.doc.resolve(n).after(l+1);var u,h,p=t.state.selection,f=function(t,e,n){var r=t.docView.parseRange(e,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,l=t.root.getSelection(),u=null,h=l.anchorNode;if(h&&t.dom.contains(1==h.nodeType?h:h.parentNode)&&(u=[{node:h,offset:l.anchorOffset}],Ca(l)||u.push({node:l.focusNode,offset:l.focusOffset})),ua.chrome&&8===t.lastKeyCode)for(var p=s;p>i;p--){var f=o.childNodes[p-1],d=f.pmViewDesc;if("BR"==f.nodeType&&!d){s=p;break}if(!d||d.size)break}var v=t.state.doc,m=t.someProp("domParser")||Cs.fromSchema(t.state.schema),g=v.resolve(a),y=null,b=m.parse(o,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!g.parent.type.spec.code||"full",editableContent:!0,findPositions:u,ruleFromNode:Pc(m,g),context:g});if(u&&null!=u[0].pos){var w=u[0].pos,x=u[1]&&u[1].pos;null==x&&(x=w),y={anchor:w+a,head:x+a}}return{doc:b,sel:y,from:a,to:c}}(t,e,n),d=t.state.doc,v=d.slice(f.from,f.to);8===t.lastKeyCode&&Date.now()-100<t.lastKeyCodeTime?(u=t.state.selection.to,h="end"):(u=t.state.selection.from,h="start"),t.lastKeyCode=null;var m=function(t,e,n,r,o){var i=t.findDiffStart(e,n);if(null==i)return null;var s=t.findDiffEnd(e,n+t.size,n+e.size),a=s.a,c=s.b;if("end"==o){var l=Math.max(0,i-Math.min(a,c));r-=a+l-i}if(a<i&&t.size<e.size){c=(i-=r<=i&&r>=a?i-r:0)+(c-a),a=i}else if(c<i){a=(i-=r<=i&&r>=c?i-r:0)+(a-c),c=i}return{start:i,endA:a,endB:c}}(v.content,f.doc.content,f.from,u,h);if(!m){if(!(r&&p instanceof i.TextSelection&&!p.empty&&p.$head.sameParent(p.$anchor))||t.composing||f.sel&&f.sel.anchor!=f.sel.head){if(f.sel){var g=Rc(t,t.state.doc,f.sel);g&&!g.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(g))}return}m={start:p.from,endA:p.to,endB:p.to}}t.domChangeCount++,t.state.selection.from<t.state.selection.to&&m.start==m.endB&&t.state.selection instanceof i.TextSelection&&(m.start>t.state.selection.from&&m.start<=t.state.selection.from+2?m.start=t.state.selection.from:m.endA<t.state.selection.to&&m.endA>=t.state.selection.to-2&&(m.endB+=t.state.selection.to-m.endA,m.endA=t.state.selection.to)),ua.ie&&ua.ie_version<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>f.from&&" "==f.doc.textBetween(m.start-f.from-1,m.start-f.from+1)&&(m.start--,m.endA--,m.endB--);var y,b=f.doc.resolveNoCache(m.start-f.from),w=f.doc.resolveNoCache(m.endB-f.from);if(!(!b.sameParent(w)&&b.pos<f.doc.content.size&&(y=i.Selection.findFrom(f.doc.resolve(b.pos+1),1,!0))&&y.head==w.pos&&t.someProp("handleKeyDown",(function(e){return e(t,Oa(13,"Enter"))}))))if(t.state.selection.anchor>m.start&&function(t,e,n,r,o){if(!r.parent.isTextblock||n-e<=o.pos-r.pos||zc(r,!0,!1)<o.pos)return!1;var i=t.resolve(e);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=t.resolve(zc(i,!0,!0));if(!s.parent.isTextblock||s.pos>n||zc(s,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(d,m.start,m.endA,b,w)&&t.someProp("handleKeyDown",(function(e){return e(t,Oa(8,"Backspace"))})))ua.android&&ua.chrome&&t.domObserver.suppressSelectionUpdates();else{var x,k,S,C,O=m.start,N=m.endA;if(b.sameParent(w)&&b.parent.inlineContent)if(b.pos==w.pos)ua.ie&&ua.ie_version<=11&&0==b.parentOffset&&(t.domObserver.suppressSelectionUpdates(),setTimeout((function(){return Oc(t)}),20)),x=t.state.tr.delete(O,N),k=d.resolve(m.start).marksAcross(d.resolve(m.endA));else if(m.endA==m.endB&&(C=d.resolve(m.start))&&(S=function(t,e){for(var n,r,o,i=t.firstChild.marks,s=e.firstChild.marks,a=i,c=s,l=0;l<s.length;l++)a=s[l].removeFromSet(a);for(var u=0;u<i.length;u++)c=i[u].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(t){return t.mark(r.addToSet(t.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(t){return t.mark(r.removeFromSet(t.marks))}}for(var h=[],p=0;p<e.childCount;p++)h.push(o(e.child(p)));if(Ti.from(h).eq(t))return{mark:r,type:n}}(b.parent.content.cut(b.parentOffset,w.parentOffset),C.parent.content.cut(C.parentOffset,m.endA-C.start()))))x=t.state.tr,"add"==S.type?x.addMark(O,N,S.mark):x.removeMark(O,N,S.mark);else if(b.parent.child(b.index()).isText&&b.index()==w.index()-(w.textOffset?0:1)){var M=b.parent.textBetween(b.parentOffset,w.parentOffset);if(t.someProp("handleTextInput",(function(e){return e(t,O,N,M)})))return;x=t.state.tr.insertText(M,O,N)}if(x||(x=t.state.tr.replace(O,N,f.doc.slice(m.start-f.from,m.endB-f.from))),f.sel){var T=Rc(t,x.doc,f.sel);T&&!(ua.chrome&&ua.android&&t.composing&&T.empty&&T.head==O||ua.ie&&T.empty&&T.head==O)&&x.setSelection(T)}k&&x.ensureMarks(k),t.dispatch(x.scrollIntoView())}}}function Rc(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Ec(t,e.resolve(n.anchor),e.resolve(n.head))}function zc(t,e,n){for(var r=t.depth,o=e?t.end():t.pos;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,o++,e=!1;if(n)for(var i=t.node(r).maybeChild(t.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function _c(t,e){for(var n=[],r=e.content,o=e.openStart,i=e.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.type.hasRequiredAttrs()?s.attrs:null),r=s.content}var a=t.someProp("clipboardSerializer")||zs.fromSchema(t.state.schema),c=Lc(),l=c.createElement("div");l.appendChild(a.serializeFragment(r,{document:c}));for(var u,h=l.firstChild;h&&1==h.nodeType&&(u=Fc[h.nodeName.toLowerCase()]);){for(var p=u.length-1;p>=0;p--){for(var f=c.createElement(u[p]);l.firstChild;)f.appendChild(l.firstChild);l.appendChild(f)}h=l.firstChild}return h&&1==h.nodeType&&h.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:l,text:t.someProp("clipboardTextSerializer",(function(t){return t(e)}))||e.content.textBetween(0,e.content.size,"\n\n")}}function $c(t,e,n,r,o){var i,s,a=o.parent.type.spec.code;if(!n&&!e)return null;var c=e&&(r||a||!n);if(c){if(t.someProp("transformPastedText",(function(t){e=t(e)})),a)return new zi(Ti.from(t.state.schema.text(e)),0,0);var l=t.someProp("clipboardTextParser",(function(t){return t(e,o)}));l?s=l:(i=document.createElement("div"),e.trim().split(/(?:\r\n?|\n)+/).forEach((function(t){i.appendChild(document.createElement("p")).textContent=t})))}else t.someProp("transformPastedHTML",(function(t){n=t(n)})),i=function(t){var e=/(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));var n,r=Lc().createElement("div"),o=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(t),i=0;(n=o&&Fc[o[1].toLowerCase()])&&(t=n.map((function(t){return"<"+t+">"})).join("")+t+n.map((function(t){return"</"+t+">"})).reverse().join(""),i=n.length);r.innerHTML=t;for(var s=0;s<i;s++)r=r.firstChild;return r}(n);var u=i&&i.querySelector("[data-pm-slice]"),h=u&&/^(\d+) (\d+) (.*)/.exec(u.getAttribute("data-pm-slice"));if(!s){var p=t.someProp("clipboardParser")||t.someProp("domParser")||Cs.fromSchema(t.state.schema);s=p.parseSlice(i,{preserveWhitespace:!(!c&&!h),context:o})}return s=h?function(t,e){if(!t.size)return t;var n,r=t.content.firstChild.type.schema;try{n=JSON.parse(e)}catch(e){return t}for(var o=t.content,i=t.openStart,s=t.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=Ti.from(c.create(n[a+1],o)),i++,s++}return new zi(o,i,s)}(function(t,e,n){e<t.openStart&&(t=new zi(jc(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd));n<t.openEnd&&(t=new zi(jc(t.content,1,n,t.openEnd,0,0),t.openStart,n));return t}(s,+h[1],+h[2]),h[3]):zi.maxOpen(function(t,e){if(t.childCount<2)return t;for(var n=function(n){var r=e.node(n).contentMatchAt(e.index(n)),o=void 0,i=[];if(t.forEach((function(t){if(i){var e,n=r.findWrapping(t.type);if(!n)return i=null;if(e=i.length&&o.length&&function t(e,n,r,o,i){if(i<e.length&&i<n.length&&e[i]==n[i]){var s=t(e,n,r,o.lastChild,i+1);if(s)return o.copy(o.content.replaceChild(o.childCount-1,s));if(o.contentMatchAt(o.childCount).matchType(i==e.length-1?r.type:e[i+1]))return o.copy(o.content.append(Ti.from(Bc(r,e,i+1))))}}(n,o,t,i[i.length-1],0))i[i.length-1]=e;else{i.length&&(i[i.length-1]=function t(e,n){if(0==n)return e;var r=e.content.replaceChild(e.childCount-1,t(e.lastChild,n-1)),o=e.contentMatchAt(e.childCount).fillBefore(Ti.empty,!0);return e.copy(r.append(o))}(i[i.length-1],o.length));var s=Bc(t,n);i.push(s),r=r.matchType(s.type,s.attrs),o=n}}})),i)return{v:Ti.from(i)}},r=e.depth;r>=0;r--){var o=n(r);if(o)return o.v}return t}(s.content,o),!1),t.someProp("transformPasted",(function(t){s=t(s)})),s}function Bc(t,e,n){void 0===n&&(n=0);for(var r=e.length-1;r>=n;r--)t=e[r].create(null,Ti.from(t));return t}function jc(t,e,n,r,o,i){var s=e<0?t.firstChild:t.lastChild,a=s.content;return o<r-1&&(a=jc(a,e,n,r,o+1,i)),o>=n&&(a=e<0?s.contentMatchAt(0).fillBefore(a,t.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(Ti.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(a))}var Fc={thead:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Vc=null;function Lc(){return Vc||(Vc=document.implementation.createHTMLDocument("title"))}var qc={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Jc=ua.ie&&ua.ie_version<=11,Wc=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Wc.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},Wc.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var Hc=function(t,e){var n=this;this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=!1,this.observer=window.MutationObserver&&new window.MutationObserver((function(t){for(var e=0;e<t.length;e++)n.queue.push(t[e]);ua.ie&&ua.ie_version<=11&&t.some((function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new Wc,Jc&&(this.onCharData=function(t){n.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Hc.prototype.flushSoon=function(){var t=this;this.flushingSoon||(this.flushingSoon=!0,window.setTimeout((function(){t.flushingSoon=!1,t.flush()}),20))},Hc.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,qc),Jc&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Hc.prototype.stop=function(){var t=this;if(this.observer){var e=this.observer.takeRecords();if(e.length){for(var n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout((function(){return t.flush()}),20)}this.observer.disconnect()}Jc&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Hc.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Hc.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Hc.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return t.suppressingSelectionUpdates=!1}),50)},Hc.prototype.onSelectionChange=function(){if((!(t=this.view).editable||t.root.activeElement==t.dom)&&Dc(t)){var t;if(this.suppressingSelectionUpdates)return Oc(this.view);if(ua.ie&&ua.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&ba(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}},Hc.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Hc.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var e=t.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(e);return n&&n.ignoreMutation({type:"selection",target:3==e.nodeType?e.parentNode:e})},Hc.prototype.flush=function(){if(this.view.docView&&!this.flushingSoon){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var e=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&Dc(this.view)&&!this.ignoreSelectionChange(e),r=-1,o=-1,i=!1,s=[];if(this.view.editable)for(var a=0;a<t.length;a++){var c=this.registerMutation(t[a],s);c&&(r=r<0?c.from:Math.min(c.from,r),o=o<0?c.to:Math.max(c.to,o),c.typeOver&&!this.view.composing&&(i=!0))}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(t){if(Uc)return;Uc=!0,"normal"==getComputedStyle(t.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(e)||Oc(this.view))}},Hc.prototype.registerMutation=function(t,e){if(e.indexOf(t.target)>-1)return null;var n=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(n==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(t))return null;if("childList"==t.type){var r=t.previousSibling,o=t.nextSibling;if(ua.ie&&ua.ie_version<=11&&t.addedNodes.length)for(var i=0;i<t.addedNodes.length;i++){var s=t.addedNodes[i],a=s.previousSibling,c=s.nextSibling;(!a||Array.prototype.indexOf.call(t.addedNodes,a)<0)&&(r=a),(!c||Array.prototype.indexOf.call(t.addedNodes,c)<0)&&(o=c)}for(var l=r&&r.parentNode==t.target?ma(r)+1:0,u=n.localPosFromDOM(t.target,l,-1),h=o&&o.parentNode==t.target?ma(o):t.target.childNodes.length,p=0;p<t.addedNodes.length;p++)e.push(t.addedNodes[p]);return{from:u,to:n.localPosFromDOM(t.target,h,1)}}return"attributes"==t.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var Uc=!1;var Kc={},Gc={};function Yc(t,e){t.lastSelectionOrigin=e,t.lastSelectionTime=Date.now()}function Xc(t){t.someProp("handleDOMEvents",(function(e){for(var n in e)t.eventHandlers[n]||t.dom.addEventListener(n,t.eventHandlers[n]=function(e){return Zc(t,e)})}))}function Zc(t,e){return t.someProp("handleDOMEvents",(function(n){var r=n[e.type];return!!r&&(r(t,e)||e.defaultPrevented)}))}function Qc(t){return{left:t.clientX,top:t.clientY}}function tl(t,e,n,r,o){if(-1==r)return!1;for(var i=t.state.doc.resolve(r),s=function(r){if(t.someProp(e,(function(e){return r>i.depth?e(t,n,i.nodeAfter,i.before(r),o,!0):e(t,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function el(t,e,n){t.focused||t.focus();var r=t.state.tr.setSelection(e);"pointer"==n&&r.setMeta("pointer",!0),t.dispatch(r)}function nl(t,e,n,r,o){return tl(t,"handleClickOn",e,n,r)||t.someProp("handleClick",(function(n){return n(t,e,r)}))||(o?function(t,e){if(-1==e)return!1;var n,r,o=t.state.selection;o instanceof i.NodeSelection&&(n=o.node);for(var s=t.state.doc.resolve(e),a=s.depth+1;a>0;a--){var c=a>s.depth?s.nodeAfter:s.node(a);if(i.NodeSelection.isSelectable(c)){r=n&&o.$from.depth>0&&a>=o.$from.depth&&s.before(o.$from.depth+1)==o.$from.pos?s.before(o.$from.depth):s.before(a);break}}return null!=r&&(el(t,i.NodeSelection.create(t.state.doc,r),"pointer"),!0)}(t,n):function(t,e){if(-1==e)return!1;var n=t.state.doc.resolve(e),r=n.nodeAfter;return!!(r&&r.isAtom&&i.NodeSelection.isSelectable(r))&&(el(t,new i.NodeSelection(n),"pointer"),!0)}(t,n))}function rl(t,e,n,r){return tl(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",(function(n){return n(t,e,r)}))}function ol(t,e,n,r){return tl(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",(function(n){return n(t,e,r)}))||function(t,e){var n=t.state.doc;if(-1==e)return!!n.inlineContent&&(el(t,i.TextSelection.create(n,0,n.content.size),"pointer"),!0);for(var r=n.resolve(e),o=r.depth+1;o>0;o--){var s=o>r.depth?r.nodeAfter:r.node(o),a=r.before(o);if(s.inlineContent)el(t,i.TextSelection.create(n,a+1,a+1+s.content.size),"pointer");else{if(!i.NodeSelection.isSelectable(s))continue;el(t,i.NodeSelection.create(n,a),"pointer")}return!0}}(t,n)}function il(t){return hl(t)}Gc.keydown=function(t,e){t.shiftKey=16==e.keyCode||e.shiftKey,cl(t,e)||(t.lastKeyCode=e.keyCode,t.lastKeyCodeTime=Date.now(),t.someProp("handleKeyDown",(function(n){return n(t,e)}))||Cc(t,e)?e.preventDefault():Yc(t,"key"))},Gc.keyup=function(t,e){16==e.keyCode&&(t.shiftKey=!1)},Gc.keypress=function(t,e){if(!(cl(t,e)||!e.charCode||e.ctrlKey&&!e.altKey||ua.mac&&e.metaKey))if(t.someProp("handleKeyPress",(function(n){return n(t,e)})))e.preventDefault();else{var n=t.state.selection;if(!(n instanceof i.TextSelection&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(e.charCode);t.someProp("handleTextInput",(function(e){return e(t,n.$from.pos,n.$to.pos,r)}))||t.dispatch(t.state.tr.insertText(r).scrollIntoView()),e.preventDefault()}}};var sl=ua.mac?"metaKey":"ctrlKey";Kc.mousedown=function(t,e){t.shiftKey=e.shiftKey;var n=il(t),r=Date.now(),o="singleClick";r-t.lastClick.time<500&&function(t,e){var n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}(e,t.lastClick)&&!e[sl]&&("singleClick"==t.lastClick.type?o="doubleClick":"doubleClick"==t.lastClick.type&&(o="tripleClick")),t.lastClick={time:r,x:e.clientX,y:e.clientY,type:o};var i=t.posAtCoords(Qc(e));i&&("singleClick"==o?t.mouseDown=new al(t,i,e,n):("doubleClick"==o?rl:ol)(t,i.pos,i.inside,e)?e.preventDefault():Yc(t,"pointer"))};var al=function(t,e,n,r){var o,s,a=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=e,this.event=n,this.flushed=r,this.selectNode=n[sl],this.allowDefault=n.shiftKey,e.inside>-1)o=t.state.doc.nodeAt(e.inside),s=e.inside;else{var c=t.state.doc.resolve(e.pos);o=c.parent,s=c.depth?c.before():0}this.mightDrag=null;var l=r?null:n.target,u=l?t.docView.nearestDesc(l,!0):null;this.target=u?u.dom:null,(o.type.spec.draggable&&!1!==o.type.spec.selectable||t.state.selection instanceof i.NodeSelection&&s==t.state.selection.from)&&(this.mightDrag={node:o,pos:s,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&ua.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){return a.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Yc(t,"pointer")};function cl(t,e){return!!t.composing||!!(ua.safari&&Math.abs(e.timeStamp-t.compositionEndedAt)<500)&&(t.compositionEndedAt=-2e8,!0)}al.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!1),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},al.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Qc(t))),this.allowDefault||!e?Yc(this.view,"pointer"):nl(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():!this.flushed&&(!ua.chrome||this.view.state.selection instanceof i.TextSelection||e.pos!=this.view.state.selection.from&&e.pos!=this.view.state.selection.to)?Yc(this.view,"pointer"):(el(this.view,i.Selection.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault())}},al.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),Yc(this.view,"pointer")},Kc.touchdown=function(t){il(t),Yc(t,"pointer")},Kc.contextmenu=function(t){return il(t)};var ll=ua.android?5e3:-1;function ul(t,e){clearTimeout(t.composingTimeout),e>-1&&(t.composingTimeout=setTimeout((function(){return hl(t)}),e))}function hl(t,e){for(t.composing=!1;t.compositionNodes.length>0;)t.compositionNodes.pop().markParentsDirty();return!(!e&&!t.docView.dirty)&&(t.updateState(t.state),!0)}Gc.compositionstart=Gc.compositionupdate=function(t){if(!t.composing){t.domObserver.flush();var e=t.state,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(t){return!1===t.type.spec.inclusive}))))t.markCursor=t.state.storedMarks||n.marks(),hl(t,!0),t.markCursor=null;else if(hl(t),ua.gecko&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=t.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}t.composing=!0}ul(t,ll)},Gc.compositionend=function(t,e){t.composing&&(t.composing=!1,t.compositionEndedAt=e.timeStamp,ul(t,20))};var pl=ua.ie&&ua.ie_version<15||ua.ios&&ua.webkit_version<604;function fl(t,e,n,r){var o=$c(t,e,n,t.shiftKey,t.state.selection.$from);if(!t.someProp("handlePaste",(function(e){return e(t,r,o||zi.empty)}))&&o){var i=function(t){return 0==t.openStart&&0==t.openEnd&&1==t.content.childCount?t.content.firstChild:null}(o),s=i?t.state.tr.replaceSelectionWith(i,t.shiftKey):t.state.tr.replaceSelection(o);t.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste"))}}Kc.copy=Gc.cut=function(t,e){var n=t.state.selection,r="cut"==e.type;if(!n.empty){var o=pl?null:e.clipboardData,i=_c(t,n.content()),s=i.dom,a=i.text;o?(e.preventDefault(),o.clearData(),o.setData("text/html",s.innerHTML),o.setData("text/plain",a)):function(t,e){var n=t.dom.ownerDocument,r=n.body.appendChild(n.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";var o=getSelection(),i=n.createRange();i.selectNodeContents(e),t.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout((function(){n.body.removeChild(r),t.focus()}),50)}(t,s),r&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},Gc.paste=function(t,e){var n=pl?null:e.clipboardData,r=n&&n.getData("text/html"),o=n&&n.getData("text/plain");n&&(r||o||n.files.length)?(fl(t,o,r,e),e.preventDefault()):function(t,e){var n=t.dom.ownerDocument,r=t.shiftKey||t.state.selection.$from.parent.type.spec.code,o=n.body.appendChild(n.createElement(r?"textarea":"div"));r||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout((function(){t.focus(),n.body.removeChild(o),r?fl(t,o.value,null,e):fl(t,o.textContent,o.innerHTML,e)}),50)}(t,e)};var dl=function(t,e){this.slice=t,this.move=e},vl=ua.mac?"altKey":"ctrlKey";for(var ml in Kc.dragstart=function(t,e){var n=t.mouseDown;if(n&&n.done(),e.dataTransfer){var r=t.state.selection,o=r.empty?null:t.posAtCoords(Qc(e));if(o&&o.pos>=r.from&&o.pos<=(r instanceof i.NodeSelection?r.to-1:r.to));else if(n&&n.mightDrag)t.dispatch(t.state.tr.setSelection(i.NodeSelection.create(t.state.doc,n.mightDrag.pos)));else if(e.target&&1==e.target.nodeType){var s=t.docView.nearestDesc(e.target,!0);if(!s||!s.node.type.spec.draggable||s==t.docView)return;t.dispatch(t.state.tr.setSelection(i.NodeSelection.create(t.state.doc,s.posBefore)))}var a=t.state.selection.content(),c=_c(t,a),l=c.dom,u=c.text;e.dataTransfer.clearData(),e.dataTransfer.setData(pl?"Text":"text/html",l.innerHTML),pl||e.dataTransfer.setData("text/plain",u),t.dragging=new dl(a,!e[vl])}},Kc.dragend=function(t){window.setTimeout((function(){return t.dragging=null}),50)},Gc.dragover=Gc.dragenter=function(t,e){return e.preventDefault()},Gc.drop=function(t,e){var n=t.dragging;if(t.dragging=null,e.dataTransfer){var r=t.posAtCoords(Qc(e));if(r){var o=t.state.doc.resolve(r.pos);if(o){var s=n&&n.slice||$c(t,e.dataTransfer.getData(pl?"Text":"text/plain"),pl?null:e.dataTransfer.getData("text/html"),!1,o);if(s&&(e.preventDefault(),!t.someProp("handleDrop",(function(r){return r(t,e,s,n&&n.move)})))){var a=s?function(t,e,n){var r=t.resolve(e);if(!n.content.size)return e;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,l=r.index(a)+(c>0?1:0);if(1==s?r.node(a).canReplace(l,l,o):r.node(a).contentMatchAt(l).findWrapping(o.firstChild.type))return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}(t.state.doc,o.pos,s):o.pos;null==a&&(a=o.pos);var c=t.state.tr;n&&n.move&&c.deleteSelection();var l=c.mapping.map(a),u=0==s.openStart&&0==s.openEnd&&1==s.content.childCount,h=c.doc;if(u?c.replaceRangeWith(l,l,s.content.firstChild):c.replaceRange(l,l,s),!c.doc.eq(h)){var p=c.doc.resolve(l);u&&i.NodeSelection.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild)?c.setSelection(new i.NodeSelection(p)):c.setSelection(Ec(t,p,c.doc.resolve(c.mapping.map(a)))),t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))}}}}}},Kc.focus=function(t){t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0)},Kc.blur=function(t){t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),t.domObserver.currentSelection.set({}),t.focused=!1)},Kc.beforeinput=function(t,e){if(ua.chrome&&ua.android&&"deleteContentBackward"==e.inputType){var n=t.domChangeCount;setTimeout((function(){if(t.domChangeCount==n&&(t.dom.blur(),t.focus(),!t.someProp("handleKeyDown",(function(e){return e(t,Oa(8,"Backspace"))})))){var e=t.state.selection.$cursor;e&&e.pos>0&&t.dispatch(t.state.tr.delete(e.pos-1,e.pos).scrollIntoView())}}),50)}},Gc)Kc[ml]=Gc[ml];function gl(t,e){if(t==e)return!0;for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(!(r in t))return!1;return!0}var yl=function(t,e){this.spec=e||Cl,this.side=this.spec.side||0,this.toDOM=t};yl.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new xl(i-n,i-n,this)},yl.prototype.valid=function(){return!0},yl.prototype.eq=function(t){return this==t||t instanceof yl&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&gl(this.spec,t.spec))};var bl=function(t,e){this.spec=e||Cl,this.attrs=t};bl.prototype.map=function(t,e,n,r){var o=t.map(e.from+r,this.spec.inclusiveStart?-1:1)-n,i=t.map(e.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new xl(o,i,this)},bl.prototype.valid=function(t,e){return e.from<e.to},bl.prototype.eq=function(t){return this==t||t instanceof bl&&gl(this.attrs,t.attrs)&&gl(this.spec,t.spec)},bl.is=function(t){return t.type instanceof bl};var wl=function(t,e){this.spec=e||Cl,this.attrs=t};wl.prototype.map=function(t,e,n,r){var o=t.mapResult(e.from+r,1);if(o.deleted)return null;var i=t.mapResult(e.to+r,-1);return i.deleted||i.pos<=o.pos?null:new xl(o.pos-n,i.pos-n,this)},wl.prototype.valid=function(t,e){var n=t.content.findIndex(e.from),r=n.index,o=n.offset;return o==e.from&&o+t.child(r).nodeSize==e.to},wl.prototype.eq=function(t){return this==t||t instanceof wl&&gl(this.attrs,t.attrs)&&gl(this.spec,t.spec)};var xl=function(t,e,n){this.from=t,this.to=e,this.type=n},kl={spec:{configurable:!0}};xl.prototype.copy=function(t,e){return new xl(t,e,this.type)},xl.prototype.eq=function(t){return this.type.eq(t.type)&&this.from==t.from&&this.to==t.to},xl.prototype.map=function(t,e,n){return this.type.map(t,this,e,n)},xl.widget=function(t,e,n){return new xl(t,t,new yl(e,n))},xl.inline=function(t,e,n,r){return new xl(t,e,new bl(n,r))},xl.node=function(t,e,n,r){return new xl(t,e,new wl(n,r))},kl.spec.get=function(){return this.type.spec},Object.defineProperties(xl.prototype,kl);var Sl=[],Cl={},Ol=function(t,e){this.local=t&&t.length?t:Sl,this.children=e&&e.length?e:Sl};Ol.create=function(t,e){return e.length?Dl(e,t,0,Cl):Nl},Ol.prototype.find=function(t,e,n){var r=[];return this.findInner(null==t?0:t,null==e?1e9:e,r,0,n),r},Ol.prototype.findInner=function(t,e,n,r,o){for(var i=0;i<this.local.length;i++){var s=this.local[i];s.from<=e&&s.to>=t&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(var a=0;a<this.children.length;a+=3)if(this.children[a]<e&&this.children[a+1]>t){var c=this.children[a]+1;this.children[a+2].findInner(t-c,e-c,n,r+c,o)}},Ol.prototype.map=function(t,e,n){return this==Nl||0==t.maps.length?this:this.mapInner(t,e,0,0,n||Cl)},Ol.prototype.mapInner=function(t,e,n,r,o){for(var i,s=0;s<this.local.length;s++){var a=this.local[s].map(t,n,r);a&&a.type.valid(e,a)?(i||(i=[])).push(a):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(t,e,n,r,o,i,s){for(var a=t.slice(),c=function(t,e,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],l=void 0;-1==c||t>c+i||(e>=a[s]+i?a[s+1]=-1:(l=r-n-(e-t)+(i-o))&&(a[s]+=l,a[s+1]+=l))}},l=0;l<n.maps.length;l++)n.maps[l].forEach(c);for(var u=!1,h=0;h<a.length;h+=3)if(-1==a[h+1]){var p=n.map(a[h]+i),f=p-o;if(f<0||f>=r.content.size){u=!0;continue}var d=n.map(t[h+1]+i,-1)-o,v=r.content.findIndex(f),m=v.index,g=v.offset,y=r.maybeChild(m);if(y&&g==f&&g+y.nodeSize==d){var b=a[h+2].mapInner(n,y,p+1,a[h]+i+1,s);b!=Nl?(a[h]=f,a[h+1]=d,a[h+2]=b):(a[h+1]=-2,u=!0)}else u=!0}if(u){var w=Dl(function(t,e,n,r,o,i,s){function a(t,e){for(var i=0;i<t.local.length;i++){var c=t.local[i].map(r,o,e);c?n.push(c):s.onRemove&&s.onRemove(t.local[i].spec)}for(var l=0;l<t.children.length;l+=3)a(t.children[l+2],t.children[l]+e+1)}for(var c=0;c<t.length;c+=3)-1==t[c+1]&&a(t[c+2],e[c]+i+1);return n}(a,t,e||[],n,o,i,s),r,0,s);e=w.local;for(var x=0;x<a.length;x+=3)a[x+1]<0&&(a.splice(x,3),x-=3);for(var k=0,S=0;k<w.children.length;k+=3){for(var C=w.children[k];S<a.length&&a[S]<C;)S+=3;a.splice(S,0,w.children[k],w.children[k+1],w.children[k+2])}}return new Ol(e&&e.sort(Pl),a)}(this.children,i,t,e,n,r,o):i?new Ol(i.sort(Pl)):Nl},Ol.prototype.add=function(t,e){return e.length?this==Nl?Ol.create(t,e):this.addInner(t,e,0):this},Ol.prototype.addInner=function(t,e,n){var r,o=this,i=0;t.forEach((function(t,s){var a,c=s+n;if(a=Al(e,t,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(t,a,c+1):r.splice(i,0,s,s+t.nodeSize,Dl(a,t,c+1,Cl)),i+=3}}));var s=Tl(i?El(e):e,-n);return new Ol(s.length?this.local.concat(s).sort(Pl):this.local,r||this.children)},Ol.prototype.remove=function(t){return 0==t.length||this==Nl?this:this.removeInner(t,0)},Ol.prototype.removeInner=function(t,e){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,s=n[o]+e,a=n[o+1]+e,c=0,l=void 0;c<t.length;c++)(l=t[c])&&l.from>s&&l.to<a&&(t[c]=null,(i||(i=[])).push(l));if(i){n==this.children&&(n=this.children.slice());var u=n[o+2].removeInner(i,s+1);u!=Nl?n[o+2]=u:(n.splice(o,3),o-=3)}}if(r.length)for(var h=0,p=void 0;h<t.length;h++)if(p=t[h])for(var f=0;f<r.length;f++)r[f].type.eq(p.type)&&(r==this.local&&(r=this.local.slice()),r.splice(f--,1));return n==this.children&&r==this.local?this:r.length||n.length?new Ol(r,n):Nl},Ol.prototype.forChild=function(t,e){if(this==Nl)return this;if(e.isLeaf)return Ol.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(n=this.children[o+2]);break}for(var i=t+1,s=i+e.content.size,a=0;a<this.local.length;a++){var c=this.local[a];if(c.from<s&&c.to>i&&c.type instanceof bl){var l=Math.max(i,c.from)-i,u=Math.min(s,c.to)-i;l<u&&(r||(r=[])).push(c.copy(l,u))}}if(r){var h=new Ol(r.sort(Pl));return n?new Ml([h,n]):h}return n||Nl},Ol.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof Ol)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0},Ol.prototype.locals=function(t){return Il(this.localsInner(t))},Ol.prototype.localsInner=function(t){if(this==Nl)return Sl;if(t.inlineContent||!this.local.some(bl.is))return this.local;for(var e=[],n=0;n<this.local.length;n++)this.local[n].type instanceof bl||e.push(this.local[n]);return e};var Nl=new Ol;Ol.empty=Nl,Ol.removeOverlap=Il;var Ml=function(t){this.members=t};function Tl(t,e){if(!e||!t.length)return t;for(var n=[],r=0;r<t.length;r++){var o=t[r];n.push(new xl(o.from+e,o.to+e,o.type))}return n}function Al(t,e,n){if(e.isLeaf)return null;for(var r=n+e.nodeSize,o=null,i=0,s=void 0;i<t.length;i++)(s=t[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),t[i]=null);return o}function El(t){for(var e=[],n=0;n<t.length;n++)null!=t[n]&&e.push(t[n]);return e}function Dl(t,e,n,r){var o=[],i=!1;e.forEach((function(e,s){var a=Al(t,e,s+n);if(a){i=!0;var c=Dl(a,e,n+s+1,r);c!=Nl&&o.push(s,s+e.nodeSize,c)}}));for(var s=Tl(i?El(t):t,-n).sort(Pl),a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Ol(s,o):Nl}function Pl(t,e){return t.from-e.from||t.to-e.to}function Il(t){for(var e=t,n=0;n<e.length-1;n++){var r=e[n];if(r.from!=r.to)for(var o=n+1;o<e.length;o++){var i=e[o];if(i.from!=r.from){i.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,i.from),Rl(e,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(e==t&&(e=t.slice()),e[o]=i.copy(i.from,r.to),Rl(e,o+1,i.copy(r.to,i.to)))}}return e}function Rl(t,e,n){for(;e<t.length&&Pl(n,t[e])>0;)e++;t.splice(e,0,n)}function zl(t){var e=[];return t.someProp("decorations",(function(n){var r=n(t.state);r&&r!=Nl&&e.push(r)})),t.cursorWrapper&&e.push(Ol.create(t.state.doc,[t.cursorWrapper.deco])),Ml.from(e)}Ml.prototype.forChild=function(t,e){if(e.isLeaf)return Ol.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(t,e);o!=Nl&&(o instanceof Ml?n=n.concat(o.members):n.push(o))}return Ml.from(n)},Ml.prototype.eq=function(t){if(!(t instanceof Ml)||t.members.length!=this.members.length)return!1;for(var e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0},Ml.prototype.locals=function(t){for(var e,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(t);if(o.length)if(e){n&&(e=e.slice(),n=!1);for(var i=0;i<o.length;i++)e.push(o[i])}else e=o}return e?Il(n?e:e.sort(Pl)):Sl},Ml.from=function(t){switch(t.length){case 0:return Nl;case 1:return t[0];default:return new Ml(t)}};var _l=function(t,e){this._props=e,this.state=e.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Fl(this),this.markCursor=null,this.cursorWrapper=null,jl(this),this.nodeViews=Ll(this),this.docView=Xa(this.state.doc,Bl(this),zl(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(t){t.shiftKey=!1,t.mouseDown=null,t.lastKeyCode=null,t.lastKeyCodeTime=0,t.lastClick={time:0,x:0,y:0,type:""},t.lastSelectionOrigin=null,t.lastSelectionTime=0,t.composing=!1,t.composingTimeout=null,t.compositionNodes=[],t.compositionEndedAt=-2e8,t.domObserver=new Hc(t,(function(e,n,r){return Ic(t,e,n,r)})),t.domObserver.start(),t.domChangeCount=0,t.eventHandlers=Object.create(null);var e=function(e){var n=Kc[e];t.dom.addEventListener(e,t.eventHandlers[e]=function(e){!function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(var n=e.target;n!=t.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}(t,e)||Zc(t,e)||!t.editable&&e.type in Gc||n(t,e)})};for(var n in Kc)e(n);ua.safari&&t.dom.addEventListener("input",(function(){return null})),Xc(t)}(this),this.pluginViews=[],this.updatePluginViews()},$l={props:{configurable:!0},root:{configurable:!0}};function Bl(t){var e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(t.state)),n)for(var r in n)"class"==r?e.class+=" "+n[r]:e[r]||"contenteditable"==r||"nodeName"==r||(e[r]=String(n[r]))})),[xl.node(0,t.state.doc.content.size,e)]}function jl(t){var e=t.state.selection,n=e.$head,r=e.$anchor,o=e.visible;if(t.markCursor){var i=document.createElement("img");i.setAttribute("mark-placeholder","true"),t.cursorWrapper={dom:i,deco:xl.widget(n.pos,i,{raw:!0,marks:t.markCursor})}}else if(o||n.pos!=r.pos)t.cursorWrapper=null;else{var s;!t.cursorWrapper||t.cursorWrapper.dom.childNodes.length?((s=document.createElement("div")).style.position="absolute",s.style.left="-100000px"):t.cursorWrapper.deco.pos!=n.pos&&(s=t.cursorWrapper.dom),s&&(t.cursorWrapper={dom:s,deco:xl.widget(n.pos,s,{raw:!0})})}}function Fl(t){return!t.someProp("editable",(function(e){return!1===e(t.state)}))}function Vl(t){var e=t.getSelection(),n=e.focusOffset,r=e.focusNode;return r&&3!=r.nodeType?[r,n,1==r.nodeType?r.childNodes[n-1]:null,1==r.nodeType?r.childNodes[n]:null]:null}function Ll(t){var e={};return t.someProp("nodeViews",(function(t){for(var n in t)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t[n])})),e}$l.props.get=function(){if(this._props.state!=this.state){var t=this._props;for(var e in this._props={},t)this._props[e]=t[e];this._props.state=this.state}return this._props},_l.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&Xc(this),this._props=t,this.updateStateInner(t.state,!0)},_l.prototype.setProps=function(t){var e={};for(var n in this._props)e[n]=this._props[n];for(var r in e.state=this.state,t)e[r]=t[r];this.update(e)},_l.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},_l.prototype.updateStateInner=function(t,e){var n=this,r=this.state,o=!1;if(this.state=t,e){var s=Ll(this);(function(t,e){var n=0,r=0;for(var o in t){if(t[o]!=e[o])return!0;n++}for(var i in e)r++;return n!=r})(s,this.nodeViews)&&(this.nodeViews=s,o=!0),Xc(this)}this.editable=Fl(this),jl(this);var a,c,l,u,h,p,f,d,v=zl(this),m=Bl(this),g=e?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",y=o||!this.docView.matchesNode(t.doc,m,v),b=y||!t.selection.eq(r.selection),w="preserve"==g&&b&&null==this.dom.style.overflowAnchor&&function(t){for(var e,n,r=t.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){var a=t.root.elementFromPoint(i,s);if(a!=t.dom&&t.dom.contains(a)){var c=a.getBoundingClientRect();if(c.top>=o-20){e=a,n=c.top;break}}}return{refDOM:e,refTop:n,stack:Aa(t.dom)}}(this);if(b){this.domObserver.stop();var x=!1;if(y){var k=ua.chrome&&Vl(this.root);!o&&this.docView.update(t.doc,m,v,this)||(this.docView.destroy(),this.docView=Xa(t.doc,m,v,this.dom,this)),k&&(x=!this.composing&&function(t,e){var n=Vl(e);if(!n||3==n[0].nodeType)return!1;for(var r=0;r<t.length;r++)if(n[r]!=t[r])return!0;return!1}(k,this.root)),ua.ie&&ua.ie_version<=11&&!r.selection.empty&&t.selection.empty&&t.doc.content.size<r.doc.content.size&&(x=!0)}x||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(a=this,c=a.docView.domFromPos(a.state.selection.anchor),l=a.root.getSelection(),ba(c.node,c.offset,l.anchorNode,l.anchorOffset)))?Oc(this,x):(Tc(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==g)this.dom.scrollTop=0;else if("to selection"==g){var S=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(t){return t(n)}))||(t.selection instanceof i.NodeSelection?Ta(this,this.docView.domAfterPos(t.selection.from).getBoundingClientRect(),S):Ta(this,this.coordsAtPos(t.selection.head),S))}else w&&(h=(u=w).refDOM,p=u.refTop,f=u.stack,d=h?h.getBoundingClientRect().top:0,Ea(f,0==d?0:d-p))},_l.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},_l.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins)for(var e=0;e<this.pluginViews.length;e++){var n=this.pluginViews[e];n.update&&n.update(this,t)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},_l.prototype.someProp=function(t,e){var n,r=this._props&&this._props[t];if(null!=r&&(n=e?e(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[t];if(null!=s&&(n=e?e(s):s))return n}},_l.prototype.hasFocus=function(){return this.root.activeElement==this.dom},_l.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(t){if(t.setActive)return t.setActive();if(Da)return t.focus(Da);var e=Aa(t);t.focus(null==Da?{get preventScroll(){return Da={preventScroll:!0},!0}}:void 0),Da||(Da=!1,Ea(e,0))}(this.dom),Oc(this),this.domObserver.start()},$l.root.get=function(){var t=this._root;if(null==t)for(var e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return this._root=e;return t||document},_l.prototype.posAtCoords=function(t){return Ra(this,t)},_l.prototype.coordsAtPos=function(t){return _a(this,t)},_l.prototype.domAtPos=function(t){return this.docView.domFromPos(t)},_l.prototype.nodeDOM=function(t){var e=this.docView.descAt(t);return e?e.nodeDOM:null},_l.prototype.posAtDOM=function(t,e,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(t,e,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},_l.prototype.endOfTextblock=function(t,e){return qa(this,e||this.state,t)},_l.prototype.destroy=function(){this.docView&&(!function(t){for(var e in t.domObserver.stop(),t.eventHandlers)t.dom.removeEventListener(e,t.eventHandlers[e]);clearTimeout(t.composingTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],zl(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},_l.prototype.dispatchEvent=function(t){return function(t,e){Zc(t,e)||!Kc[e.type]||!t.editable&&e.type in Gc||Kc[e.type](t,e)}(this,t)},_l.prototype.dispatch=function(t){var e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(_l.prototype,$l);n(16);var ql=n(7);var Jl=function(t,e){if(this.content=t,this.size=e||0,null==e)for(var n=0;n<t.length;n++)this.size+=t[n].nodeSize},Wl={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};Jl.prototype.nodesBetween=function(t,e,n,r,o){void 0===r&&(r=0);for(var i=0,s=0;s<e;i++){var a=this.content[i],c=s+a.nodeSize;if(c>t&&!1!==n(a,r+s,o,i)&&a.content.size){var l=s+1;a.nodesBetween(Math.max(0,t-l),Math.min(a.content.size,e-l),n,r+l)}s=c}},Jl.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},Jl.prototype.textBetween=function(t,e,n,r){var o="",i=!0;return this.nodesBetween(t,e,(function(s,a){s.isText?(o+=s.text.slice(Math.max(t,a)-a,e-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)}),0),o},Jl.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var e=this.lastChild,n=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(n)&&(r[r.length-1]=e.withText(e.text+n.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new Jl(r,this.size+t.size)},Jl.prototype.cut=function(t,e){if(null==e&&(e=this.size),0==t&&e==this.size)return this;var n=[],r=0;if(e>t)for(var o=0,i=0;i<e;o++){var s=this.content[o],a=i+s.nodeSize;a>t&&((i<t||a>e)&&(s=s.isText?s.cut(Math.max(0,t-i),Math.min(s.text.length,e-i)):s.cut(Math.max(0,t-i-1),Math.min(s.content.size,e-i-1))),n.push(s),r+=s.nodeSize),i=a}return new Jl(n,r)},Jl.prototype.cutByIndex=function(t,e){return t==e?Jl.empty:0==t&&e==this.content.length?this:new Jl(this.content.slice(t,e))},Jl.prototype.replaceChild=function(t,e){var n=this.content[t];if(n==e)return this;var r=this.content.slice(),o=this.size+e.nodeSize-n.nodeSize;return r[t]=e,new Jl(r,o)},Jl.prototype.addToStart=function(t){return new Jl([t].concat(this.content),this.size+t.nodeSize)},Jl.prototype.addToEnd=function(t){return new Jl(this.content.concat(t),this.size+t.nodeSize)},Jl.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0},Wl.firstChild.get=function(){return this.content.length?this.content[0]:null},Wl.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},Wl.childCount.get=function(){return this.content.length},Jl.prototype.child=function(t){var e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e},Jl.prototype.maybeChild=function(t){return this.content[t]},Jl.prototype.forEach=function(t){for(var e=0,n=0;e<this.content.length;e++){var r=this.content[e];t(r,n,e),n+=r.nodeSize}},Jl.prototype.findDiffStart=function(t,e){return void 0===e&&(e=0),function t(e,n,r){for(var o=0;;o++){if(o==e.childCount||o==n.childCount)return e.childCount==n.childCount?null:r;var i=e.child(o),s=n.child(o);if(i!=s){if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)r++;return r}if(i.content.size||s.content.size){var c=t(i.content,s.content,r+1);if(null!=c)return c}r+=i.nodeSize}else r+=i.nodeSize}}(this,t,e)},Jl.prototype.findDiffEnd=function(t,e,n){return void 0===e&&(e=this.size),void 0===n&&(n=t.size),function t(e,n,r,o){for(var i=e.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};var a=e.child(--i),c=n.child(--s),l=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:r,b:o};if(a.isText&&a.text!=c.text){for(var u=0,h=Math.min(a.text.length,c.text.length);u<h&&a.text[a.text.length-u-1]==c.text[c.text.length-u-1];)u++,r--,o--;return{a:r,b:o}}if(a.content.size||c.content.size){var p=t(a.content,c.content,r-1,o-1);if(p)return p}r-=l,o-=l}else r-=l,o-=l}}(this,t,e,n)},Jl.prototype.findIndex=function(t,e){if(void 0===e&&(e=-1),0==t)return Ul(0,t);if(t==this.size)return Ul(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=t)return o==t||e>0?Ul(n+1,o):Ul(n,r);r=o}},Jl.prototype.toString=function(){return"<"+this.toStringInner()+">"},Jl.prototype.toStringInner=function(){return this.content.join(", ")},Jl.prototype.toJSON=function(){return this.content.length?this.content.map((function(t){return t.toJSON()})):null},Jl.fromJSON=function(t,e){if(!e)return Jl.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new Jl(e.map(t.nodeFromJSON))},Jl.fromArray=function(t){if(!t.length)return Jl.empty;for(var e,n=0,r=0;r<t.length;r++){var o=t[r];n+=o.nodeSize,r&&o.isText&&t[r-1].sameMarkup(o)?(e||(e=t.slice(0,r)),e[e.length-1]=o.withText(e[e.length-1].text+o.text)):e&&e.push(o)}return new Jl(e||t,n)},Jl.from=function(t){if(!t)return Jl.empty;if(t instanceof Jl)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new Jl([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(Jl.prototype,Wl);var Hl={index:0,offset:0};function Ul(t,e){return Hl.index=t,Hl.offset=e,Hl}function Kl(t,e){if(t===e)return!0;if(!t||"object"!=typeof t||!e||"object"!=typeof e)return!1;var n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!Kl(t[r],e[r]))return!1}else{for(var o in t)if(!(o in e&&Kl(t[o],e[o])))return!1;for(var i in e)if(!(i in t))return!1}return!0}Jl.empty=new Jl([],0);var Gl=function(t,e){this.type=t,this.attrs=e};function Yl(t){var e=Error.call(this,t);return e.__proto__=Yl.prototype,e}Gl.prototype.addToSet=function(t){for(var e,n=!1,r=0;r<t.length;r++){var o=t[r];if(this.eq(o))return t;if(this.type.excludes(o.type))e||(e=t.slice(0,r));else{if(o.type.excludes(this.type))return t;!n&&o.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),n=!0),e&&e.push(o)}}return e||(e=t.slice()),n||e.push(this),e},Gl.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t},Gl.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1},Gl.prototype.eq=function(t){return this==t||this.type==t.type&&Kl(this.attrs,t.attrs)},Gl.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return t},Gl.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");var n=t.marks[e.type];if(!n)throw new RangeError("There is no mark type "+e.type+" in this schema");return n.create(e.attrs)},Gl.sameSet=function(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].eq(e[n]))return!1;return!0},Gl.setFrom=function(t){if(!t||0==t.length)return Gl.none;if(t instanceof Gl)return[t];var e=t.slice();return e.sort((function(t,e){return t.type.rank-e.type.rank})),e},Gl.none=[],Yl.prototype=Object.create(Error.prototype),Yl.prototype.constructor=Yl,Yl.prototype.name="ReplaceError";var Xl=function(t,e,n){this.content=t,this.openStart=e,this.openEnd=n},Zl={size:{configurable:!0}};function Ql(t,e,n){if(n.openStart>t.depth)throw new Yl("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Yl("Inconsistent open depths");return function t(e,n,r,o){var i=e.index(o),s=e.node(o);if(i==n.index(o)&&o<e.depth-r.openStart){var a=t(e,n,r,o+1);return s.copy(s.content.replaceChild(i,a))}if(r.content.size){if(r.openStart||r.openEnd||e.depth!=o||n.depth!=o){var c=function(t,e){for(var n=e.depth-t.openStart,r=e.node(n).copy(t.content),o=n-1;o>=0;o--)r=e.node(o).copy(Jl.from(r));return{start:r.resolveNoCache(t.openStart+n),end:r.resolveNoCache(r.content.size-t.openEnd-n)}}(r,e),l=c.start,u=c.end;return ou(s,function t(e,n,r,o,i){var s=e.depth>i&&eu(e,n,i+1),a=o.depth>i&&eu(r,o,i+1),c=[];ru(null,e,i,c),s&&a&&n.index(i)==r.index(i)?(tu(s,a),nu(ou(s,t(e,n,r,o,i+1)),c)):(s&&nu(ou(s,iu(e,n,i+1)),c),ru(n,r,i,c),a&&nu(ou(a,iu(r,o,i+1)),c));return ru(o,null,i,c),new Jl(c)}(e,l,u,n,o))}var h=e.parent,p=h.content;return ou(h,p.cut(0,e.parentOffset).append(r.content).append(p.cut(n.parentOffset)))}return ou(s,iu(e,n,o))}(t,e,n,0)}function tu(t,e){if(!e.type.compatibleContent(t.type))throw new Yl("Cannot join "+e.type.name+" onto "+t.type.name)}function eu(t,e,n){var r=t.node(n);return tu(r,e.node(n)),r}function nu(t,e){var n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function ru(t,e,n,r){var o=(e||t).node(n),i=0,s=e?e.index(n):o.childCount;t&&(i=t.index(n),t.depth>n?i++:t.textOffset&&(nu(t.nodeAfter,r),i++));for(var a=i;a<s;a++)nu(o.child(a),r);e&&e.depth==n&&e.textOffset&&nu(e.nodeBefore,r)}function ou(t,e){if(!t.type.validContent(e))throw new Yl("Invalid content for node "+t.type.name);return t.copy(e)}function iu(t,e,n){var r=[];(ru(null,t,n,r),t.depth>n)&&nu(ou(eu(t,e,n+1),iu(t,e,n+1)),r);return ru(e,null,n,r),new Jl(r)}Zl.size.get=function(){return this.content.size-this.openStart-this.openEnd},Xl.prototype.insertAt=function(t,e){var n=function t(e,n,r,o){var i=e.findIndex(n),s=i.index,a=i.offset,c=e.maybeChild(s);if(a==n||c.isText)return o&&!o.canReplace(s,s,r)?null:e.cut(0,n).append(r).append(e.cut(n));var l=t(c.content,n-a-1,r);return l&&e.replaceChild(s,c.copy(l))}(this.content,t+this.openStart,e,null);return n&&new Xl(n,this.openStart,this.openEnd)},Xl.prototype.removeBetween=function(t,e){return new Xl(function t(e,n,r){var o=e.findIndex(n),i=o.index,s=o.offset,a=e.maybeChild(i),c=e.findIndex(r),l=c.index,u=c.offset;if(s==n||a.isText){if(u!=r&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,n).append(e.cut(r))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,a.copy(t(a.content,n-s-1,r-s-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)},Xl.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},Xl.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},Xl.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},Xl.fromJSON=function(t,e){if(!e)return Xl.empty;var n=e.openStart||0,r=e.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new Xl(Jl.fromJSON(t,e.content),e.openStart||0,e.openEnd||0)},Xl.maxOpen=function(t,e){void 0===e&&(e=!0);for(var n=0,r=0,o=t.firstChild;o&&!o.isLeaf&&(e||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new Xl(t,n,r)},Object.defineProperties(Xl.prototype,Zl),Xl.empty=new Xl(Jl.empty,0,0);var su=function(t,e,n){this.pos=t,this.path=e,this.depth=e.length/3-1,this.parentOffset=n},au={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};su.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},au.parent.get=function(){return this.node(this.depth)},au.doc.get=function(){return this.node(0)},su.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},su.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},su.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},su.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},su.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},su.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},su.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},au.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},au.nodeAfter.get=function(){var t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=t.child(e);return n?t.child(e).cut(n):r},au.nodeBefore.get=function(){var t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)},su.prototype.marks=function(){var t=this.parent,e=this.index();if(0==t.content.size)return Gl.none;if(this.textOffset)return t.child(e).marks;var n=t.maybeChild(e-1),r=t.maybeChild(e);if(!n){var o=n;n=r,r=o}for(var i=n.marks,s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i},su.prototype.marksAcross=function(t){var e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;for(var n=e.marks,r=t.parent.maybeChild(t.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},su.prototype.sharedDepth=function(t){for(var e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0},su.prototype.blockRange=function(t,e){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);n>=0;n--)if(t.pos<=this.end(n)&&(!e||e(this.node(n))))return new hu(this,t,n)},su.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},su.prototype.max=function(t){return t.pos>this.pos?t:this},su.prototype.min=function(t){return t.pos<this.pos?t:this},su.prototype.toString=function(){for(var t="",e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset},su.resolve=function(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");for(var n=[],r=0,o=e,i=t;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,l=o-c;if(n.push(i,a,r+c),!l)break;if((i=i.child(a)).isText)break;o=l-1,r+=c+1}return new su(e,n,o)},su.resolveCached=function(t,e){for(var n=0;n<cu.length;n++){var r=cu[n];if(r.pos==e&&r.doc==t)return r}var o=cu[lu]=su.resolve(t,e);return lu=(lu+1)%uu,o},Object.defineProperties(su.prototype,au);var cu=[],lu=0,uu=12,hu=function(t,e,n){this.$from=t,this.$to=e,this.depth=n},pu={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};pu.start.get=function(){return this.$from.before(this.depth+1)},pu.end.get=function(){return this.$to.after(this.depth+1)},pu.parent.get=function(){return this.$from.node(this.depth)},pu.startIndex.get=function(){return this.$from.index(this.depth)},pu.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(hu.prototype,pu);var fu=Object.create(null),du=function(t,e,n,r){this.type=t,this.attrs=e,this.content=n||Jl.empty,this.marks=r||Gl.none},vu={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};vu.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},vu.childCount.get=function(){return this.content.childCount},du.prototype.child=function(t){return this.content.child(t)},du.prototype.maybeChild=function(t){return this.content.maybeChild(t)},du.prototype.forEach=function(t){this.content.forEach(t)},du.prototype.nodesBetween=function(t,e,n,r){void 0===r&&(r=0),this.content.nodesBetween(t,e,n,r,this)},du.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},vu.textContent.get=function(){return this.textBetween(0,this.content.size,"")},du.prototype.textBetween=function(t,e,n,r){return this.content.textBetween(t,e,n,r)},vu.firstChild.get=function(){return this.content.firstChild},vu.lastChild.get=function(){return this.content.lastChild},du.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},du.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},du.prototype.hasMarkup=function(t,e,n){return this.type==t&&Kl(this.attrs,e||t.defaultAttrs||fu)&&Gl.sameSet(this.marks,n||Gl.none)},du.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},du.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},du.prototype.cut=function(t,e){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))},du.prototype.slice=function(t,e,n){if(void 0===e&&(e=this.content.size),void 0===n&&(n=!1),t==e)return Xl.empty;var r=this.resolve(t),o=this.resolve(e),i=n?0:r.sharedDepth(e),s=r.start(i),a=r.node(i).content.cut(r.pos-s,o.pos-s);return new Xl(a,r.depth-i,o.depth-i)},du.prototype.replace=function(t,e,n){return Ql(this.resolve(t),this.resolve(e),n)},du.prototype.nodeAt=function(t){for(var e=this;;){var n=e.content.findIndex(t),r=n.index,o=n.offset;if(!(e=e.maybeChild(r)))return null;if(o==t||e.isText)return e;t-=o+1}},du.prototype.childAfter=function(t){var e=this.content.findIndex(t),n=e.index,r=e.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},du.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var e=this.content.findIndex(t),n=e.index,r=e.offset;if(r<t)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},du.prototype.resolve=function(t){return su.resolveCached(this,t)},du.prototype.resolveNoCache=function(t){return su.resolve(this,t)},du.prototype.rangeHasMark=function(t,e,n){var r=!1;return e>t&&this.nodesBetween(t,e,(function(t){return n.isInSet(t.marks)&&(r=!0),!r})),r},vu.isBlock.get=function(){return this.type.isBlock},vu.isTextblock.get=function(){return this.type.isTextblock},vu.inlineContent.get=function(){return this.type.inlineContent},vu.isInline.get=function(){return this.type.isInline},vu.isText.get=function(){return this.type.isText},vu.isLeaf.get=function(){return this.type.isLeaf},vu.isAtom.get=function(){return this.type.isAtom},du.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),gu(this.marks,t)},du.prototype.contentMatchAt=function(t){var e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e},du.prototype.canReplace=function(t,e,n,r,o){void 0===n&&(n=Jl.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(t).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,e);if(!s||!s.validEnd)return!1;for(var a=r;a<o;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0},du.prototype.canReplaceWith=function(t,e,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(t).matchType(n),i=o&&o.matchFragment(this.content,e);return!!i&&i.validEnd},du.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},du.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach((function(t){return t.check()}))},du.prototype.toJSON=function(){var t={type:this.type.name};for(var e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map((function(t){return t.toJSON()}))),t},du.fromJSON=function(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw new RangeError("Invalid text node in JSON");return t.text(e.text,n)}var r=Jl.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,r,n)},Object.defineProperties(du.prototype,vu);var mu=function(t){function e(e,n,r,o){if(t.call(this,e,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return e.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):gu(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},e.prototype.textBetween=function(t,e){return this.text.slice(t,e)},n.nodeSize.get=function(){return this.text.length},e.prototype.mark=function(t){return t==this.marks?this:new e(this.type,this.attrs,this.text,t)},e.prototype.withText=function(t){return t==this.text?this:new e(this.type,this.attrs,t,this.marks)},e.prototype.cut=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.text.length),0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))},e.prototype.eq=function(t){return this.sameMarkup(t)&&this.text==t.text},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.text=this.text,e},Object.defineProperties(e.prototype,n),e}(du);function gu(t,e){for(var n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}var yu=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},bu={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};yu.parse=function(t,e){var n=new wu(t,e);if(null==n.next)return yu.empty;var r=ku(n);n.next&&n.err("Unexpected trailing text");var o=function(t){var e=Object.create(null);return function n(r){var o=[];r.forEach((function(e){t[e].forEach((function(e){var n=e.term,r=e.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];Tu(t,r).forEach((function(t){s||o.push(n,s=[]),-1==s.indexOf(t)&&s.push(t)}))}}))}));for(var i=e[r.join(",")]=new yu(r.indexOf(t.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(Mu);i.next.push(o[s],e[a.join(",")]||n(a))}return i}(Tu(t,0))}(function(t){var e=[[]];return o(function t(e,i){if("choice"==e.type)return e.exprs.reduce((function(e,n){return e.concat(t(n,i))}),[]);if("seq"==e.type)for(var s=0;;s++){var a=t(e.exprs[s],i);if(s==e.exprs.length-1)return a;o(a,i=n())}else{if("star"==e.type){var c=n();return r(i,c),o(t(e.expr,c),c),[r(c)]}if("plus"==e.type){var l=n();return o(t(e.expr,i),l),o(t(e.expr,l),l),[r(l)]}if("opt"==e.type)return[r(i)].concat(t(e.expr,i));if("range"==e.type){for(var u=i,h=0;h<e.min;h++){var p=n();o(t(e.expr,u),p),u=p}if(-1==e.max)o(t(e.expr,u),u);else for(var f=e.min;f<e.max;f++){var d=n();r(u,d),o(t(e.expr,u),d),u=d}return[r(u)]}if("name"==e.type)return[r(i,null,e.value)]}}(t,0),n()),e;function n(){return e.push([])-1}function r(t,n,r){var o={term:r,to:n};return e[t].push(o),o}function o(t,e){t.forEach((function(t){return t.to=e}))}}(r));return function(t,e){for(var n=0,r=[t];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],l=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),-1==r.indexOf(l)&&r.push(l)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}(o,n),o},yu.prototype.matchType=function(t){for(var e=0;e<this.next.length;e+=2)if(this.next[e]==t)return this.next[e+1];return null},yu.prototype.matchFragment=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.childCount);for(var r=this,o=e;r&&o<n;o++)r=r.matchType(t.child(o).type);return r},bu.inlineContent.get=function(){var t=this.next[0];return!!t&&t.isInline},bu.defaultType.get=function(){for(var t=0;t<this.next.length;t+=2){var e=this.next[t];if(!e.isText&&!e.hasRequiredAttrs())return e}},yu.prototype.compatible=function(t){for(var e=0;e<this.next.length;e+=2)for(var n=0;n<t.next.length;n+=2)if(this.next[e]==t.next[n])return!0;return!1},yu.prototype.fillBefore=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=0);var r=[this];return function o(i,s){var a=i.matchFragment(t,n);if(a&&(!e||a.validEnd))return Jl.from(s.map((function(t){return t.createAndFill()})));for(var c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];if(!l.isText&&!l.hasRequiredAttrs()&&-1==r.indexOf(u)){r.push(u);var h=o(u,s.concat(l));if(h)return h}}}(this,[])},yu.prototype.findWrapping=function(t){for(var e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];var n=this.computeWrapping(t);return this.wrapCache.push(t,n),n},yu.prototype.computeWrapping=function(t){for(var e=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(t)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in e||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),e[c.name]=!0)}}},bu.edgeCount.get=function(){return this.next.length>>1},yu.prototype.edge=function(t){var e=t<<1;if(e>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[e],next:this.next[e+1]}},yu.prototype.toString=function(){var t=[];return function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)-1==t.indexOf(n.next[r])&&e(n.next[r])}(this),t.map((function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r})).join("\n")},Object.defineProperties(yu.prototype,bu),yu.empty=new yu(!0);var wu=function(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},xu={next:{configurable:!0}};function ku(t){var e=[];do{e.push(Su(t))}while(t.eat("|"));return 1==e.length?e[0]:{type:"choice",exprs:e}}function Su(t){var e=[];do{e.push(Cu(t))}while(t.next&&")"!=t.next&&"|"!=t.next);return 1==e.length?e[0]:{type:"seq",exprs:e}}function Cu(t){for(var e=function(t){if(t.eat("(")){var e=ku(t);return t.eat(")")||t.err("Missing closing paren"),e}if(!/\W/.test(t.next)){var n=function(t,e){var n=t.nodeTypes,r=n[e];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(e)>-1&&o.push(s)}0==o.length&&t.err("No node type or group '"+e+"' found");return o}(t,t.next).map((function(e){return null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}}));return t.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}t.err("Unexpected token '"+t.next+"'")}(t);;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else{if(!t.eat("{"))break;e=Nu(t,e)}return e}function Ou(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");var e=Number(t.next);return t.pos++,e}function Nu(t,e){var n=Ou(t),r=n;return t.eat(",")&&(r="}"!=t.next?Ou(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Mu(t,e){return e-t}function Tu(t,e){var n=[];return function e(r){var o=t[r];if(1==o.length&&!o[0].term)return e(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||-1!=n.indexOf(c)||e(c)}}(e),n.sort(Mu)}function Au(t){var e=Object.create(null);for(var n in t){var r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Eu(t,e){var n=Object.create(null);for(var r in t){var o=e&&e[r];if(void 0===o){var i=t[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Du(t){var e=Object.create(null);if(t)for(var n in t)e[n]=new Ru(t[n]);return e}xu.next.get=function(){return this.tokens[this.pos]},wu.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},wu.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(wu.prototype,xu);var Pu=function(t,e,n){this.name=t,this.schema=e,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Du(n.attrs),this.defaultAttrs=Au(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==t),this.isText="text"==t},Iu={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Iu.isInline.get=function(){return!this.isBlock},Iu.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Iu.isLeaf.get=function(){return this.contentMatch==yu.empty},Iu.isAtom.get=function(){return this.isLeaf||this.spec.atom},Pu.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},Pu.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},Pu.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:Eu(this.attrs,t)},Pu.prototype.create=function(t,e,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new du(this,this.computeAttrs(t),Jl.from(e),Gl.setFrom(n))},Pu.prototype.createChecked=function(t,e,n){if(e=Jl.from(e),!this.validContent(e))throw new RangeError("Invalid content for node "+this.name);return new du(this,this.computeAttrs(t),e,Gl.setFrom(n))},Pu.prototype.createAndFill=function(t,e,n){if(t=this.computeAttrs(t),(e=Jl.from(e)).size){var r=this.contentMatch.fillBefore(e);if(!r)return null;e=r.append(e)}var o=this.contentMatch.matchFragment(e).fillBefore(Jl.empty,!0);return o?new du(this,t,e.append(o),Gl.setFrom(n)):null},Pu.prototype.validContent=function(t){var e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(var n=0;n<t.childCount;n++)if(!this.allowsMarks(t.child(n).marks))return!1;return!0},Pu.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},Pu.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0},Pu.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var e,n=0;n<t.length;n++)this.allowsMarkType(t[n].type)?e&&e.push(t[n]):e||(e=t.slice(0,n));return e?e.length?e:Gl.empty:t},Pu.compile=function(t,e){var n=Object.create(null);t.forEach((function(t,r){return n[t]=new Pu(t,e,r)}));var r=e.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(Pu.prototype,Iu);var Ru=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},zu={isRequired:{configurable:!0}};zu.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(Ru.prototype,zu);var _u=function(t,e,n,r){this.name=t,this.schema=n,this.spec=r,this.attrs=Du(r.attrs),this.rank=e,this.excluded=null;var o=Au(this.attrs);this.instance=o&&new Gl(this,o)};_u.prototype.create=function(t){return!t&&this.instance?this.instance:new Gl(this,Eu(this.attrs,t))},_u.compile=function(t,e){var n=Object.create(null),r=0;return t.forEach((function(t,o){return n[t]=new _u(t,r++,e,o)})),n},_u.prototype.removeFromSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t.slice(0,e).concat(t.slice(e+1));return t},_u.prototype.isInSet=function(t){for(var e=0;e<t.length;e++)if(t[e].type==this)return t[e]},_u.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var $u=function(t){for(var e in this.spec={},t)this.spec[e]=t[e];this.spec.nodes=s.a.from(t.nodes),this.spec.marks=s.a.from(t.marks),this.nodes=Pu.compile(this.spec.nodes,this),this.marks=_u.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",a=o.spec.marks;o.contentMatch=n[i]||(n[i]=yu.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==a?null:a?Bu(this,a.split(" ")):""!=a&&o.inlineContent?null:[]}for(var c in this.marks){var l=this.marks[c],u=l.spec.excludes;l.excluded=null==u?[l]:""==u?[]:Bu(this,u.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Bu(t,e){for(var n=[],r=0;r<e.length;r++){var o=e[r],i=t.marks[o],s=i;if(i)n.push(i);else for(var a in t.marks){var c=t.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}$u.prototype.node=function(t,e,n,r){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof Pu))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(e,n,r)},$u.prototype.text=function(t,e){var n=this.nodes.text;return new mu(n,n.defaultAttrs,t,Gl.setFrom(e))},$u.prototype.mark=function(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)},$u.prototype.nodeFromJSON=function(t){return du.fromJSON(this,t)},$u.prototype.markFromJSON=function(t){return Gl.fromJSON(this,t)},$u.prototype.nodeType=function(t){var e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e};var ju=function(t,e){var n=this;this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach((function(t){t.tag?n.tags.push(t):t.style&&n.styles.push(t)}))};ju.prototype.parse=function(t,e){void 0===e&&(e={});var n=new Wu(this,e,!1);return n.addAll(t,null,e.from,e.to),n.finish()},ju.prototype.parseSlice=function(t,e){void 0===e&&(e={});var n=new Wu(this,e,!0);return n.addAll(t,null,e.from,e.to),Xl.maxOpen(n.finish())},ju.prototype.matchTag=function(t,e){for(var n=0;n<this.tags.length;n++){var r=this.tags[n];if(Uu(t,r.tag)&&(void 0===r.namespace||t.namespaceURI==r.namespace)&&(!r.context||e.matchesContext(r.context))){if(r.getAttrs){var o=r.getAttrs(t);if(!1===o)continue;r.attrs=o}return r}}},ju.prototype.matchStyle=function(t,e,n){for(var r=0;r<this.styles.length;r++){var o=this.styles[r];if(!(0!=o.style.indexOf(t)||o.context&&!n.matchesContext(o.context)||o.style.length>t.length&&(61!=o.style.charCodeAt(t.length)||o.style.slice(t.length+1)!=e))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},ju.schemaRules=function(t){var e=[];function n(t){for(var n=null==t.priority?50:t.priority,r=0;r<e.length;r++){var o=e[r];if((null==o.priority?50:o.priority)<n)break}e.splice(r,0,t)}var r=function(e){var r=t.marks[e].spec.parseDOM;r&&r.forEach((function(t){n(t=Ku(t)),t.mark=e}))};for(var o in t.marks)r(o);var i;for(var s in t.nodes)i=void 0,(i=t.nodes[s].spec.parseDOM)&&i.forEach((function(t){n(t=Ku(t)),t.node=s}));return e},ju.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new ju(t,ju.schemaRules(t)))};var Fu={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Vu={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Lu={ol:!0,ul:!0};function qu(t){return(t?1:0)|("full"===t?2:0)}var Ju=function(t,e,n,r,o,i,s){this.type=t,this.attrs=e,this.solid=o,this.match=i||(4&s?null:t.contentMatch),this.options=s,this.content=[],this.marks=n,this.activeMarks=Gl.none,this.pendingMarks=r};Ju.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var e=this.type.contentMatch.fillBefore(Jl.from(t));if(!e){var n,r=this.type.contentMatch;return(n=r.findWrapping(t.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(e)}return this.match.findWrapping(t.type)},Ju.prototype.finish=function(t){if(!(1&this.options)){var e,n=this.content[this.content.length-1];n&&n.isText&&(e=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length)))}var r=Jl.from(this.content);return!t&&this.match&&(r=r.append(this.match.fillBefore(Jl.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},Ju.prototype.applyPending=function(t){for(var e=0,n=this.pendingMarks;e<n.length;e++){var r=n[e];(this.type?this.type.allowsMarkType(r.type):Gu(r.type,t))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}};var Wu=function(t,e,n){this.parser=t,this.options=e,this.isOpen=n;var r,o=e.topNode,i=qu(e.preserveWhitespace)|(n?4:0);r=o?new Ju(o.type,o.attrs,Gl.none,Gl.none,!0,e.topMatch||o.type.contentMatch,i):new Ju(n?null:t.schema.topNodeType,null,Gl.none,Gl.none,!0,null,i),this.nodes=[r],this.open=0,this.find=e.findPositions,this.needsBlock=!1},Hu={top:{configurable:!0},currentPos:{configurable:!0}};function Uu(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function Ku(t){var e={};for(var n in t)e[n]=t[n];return e}function Gu(t,e){var n=e.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(t)){var i=[],s=function(t){i.push(t);for(var n=0;n<t.edgeCount;n++){var r=t.edge(n),o=r.type,a=r.next;if(o==e)return!0;if(i.indexOf(a)<0&&s(a))return!0}};return s(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}Hu.top.get=function(){return this.nodes[this.open]},Wu.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var e=t.getAttribute("style"),n=e?this.readStyles(function(t){var e,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;e=n.exec(t);)r.push(e[1],e[2].trim());return r}(e)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(t),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},Wu.prototype.addTextNode=function(t){var e=t.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/[^ \t\r\n\u000c]/.test(e)){if(1&n.options)2&n.options||(e=e.replace(/\r?\n|\r/g," "));else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=t.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)},Wu.prototype.addElement=function(t){var e=t.nodeName.toLowerCase();Lu.hasOwnProperty(e)&&function(t){for(var e=t.firstChild,n=null;e;e=e.nextSibling){var r=1==e.nodeType?e.nodeName.toLowerCase():null;r&&Lu.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):"li"==r?n=e:r&&(n=null)}}(t);var n=this.options.ruleFromNode&&this.options.ruleFromNode(t)||this.parser.matchTag(t,this);if(n?n.ignore:Vu.hasOwnProperty(e))this.findInside(t);else if(!n||n.skip){n&&n.skip.nodeType&&(t=n.skip);var r,o=this.top,i=this.needsBlock;if(Fu.hasOwnProperty(e))r=!0,o.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(t,n)},Wu.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},Wu.prototype.readStyles=function(t){for(var e=Gl.none,n=0;n<t.length;n+=2){var r=this.parser.matchStyle(t[n],t[n+1],this);if(r){if(r.ignore)return null;e=this.parser.schema.marks[r.mark].create(r.attrs).addToSet(e)}}return e},Wu.prototype.addElementByRule=function(t,e){var n,r,o,i=this;e.node?(r=this.parser.schema.nodes[e.node]).isLeaf?this.insertNode(r.create(e.attrs))||this.leafFallback(t):n=this.enter(r,e.attrs,e.preserveWhitespace):(o=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(o));var s=this.top;if(r&&r.isLeaf)this.findInside(t);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach((function(t){return i.insertNode(t)}));else{var a=e.contentElement;"string"==typeof a?a=t.querySelector(a):"function"==typeof a&&(a=a(t)),a||(a=t),this.findAround(t,a,!0),this.addAll(a,n)}n&&(this.sync(s),this.open--),o&&this.removePendingMark(o,s)},Wu.prototype.addAll=function(t,e,n,r){for(var o=n||0,i=n?t.childNodes[n]:t.firstChild,s=null==r?null:t.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(i),e&&Fu.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(e);this.findAtPoint(t,o)},Wu.prototype.findPlace=function(t){for(var e,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(t);if(i&&(!e||e.length>i.length)&&(e=i,n=o,!i.length))break;if(o.solid)break}if(!e)return!1;this.sync(n);for(var s=0;s<e.length;s++)this.enterInner(e[s],null,!1);return!0},Wu.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();var n=this.top;n.applyPending(t.type),n.match&&(n.match=n.match.matchType(t.type));for(var r=n.activeMarks,o=0;o<t.marks.length;o++)n.type&&!n.type.allowsMarkType(t.marks[o].type)||(r=t.marks[o].addToSet(r));return n.content.push(t.mark(r)),!0}return!1},Wu.prototype.enter=function(t,e,n){var r=this.findPlace(t.create(e));return r&&this.enterInner(t,e,!0,n),r},Wu.prototype.enterInner=function(t,e,n,r){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,e);var i=null==r?-5&o.options:qu(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new Ju(t,e,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},Wu.prototype.closeExtra=function(t){var e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}},Wu.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Wu.prototype.sync=function(t){for(var e=this.open;e>=0;e--)if(this.nodes[e]==t)return void(this.open=e)},Hu.currentPos.get=function(){this.closeExtra();for(var t=0,e=this.open;e>=0;e--){for(var n=this.nodes[e].content,r=n.length-1;r>=0;r--)t+=n[r].nodeSize;e&&t++}return t},Wu.prototype.findAtPoint=function(t,e){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&this.find[n].offset==e&&(this.find[n].pos=this.currentPos)},Wu.prototype.findInside=function(t){if(this.find)for(var e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)},Wu.prototype.findAround=function(t,e,n){if(t!=e&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node))e.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},Wu.prototype.findInText=function(t){if(this.find)for(var e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))},Wu.prototype.matchesContext=function(t){var e=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var n=t.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function(t,a){for(;t>=0;t--){var c=n[t];if(""==c){if(t==n.length-1||0==t)continue;for(;a>=i;a--)if(s(t-1,a))return!0;return!1}var l=a>0||0==a&&o?e.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!l||l.name!=c&&-1==l.groups.indexOf(c))return!1;a--}return!0};return s(n.length-1,this.open)},Wu.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var e=t.depth;e>=0;e--){var n=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Wu.prototype.addPendingMark=function(t){this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},Wu.prototype.removePendingMark=function(t,e){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(t)>-1?r.pendingMarks=t.removeFromSet(r.pendingMarks):r.activeMarks=t.removeFromSet(r.activeMarks),r==e)break}},Object.defineProperties(Wu.prototype,Hu);var Yu=function(t,e){this.nodes=t||{},this.marks=e||{}};function Xu(t){var e={};for(var n in t){var r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function Zu(t){return t.document||window.document}Yu.prototype.serializeFragment=function(t,e,n){var r=this;void 0===e&&(e={}),n||(n=Zu(e).createDocumentFragment());var o=n,i=null;return t.forEach((function(t){if(i||t.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<t.marks.length;){var a=t.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||!1===a.type.spec.spanning)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<t.marks.length;){var c=t.marks[s++],l=r.serializeMark(c,t.isInline,e);l&&(i.push(c,o),o.appendChild(l.dom),o=l.contentDOM||l.dom)}}o.appendChild(r.serializeNode(t,e))})),n},Yu.prototype.serializeNode=function(t,e){void 0===e&&(e={});var n=Yu.renderSpec(Zu(e),this.nodes[t.type.name](t)),r=n.dom,o=n.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");e.onContent?e.onContent(t,o,e):this.serializeFragment(t.content,e,o)}return r},Yu.prototype.serializeNodeAndMarks=function(t,e){void 0===e&&(e={});for(var n=this.serializeNode(t,e),r=t.marks.length-1;r>=0;r--){var o=this.serializeMark(t.marks[r],t.isInline,e);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},Yu.prototype.serializeMark=function(t,e,n){void 0===n&&(n={});var r=this.marks[t.type.name];return r&&Yu.renderSpec(Zu(n),r(t,e))},Yu.renderSpec=function(t,e,n){if(void 0===n&&(n=null),"string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};var r=e[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,s=n?t.createElementNS(n,r):t.createElement(r),a=e[1],c=1;if(a&&"object"==typeof a&&null==a.nodeType&&!Array.isArray(a))for(var l in c=2,a)if(null!=a[l]){var u=l.indexOf(" ");u>0?s.setAttributeNS(l.slice(0,u),l.slice(u+1),a[l]):s.setAttribute(l,a[l])}for(var h=c;h<e.length;h++){var p=e[h];if(0===p){if(h<e.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:s,contentDOM:s}}var f=Yu.renderSpec(t,p,n),d=f.dom,v=f.contentDOM;if(s.appendChild(d),v){if(i)throw new RangeError("Multiple content holes");i=v}}return{dom:s,contentDOM:i}},Yu.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Yu(this.nodesFromSchema(t),this.marksFromSchema(t)))},Yu.nodesFromSchema=function(t){var e=Xu(t.nodes);return e.text||(e.text=function(t){return t.text}),e},Yu.marksFromSchema=function(t){return Xu(t.marks)};var Qu=Math.pow(2,16);function th(t){return 65535&t}var eh=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=null),this.pos=t,this.deleted=e,this.recover=n},nh=function(t,e){void 0===e&&(e=!1),this.ranges=t,this.inverted=e};nh.prototype.recover=function(t){var e=0,n=th(t);if(!this.inverted)for(var r=0;r<n;r++)e+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+e+function(t){return(t-(65535&t))/Qu}(t)},nh.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},nh.prototype.map=function(t,e){return void 0===e&&(e=1),this._map(t,e,!0)},nh.prototype._map=function(t,e,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?r:0);if(a>t)break;var c=this.ranges[s+o],l=this.ranges[s+i],u=a+c;if(t<=u){var h=a+r+((c?t==a?-1:t==u?1:e:e)<0?0:l);if(n)return h;var p=s/3+(t-a)*Qu;return new eh(h,e<0?t!=a:t!=u,p)}r+=l-c}return n?t+r:new eh(t+r)},nh.prototype.touches=function(t,e){for(var n=0,r=th(e),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var a=this.ranges[s]-(this.inverted?n:0);if(a>t)break;var c=this.ranges[s+o];if(t<=a+c&&s==3*r)return!0;n+=this.ranges[s+i]-c}return!1},nh.prototype.forEach=function(t){for(var e=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+e],l=this.ranges[r+n];t(s,s+c,a,a+l),o+=l-c}},nh.prototype.invert=function(){return new nh(this.ranges,!this.inverted)},nh.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},nh.offset=function(t){return 0==t?nh.empty:new nh(t<0?[0,-t,0]:[0,0,t])},nh.empty=new nh([]);var rh=function(t,e,n,r){this.maps=t||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=e};function oh(t){var e=Error.call(this,t);return e.__proto__=oh.prototype,e}rh.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.maps.length),new rh(this.maps,this.mirror,t,e)},rh.prototype.copy=function(){return new rh(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},rh.prototype.appendMap=function(t,e){this.to=this.maps.push(t),null!=e&&this.setMirror(this.maps.length-1,e)},rh.prototype.appendMapping=function(t){for(var e=0,n=this.maps.length;e<t.maps.length;e++){var r=t.getMirror(e);this.appendMap(t.maps[e],null!=r&&r<e?n+r:null)}},rh.prototype.getMirror=function(t){if(this.mirror)for(var e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]},rh.prototype.setMirror=function(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)},rh.prototype.appendMappingInverted=function(t){for(var e=t.maps.length-1,n=this.maps.length+t.maps.length;e>=0;e--){var r=t.getMirror(e);this.appendMap(t.maps[e].invert(),null!=r&&r>e?n-r-1:null)}},rh.prototype.invert=function(){var t=new rh;return t.appendMappingInverted(this),t},rh.prototype.map=function(t,e){if(void 0===e&&(e=1),this.mirror)return this._map(t,e,!0);for(var n=this.from;n<this.to;n++)t=this.maps[n].map(t,e);return t},rh.prototype.mapResult=function(t,e){return void 0===e&&(e=1),this._map(t,e,!1)},rh.prototype._map=function(t,e,n){for(var r=!1,o=null,i=this.from;i<this.to;i++){var s=this.maps[i],a=o&&o[i];if(null!=a&&s.touches(t,a))t=s.recover(a);else{var c=s.mapResult(t,e);if(null!=c.recover){var l=this.getMirror(i);if(null!=l&&l>i&&l<this.to){if(c.deleted){i=l,t=this.maps[l].recover(c.recover);continue}(o||(o=Object.create(null)))[l]=c.recover}}c.deleted&&(r=!0),t=c.pos}}return n?t:new eh(t,r)},oh.prototype=Object.create(Error.prototype),oh.prototype.constructor=oh,oh.prototype.name="TransformError";var ih=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new rh},sh={before:{configurable:!0},docChanged:{configurable:!0}};function ah(){throw new Error("Override me")}sh.before.get=function(){return this.docs.length?this.docs[0]:this.doc},ih.prototype.step=function(t){var e=this.maybeStep(t);if(e.failed)throw new oh(e.failed);return this},ih.prototype.maybeStep=function(t){var e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e},sh.docChanged.get=function(){return this.steps.length>0},ih.prototype.addStep=function(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e},Object.defineProperties(ih.prototype,sh);var ch=Object.create(null),lh=function(){};lh.prototype.apply=function(t){return ah()},lh.prototype.getMap=function(){return nh.empty},lh.prototype.invert=function(t){return ah()},lh.prototype.map=function(t){return ah()},lh.prototype.merge=function(t){return null},lh.prototype.toJSON=function(){return ah()},lh.fromJSON=function(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=ch[e.stepType];if(!n)throw new RangeError("No step type "+e.stepType+" defined");return n.fromJSON(t,e)},lh.jsonID=function(t,e){if(t in ch)throw new RangeError("Duplicate use of step JSON ID "+t);return ch[t]=e,e.prototype.jsonID=t,e};var uh=function(t,e){this.doc=t,this.failed=e};uh.ok=function(t){return new uh(t,null)},uh.fail=function(t){return new uh(null,t)},uh.fromReplace=function(t,e,n,r){try{return uh.ok(t.replace(e,n,r))}catch(t){if(t instanceof Yl)return uh.fail(t.message);throw t}};var hh=function(t){function e(e,n,r,o){t.call(this),this.from=e,this.to=n,this.slice=r,this.structure=!!o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){return this.structure&&fh(t,this.from,this.to)?uh.fail("Structure replace would overwrite content"):uh.fromReplace(t,this.from,this.to,this.slice)},e.prototype.getMap=function(){return new nh([this.from,this.to-this.from,this.slice.size])},e.prototype.invert=function(t){return new e(this.from,this.from+this.slice.size,t.slice(this.from,this.to))},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new e(n.pos,Math.max(n.pos,r.pos),this.slice)},e.prototype.merge=function(t){if(!(t instanceof e)||t.structure!=this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart){if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;var n=this.slice.size+t.slice.size==0?Xl.empty:new Xl(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new e(t.from,this.to,n,this.structure)}var r=this.slice.size+t.slice.size==0?Xl.empty:new Xl(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new e(this.from,this.to+(t.to-t.from),r,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new e(n.from,n.to,Xl.fromJSON(t,n.slice),!!n.structure)},e}(lh);lh.jsonID("replace",hh);var ph=function(t){function e(e,n,r,o,i,s,a){t.call(this),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){if(this.structure&&(fh(t,this.from,this.gapFrom)||fh(t,this.gapTo,this.to)))return uh.fail("Structure gap-replace would overwrite content");var e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return uh.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,e.content);return n?uh.fromReplace(t,this.from,this.to,n):uh.fail("Content does not fit in gap")},e.prototype.getMap=function(){return new nh([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},e.prototype.invert=function(t){var n=this.gapTo-this.gapFrom;return new e(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),o=t.map(this.gapFrom,-1),i=t.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new e(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},e.prototype.toJSON=function(){var t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new e(n.from,n.to,n.gapFrom,n.gapTo,Xl.fromJSON(t,n.slice),n.insert,!!n.structure)},e}(lh);function fh(t,e,n){for(var r=t.resolve(e),o=n-e,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function dh(t,e,n){for(var r=[],o=0;o<t.childCount;o++){var i=t.child(o);i.content.size&&(i=i.copy(dh(i.content,e,i))),i.isInline&&(i=e(i,n,o)),r.push(i)}return Jl.fromArray(r)}lh.jsonID("replaceAround",ph),ih.prototype.lift=function(t,e){for(var n=t.$from,r=t.$to,o=t.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,l=Jl.empty,u=0,h=o,p=!1;h>e;h--)p||n.index(h)>0?(p=!0,l=Jl.from(n.node(h).copy(l)),u++):a--;for(var f=Jl.empty,d=0,v=o,m=!1;v>e;v--)m||r.after(v+1)<r.end(v)?(m=!0,f=Jl.from(r.node(v).copy(f)),d++):c++;return this.step(new ph(a,c,i,s,new Xl(l.append(f),u,d),l.size-u,!0))},ih.prototype.wrap=function(t,e){for(var n=Jl.empty,r=e.length-1;r>=0;r--)n=Jl.from(e[r].type.create(e[r].attrs,n));var o=t.start,i=t.end;return this.step(new ph(o,i,o,i,new Xl(n,0,0),e.length,!0))},ih.prototype.setBlockType=function(t,e,n,r){var o=this;if(void 0===e&&(e=t),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(t,e,(function(t,e){if(t.isTextblock&&!t.hasMarkup(n,r)&&function(t,e,n){var r=t.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(e),n)){o.clearIncompatible(o.mapping.slice(i).map(e,1),n);var s=o.mapping.slice(i),a=s.map(e,1),c=s.map(e+t.nodeSize,1);return o.step(new ph(a,c,a+1,c-1,new Xl(Jl.from(n.create(r,null,t.marks)),0,0),1,!0)),!1}})),this},ih.prototype.setNodeMarkup=function(t,e,n,r){var o=this.doc.nodeAt(t);if(!o)throw new RangeError("No node at given position");e||(e=o.type);var i=e.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(t,t+o.nodeSize,i);if(!e.validContent(o.content))throw new RangeError("Invalid content for node type "+e.name);return this.step(new ph(t,t+o.nodeSize,t+1,t+o.nodeSize-1,new Xl(Jl.from(i),0,0),1,!0))},ih.prototype.split=function(t,e,n){void 0===e&&(e=1);for(var r=this.doc.resolve(t),o=Jl.empty,i=Jl.empty,s=r.depth,a=r.depth-e,c=e-1;s>a;s--,c--){o=Jl.from(r.node(s).copy(o));var l=n&&n[c];i=Jl.from(l?l.type.create(l.attrs,i):r.node(s).copy(i))}return this.step(new hh(t,t,new Xl(o.append(i),e,e),!0))},ih.prototype.join=function(t,e){void 0===e&&(e=1);var n=new hh(t-e,t+e,Xl.empty,!0);return this.step(n)};var vh=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=t.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new Xl(dh(n.content,(function(t,n){return n.type.allowsMarkType(e.mark.type)?t.mark(e.mark.addToSet(t.marks)):t}),o),n.openStart,n.openEnd);return uh.fromReplace(t,this.from,this.to,i)},e.prototype.invert=function(){return new mh(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(lh);lh.jsonID("addMark",vh);var mh=function(t){function e(e,n,r){t.call(this),this.from=e,this.to=n,this.mark=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t){var e=this,n=t.slice(this.from,this.to),r=new Xl(dh(n.content,(function(t){return t.mark(e.mark.removeFromSet(t.marks))})),n.openStart,n.openEnd);return uh.fromReplace(t,this.from,this.to,r)},e.prototype.invert=function(){return new vh(this.from,this.to,this.mark)},e.prototype.map=function(t){var n=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new e(n.pos,r.pos,this.mark)},e.prototype.merge=function(t){if(t instanceof e&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from)return new e(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark)},e.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},e.fromJSON=function(t,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new e(n.from,n.to,t.markFromJSON(n.mark))},e}(lh);function gh(t,e,n,r){if(void 0===n&&(n=e),void 0===r&&(r=Xl.empty),e==n&&!r.size)return null;var o=t.resolve(e),i=t.resolve(n);if(wh(o,i,r))return new hh(e,n,r);var s=function(t,e){var n=function t(e,n,r,o){var i=Jl.empty,s=0,a=r[n];if(e.depth>n){var c=t(e,n+1,r,o||a);s=c.openEnd+1,i=Jl.from(e.node(n+1).copy(c.content))}a&&(i=i.append(a.content),s=a.openEnd);o&&(i=i.append(e.node(n).contentMatchAt(e.indexAfter(n)).fillBefore(Jl.empty,!0)),s=0);return{content:i,openEnd:s}}(t,0,e,!1),r=n.content,o=n.openEnd;return new Xl(r,t.depth,o||0)}(o,function(t,e){for(var n=new xh(t),r=1;e.size&&r<=3;r++){var o=n.placeSlice(e.content,e.openStart,e.openEnd,r);3==r&&o!=e&&o.size&&(r=0),e=o}for(;n.open.length;)n.closeNode();return n.placed}(o,r)),a=bh(o,i,s);if(!a)return null;if(s.size!=a.size&&function(t,e,n){if(!e.parent.isTextblock)return!1;var r,o=n.openEnd?function(t,e){for(var n=1;n<e;n++)t=t.lastChild.content;return t.lastChild}(n.content,n.openEnd):t.node(t.depth-(n.openStart-n.openEnd));if(!o.isTextblock)return!1;for(var i=e.index();i<e.parent.childCount;i++)if(!o.type.allowsMarks(e.parent.child(i).marks))return!1;n.openEnd?r=o.contentMatchAt(o.childCount):(r=o.contentMatchAt(o.childCount),n.size&&(r=r.matchFragment(n.content,n.openStart?1:0)));return(r=r.matchFragment(e.parent.content,e.index()))&&r.validEnd}(o,i,s)){for(var c=i.depth,l=i.after(c);c>1&&l==i.end(--c);)++l;var u=bh(o,t.resolve(l),s);if(u)return new ph(e,l,n,i.end(),u,s.size)}return a.size||e!=n?new hh(e,n,a):null}function yh(t,e,n,r,o,i,s){var a,c=t.childCount,l=c-(s>0?1:0),u=i<0?e:n.node(o);a=i<0?u.contentMatchAt(l):1==c&&s>0?u.contentMatchAt(i?n.index(o):n.indexAfter(o)):u.contentMatchAt(n.indexAfter(o)).matchFragment(t,c>0&&i?1:0,l);var h=r.node(o);if(s>0&&o<r.depth){var p=h.content.cutByIndex(r.indexAfter(o)).addToStart(t.lastChild),f=a.fillBefore(p,!0);if(f&&f.size&&i>0&&1==c&&(f=null),f){var d=yh(t.lastChild.content,t.lastChild,n,r,o+1,1==c?i-1:-1,s-1);if(d){var v=t.lastChild.copy(d);return f.size?t.cutByIndex(0,c-1).append(f).addToEnd(v):t.replaceChild(c-1,v)}}}s>0&&(a=a.matchType((1==c&&i>0?n.node(o+1):t.lastChild).type));var m=r.index(o);if(m==h.childCount&&!h.type.compatibleContent(e.type))return null;for(var g=a.fillBefore(h.content,!0,m),y=m;g&&y<h.content.childCount;y++)u.type.allowsMarks(h.content.child(y).marks)||(g=null);if(!g)return null;if(s>0){var b=function t(e,n,r,o,i){var s,a=e.content,c=a.childCount;s=i>=0?r.node(o).contentMatchAt(r.indexAfter(o)).matchFragment(a,i>0?1:0,c):e.contentMatchAt(c);if(n>0){var l=t(a.lastChild,n-1,r,o+1,1==c?i-1:-1);a=a.replaceChild(c-1,l)}return e.copy(a.append(s.fillBefore(Jl.empty,!0)))}(t.lastChild,s-1,n,o+1,1==c?i-1:-1);t=t.replaceChild(c-1,b)}return t=t.append(g),r.depth>o&&(t=t.addToEnd(function t(e,n){var r=e.node(n),o=r.contentMatchAt(0).fillBefore(r.content,!0,e.index(n));e.depth>n&&(o=o.addToEnd(t(e,n+1)));return r.copy(o)}(r,o+1))),t}function bh(t,e,n){var r=yh(n.content,t.node(0),t,e,0,n.openStart,n.openEnd);return r?function(t,e,n){for(;e>0&&n>0&&1==t.childCount;)t=t.firstChild.content,e--,n--;return new Xl(t,e,n)}(r,n.openStart,e.depth):null}function wh(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}lh.jsonID("removeMark",mh),ih.prototype.addMark=function(t,e,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(t,e,(function(r,c,l){if(r.isInline){var u=r.marks;if(!n.isInSet(u)&&l.type.allowsMarkType(n.type)){for(var h=Math.max(c,t),p=Math.min(c+r.nodeSize,e),f=n.addToSet(u),d=0;d<u.length;d++)u[d].isInSet(f)||(s&&s.to==h&&s.mark.eq(u[d])?s.to=p:o.push(s=new mh(h,p,u[d])));a&&a.to==h?a.to=p:i.push(a=new vh(h,p,n))}}})),o.forEach((function(t){return r.step(t)})),i.forEach((function(t){return r.step(t)})),this},ih.prototype.removeMark=function(t,e,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(t,e,(function(r,s){if(r.isInline){i++;var a=null;if(n instanceof _u){var c=n.isInSet(r.marks);c&&(a=[c])}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var l=Math.min(s+r.nodeSize,e),u=0;u<a.length;u++){for(var h=a[u],p=void 0,f=0;f<o.length;f++){var d=o[f];d.step==i-1&&h.eq(o[f].style)&&(p=d)}p?(p.to=l,p.step=i):o.push({style:h,from:Math.max(s,t),to:l,step:i})}}})),o.forEach((function(t){return r.step(new mh(t.from,t.to,t.style))})),this},ih.prototype.clearIncompatible=function(t,e,n){void 0===n&&(n=e.contentMatch);for(var r=this.doc.nodeAt(t),o=[],i=t+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,l=n.matchType(a.type,a.attrs);if(l){n=l;for(var u=0;u<a.marks.length;u++)e.allowsMarkType(a.marks[u].type)||this.step(new mh(i,c,a.marks[u]))}else o.push(new hh(i,c,Xl.empty));i=c}if(!n.validEnd){var h=n.fillBefore(Jl.empty,!0);this.replace(i,i,new Xl(h,0,0))}for(var p=o.length-1;p>=0;p--)this.step(o[p]);return this},ih.prototype.replace=function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=Xl.empty);var r=gh(this.doc,t,e,n);return r&&this.step(r),this},ih.prototype.replaceWith=function(t,e,n){return this.replace(t,e,new Xl(Jl.from(n),0,0))},ih.prototype.delete=function(t,e){return this.replace(t,e,Xl.empty)},ih.prototype.insert=function(t,e){return this.replaceWith(t,t,e)};var xh=function(t){this.open=[];for(var e=0;e<=t.depth;e++){var n=t.node(e),r=n.contentMatchAt(t.indexAfter(e));this.open.push({parent:n,match:r,content:Jl.empty,wrapper:!1,openEnd:0,depth:e})}this.placed=[]};function kh(t,e,n){var r=t.content;if(e>1){var o=kh(t.firstChild,e-1,1==t.childCount?n-1:0);r=t.content.replaceChild(0,o)}var i=t.type.contentMatch.fillBefore(r,0==n);return t.copy(i.append(r))}function Sh(t,e,n,r,o){if(e<n){var i=t.firstChild;t=t.replaceChild(0,i.copy(Sh(i.content,e+1,n,r,i)))}if(e>r){var s=o.contentMatchAt(0),a=s.fillBefore(t).append(t);t=a.append(s.matchFragment(a).fillBefore(Jl.empty,!0))}return t}function Ch(t,e){for(var n=[],r=Math.min(t.depth,e.depth);r>=0;r--){var o=t.start(r);if(o<t.pos-(t.depth-r)||e.end(r)>e.pos+(e.depth-r)||t.node(r).type.spec.isolating||e.node(r).type.spec.isolating)break;o==e.start(r)&&n.push(r)}return n}xh.prototype.placeSlice=function(t,e,n,r,o){if(e>0){var i=t.firstChild,s=this.placeSlice(i.content,Math.max(0,e-1),n&&1==t.childCount?n-1:0,r,i);s.content!=i.content&&(s.content.size?(t=t.replaceChild(0,i.copy(s.content)),e=s.openStart+1):(1==t.childCount&&(n=0),t=t.cutByIndex(1),e=0))}var a=this.placeContent(t,e,n,r,o);if(r>2&&a.size&&0==e){var c=a.content.firstChild,l=1==a.content.childCount;this.placeContent(c.content,0,n&&l?n-1:0,r,c),a=l?Jl.empty:new Xl(a.content.cutByIndex(1),0,n)}return a},xh.prototype.placeContent=function(t,e,n,r,o){for(var i=0;i<t.childCount;i++){for(var s=t.child(i),a=!1,c=i==t.childCount-1,l=this.open.length-1;l>=0;l--){var u=this.open[l],h=void 0;if(r>1&&(h=u.match.findWrapping(s.type))&&(!o||!h.length||h[h.length-1]!=o.type)){for(;this.open.length-1>l;)this.closeNode();for(var p=0;p<h.length;p++)u.match=u.match.matchType(h[p]),l++,u={parent:h[p].create(),match:h[p].contentMatch,content:Jl.empty,wrapper:!0,openEnd:0,depth:l+p},this.open.push(u)}var f=u.match.matchType(s.type);if(!f){var d=u.match.fillBefore(Jl.from(s));if(!d){if(o&&u.match.matchType(o.type))break;continue}for(var v=0;v<d.childCount;v++){var m=d.child(v);this.addNode(u,m,0),f=u.match.matchFragment(m)}}for(;this.open.length-1>l;)this.closeNode();s=s.mark(u.parent.type.allowedMarks(s.marks)),e&&(s=kh(s,e,c?n:0),e=0),this.addNode(u,s,c?n:0),u.match=f,c&&(n=0),a=!0;break}if(!a)break}return this.open.length>1&&(i>0&&i==t.childCount||o&&this.open[this.open.length-1].parent.type==o.type)&&this.closeNode(),new Xl(t.cutByIndex(i),e,n)},xh.prototype.addNode=function(t,e,n){var r,o;t.content=(r=t.content,o=t.openEnd,o?r.replaceChild(r.childCount-1,function t(e,n){var r=e.content;if(n>1){var o=t(e.lastChild,n-1);r=e.content.replaceChild(e.childCount-1,o)}var i=e.contentMatchAt(e.childCount).fillBefore(Jl.empty,!0);return e.copy(r.append(i))}(r.lastChild,o)):r).addToEnd(e),t.openEnd=n},xh.prototype.closeNode=function(){var t=this.open.pop();0==t.content.size||(t.wrapper?this.addNode(this.open[this.open.length-1],t.parent.copy(t.content),t.openEnd+1):this.placed[t.depth]={depth:t.depth,content:t.content,openEnd:t.openEnd})},ih.prototype.replaceRange=function(t,e,n){if(!n.size)return this.deleteRange(t,e);var r=this.doc.resolve(t),o=this.doc.resolve(e);if(wh(r,o,n))return this.step(new hh(t,e,n));var i=Ch(r,this.doc.resolve(e));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var l=r.node(a).type.spec;if(l.defining||l.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var u=i.indexOf(s),h=[],p=n.openStart,f=n.content,d=0;;d++){var v=f.firstChild;if(h.push(v),d==n.openStart)break;f=v.content}p>0&&h[p-1].type.spec.defining&&r.node(u).type!=h[p-1].type?p-=1:p>=2&&h[p-1].isTextblock&&h[p-2].type.spec.defining&&r.node(u).type!=h[p-2].type&&(p-=2);for(var m=n.openStart;m>=0;m--){var g=(m+p+1)%(n.openStart+1),y=h[g];if(y)for(var b=0;b<i.length;b++){var w=i[(b+u)%i.length],x=!0;w<0&&(x=!1,w=-w);var k=r.node(w-1),S=r.index(w-1);if(k.canReplaceWith(S,S,y.type,y.marks))return this.replace(r.before(w),x?o.after(w):e,new Xl(Sh(n.content,0,n.openStart,g),g,n.openEnd))}}for(var C=this.steps.length,O=i.length-1;O>=0&&(this.replace(t,e,n),!(this.steps.length>C));O--){var N=i[O];O<0||(t=r.before(N),e=o.after(N))}return this},ih.prototype.replaceRangeWith=function(t,e,n){if(!n.isInline&&t==e&&this.doc.resolve(t).parent.content.size){var r=function(t,e,n){var r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}(this.doc,t,n.type);null!=r&&(t=e=r)}return this.replaceRange(t,e,new Xl(Jl.from(n),0,0))},ih.prototype.deleteRange=function(t,e){for(var n=this.doc.resolve(t),r=this.doc.resolve(e),o=Ch(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth;c++)if(t-n.start(c)==n.depth-c&&e>n.end(c)&&r.end(c)-e!=r.depth-c)return this.delete(n.before(c),e);return this.delete(t,e)};new i.PluginKey("collab");var Oh=function(){};Oh.prototype.append=function(t){return t.length?(t=Oh.from(t),!this.length&&t||t.length<200&&this.leafAppend(t)||this.length<200&&t.leafPrepend(this)||this.appendInner(t)):this},Oh.prototype.prepend=function(t){return t.length?Oh.from(t).append(this):this},Oh.prototype.appendInner=function(t){return new Mh(this,t)},Oh.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e?Oh.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},Oh.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},Oh.prototype.forEach=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length),e<=n?this.forEachInner(t,e,n,0):this.forEachInvertedInner(t,e,n,0)},Oh.prototype.map=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(e,n){return r.push(t(e,n))}),e,n),r},Oh.from=function(t){return t instanceof Oh?t:t&&t.length?new Nh(t):Oh.empty};var Nh=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,n){return 0==t&&n==this.length?this:new e(this.values.slice(t,n))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,n,r){for(var o=e;o<n;o++)if(!1===t(this.values[o],r+o))return!1},e.prototype.forEachInvertedInner=function(t,e,n,r){for(var o=e-1;o>=n;o--)if(!1===t(this.values[o],r+o))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=200)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=200)return new e(t.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Oh);Oh.empty=new Nh([]);var Mh=function(t){function e(e,n){t.call(this),this.left=e,this.right=n,this.length=e.length+n.length,this.depth=Math.max(e.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,n,r){var o=this.left.length;return!(e<o&&!1===this.left.forEachInner(t,e,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(t,Math.max(e-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},e.prototype.forEachInvertedInner=function(t,e,n,r){var o=this.left.length;return!(e>o&&!1===this.right.forEachInvertedInner(t,e-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(t,Math.min(e,o),n,r))&&void 0)},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var n=this.left.length;return e<=n?this.left.slice(t,e):t>=n?this.right.slice(t-n,e-n):this.left.slice(t,n).append(this.right.slice(0,e-n))},e.prototype.leafAppend=function(t){var n=this.right.leafAppend(t);if(n)return new e(this.left,n)},e.prototype.leafPrepend=function(t){var n=this.left.leafPrepend(t);if(n)return new e(n,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(Oh),Th=Oh,Ah=function(t,e){this.items=t,this.eventCount=e};Ah.prototype.popEvent=function(t,e){var n=this;if(0==this.eventCount)return null;for(var r,o,i=this.items.length;;i--){if(this.items.get(i-1).selection){--i;break}}e&&(r=this.remapping(i,this.items.length),o=r.maps.length);var s,a,c=t.tr,l=[],u=[];return this.items.forEach((function(t,e){if(!t.step)return r||(r=n.remapping(i,e+1),o=r.maps.length),o--,void u.push(t);if(r){u.push(new Eh(t.map));var h,p=t.step.map(r.slice(o));p&&c.maybeStep(p).doc&&(h=c.mapping.maps[c.mapping.maps.length-1],l.push(new Eh(h,null,null,l.length+u.length))),o--,h&&r.appendMap(h,o)}else c.maybeStep(t.step);return t.selection?(s=r?t.selection.map(r.slice(o)):t.selection,a=new Ah(n.items.slice(0,i).append(u.reverse().concat(l)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:a,transform:c,selection:s}},Ah.prototype.addTransform=function(t,e,n,r){for(var o=[],i=this.eventCount,s=this.items,a=!r&&s.length?s.get(s.length-1):null,c=0;c<t.steps.length;c++){var l,u=t.steps[c].invert(t.docs[c]),h=new Eh(t.mapping.maps[c],u,e);(l=a&&a.merge(h))&&(h=l,c?o.pop():s=s.slice(0,s.length-1)),o.push(h),e&&(i++,e=null),r||(a=h)}var p,f,d,v=i-n.depth;return v>Dh&&(f=v,(p=s).forEach((function(t,e){if(t.selection&&0==f--)return d=e,!1})),s=p.slice(d),i-=v),new Ah(s.append(o),i)},Ah.prototype.remapping=function(t,e){var n=new mt.a;return this.items.forEach((function(e,r){var o=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?o=n.maps.length-e.mirrorOffset:null;n.appendMap(e.map,o)}),t,e),n},Ah.prototype.addMaps=function(t){return 0==this.eventCount?this:new Ah(this.items.append(t.map((function(t){return new Eh(t)}))),this.eventCount)},Ah.prototype.rebased=function(t,e){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-e),o=t.mapping,i=t.steps.length,s=this.eventCount;this.items.forEach((function(t){t.selection&&s--}),r);var a=e;this.items.forEach((function(e){var r=o.getMirror(--a);if(null!=r){i=Math.min(i,r);var c=o.maps[r];if(e.step){var l=t.steps[r].invert(t.docs[r]),u=e.selection&&e.selection.map(o.slice(a+1,r));u&&s++,n.push(new Eh(c,l,u))}else n.push(new Eh(c))}}),r);for(var c=[],l=e;l<i;l++)c.push(new Eh(o.maps[l]));var u=this.items.slice(0,r).append(c).append(n),h=new Ah(u,s);return h.emptyItemCount()>500&&(h=h.compress(this.items.length-n.length)),h},Ah.prototype.emptyItemCount=function(){var t=0;return this.items.forEach((function(e){e.step||t++})),t},Ah.prototype.compress=function(t){void 0===t&&(t=this.items.length);var e=this.remapping(0,t),n=e.maps.length,r=[],o=0;return this.items.forEach((function(i,s){if(s>=t)r.push(i),i.selection&&o++;else if(i.step){var a=i.step.map(e.slice(n)),c=a&&a.getMap();if(n--,c&&e.appendMap(c,n),a){var l=i.selection&&i.selection.map(e.slice(n));l&&o++;var u,h=new Eh(c.invert(),a,l),p=r.length-1;(u=r.length&&r[p].merge(h))?r[p]=u:r.push(h)}}else i.map&&n--}),this.items.length,0),new Ah(Th.from(r.reverse()),o)},Ah.empty=new Ah(Th.empty,0);var Eh=function(t,e,n,r){this.map=t,this.step=e,this.selection=n,this.mirrorOffset=r};Eh.prototype.merge=function(t){if(this.step&&t.step&&!t.selection){var e=t.step.merge(this.step);if(e)return new Eh(e.getMap().invert(),e,this.selection)}};var Dh=20;new i.PluginKey("history"),new i.PluginKey("closeHistory");
/*!
    * tiptap-extensions v1.28.5
    * (c) 2019 Scrumpy UG (limited liability)
    * @license MIT
    */
function Ph(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ih(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rh(t,e,n){return e&&Ih(t.prototype,e),n&&Ih(t,n),t}function zh(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_h(Object(n),!0).forEach((function(e){zh(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Bh(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fh(t,e)}function jh(t){return(jh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fh(t,e){return(Fh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vh(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}Object(ql.tableNodes)({tableGroup:"block",cellContent:"block+",cellAttributes:{background:{default:null,getFromDOM:function(t){return t.style.backgroundColor||null},setDOMAttr:function(t,e){if(t){var n={style:"".concat(e.style||"","background-color: ").concat(t,";")};Object.assign(e,n)}}}}});var Lh=function(t){function e(){return Ph(this,e),Vh(this,jh(e).apply(this,arguments))}return Bh(e,t),Rh(e,[{key:"keys",value:function(t){return{"Mod-b":Co(t.type)}}},{key:"commands",value:function(t){var e=t.type;return function(){return Co(e)}}},{key:"inputRules",value:function(t){return[qo(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,t.type)]}},{key:"pasteRules",value:function(t){return[Wo(/(?:\*\*|__)([^*_]+)(?:\*\*|__)/g,t.type)]}},{key:"name",get:function(){return"bold"}},{key:"schema",get:function(){return{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(t){return"normal"!==t.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(t){return/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}}],toDOM:function(){return["strong",0]}}}}]),e}(hi),qh=function(t){function e(){return Ph(this,e),Vh(this,jh(e).apply(this,arguments))}return Bh(e,t),Rh(e,[{key:"commands",value:function(t){var e=t.type;return function(t){return t.href?function(t,e){return function(n,r){var o=n.tr,i=n.selection,s=n.doc,a=i.from,c=i.to,l=i.$from;if(i.empty){var u=Bo(l,t);a=u.from,c=u.to}return s.rangeHasMark(a,c,t)&&o.removeMark(a,c,t),o.addMark(a,c,t.create(e)),r(o)}}(e,t):function(t){return function(e,n){var r=e.tr,o=e.selection,i=o.from,s=o.to,a=o.$from;if(o.empty){var c=Bo(a,t);i=c.from,s=c.to}return r.removeMark(i,s,t),n(r)}}(e)}}},{key:"pasteRules",value:function(t){return[Jo(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-zA-Z]{2,}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g,t.type,(function(t){return{href:t}}))]}},{key:"name",get:function(){return"link"}},{key:"defaultOptions",get:function(){return{openOnClick:!0}}},{key:"schema",get:function(){return{attrs:{href:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(t){return{href:t.getAttribute("href")}}}],toDOM:function(t){return["a",$h({},t.attrs,{rel:"noopener noreferrer nofollow"}),0]}}}},{key:"plugins",get:function(){return this.options.openOnClick?[new i.Plugin({props:{handleClick:function(t,e,n){var r=t.state.schema,o=$o(t.state,r.marks.link);o.href&&n.target instanceof HTMLAnchorElement&&(n.stopPropagation(),window.open(o.href))}}})]:[]}}]),e}(hi),Jh={name:"NWysiwygPluginBold",extends:Mi,computed:{active:function(){return this.editor.isActive.bold()}},methods:{toggleBoldState:function(){this.editor.commands.bold()}},created:function(){this.NWysiwyg.addExtension(new Lh)},render:function(){var t=arguments[0];return t("div",[t("NButton",{attrs:{square:!0,icon:"fa fa-bold"},on:{click:this.toggleBoldState}})])}};function Wh(t){return(Wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kh(t,e){return!e||"object"!==Wh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gh(t){return(Gh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yh(t,e){return(Yh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xh=function(t){function e(){return Hh(this,e),Kh(this,Gh(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yh(t,e)}(e,t),n=e,(r=[{key:"schema",get:function(){return{attrs:{href:{default:null},target:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(t){return{href:t.getAttribute("href"),target:t.getAttribute("target")}}}],toDOM:function(t){return["a",t.attrs]}}}}])&&Uh(n.prototype,r),o&&Uh(n,o),e}(qh),Zh={name:"NWysiwygPluginLink",extends:Mi,computed:{active:function(){return this.editor.isActive.link()}},data:function(){return{value:{},visible:!1}},methods:{toggleLinkState:function(){this.value=wi.Obj.assign({},this.getMarkAttrs("link")),this.visible=!0},confirmLinkState:function(){this.editor.commands.link(this.value),this.visible=!1},removeLinkState:function(){this.editor.commands.link({href:null}),this.visible=!1}},created:function(){this.NWysiwyg.addExtension(new Xh)},render:function(){var t=this,e=arguments[0];return e("div",[e("NButton",{attrs:{square:!0,icon:"fa fa-link"},on:{click:this.toggleLinkState}}),e("NModal",{attrs:{selector:!1},model:{value:t.visible,callback:function(e){t.visible=e}}},[e("NForm",[e("NFormItem",{attrs:{label:this.trans("URL")}},[e("NInput",{attrs:{placeholder:this.trans("http://google.com")},model:{value:t.value.href,callback:function(e){t.$set(t.value,"href",e)}}})]),e("NFormItem",{attrs:{label:this.trans("Target")}},[e("NSelect",{model:{value:t.value.target,callback:function(e){t.$set(t.value,"target",e)}}},[e("NSelectOption",{attrs:{value:"_self"}},[this.trans("Same window")]),e("NSelectOption",{attrs:{value:"_blank"}},[this.trans("New window")])])])]),e("div",{slot:"footer"},[e("NButton",{attrs:{type:"primary"},on:{click:this.confirmLinkState}},[this.trans("Confirm")]),e("NButton",{attrs:{type:"danger"},on:{click:this.removeLinkState}},[this.trans("Remove")])])])])}};o.a.component(Ci.name,Ci),o.a.component(Jh.name,Jh),o.a.component(Zh.name,Zh)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var p={name:"NTable",model:{prop:"items"},props:{items:{default:function(){return[]}},selected:{default:function(){return[]}},expanded:{default:function(){return[]}},sortProp:{default:function(){return"id"},type:[String]},sortDir:{default:function(){return"desc"},type:[String]},sortOnLabel:{default:function(){return!1},type:[Boolean]},filterProps:{default:function(){return[]},type:[Array]},group:{default:function(){return["default"]},type:[Array]},safeZone:{default:function(){return function(t){return.2*t}}},showEmpty:{default:function(){return!0},type:[Boolean]},itemHeight:{default:function(){return 34},type:[Number]},viewportHeight:{default:function(){return!1}},keyProp:{default:function(){return"md5"},type:[String]},orderProp:{default:function(){return"order"},type:[String]},uniqueProp:{default:function(){return"id"},type:[String]},depthProp:{default:function(){return"depth"},type:[String]},pathProp:{default:function(){return"path"},type:[String]},indexProp:{default:function(){return"index"},type:[String]},childProp:{default:function(){return"children"},type:[String]},renderSelect:{default:function(){return!0},type:[Boolean]},renderExpand:{default:function(){return!1},type:[Boolean]},transformDrop:{default:function(){return function(t){return t}}},disableMove:{default:function(){return!1},type:[Boolean]},insertNode:{default:function(){return function(){return!0}}},removeNode:{default:function(){return function(){return!0}}},allowSelect:{default:function(){return function(){return!0}}},allowDrag:{default:function(){return function(){return!0}}},allowDrop:{default:function(){return function(){return!0}}},wrapNode:{default:function(){return!1},type:[Boolean]},updateDelay:{default:function(){return 100},type:[Number]},preloadItems:{default:function(){return 30},type:[Number]},bufferItems:{default:function(){return 30},type:[Number]}},provide:function(){return{NTable:this}},data:function(){return{veColumns:[],veFilterProps:this.filterProps,veSortProp:this.sortProp,veSortDir:this.sortDir}},methods:{addColumn:function(t){a.Arr.add(this.veColumns,t,{prop:t.prop})},removeColumn:function(t){a.Arr.remove(this.veColumns,{prop:t.prop})},sortByColumn:function(t){var e=this.veSortDir;t===this.veSortProp&&"desc"===this.veSortDir&&(e="asc"),t===this.veSortProp&&"asc"===this.veSortDir&&(e="desc"),this.veSortDir!==e&&this.$emit("update:sortDir",this.veSortDir=e),this.veSortProp!==t&&this.$emit("update:sortProp",this.veSortProp=t),this.$emit("sort",this.veSortProp,this.veSortDir)},toggleSelected:function(){this.$refs.list.toggleAllItems(this.$refs.list.isIntermediate(!0))}},renderExpand:function(){var t=this.$createElement;return this.renderExpand?t("div",{class:"n-draggable-item__expand"}):null},renderSelect:function(){var t=this.$createElement;if(!this.renderSelect)return null;var e={input:this.toggleSelected},n={disabled:!this.items.length},r=Object(a.UUID)();return this.$refs.list&&this.items.length&&(n.checked=this.$refs.list.isAllSelected(!0),n.intermediate=this.$refs.list.isIntermediate(!0),r=a.Any.md5(this.$refs.list.veSelected)),t("div",{class:"n-draggable-item__select"},[t("NCheckbox",s()([{key:r},{props:n},{},{on:e}]))])},renderBody:function(t){return a.Arr.each(this.veColumns,(function(e){return e.ctor("renderBody")(t)}))},renderHead:function(){var t=this.$createElement,e=[this.ctor("renderExpand")(),this.ctor("renderSelect")()],n=a.Arr.each(this.veColumns,(function(t){return t.ctor("renderHead")()}));return t("div",{class:"n-table__head"},[[e].concat(h(n))])},render:function(t){var e=this,n=arguments[0];this.$render=t;var r=a.Obj.assign(a.Obj.clone(this.$props),{renderNode:this.ctor("renderBody")}),o={height:this.viewportHeight+"px"},i=a.Arr.each(this.$slots,(function(t,n){return e.$render("template",{slot:n},t)})),s={on:this.$listeners,scopedSlots:this.$scopedSlots},c=this.$render("NDraggable",l({ref:"list",class:"n-table__body",props:r},s),i);return n("div",{class:"n-table",style:o},[n("NScrollbar",{class:"n-table__wrap",attrs:{relative:!this.viewportHeight}},[n("div",{class:"n-table__inner"},[[this.ctor("renderHead")(),c]])])])}};var f={name:"NTableColumn",inject:{NDraggable:{default:void 0},NTable:{default:void 0}},props:{prop:{default:function(){return"id"},type:[String]},label:{default:function(){return""},type:[String]},type:{default:function(){return"string"},type:[String]},align:{default:function(){return"left"},type:[String]},sort:{default:function(){return!1},type:[Boolean]},filter:{default:function(){return!1},type:[Boolean]},resize:{default:function(){return!0},type:[Boolean]},visible:{default:function(){return!0},type:[Boolean]},breakpoint:{default:function(){return 0},type:[Number]},options:{default:function(){return[]},type:[Object,Array,Function]},optionsValue:{default:function(){return"$value"},type:[String]},optionsLabel:{default:function(){return"$value"},type:[String]},sortProp:{default:function(){return this.prop},type:[String]},filterProp:{default:function(){return this.prop},type:[String]},fluid:{default:function(){return!1},type:[Boolean]},fixedWidth:{default:function(){return 0}},width:{default:function(){return this.fixedWidth||170}},minWidth:{default:function(){return this.fixedWidth||120}},maxWidth:{default:function(){return this.fixedWidth||9999}},emptyText:{default:function(){return this.trans("-")},type:[String]},undefinedText:{default:function(){return this.trans("-")},type:[String]},trueText:{default:function(){return this.trans("Yes")},type:[String]},falseText:{default:function(){return this.trans("No")},type:[String]},datetimeFormat:{default:function(){return this.trans("YYYY-MM-DD HH:mm")},type:[String]}},provide:function(){return{NTableColumn:this}},data:function(){return{veVisible:!0,veWidth:0,veFluid:this.fluid}},methods:{bindAdaptWidth:function(){if(this.veVisible){if(!this.$refs.column)return a.Any.delay(this.bindAdaptWidth,10);this.veFluid=!1,this.veWidth=a.Dom.find(this.$refs.column).width()}},sortByColumn:function(t){a.Dom.find(t.target).closest(".n-table-column__filter")||this.NTable.sortByColumn(this.prop)},adjustResizerPosition:function(){if(!this.$refs.column)return a.Any.delay(this.adjustResizerPosition,500);this.veWidth=a.Dom.find(this.$refs.column).width();var t={left:this.veWidth+"px"};a.Dom.find(this.$refs.column).find("[data-resizer]").css(t)},eventResizerMousedown:function(t){t.preventDefault(),a.Dom.find(this.$refs.column).addClass("n-resize"),a.Dom.find(document).on("mousemove",a.Any.framerate(this.eventResizerMousemove,30),this._uid),a.Dom.find(document).on("mouseup",a.Any.framerate(this.eventResizerMouseup,30),this._uid)},eventResizerMousemove:function(t){this.clientX=t.clientX,t.preventDefault();var e=a.Dom.find(this.$refs.column).offset("left"),n=a.Dom.find(this.$refs.column).scroll("left"),r=this.clientX+n-e;this.minWidth&&(r=Math.max(r,this.minWidth)),this.maxWidth&&(r=Math.min(r,this.maxWidth));var o={left:r+"px"};a.Dom.find(this.$refs.column).find("[data-resizer]").css(o)},eventResizerMouseup:function(t){var e=this;if(t.preventDefault(),a.Dom.find(document).off("mousemove",null,this._uid),a.Dom.find(document).off("mouseup",null,this._uid),this.clientX){var n=a.Dom.find(this.$refs.column).offset("left"),r=a.Dom.find(this.$refs.column).scroll("left"),o=this.clientX+r-n;this.minWidth&&(o=Math.max(o,this.minWidth)),this.maxWidth&&(o=Math.min(o,this.maxWidth)),this.veWidth=o,a.Dom.find(this.$refs.column).removeClass("n-resize"),delete this.clientX,this.$nextTick((function(){return e.NTable.$emit("hook:resized")}))}}},beforeMount:function(){this.NTable.addColumn(this)},mounted:function(){this.NTable.$on("hook:resized",this.adjustResizerPosition),this.NTable.$on("hook:mounted",this.adjustResizerPosition),this.bindAdaptWidth()},beforeDestroy:function(){this.NTable.removeColumn(this)},renderHead:function(){var t=this.$createElement,e=["n-table-column","n-"+this.align];this.NTable.veSortProp===this.prop&&e.push("is-sorted is-"+this.NTable.veSortDir),this.veFluid&&e.push("n-fluid"),this.veWidth&&e.push("n-fixed");var n=this.veWidth;return this.veWidth||(n=this.width),t("div",{ref:"column",class:e,style:{width:n+"px",minWidth:this.minWidth+"px",maxWidth:this.maxWidth+"px"}},[this.ctor("renderHeadSort")(),this.ctor("renderHeadLabel")(),this.ctor("renderHeadFilter")(),this.ctor("renderHeadResizer")()])},renderHeadLabel:function(){var t=this.$createElement;this.boundaryEl||(this.boundaryEl=a.Dom.find(this.NTable.$el).find(".n-table__inner").get(0));var e={};return this.sort&&this.NTable.sortOnLabel&&(e.click=this.sortByColumn),[t("div",s()([{class:"n-table-column__label"},{on:e}]),[this.label]),t("NPopover",{attrs:{type:"tooltip",boundary:this.boundaryEl}},[this.label])]},renderHeadSort:function(){var t=this.$createElement;if(!this.sort)return null;var e={};return this.sort&&!this.NTable.sortOnLabel&&(e.click=this.sortByColumn),t("div",s()([{class:"n-table-column__sort"},{on:e}]),[t("div")])},renderHeadFilter:function(){var t=this.$createElement;if(!this.filter)return null;var e="NTableFilter"+a.Str.ucfirst(this.type),n={column:this};return[t("div",{class:"n-table-column__filter"},[t("div",[t("span",{class:this.icons.angleDown})])]),t("NPopover",{class:"n-popover-filter",attrs:{trigger:"click",boundary:this.boundaryEl}},[this.$render(e,{slot:"raw",props:n})])]},renderHeadResizer:function(){var t=this.$createElement,e={mousedown:this.eventResizerMousedown};return t("div",s()([{class:"n-table-column__resizer",attrs:{"data-resizer":"true"}},{on:e}]))},renderBody:function(t){var e=this.$createElement;if(this.veWidth){var n=this.NTable.$refs.list,r=a.Arr.find(n.veItems,function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},n.uniqueProp,t.value[n.uniqueProp])),o="NTableCell"+a.Str.ucfirst(this.type),i=["n-table-column","n-"+this.align];this.veFluid&&i.push("n-fluid"),this.veWidth&&i.push("n-fixed");var s=a.Arr.findIndex(this.NTable.veColumns,{prop:this.prop}),c=this.veWidth;s||(c-=20*r.depth);var l={width:c+"px"};s&&(l.minWidth=this.minWidth+"px"),t=a.Obj.assign(t,{column:this});var u="".concat(this.prop,"-").concat(t.value[this.NTable.uniqueProp]);return e("div",{class:i,style:l},[this.$scopedSlots.default?this.$scopedSlots.default(t):this.$render(o,{key:u,props:t})])}},render:function(t){return this.$render=t,null}},d=n(6);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g={inject:{NTable:{default:void 0}},props:{column:{required:!0},value:{required:!0}},computed:{input:function(){return a.Obj.get(this.value,this.column.prop)}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},d.a),render:function(){var t=arguments[0];return t("div",{class:"n-table-cell"},[t("span",[this.input])])}},y={name:"NTableCellString",extends:g,render:function(){var t=arguments[0],e=["n-table-cell","n-table-cell--"+this.column.type];return t("div",{class:e},[t("span",[a.Any.convertString(this.input,this.column.emptyText)])])}},b={name:"NTableCellBoolean",extends:g,render:function(){var t=arguments[0],e=["n-table-cell","n-table-cell--"+this.column.type];return t("div",{class:e},[t("span",[a.Any.convertBoolean(this.input,this.column.trueText,this.column.falseText)])])}},w={name:"NTableCellDatetime",extends:g,render:function(){var t=arguments[0],e=["n-table-cell","n-table-cell--"+this.column.type];return t("div",{class:e},[t("span",[a.Any.convertDatetime(this.input,this.column.datetimeFormat,this.column.emptyText)])])}},x={name:"NTableCellOption",extends:g,render:function(){var t=this,e=arguments[0],n=a.Any.isFunction(this.column.options)?this.column.options(this.value):this.column.options;n=a.Arr.map(a.Arr.clone(n),(function(t,e){return{$value:t,$index:e}}));var r=["n-table-cell","n-table-cell--"+this.column.type];return e("div",{class:r},[e("span",[a.Arr.each(a.Any.isArray(this.input)?this.input:[this.input],(function(e){var r=a.Arr.find(n,(function(n){return a.Any.string(a.Obj.get(n,t.column.optionsValue))===a.Any.string(e)}));return a.Obj.get(r,t.column.optionsLabel,t.column.undefinedText)})).join(", ")||this.column.emptyText])])}},k={name:"NTableCellImage",extends:g,render:function(){var t=arguments[0],e=["n-table-cell","n-table-cell--"+this.column.type];return t("div",{class:e,style:"background-image: url('"+this.input+"');"})}};function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O={inject:{NTable:{default:void 0}},props:{column:{required:!0}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){C(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},d.a,{getFilterProps:function(t){var e=a.Arr.find(this.NTable.veFilterProps,{property:this.column.filterProp},{});return a.Obj.assign(t,e)},changeFilter:function(){var t=a.Obj.each(this.form,(function(t){return a.Any.isArray(t)?t.join(","):t}));a.Arr.remove(this.NTable.veFilterProps,{property:this.column.filterProp}),a.Arr.push(this.NTable.veFilterProps,t)},resetFilter:function(){}}),data:function(){var t={property:this.column.filterProp,type:this.column.type,value:null};return{form:this.getFilterProps(t)}},mounted:function(){this.NTable.$on("reset",this.resetFilter)},renderForm:function(){return null},renderReset:function(){return(0,this.$createElement)("NButton",{key:Object(a.UUID)(),attrs:{type:"link",size:"small",disabled:a.Any.isEmpty(this.form.value)},on:{click:this.resetFilter}},[this.trans("Reset")])},render:function(){var t=arguments[0];return t("div",{class:"n-popover__frame"},[t("div",{class:"n-popover__body"},[this.ctor("renderForm")&&this.ctor("renderForm")()]),t("div",{class:"n-popover__footer n-text-right"},[this.ctor("renderReset")&&this.ctor("renderReset")()])])}},N={name:"NTableFilterString",extends:O,methods:{resetFilter:function(){this.form.value=null,this.form.operator="li"}},data:function(){var t={property:this.column.filterProp,type:this.column.type,value:null,operator:"li"};return{form:this.getFilterProps(t)}},renderForm:function(){var t=this,e=this.$createElement,n={change:this.changeFilter};return e("NForm",s()([{attrs:{form:this.form}},{on:n}]),[e("NFormItem",[e("NInput",{attrs:{size:"small"},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)}}})]),e("NFormItem",[e("NSelect",{attrs:{size:"small"},model:{value:t.form.operator,callback:function(e){t.$set(t.form,"operator",e)}}},[e("NSelectOption",{attrs:{value:"li",label:this.trans("Includes value")}}),e("NSelectOption",{attrs:{value:"nl",label:this.trans("Excludes value")}}),e("NSelectOption",{attrs:{value:"eq",label:this.trans("Equal value")}}),e("NSelectOption",{attrs:{value:"ne",label:this.trans("Except value")}})])])])}},M={name:"NTableFilterBoolean",extends:O,methods:{resetFilter:function(){this.value=null,this.operator="in"}},data:function(){var t={property:this.column.filterProp,type:this.column.type,value:null,operator:"in"};return this.getFilterProps(t)},renderForm:function(){var t=this,e=this.$createElement;return e("NForm",{model:{value:t.$data,callback:function(e){t.$data=e}},on:{change:a.Any.debounce(this.changeFilter)}},[e("NFormItem",[e("NSelect",{attrs:{size:"small"},model:{value:t.value,callback:function(e){t.value=e}}},[e("NSelectOption",{attrs:{value:"1",label:this.column.trueText}}),e("NSelectOption",{attrs:{value:"0",label:this.column.falseText}})])])])}},T={name:"NTableFilterDatetime",extends:O,methods:{resetFilter:function(){this.value=null,this.operator="eq"}},data:function(){var t={property:this.column.filterProp,type:this.column.type,value:null,operator:"eq"};return this.getFilterProps(t)},renderForm:function(){var t=this,e=this.$createElement;return e("NForm",{model:{value:t.$data,callback:function(e){t.$data=e}},on:{change:a.Any.debounce(this.changeFilter)}},[e("NFormItem",[e("NDatepicker",{attrs:{size:"small",format:"YYYY-MM-DD"},model:{value:t.value,callback:function(e){t.value=e}}})]),e("NFormItem",[e("NSelect",{attrs:{size:"small"},model:{value:t.operator,callback:function(e){t.operator=e}}},[e("NSelectOption",{attrs:{value:"eq",label:this.trans("Exact date")}}),e("NSelectOption",{attrs:{value:"lt",label:this.trans("Before date")}}),e("NSelectOption",{attrs:{value:"gt",label:this.trans("After date")}})])])])}},A={name:"NTableFilterOption",extends:O,methods:{resetFilter:function(){this.value=null,this.operator="in"}},data:function(){var t={property:this.column.filterProp,type:this.column.type,value:null,operator:"in"},e=this.getFilterProps(t);return a.Any.isArray(e.value)||(e.value=a.Any.string(e.value).split(",")),e},renderForm:function(){var t=this,e=this.$createElement,n="function"==typeof this.column.options?this.column.options(null):this.column.options;return n=a.Arr.map(a.Any.keys(n),(function(t){return{$value:n[t],$index:t}})),e("NForm",{model:{value:t.$data,callback:function(e){t.$data=e}},on:{change:a.Any.debounce(this.changeFilter)}},[e("NFormItem",[e("NCheckboxGroup",{attrs:{size:"small"},model:{value:t.value,callback:function(e){t.value=e}}},[a.Arr.each(n,(function(n){return e("NCheckbox",{attrs:{size:"small",value:a.Obj.get(n,t.column.optionsValue)}},[a.Obj.get(n,t.column.optionsLabel)])}))])]),e("NFormItem",[e("NSelect",{attrs:{size:"small"},model:{value:t.operator,callback:function(e){t.operator=e}}},[e("NSelectOption",{attrs:{value:"in",label:this.trans("Includes value")}}),e("NSelectOption",{attrs:{value:"ni",label:this.trans("Excludes value")}})])])])}};o.a.component(p.name,p),o.a.component(f.name,f),o.a.component(y.name,y),o.a.component(b.name,b),o.a.component(w.name,w),o.a.component(x.name,x),o.a.component(k.name,k),o.a.component(N.name,N),o.a.component(M.name,M),o.a.component(T.name,T),o.a.component(A.name,A)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(0),s=n(6);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l={name:"NInfo",model:{prop:"item"},props:{item:{default:function(){return null}},adaptHeight:{default:function(){return null}}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},s.a,{addColumn:function(t){this.columns.push(t)},removeColumn:function(t){i.Arr.remove(this.columns,{_uid:t._uid})},bindObserver:function(){var t=this,e=this.$el.parentNode;!0!==this.adaptHeight&&(e=this.adaptHeight),i.Dom.find(e).observerResize((function(){t.height=i.Dom.find(e).height()}))(e)}}),provide:function(){return{NInfo:this}},data:function(){return{columns:[]}},mounted:function(){null!==this.adaptHeight&&this.$nextTick(this.bindObserver)},render:function(){var t=this,e=arguments[0];return this.h=e,e("div",{class:"n-info"},[e("div",{ref:"wrapper",class:"n-info-wrapper"},[!1===i.Any.isEmpty(this.item)&&e("div",{class:"n-info__body"},[i.Arr.each(this.columns,(function(n,r){return e("div",{class:"n-info__column"},[n.$scopedSlots.label({column:n,key:r,item:t.item}),n.$scopedSlots.default({column:n,key:r,item:t.item})])}))]),!0===i.Any.isEmpty(this.item)&&e("div",{class:"n-info__empty"},[this.trans("No entry")]),this.$slots.default])])}};function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p={name:"NInfoColumn",inject:{NInfo:{default:void 0}},props:{prop:{default:function(){return"id"},type:[String]},label:{default:function(){return""},type:[String]},type:{default:function(){return"string"},type:[String]},options:{default:function(){return[]},type:[Object,Array,Function]},optionsValue:{default:function(){return"$value"},type:[String]},optionsLabel:{default:function(){return"$value"},type:[String]},emptyText:{default:function(){return this.trans("-")},type:[String]},trueText:{default:function(){return this.trans("Yes")},type:[String]},falseText:{default:function(){return this.trans("No")},type:[String]},datetimeFormat:{default:function(){return this.trans("YYYY-MM-DD HH:mm")},type:[String]}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},s.a),beforeMount:function(){this.NInfo.addColumn(this)},destroyed:function(){this.NInfo.removeColumn(this)},renderLabel:function(t){var e=t.column,n=this.$createElement;return n("div",{class:"n-info-column__label"},[n("span",[e.label])])},renderBody:function(t){var e=t.column,n=t.item,r=t.key;return(0,this.$createElement)("div",{class:"n-info-column__value"},[this.ctor("renderCell")({column:e,item:n,key:r})])},renderCell:function(t){return this.h("NInfoField"+i.Str.ucfirst(this.type),{props:t})},render:function(t){return this.h=t,this.$scopedSlots.label||(this.$scopedSlots.label=this.ctor("renderLabel")),this.$scopedSlots.default||(this.$scopedSlots.default=this.ctor("renderBody")),null}};function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v={inject:{NInfo:{default:void 0}},props:{column:{required:!0},item:{required:!0}},computed:{value:function(){return i.Obj.get(this.item,this.column.prop)}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},s.a),render:function(){var t=arguments[0];return t("div",{class:"n-info__field"},[t("span",[this.value])])}},m={name:"NInfoFieldString",extends:v,render:function(){var t=arguments[0],e=["n-info__field","n-info__field--"+this.column.type];return t("div",{class:e},[t("span",[i.Any.convertString(this.value,this.column.emptyText)])])}},g={name:"NInfoFieldBoolean",extends:v,render:function(){var t=arguments[0],e=["n-info__field","n-info__field--"+this.column.type];return t("div",{class:e},[t("span",[i.Any.convertBoolean(this.value,this.column.trueText,this.column.falseText)])])}},y={name:"NInfoFieldDatetime",extends:v,render:function(){var t=arguments[0],e=["n-info__field","n-info__field--"+this.column.type];return t("div",{class:e},[t("span",[i.Any.convertDatetime(this.value,this.column.datetimeFormat,this.column.emptyText)])])}},b={name:"NInfoFieldOption",extends:v,render:function(){var t=this,e=arguments[0],n="function"==typeof this.column.options?this.column.options(this.item):this.column.options;n=i.Arr.map(i.Any.keys(n),(function(t){return{$value:n[t],$index:t}}));var r=["n-info__field","n-info__field--"+this.column.type];return e("div",{class:r},[e("span",[i.Arr.each(i.Any.isArray(this.value)?this.value:[this.value],(function(e){var r=i.Arr.find(n,(function(n){return i.Any.string(i.Obj.get(n,t.column.optionsValue))===i.Any.string(e)}));return i.Obj.get(r,t.column.optionsLabel,e)})).join(", ")||this.column.emptyText])])}},w={name:"NInfoFieldImage",extends:v,render:function(){var t=arguments[0],e=["n-info__field","n-info__field--"+this.column.type];return t("div",{class:e},[t("img",{attrs:{src:this.value}})])}};o.a.component(l.name,l),o.a.component(p.name,p),o.a.component(m.name,m),o.a.component(g.name,g),o.a.component(y.name,y),o.a.component(b.name,b),o.a.component(w.name,w)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NForm",model:{prop:"form"},props:{form:{default:function(){return{}},type:[Object]},errors:{default:function(){return{}},type:[Object]},align:{default:function(){return"vertical"},type:[String]}},methods:{addItem:function(t){a.Arr.add(this.items,t,{_uid:t._uid})},removeItem:function(t){a.Arr.remove(this.items,{_uid:t._uid})},updateForm:function(){this.$emit("change")},updateErrors:function(){this.$emit("errors")}},data:function(){return{items:[]}},provide:function(){return{NForm:this}},mounted:function(){this.$watch("form",this.updateForm,{deep:!0}),this.$watch("errors",this.updateErrors,{deep:!0})},render:function(t){var e=arguments[0];this.$render=t;var n=["n-form","n-form--"+this.align];return e("form",s()([{class:n},{on:this.$listeners}]),[this.$slots.default])}},l={name:"NFormGroup",inject:{NForm:{default:void 0}},props:{value:{default:function(){return!0},type:[Boolean]},legend:{default:function(){return this.$slots.legend},type:[String]},align:{default:function(){return"vertical"},type:[String]},checkable:{default:function(){return!1},type:[Boolean]},tooltip:{default:function(){return this.$slots.tooltip},type:[String]},tooltipPosition:{default:function(){return"right-center"},type:[String]}},data:function(){return{nativeValue:this.value}},watch:{value:function(){this.value!==this.nativeValue&&(this.nativeValue=this.value)}},methods:{toggleValue:function(){!1!==this.checkable&&this.$emit("input",this.nativeValue=!this.nativeValue)}},render:function(t){var e=arguments[0];this.$render=t;var n=["n-form-group","n-form--"+this.align];return!0===this.checkable&&n.push("n-form-group--checkable"),e("fieldset",{class:n},[this.legend&&e("div",{class:"n-form-group__legend"},[e("legend",{class:"n-form-group__label"},[this.checkable&&e("NCheckbox",{attrs:{checked:this.nativeValue},on:{input:this.toggleValue}}),e("div",{class:"n-form-group__label-text",on:{click:this.toggleValue}},[e("span",[this.legend])]),this.tooltip&&e("NPopover",{attrs:{type:"tooltip",position:this.tooltipPosition}},[this.tooltip]),this.$slots.actions&&e("div",{class:"n-form-group__actions"},[this.$slots.actions])])]),this.nativeValue&&e("div",{class:"n-form-group__body"},[this.$slots.default])])}},u={name:"NFormItem",inject:{NForm:{default:void 0},NTabs:{default:void 0},NTabsItem:{default:void 0}},props:{prop:{default:function(){return"id"},type:[String]},label:{default:function(){return""},type:[String]},tooltip:{default:function(){return""},type:[String]},tooltipPosition:{default:function(){return"right-center"},type:[String]},tooltipWindow:{default:function(){return!1},type:[Boolean]}},methods:{focusInput:function(){var t=a.Dom.find(this.$el).find("input");t.empty()||t.get(0).focus()},gotoInput:function(){var t=this.NForm.errors;if(!a.Any.isEmpty(t)&&this.NTabs&&this.NTabsItem){var e=a.Any.keys(t);a.Arr.first(e)===this.prop&&this.NTabs.changeTab(this.NTabsItem.name)}}},beforeMount:function(){this.NForm.addItem(this)},mounted:function(){this.NForm.$on("errors",this.gotoInput)},beforeDestroy:function(){this.NForm.removeItem(this)},renderTooltip:function(){var t=this.$createElement;if(!this.tooltip&&!this.$slots.tooltip)return null;var e={position:this.tooltipPosition,window:this.tooltipWindow,contain:this.tooltipWindow};return t("NPopover",s()([{attrs:{type:"tooltip"}},{props:e}]),[this.$slots.tooltip||this.tooltip])},renderLabel:function(){var t=this.$createElement;return this.label||this.$slots.label?t("div",{class:"n-form-item__label"},[t("label",{on:{click:this.focusInput}},[this.$slots.label||this.label]),this.ctor("renderTooltip")()]):null},renderError:function(){var t=this.$createElement;return a.Obj.has(this.NForm.errors,this.prop)?t("div",{class:"n-form-item__error"},[a.Obj.get(this.NForm.errors,this.prop)]):null},render:function(t){var e=arguments[0];return this.$render=t,e("div",{class:"n-form-item"},[this.ctor("renderLabel")(),e("div",{class:"n-form-item__input"},[this.$slots.default]),this.ctor("renderError")()])}};o.a.component(c.name,c),o.a.component(l.name,l),o.a.component(u.name,u)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(0),s={name:"NFileList",model:{prop:"items"},props:{items:{default:function(){return[]},type:[Array]},useProgress:{default:function(){return!0},type:[Boolean]},fileProp:{default:function(){return"$value.file"}},uniqueProp:{default:function(){return"$value.id"}},doneProp:{default:function(){return"$value.done"}},errorProp:{default:function(){return"$value.error"}},progressProp:{default:function(){return"$value.progress"}},casts:{default:function(){return[{match:"image/*",use:"NFileListItemImage"}]},type:[Array]}},provide:function(){return{NFileList:this}},render:function(){var t=this,e=arguments[0],n=function(e,n,r){var o=i.Obj.get({$value:n},t.fileProp),s=i.Arr.find(t.casts,(function(t){return o.type.match(new RegExp("^"+t.match.replace("*",".*?")+"$"))})),a={value:n},c={remove:function(){i.Arr.removeIndex(t.items,r)}},l=i.Obj.get({$value:n},t.uniqueProp);return e("div",{class:"n-file-list__item"},[e(s?s.use:"NFileListItem",{key:l,props:a,on:c})])};return e("NRenderList",{class:"n-file-list",attrs:{items:this.items,renderNode:n}})}};function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l={name:"NFileListItem",inject:{NFileList:{default:void 0}},props:{value:{default:function(){return{}}}},computed:{file:function(){return i.Obj.get({$value:this.value},this.NFileList.fileProp)},done:function(){return i.Obj.get({$value:this.value},this.NFileList.doneProp)},error:function(){return i.Obj.get({$value:this.value},this.NFileList.errorProp)},progress:function(){return i.Obj.get({$value:this.value},this.NFileList.progressProp)}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n(6).a),renderPreview:function(){return(0,this.$createElement)("span",{class:"fa fad fa-file"})},renderName:function(){return(0,this.$createElement)("span",[this.file.name])},renderMeta:function(){return(0,this.$createElement)("span",[i.Str.filesize(this.file.size)])},render:function(){var t=this,e=arguments[0];this.h=e;var n=["n-file-list-item"];return!0===this.done&&n.push("n-file-list-item--done"),!0===this.error&&n.push("n-file-list-item--error"),e("div",{class:n},[e("div",{class:"n-file-list-item__preview"},[e("div",{class:"n-file-list-item__preview-inner"},[this.ctor("renderPreview")()]),this.NFileList.useProgress&&e("div",{class:"n-file-list-item__progress"},[e("span",{style:{width:this.progress+"%"}})])]),e("div",{class:"n-file-list-item__name"},[e("div",{class:"n-file-list-item__name-inner"},[this.ctor("renderName")()])]),e("div",{class:"n-file-list-item__meta"},[e("div",{class:"n-file-list-item__meta-inner"},[this.ctor("renderMeta")()])]),e("a",{class:"n-file-list-item__remove",attrs:{href:"javascript:void(0)"},on:{click:function(){return t.$emit("remove")}}},[e("span",{class:this.icons.times})])])}},u={name:"NFileListItemImage",extends:l,methods:{getImagePreview:function(){var t=this,e=new FileReader;e.onload=function(){t.preview=e.result},e.readAsDataURL(this.value.file)}},data:function(){return{preview:null}},mounted:function(){this.getImagePreview()},renderPreview:function(){var t=this.$createElement;return null!==this.preview?t("img",{attrs:{src:this.preview}}):t("span",{class:"fa fad fa-file-image"})}};o.a.component(s.name,s),o.a.component(l.name,l),o.a.component(u.name,u)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c=n(6);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h={name:"NMatrix",props:{value:{default:function(){return null}},items:{default:function(){return[]},type:[Array]},multiple:{default:function(){return!0},type:[Boolean]},use:{default:function(){return null}},label:{default:function(){return a.Locale.trans("Structure")},type:[String]},titleProp:{default:function(){return"title"},type:[String]},uniqueProp:{default:function(){return"id"},type:[String]},matrixProp:{default:function(){return"matrix"},type:[String]},childProp:{default:function(){return"children"},type:[String]},minWidth:{default:function(){return 200},type:[Number]},itemHeight:{default:function(){return 30}},adaptHeight:{default:function(){return null}},defaultExpanded:{default:function(){return[]},type:[Array]}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},c.a,{addColumn:function(t){var e=a.Arr.add(this.columns,t,{_uid:t._uid});this.columns=a.Arr.sort(e,"_uid")},removeColumn:function(t){a.Arr.remove(this.columns,{_uid:t._uid})},updateValue:function(){!0!==this.multiple||a.Any.isEmpty(this.value)||(this.nativeValue=this.value),!1!==this.multiple||a.Any.isEmpty(this.value)||(this.nativeValue=[this.value])},calculateHeight:function(){this.height=a.Dom.find(this.$refs.head).height()+a.Dom.find(this.$refs.body).child().height()+1},bindObserver:function(){var t=this.$el.parentNode;!0!==this.adaptHeight&&(t=this.adaptHeight),a.Dom.find(t).observerResize(this.updateObserver)(t)},updateObserver:function(){var t=this.$el.parentNode;!0!==this.adaptHeight&&(t=this.adaptHeight),this.height=a.Dom.find(t).innerHeight()},toggleRow:function(t){a.Arr.toggle(this.expanded,a.Obj.get(t,this.uniqueProp))},changeRow:function(t,e){var n;!1===this.multiple&&(this.nativeValue=[]);var r=(u(n={},this.uniqueProp,a.Obj.get(t,this.uniqueProp)),u(n,this.matrixProp,0),n);-1===a.Arr.findIndex(this.nativeValue,u({},this.uniqueProp,a.Obj.get(t,this.uniqueProp)))&&this.nativeValue.push(r);var o=a.Arr.find(this.nativeValue,u({},this.uniqueProp,a.Obj.get(t,this.uniqueProp))),i=a.Arr.toggle(a.Num.matrix(o[this.matrixProp]),e);if(o[this.matrixProp]=a.Num.combine(i),!0===this.multiple)return this.$emit("input",this.nativeValue);this.$emit("input",a.Arr.first(this.nativeValue))},isChecked:function(t,e){var n=a.Arr.find(this.nativeValue,u({},this.uniqueProp,a.Obj.get(t,this.uniqueProp)));if(null===n)return!1;var r=a.Num.matrix(n[this.matrixProp]);return-1===e||a.Arr.has(r,e)}}),provide:function(){return{NMatrix:this}},data:function(){return{height:0,nativeValue:[],expanded:this.defaultExpanded,columns:[]}},beforeMount:function(){this.updateValue()},mounted:function(){null===this.adaptHeight&&this.calculateHeight(),null!==this.adaptHeight&&!1!==this.adaptHeight&&this.$nextTick(this.bindObserver),this.$watch("value",this.updateValue,{deep:!0})},updated:function(){null===this.adaptHeight&&this.calculateHeight()},renderHeadRow:function(){var t=this.$createElement;return t("div",{class:["n-matrix__row"]},[t("div",{class:"n-matrix__column n-matrix__column--item"},[this.$slots.label||this.label]),a.Arr.each(this.columns,(function(e){return t("div",{class:"n-matrix__column",attrs:{"data-column-id":e._uid}},[e.ctor("renderLabel")({column:e})])}))])},renderBodyRow:function(t){var e=this,n=this.$createElement,r=a.Obj.get(t.value,this.titleProp),o=a.Arr.has(this.expanded,a.Obj.get(t.value,this.uniqueProp)),i=a.Obj.get(t.value,this.childProp,[]),c={items:i,itemHeight:this.itemHeight,renderNode:function(t,n,r){return e.ctor("renderBodyRow")({value:n,key:r})}},l=["n-matrix__row","n-matrix__row--"+t.key];!0===o&&l.push("n-matrix__row--expanded"),!0===a.Any.isEmpty(i)&&l.push("n-matrix__row--empty");var u=function(){e.toggleRow(t.value)};return n("div",{class:"n-matrix__group"},[n("div",{class:l},[n("div",{class:"n-matrix__column n-matrix__column--item",on:{dblclick:u}},[n("div",{class:"n-matrix__expand",on:{click:u}},[n("span",{class:this.icons.angleRight})]),n("div",{class:"n-matrix__title"},[this.use?this.h(this.use,{props:t}):this.$slots.title||r])]),a.Arr.each(this.columns,(function(e){return n("div",{class:"n-matrix__column"},[e.ctor("renderBody")({column:e,row:t.value,key:t.key})])}))]),!0===o&&!1===a.Any.isEmpty(i)&&n("NRenderList",s()([{},{props:c}]))])},render:function(t){var e=this;this.h=t;var n={items:this.items,itemHeight:this.itemHeight,renderNode:function(t,n,r){return e.ctor("renderBodyRow")({value:n,key:r})}},r={minWidth:this.minWidth+"px"};return this.height>0&&(r.height=this.height+"px"),t("div",{class:"n-matrix"},[t("div",{ref:"wrapper",class:"n-matrix-wrapper",style:r},[t("div",{ref:"head",class:"n-matrix__head"},[this.ctor("renderHeadRow")()]),t("div",{ref:"body",class:"n-matrix__body"},[!1===a.Any.isEmpty(this.items)&&t("NRenderList",{props:n})]),this.$slots.default])])}};function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d={name:"NMatrixColumn",inject:{NMatrix:{default:void 0}},props:{value:{default:function(){return-1}},disabled:{default:function(){return!1}},label:{default:function(){return null}}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},c.a),mounted:function(){this.NMatrix.addColumn(this)},renderLabel:function(t){var e=this.$createElement;return this.$scopedSlots.label?this.$scopedSlots.label:e("span",[this.label])},renderBody:function(t){var e=this,n=this.$createElement;if(this.$scopedSlots.default)return this.$scopedSlots.default;var r=a.Arr.findIndex(this.NMatrix.columns,{_uid:this._uid}),o=a.Num.int(this.value)||Math.pow(2,r),i={input:function(){return e.NMatrix.changeRow(t.row,o)}},c="function"==typeof this.disabled?this.disabled:function(){return e.disabled};return n("NCheckbox",s()([{attrs:{checked:this.NMatrix.isChecked(t.row,o),disabled:c(t.row)}},{on:i}]))},render:function(t){return this.h=t,null}};o.a.component(h.name,h),o.a.component(d.name,d)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0);function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l={name:"NDraggable",model:{prop:"items"},props:{items:{default:function(){return[]}},renderNode:{default:function(){return null}},selected:{default:function(){return[]}},expanded:{default:function(){return[]}},group:{default:function(){return["default"]},type:[Array]},safeZone:{default:function(){return function(t){return.51*t}}},showEmpty:{default:function(){return!0},type:[Boolean]},itemHeight:{default:function(){return 34},type:[Number]},viewportHeight:{default:function(){return!1}},keyProp:{default:function(){return"md5"},type:[String]},orderProp:{default:function(){return"order"},type:[String]},uniqueProp:{default:function(){return"id"},type:[String]},depthProp:{default:function(){return"depth"},type:[String]},pathProp:{default:function(){return"path"},type:[String]},indexProp:{default:function(){return"index"},type:[String]},childProp:{default:function(){return"children"},type:[String]},renderSelect:{default:function(){return!1},type:[Boolean]},renderExpand:{default:function(){return!1},type:[Boolean]},transformDrop:{default:function(){return function(t){return t}}},disableMove:{default:function(){return!1},type:[Boolean]},insertNode:{default:function(){return function(){return!0}}},removeNode:{default:function(){return function(){return!0}}},allowSelect:{default:function(){return function(){return!0}}},allowDrag:{default:function(){return function(){return!0}}},allowDrop:{default:function(){return function(){return!0}}},wrapNode:{default:function(){return!1},type:[Boolean]},updateDelay:{default:function(){return 100},type:[Number]},preloadItems:{default:function(){return 20},type:[Number]},bufferItems:{default:function(){return 20},type:[Number]}},data:function(){return{veCopy:[],veItems:[],veCached:[],veSelfCached:[],veSelected:this.selected,veExpanded:this.expanded}},provide:function(){return{NDraggable:this}},beforeMount:function(){this.$watch("veCopy",a.Any.debounce(this.exportItems,this.updateDelay),{deep:!0}),this.$watch("items",a.Any.debounce(this.importItems,this.updateDelay)),this.importItems()},methods:{exportItems:function(){a.Any.md5(this.items)!==a.Any.md5(this.veCopy)&&this.$emit("input",this.veCopy)},importItems:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t||this.items,a.Any.md5(t)!==a.Any.md5(this.veCopy)&&(this.veCopy=a.Obj.clone(t),this.refreshItems())},refreshItems:function(){this.veItems=this.itemReducer([],this.veCopy)},moveItems:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inner";e=this.getTarget(e);var o=a.Arr.each(this.veCached,(function(t){return t[n.uniqueProp]}));if(this.$emit("move",o.join(","),e[this.uniqueProp],r),!this.disableMove){var i=this.getCachedBatches(),s=a.Num.int(e[this.orderProp].slice(0,-1).join("")||e[this.indexProp]+1),l=a.Obj.filter(a.Any.vals(i).reverse(),(function(t){return a.Num.int(t._key)>=s})),u=a.Obj.filter(a.Any.vals(i).reverse(),(function(t){return a.Num.int(t._key)<s}));if("root"===r&&a.Arr.each(this.veCached,(function(t){(a.Any.isFunction(n.insertNode)?n.insertNode(t,e):n.insertNode)&&a.Arr.push(n.veCopy,n.transformDrop(t.item))})),"inner"===r){var h=a.Obj.get(this,e[this.pathProp]),p=a.Arr.find(h,c({},this.uniqueProp,e[this.uniqueProp]));void 0===p[this.childProp]&&(p[this.childProp]=[]),a.Arr.each(i,(function(t){delete t._key,a.Arr.each(t,(function(t){a.Arr.push(p[n.childProp],n.transformDrop(t.item))})),a.Arr.each(t,n.dropItem)})),a.Arr.each(this.veCached,(function(t){(a.Any.isFunction(n.insertNode)?n.insertNode(t,e):n.insertNode)&&a.Arr.push(p[n.childProp],n.transformDrop(t.item))}))}if("after"===r){var f=[];a.Arr.each(a.Any.vals(l),(function(t){delete t._key,a.Arr.each(t,(function(t){f.push(t)})),a.Arr.each(t,n.dropItem)})),a.Arr.each(a.Any.vals(f),(function(t){var r=a.Obj.get(n,e[n.pathProp]),o=a.Arr.findIndex(r,c({},n.uniqueProp,e[n.uniqueProp]));a.Arr.insert(r,o+1,n.transformDrop(t.item))})),a.Arr.each(a.Any.vals(u),(function(t){delete t._key,a.Arr.each(t.reverse(),(function(t){var r=a.Obj.get(n,e[n.pathProp]),o=a.Arr.findIndex(r,c({},n.uniqueProp,e[n.uniqueProp]));a.Arr.insert(r,o+1,n.transformDrop(t.item))})),a.Arr.each(t,n.dropItem)})),a.Arr.each(this.veCached.reverse(),(function(t){if(a.Any.isFunction(n.insertNode)?n.insertNode(t,e):n.insertNode){var r=a.Obj.get(n,e[n.pathProp]),o=a.Arr.findIndex(r,c({},n.uniqueProp,e[n.uniqueProp]));a.Arr.insert(r,o+1,n.transformDrop(t.item))}}))}if("before"===r){var d=[];a.Arr.each(a.Any.vals(l),(function(t){delete t._key,a.Arr.each(t.reverse(),(function(t){d.push(t)})),a.Arr.each(t,n.dropItem)})),a.Arr.each(a.Any.vals(d).reverse(),(function(t){var r=a.Obj.get(n,e[n.pathProp]),o=a.Arr.findIndex(r,c({},n.uniqueProp,e[n.uniqueProp]));a.Arr.insert(r,o,n.transformDrop(t.item))})),a.Arr.each(a.Any.vals(u).reverse(),(function(t){delete t._key;var r=a.Obj.get(n,e[n.pathProp]),o=a.Arr.findIndex(r,c({},n.uniqueProp,e[n.uniqueProp]));a.Arr.each(t.reverse(),(function(t){a.Arr.insert(r,o,n.transformDrop(t.item))})),a.Arr.each(t,n.dropItem)})),a.Arr.each(this.veCached,(function(t){if(a.Any.isFunction(n.insertNode)?n.insertNode(t,e):n.insertNode){var r=a.Obj.get(n,e[n.pathProp]),o=a.Arr.findIndex(r,c({},n.uniqueProp,e[n.uniqueProp]));a.Arr.insert(r,o,n.transformDrop(t.item))}}))}a.Event.fire("draggable.done")}},getCachedBatches:function(){var t=this,e=a.Arr.reduce(this.veSelfCached,(function(e,n){var r=n[t.orderProp].slice(0,-1).join("")||n[t.indexProp]+1;a.Obj.has(e,r)||(e[r]=[]);var o=a.Obj.only(n,[t.uniqueProp,t.pathProp,t.indexProp]);return o.item=a.Obj.clone(n.item),e[r].push(o),e}),{});return a.Arr.map(e,(function(e){var n=a.Arr.sort(e,(function(e){return e[t.orderProp].join("")}));return a.Arr.each(n,(function(t){return a.Obj.except(t,["_key"])}))})),a.Obj.sort(e,(function(e){return a.Arr.first(e)[t.orderProp].join("")}))},dropItem:function(t){a.Arr.remove(a.Obj.get(this,t[this.pathProp]),c({},this.uniqueProp,t[this.uniqueProp])),this.veCached=a.Arr.remove(this.veCached,c({},this.uniqueProp,t[this.uniqueProp])),this.veSelfCached=a.Arr.remove(this.veSelfCached,c({},this.uniqueProp,t[this.uniqueProp]))},dropItems:function(){var t=this;a.Arr.each(this.veSelfCached,(function(e){(a.Any.isFunction(t.removeNode)?t.removeNode(e):t.removeNode)&&a.Arr.remove(a.Obj.get(t,e[t.pathProp]),c({},t.uniqueProp,e[t.uniqueProp]))})),this.clearItems(),this.refreshItems(),this.$emit("moved",this.veCopy)},clearItems:function(){this.veSelected=[],this.veCached=[],this.veSelfCached=[],this.removeDragCounter(),this.removeDragIndicator()},cacheItems:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a.Arr.intersect(e,this.group).length&&(this.veCached=a.Arr.each(t,(function(t){return a.Obj.clone(t)})))},updateExpanded:function(){this.$emit("update:expanded",this.veExpanded)},expandItem:function(t){a.Any.isString(t)||(t=t[this.uniqueProp]),a.Arr.toggle(this.veExpanded,t),this.refreshItems()},isExpanded:function(t){return a.Any.isString(t)||(t=t[this.uniqueProp]),!a.Arr.has(this.veExpanded,t)},updateSelected:function(){this.$emit("update:selected",this.veSelected)},dispatchSelected:function(){var t=this,e=a.Arr.each(this.veSelected,(function(e){return t.getTarget(e)}));a.Event.fire("draggable.start",this.veSelfCached=e,this.group)},getTarget:function(t){a.Any.isString(t)||(t=t[this.uniqueProp]);var e=a.Arr.find(this.veItems,c({},this.uniqueProp,t));return e.item=a.Obj.get(this,e[this.pathProp]+"."+e[this.indexProp]),e},toggleItem:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.Any.isString(t)||(t=t[this.uniqueProp]),e&&(this.veSelected=[]),a.Arr.toggle(this.veSelected,t),this.updateSelected()},toggleAllItems:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.veSelected=[]),a.Arr.each(this.veCopy,(function(e){a.Arr.toggle(t.veSelected,e[t.uniqueProp])})),this.updateSelected()},selectItem:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.Any.isString(t)||(t=t[this.uniqueProp]),e&&(this.veSelected=[]),a.Arr.add(this.veSelected,t),this.updateSelected()},selectAllItems:function(){var t=this;this.veSelected=a.Arr.each(this.veCopy,(function(e){return e[t.uniqueProp]})),this.updateSelected()},unselectItem:function(t){a.Any.isString(t)||(t=t[this.uniqueProp]),a.Arr.remove(this.veSelected,t),this.updateSelected()},unselectAllItems:function(){this.veSelected=[],this.updateSelected()},canSelect:function(t){if(a.Any.isString(t)&&(t=a.Arr.find(this.veItems,c({},this.uniqueProp,t))),!this.veSelected.length)return!0;var e=a.Arr.find(this.veItems,c({},this.uniqueProp,a.Arr.first(this.veSelected)));return!(!e||!t)&&t[this.depthProp]===e[this.depthProp]},isSelected:function(t){return a.Any.isString(t)||(t=t[this.uniqueProp]),a.Arr.has(this.veSelected,t)},isAllSelected:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e?this.veCopy:this.veItems,r=a.Arr.reduce(n,(function(e,n){return e&&a.Arr.has(t.veSelected,n[t.uniqueProp])}),!0);return r&&!!n.length},isSelectable:function(){return!!this.veItems.length},isIntermediate:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!this.isAllSelected(t)&&!!this.veSelected.length},canDrag:function(t){return!0},canDrop:function(t){var e=this,n=t[this.pathProp]+"."+t[this.indexProp],r=a.Arr.each(this.veSelected,(function(t){return a.Arr.find(e.veItems,c({},e.uniqueProp,t))}));return!a.Arr.filter(r,(function(t){var r=t[e.pathProp]+"."+t[e.indexProp];return-1!==n.indexOf("".concat(r,"."))||r===n})).length},itemReducer:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"veCopy",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return a.Arr.each(e,(function(e,s){var l,u=(c(l={},n.indexProp,s),c(l,n.pathProp,o),c(l,n.depthProp,r),l);u[n.uniqueProp]=a.Obj.get(e,n.uniqueProp),u[n.uniqueProp]||a.Obj.set(n,o+"."+s+"."+n.uniqueProp,u[n.uniqueProp]=Object(a.UUID)()),u[n.orderProp]=a.Arr.merge(i,[s+1]),u[n.keyProp]=a.Any.md5(u),a.Arr.push(t,u),a.Arr.has(n.veExpanded,u[n.uniqueProp])&&n.itemReducer(t,a.Obj.get(e,n.childProp,[]),r+1,"".concat(o,".").concat(s,".").concat(n.childProp),u[n.orderProp])})),t},createDragIndicator:function(){this.dragIndicator||(this.dragIndicator=a.Dom.make("div",{classList:["n-draggable__indicator"]}),this.dragIndicator.attr("data-ignore",!0),this.dragIndicator.appendTo(this.$el))},updateDragIndicator:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.dragIndicator||this.createDragIndicator(),!t)return this.dragIndicator.css({visibility:"hidden"});this.dragIndicator.css({visibility:"visible",top:"".concat(e,"px")})},removeDragIndicator:function(){this.dragIndicator&&this.dragIndicator.get(0).remove(),delete this.dragIndicator},createDragCounter:function(t){this.dragCounter||(this.dragCounter=a.Dom.make("div",{classList:["n-draggable__counter"]}),this.dragCounter.html("<span>".concat(a.Locale.choice(":count Item|:count Items",this.veSelected.length),"</span>")),this.dragCounter.appendTo(document.body),t.dataTransfer.setData("text/plain",""),"function"==typeof t.dataTransfer.setDragImage&&t.dataTransfer.setDragImage(this.dragCounter.get(0),0,0))},removeDragCounter:function(){this.dragCounter&&this.dragCounter.get(0).remove(),delete this.dragCounter},eventDragenter:function(t){t.preventDefault(),a.Dom.find(t.target).closest(this.$el)&&this.createDragIndicator(t)},eventDragleave:function(t){t.preventDefault(),a.Dom.find(t.target).closest(this.$el)&&this.updateDragIndicator(!1)},eventDragend:function(t){t.preventDefault(),a.Dom.find(t.target).closest(this.$el)&&this.removeDragIndicator()},eventEmptyDragenter:function(t){t.preventDefault()},eventEmptyDragover:function(t){t.preventDefault(),a.Dom.find(this.$el).addClass("n-dragover")},eventEmptyDragleave:function(t){a.Dom.find(this.$el).removeClass("n-dragover")},eventEmptyDragdrop:function(t){var e;t.preventDefault();var n=(c(e={},this.indexProp,0),c(e,this.orderProp,[0]),c(e,this.uniqueProp,null),e);a.Dom.find(this.$el).removeClass("n-dragover"),this.$emit("dragdrop",t,n,"root")}},watch:{selected:function(){a.Any.md5(this.selected)!==a.Any.md5(this.veSelected)&&(this.veSelected=this.selected)},expanded:function(){a.Any.md5(this.expanded)!==a.Any.md5(this.veExpanded)&&(this.veExpanded=this.expanded)}},mounted:function(){this.$on("dragstart",this.dispatchSelected),this.$on("dragstart",this.createDragCounter),this.$on("dragstart",this.createDragIndicator),this.$on("dragdrop",this.moveItems);var t={_uid:this._uid};a.Event.bind("draggable.start",this.cacheItems,t),a.Event.bind("draggable.stop",this.clearItems,t),a.Event.bind("draggable.done",this.dropItems,t),a.Dom.find(document).on("dragenter",this.eventDragenter,t),a.Dom.find(document).on("dragleave",this.eventDragleave,t),a.Dom.find(document).on("dragend",this.eventDragend,t)},beforeDestroy:function(){var t={_uid:this._uid};a.Event.unbind("draggable.start",t),a.Event.unbind("draggable.stop",t),a.Event.unbind("draggable.done",t),a.Dom.find(document).off("dragenter",null,t),a.Dom.find(document).off("dragleave",null,t),a.Dom.find(document).off("dragend",null,t)},renderEmpty:function(){var t=this.$createElement;if(!this.showEmpty)return null;var e={dragenter:this.eventEmptyDragenter,dragover:this.eventEmptyDragover,dragleave:this.eventEmptyDragleave,dragdrop:this.eventEmptyDragdrop,drop:this.eventEmptyDragdrop};return t("div",s()([{class:"n-draggable__empty"},{on:e}]),[t("span",[this.$slots.empty||this.trans("No entries")])])},renderItem:function(t){var e={key:t.value[this.keyProp],props:t};return this.$render("NDraggableItem",e,[this.$scopedSlots.default])},render:function(t){var e=this;this.$render=t,this.$slots.empty||(this.$slots.empty=[this.ctor("renderEmpty")()]);var n=a.Arr.each(this.$slots,(function(t,n){return e.$render("template",{slot:n},t)})),r=a.Obj.assign(a.Obj.clone(this.$props),{items:this.veItems,renderNode:this.ctor("renderItem")});return this.$render("NVirtualscroller",{class:"n-draggable",props:r},n)}},u={name:"NDraggableItem",inject:{NDraggable:{default:void 0}},props:{value:{default:function(){return{}}},ghost:{default:function(){return!0},type:[Boolean]}},computed:{veItem:function(){return a.Obj.get(this.NDraggable,this[this.NDraggable.pathProp]+"."+this[this.NDraggable.indexProp])}},data:function(){return a.Obj.assign({strategy:"nodrop"},this.value)},provide:function(){return{NDraggableItem:this}},methods:{resolveDragPosition:function(t){var e=this,n=this.NDraggable.safeZone(this.$el.clientHeight),r=a.Dom.find(this.$el).offset("top",document)-a.Dom.find(this.$el).scroll("top",document),o=a.Dom.find(this.$el).offset("top",this.NDraggable.$el)-a.Dom.find(this.$el).scroll("top",this.NDraggable.$el),i=r+this.$el.clientHeight-t,s=-1,c="inner";i>this.$el.clientHeight-n&&(c="before",s=o);var l=this.NDraggable.isExpanded(this)||!a.Obj.get(this.veItem,this.NDraggable.childProp,[]).length;i<n&&l&&(c="after",s=o+this.$el.clientHeight);var u=this.NDraggable.canDrop(this);if(u){var h=this.NDraggable.getTarget(this),p=a.Arr.each(this.NDraggable.veCached,(function(t){return!!e.NDraggable.allowDrop(t,h,c)}));u&=!a.Arr.has(p,!1)}u||(c="nodrop",a.Dom.find(this.$el).addClass("n-nodrop")),a.Dom.find(this.$el).addClass("n-dragover"),this.NDraggable.updateDragIndicator(-1!==s&&"nodrop"!==c,s||1),this.strategy=c},expand:function(t){this.NDraggable.expandItem(this)},select:function(t){this.NDraggable.toggleItem(this)},eventClick:function(t){this.NDraggable.$emit("row-click",this)},eventDblclick:function(t){this.NDraggable.$emit("row-dblclick",this)},eventDragstart:function(t){this.NDraggable.selectItem(this,!this.NDraggable.isSelected(this)),this.NDraggable.$emit("dragstart",t,this)},eventDragenter:function(t){return t.preventDefault(),!1},eventDragover:function(t){var e=this;if(this.NDraggable.veCached.length){t.preventDefault(),void 0===this.dragoverFrames&&(this.dragoverFrames=0);a.Any.framerate(this.resolveDragPosition,10,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return a.Any.isEmpty(t)||(e.dragoverFrames=t),e.dragoverFrames}))(t.clientY)}},eventDragleave:function(t){a.Dom.find(this.$el).removeClass("n-dragover n-nodrop")},eventDragend:function(t){this.NDraggable.removeDragCounter(t),this.NDraggable.$emit("dragend",t,this),a.Event.fire("draggable.stop")},eventDragdrop:function(t){if(a.Dom.find(this.$el).removeClass("n-dragover n-nodrop"),"nodrop"===this.strategy)return this.NDraggable.$emit("dragend",t,this),a.Event.fire("draggable.stop");t.preventDefault(),this.NDraggable.$emit("dragdrop",t,this,this.strategy)}},renderNode:function(){var t={index:this[this.NDraggable.indexProp],value:this.veItem},e=null;a.Any.isFunction(this.NDraggable.renderNode)&&(e=this.NDraggable.renderNode(t)),a.Any.isString(this.NDraggable.renderNode)&&(e=this.$render(this.NDraggable.renderNode,{props:t})),a.Any.isEmpty(e)&&this.$scopedSlots.default&&(e=this.$scopedSlots.default(t));return this.NDraggable.wrapNode?this.$render("div",{attrs:{width:"100%",flex:"1 1 auto"}},[e]):e},renderSpacer:function(){var t=this.$createElement;return this[this.NDraggable.depthProp]?t("div",{class:"n-draggable-item__spacer",style:{width:20*this.depth+"px"}}):null},renderExpand:function(){var t=this.$createElement;return this.NDraggable.renderExpand?t("div",{class:"n-draggable-item__expand"},[!!a.Obj.get(this.veItem,this.NDraggable.childProp,[]).length&&t("div",s()([{},{on:{click:this.expand}}]),[t("i",{class:this.icons.angleRight})])]):null},renderSelect:function(){var t=this.$createElement;if(!this.NDraggable.renderSelect)return null;var e=this.NDraggable.canSelect(this);return t("div",{class:"n-draggable-item__select"},[t("NCheckbox",{attrs:{size:"small",disabled:!(e&=a.Any.isFunction(this.NDraggable.allowSelect)?this.NDraggable.allowSelect(this):this.NDraggable.allowSelect),checked:this.NDraggable.isSelected(this)},on:{input:this.select}})])},render:function(t){var e=arguments[0];this.$render=t;var n={click:this.eventClick,dblclick:this.eventDblclick,dragstart:this.eventDragstart,dragenter:this.eventDragenter,dragover:this.eventDragover,dragleave:this.eventDragleave,dragend:this.eventDragend,dragdrop:this.eventDragdrop,drop:this.eventDragdrop},r={height:this.NDraggable.itemHeight+"px"},o=["n-draggable-item"];this.ghost&&o.push("n-ghost"),this.lazy&&o.push("n-lazy"),this.NDraggable.isSelected(this)&&o.push("n-selected"),this.NDraggable.isExpanded(this)&&o.push("n-expanded");var i=this.NDraggable.allowSelect(this);return i&=a.Any.isFunction(this.NDraggable.allowDrag)?this.NDraggable.allowDrag(this):this.NDraggable.allowDrag,e("div",s()([{class:o,style:r},{on:n},{attrs:{draggable:i}}]),[!this.ghost&&[this.ctor("renderSpacer")(),this.ctor("renderExpand")(),this.ctor("renderSelect")(),this.ctor("renderNode")()]])}};o.a.component(l.name,l),o.a.component(u.name,u)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NButton",props:{icon:{default:function(){return null}},iconPosition:{default:function(){return"before"},type:[String]},type:{default:function(){return"primary"},type:[String]},size:{default:function(){return"default"},type:[String]},link:{default:function(){return"link"===this.type},type:[Boolean]},square:{default:function(){return!1},type:[Boolean]},round:{default:function(){return!1},type:[Boolean]},outline:{default:function(){return!1},type:[Boolean]},disabled:{default:function(){return!1},type:[Boolean]},nativeType:{default:function(){return"button"},type:[String]}},renderIcon:function(){var t=this.$createElement;return this.icon?t("span",{class:["n-icon","n-icon--"+this.iconPosition,this.icon]}):null},renderButton:function(){var t=this.$createElement,e=["n-button","n-button--"+this.size,"n-button--"+this.type];this.icon&&e.push("n-button--icon"),this.link&&e.push("n-button--link"),this.square&&e.push("n-button--square"),this.round&&e.push("n-button--round"),this.outline&&e.push("n-button--outline");var n={type:this.nativeType,disabled:this.disabled},r={};return this.disabled||(r=a.Obj.assign({},this.$listeners)),t("button",s()([{class:e},{attrs:n},{},{on:r}]),["before"===this.iconPosition&&this.ctor("renderIcon")(),this.$slots.default&&t("span",[this.$slots.default]),"after"===this.iconPosition&&this.ctor("renderIcon")()])},render:function(t){var e=arguments[0];this.$render=t;var n=["n-button__wrapper"];return this.disabled&&n.push("n-disabled"),e("div",{class:n},[this.ctor("renderButton")()])}},l={name:"NButtonGroup",render:function(){var t=arguments[0];return t("div",{class:"n-button-group"},[this.$slots.default])}};o.a.component(c.name,c),o.a.component(l.name,l)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(0),s={name:"NTabs",provide:function(){return{NTabs:this}},props:{value:{default:function(){return"default"},type:[String]}},data:function(){return{width:0,offset:0,veTabs:[],veValue:this.value}},methods:{addTab:function(t){i.Arr.add(this.veTabs,t,{name:t.name})},removeTab:function(t){i.Arr.remove(this.veTabs,{name:t.name})},getTab:function(){var t=i.Arr.find(this.veTabs,{name:this.current});t||(t=i.Arr.first(this.veTabs)),t.name!==this.veValue&&this.$emit("input",this.veValue=t.name)},changeTab:function(t){this.$emit("input",this.veValue=t)}},watch:{value:function(){this.value!==this.veValue&&(this.veValue=this.value)}},mounted:function(){this.getTab()},updated:function(){var t=i.Dom.find(this.$el).find(".n-active").width();this.width=t<0?0:t;var e=i.Dom.find(this.$el).find(".n-active").offset("left",this.$el);this.offset=e<0?0:e},renderHeaderIndicator:function(){var t=this.$createElement;return t("div",{class:"n-tabs__indicator",style:{maxWidth:this.width+"px",left:this.offset+"px"}},[t("span")])},renderHeader:function(){var t=this.$createElement;return this.veTabs.length<=1?null:t("div",{class:"n-tabs__header"},[t("div",{class:"n-tabs__header-inner"},[[i.Arr.each(i.Arr.sort(this.veTabs,"sort"),(function(t){return t.ctor("renderHeader")()})),this.ctor("renderHeaderIndicator")()]])])},renderBody:function(){return(0,this.$createElement)("div",{class:"n-tabs__body"},[this.$slots.default])},render:function(){var t=arguments[0];return t("div",{class:"n-tabs"},[this.ctor("renderHeader")(),this.ctor("renderBody")()])}},a=n(3),c=n.n(a),l={name:"NTabsItem",inject:{NTabs:{default:void 0}},provide:function(){return{NTabsItem:this}},props:{label:{default:function(){return""},type:[String]},name:{default:function(){return"default"},type:[String]},icon:{default:function(){return""},type:[String]},sort:{default:function(){return this._uid},type:[Number]},preload:{default:function(){return!1},type:[Boolean]},raw:{default:function(){return!1},type:[Boolean]},keep:{default:function(){return!1},type:[Boolean]}},methods:{changeTab:function(){this.NTabs.changeTab(this.name)}},data:function(){return{veInit:!1}},beforeMount:function(){this.NTabs.addTab(this)},beforeDestroy:function(){this.NTabs.removeTab(this)},renderHeaderIcon:function(){var t=this.$createElement;return this.$slots.icon||this.icon?t("div",{class:"n-tabs__tab-icon"},[this.$slots.icon||t("span",{class:this.icon})]):null},renderHeaderLabel:function(){var t=this.$createElement;return t("div",{class:"n-tabs__tab-label"},[this.$slots.label||t("span",[this.label])])},renderHeader:function(){var t=this,e=this.$createElement,n=["n-tabs__tab"];this.NTabs.veValue===this.name&&n.push("n-active");var r={click:function(){return t.changeTab(t.name)}};return e("div",c()([{class:n},{on:r}]),[this.ctor("renderHeaderIcon")(),this.ctor("renderHeaderLabel")()])},render:function(){var t=arguments[0],e=this.NTabs.veValue===this.name;if(this.NTabs.veValue!==this.name&&this.keep&&(e=this.veInit),this.NTabs.veValue!==this.name&&this.preload&&(e=!0),!e)return null;this.veInit=!0;var n=["n-tabs-item"];this.raw&&n.push("n-raw");var r={};return this.NTabs.veValue!==this.name&&(r.display="none"),t("div",{class:n,style:r},[this.$slots.default])}};o.a.component(s.name,s),o.a.component(l.name,l)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NCheckbox",model:{prop:"checked"},inject:{NCheckboxGroup:{default:void 0}},props:{value:{default:function(){return null}},checked:{default:function(){return!1},type:[Boolean]},disabled:{default:function(){return!1},type:[Boolean]},name:{default:function(){return""},type:[String]},size:{default:function(){return"default"},type:[String]},intermediate:{default:function(){return!1},type:[Boolean]},global:{default:function(){return!1},type:[Boolean]}},computed:{veComputed:function(){return this.global?this.NCheckboxGroup.globalChecked:this.veChecked},veIntermediate:function(){return this.global?this.NCheckboxGroup.globalIntermediate:this.intermediate},veDisabled:function(){return this.global?this.NCheckboxGroup.globalDisabled:this.disabled}},data:function(){return{veChecked:this.checked}},methods:{toggle:function(){this.$emit("input",this.veChecked=!this.veChecked)},check:function(){this.NCheckboxGroup&&this.NCheckboxGroup.checkCheckbox(this),this.$emit("input",this.veChecked=!0)},uncheck:function(){this.NCheckboxGroup&&this.NCheckboxGroup.uncheckCheckbox(this),this.$emit("input",this.veChecked=!1)},eventLocalClick:function(t){this.NCheckboxGroup&&(t.shiftKey?this.NCheckboxGroup.shiftCheckbox(this):this.NCheckboxGroup.toggleCheckbox(this)),this.$emit("input",this.veChecked=!this.veChecked)},eventGlobalClick:function(){this.NCheckboxGroup.toggleAll()}},watch:{checked:function(){this.checked!==this.veChecked&&(this.veChecked=this.checked)}},beforeMount:function(){this.NCheckboxGroup&&(this.veChecked=this.NCheckboxGroup.isChecked(this.value))},mounted:function(){var t=this;this.NCheckboxGroup&&!this.global&&(this.NCheckboxGroup.$watch("veValue",(function(){t.veChecked=t.NCheckboxGroup.isChecked(t.value)})),this.NCheckboxGroup.addCheckbox(this))},beforeDestroy:function(){this.NCheckboxGroup&&!this.global&&this.NCheckboxGroup.removeCheckbox(this)},renderCheckbox:function(){var t=this.$createElement,e=this.$slots.intermediate;e||(e=t("span",{class:this.icons.intermediate}));var n=this.$slots.checked;return n||(n=t("span",{class:this.icons.checked})),t("div",{class:"n-checkbox__checkbox"},[this.veIntermediate?e:n])},renderLabel:function(){var t=this.$createElement;return this.$slots.default||this.$slots.label?t("div",{class:"n-checkbox__label"},[this.$slots.default||this.$slots.label]):null},render:function(t){var e=arguments[0];this.$render=t;var n=["n-checkbox","n-checkbox--"+this.size];this.veComputed&&n.push("n-checked"),this.veIntermediate&&n.push("n-intermediate"),this.veDisabled&&n.push("n-disabled");var r={};return this.veDisabled||(r=a.Obj.clone(this.$listeners)),!this.veDisabled&&this.global&&(r.click=this.eventGlobalClick),this.veDisabled||this.global||(r.click=this.eventLocalClick),e("div",s()([{class:n},{on:r}]),[this.ctor("renderCheckbox")(),this.ctor("renderLabel")()])}},l={name:"NCheckboxGroup",provide:function(){return{NCheckboxGroup:this}},props:{value:{default:function(){return[]},type:[Array]},align:{default:function(){return"vertical"},type:[String]}},computed:{globalChecked:function(){var t=a.Arr.filter(this.veCheckboxes,(function(t){return t.veChecked}));return 0!==this.veCheckboxes.length&&t.length===this.veCheckboxes.length},globalIntermediate:function(){var t=this.veCheckboxes.filter((function(t){return t.veChecked}));return 0!==t.length&&t.length!==this.veCheckboxes.length},globalDisabled:function(){return 0===this.veCheckboxes.length}},data:function(){return{veValue:this.value,veCheckboxes:[],veIndex:-1}},watch:{value:function(){this.value!==this.veValue&&(this.veValue=this.value)}},methods:{addCheckbox:function(t){this.veIndex=-1,a.Arr.add(this.veCheckboxes,t,{_uid:t._uid}),this.veCheckboxes=a.Arr.sort(this.veCheckboxes,"sort")},removeCheckbox:function(t){a.Arr.remove(this.veCheckboxes,{_uid:t._uid}),this.veIndex=-1},toggleCheckbox:function(t){var e=a.Arr.findIndex(this.veCheckboxes,{_uid:t._uid});t.veChecked||(this.veIndex=e),a.Arr.toggle(this.veValue,t.value)},checkCheckbox:function(t){a.Arr.add(this.veValue,t.value)},uncheckCheckbox:function(t){a.Arr.remove(this.veValue,t.value)},shiftCheckbox:function(t){if(-1===this.veIndex)return this.toggleCheckbox(t);var e=a.Arr.findIndex(this.veCheckboxes,{_uid:t._uid}),n=this.veCheckboxes.slice(this.veIndex,e+1);e<this.veIndex&&(n=this.veCheckboxes.slice(e,this.veIndex+1)),a.Arr.each(n,(function(t){return t.check()})),this.veIndex=-1},toggleAll:function(){this.globalChecked?this.uncheckAll():this.checkAll()},checkAll:function(){a.Arr.each(this.veCheckboxes,(function(t){return t.check()}))},uncheckAll:function(){a.Arr.each(this.veCheckboxes,(function(t){return t.uncheck()}))},isChecked:function(t){return a.Arr.has(this.veValue,t)}},render:function(t){var e=arguments[0];this.$render=t;var n=["n-checkbox-group","n-checkbox-group--"+this.align];return e("div",{class:n},[this.$slots.default])}};o.a.component(c.name,c),o.a.component(l.name,l)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NSelect",props:{value:{default:function(){return null}},clearValue:{default:function(){return null}},size:{default:function(){return"default"},type:[String]},position:{default:function(){return"bottom-center"},type:[String]},boundary:{default:function(){return null}},multiple:{default:function(){return!1},type:[Boolean]},disabled:{default:function(){return!1},type:[Boolean]},clearable:{default:function(){return!1},type:[Boolean]},placeholder:{default:function(){return this.trans("Please select")},type:[String]},emptyText:{default:function(){return this.trans("No items")},type:[String]},undefinedText:{default:function(){return this.trans("Undefined item")}},allowCreate:{default:function(){return!1},type:[Boolean]}},data:function(){return{veValue:this.value,veClearValue:this.clearValue,veOpen:!1,veSearch:"",veIndex:-1,veOptions:[],veSearched:[]}},provide:function(){return{NSelect:this}},watch:{value:function(){this.veValue!==this.value&&(this.veValue=this.value)}},methods:{clear:function(){this.$emit("input",this.veValue=a.Arr.clone(this.veClearValue))},addOption:function(t){a.Arr.add(this.veOptions,t,{veValue:t.veValue})},removeOption:function(t){a.Arr.remove(this.veOptions,{veValue:t.veValue})},searchOptions:function(){if(a.Any.isEmpty(this.veSearch))return this.veSearched=this.veOptions;var t=new RegExp(this.veSearch);this.veSearched=a.Arr.filter(this.veOptions,(function(e){return e.label.match(t)}))},toggleOption:function(t,e){if(!a.Any.isEmpty(t)){e&&e.stopPropagation();var n=this.veValue;this.multiple||this.$refs.popover.close(),this.multiple||(n=t),this.multiple&&a.Arr.toggle(n,t),this.veValue!==n&&this.$emit("input",this.veValue=n)}},getOptionLabel:function(t){var e=a.Arr.find(this.veOptions,{value:t});return!e&&this.allowCreate?t:e||this.allowCreate?e.label:this.undefinedText},openSelect:function(){this.veOpen=!0,!this.veOpen&&this.$refs.input&&this.$refs.input.focus(),this.veIndex=-1},closeSelect:function(){this.veOpen=!1,!this.veOpen&&this.$refs.input&&this.$refs.input.blur(),this.veIndex=-1},selectPrev:function(){var t=this.veIndex-1;t<0&&(t=this.veOptions.length-1),this.veIndex=t},selectNext:function(){var t=this.veIndex+1;t>this.veOptions.length-1&&(t=0),this.veIndex=t},toggleSelected:function(){var t=a.Arr.get(this.veSearched,this.veIndex);1===this.veSearched.length&&(t=a.Arr.get(this.veSearched,0),this.veSearch=""),t&&this.toggleOption(t.veValue)},eventUpdateSearch:function(t){this.veSearch=t.target.value,this.$once("hook:updated",this.$refs.popover.refresh),this.veIndex=-1},eventFocusSearch:function(t){this.openSelect()},eventBlurSearch:function(t){this.veOpen||(this.veSearch=""),this.veOpen&&this.$refs.input&&this.$refs.input.focus()},eventKeydownSearch:function(t){13===t.which&&(this.allowCreate&&-1===this.veIndex&&(this.toggleOption(this.veSearch),this.veSearch=""),this.allowCreate&&-1===this.veIndex||this.toggleSelected()),38===t.which&&this.selectPrev(),40===t.which&&this.selectNext(),9!==t.which&&27!==t.which||this.$refs.popover.close()},eventPopoverInput:function(t){t&&this.$refs.input&&this.$refs.input.focus(),t?this.openSelect():this.closeSelect()}},created:function(){this.multiple&&!a.Any.isArray(this.veValue)&&(this.veValue=[]),this.multiple&&!a.Any.isArray(this.veClearValue)&&(this.veClearValue=[])},beforeMount:function(){this.$watch("veSearch",this.searchOptions),this.searchOptions()},renderLabelInput:function(){var t=this.$createElement,e={input:this.eventUpdateSearch,focus:this.eventFocusSearch,blur:this.eventBlurSearch,keydown:this.eventKeydownSearch},n={disabled:this.disabled};return!this.multiple&&this.veOpen&&(n.placeholder=this.getOptionLabel(this.veValue)),a.Any.isEmpty(this.veValue)&&!a.Any.isNumber(this.veValue)&&(n.placeholder=this.placeholder),t("input",s()([{ref:"input",class:"n-select__input",attrs:{type:"text"},domProps:{value:this.veSearch}},{on:e},{},{attrs:n}]))},renderLabelClear:function(){var t=this.$createElement;if(!this.clearable)return null;var e={click:this.clear};return t("div",s()([{class:"n-select__clear"},{on:e}]),[t("span",{class:this.icons.times})])},renderLabelItem:function(t){var e=this,n=this.$createElement;if(a.Any.isEmpty(this.veValue)&&!a.Any.isNumber(this.veValue))return null;var r={};!this.multiple&&this.veOpen&&(r.display="none");var o={click:function(){return e.toggleOption(t)}},i=null;return this.multiple&&(i=n("i",s()([{},{on:o},{class:this.icons.times}]))),n("span",{class:["n-select__item"],style:r},[[this.getOptionLabel(t),i]])},renderLabelAngle:function(){var t=this.$createElement;return t("div",{class:"n-select__angle"},[t("span",{class:this.icons.angleDown})])},renderLabel:function(){var t=this,e=this.$createElement,n=this.veValue;return a.Any.isArray(n)||(n=[n]),e("div",{class:"n-select__label"},[this.ctor("renderLabelClear")(),a.Arr.each(n,(function(e){return t.ctor("renderLabelItem")(e)})),this.ctor("renderLabelInput")(),this.ctor("renderLabelAngle")()])},renderDisplay:function(){var t=this.$createElement,e=["n-select","n-select--"+this.size];return this.multiple&&e.push("n-select--multiple"),t("div",{class:e},[this.ctor("renderLabel")()])},renderOptions:function(){var t=this.$createElement;return this.veSearched.length?t("NScrollbar",{class:"n-select__items",attrs:{relative:!0}},[a.Arr.each(this.veSearched,(function(t,e){return t.ctor("renderOption")(e)}))]):t("div",{class:"n-select__empty"},[this.emptyText])},renderPopover:function(){var t=this.$createElement,e={visible:this.veOpen,type:"select",trigger:"click",width:"100%",size:this.size,disabled:this.disabled,position:this.position,boundary:this.boundary,window:!this.boundary},n={input:this.eventPopoverInput};return t("NPopover",s()([{ref:"popover"},{props:e},{},{on:n}]),[this.ctor("renderOptions")()])},render:function(t){var e=arguments[0];this.$render=t;var n=["n-select__wrapper"];return this.disabled&&n.push("n-disabled"),e("div",{class:n},[this.ctor("renderDisplay")(),this.ctor("renderPopover")(),this.$slots.default])}},l={name:"NSelectOption",inject:{NSelect:{default:void 0}},props:{value:{default:function(){return""}},prop:{default:function(){return""},type:[String]},label:{default:function(){return this.$slots.default[0].text},type:[String]},disabled:{default:function(){return!1},type:[Boolean]}},computed:{veValue:function(){return a.Any.isEmpty(this.prop)?this.value:a.Obj.get(this.value,this.prop)}},beforeMount:function(){this.NSelect.addOption(this)},destroyed:function(){this.NSelect.removeOption(this)},renderOption:function(t){var e=this,n=this.$createElement,r=["n-popover-option"];a.Arr.has(this.NSelect.veValue,this.value)&&r.push("n-active"),this.disabled&&r.push("n-disabled"),this.NSelect.veIndex===t&&r.push("n-current");var o={};return this.disabled||(o.click=function(t){return e.NSelect.toggleOption(e.veValue,t)}),n("div",s()([{class:r},{on:o}]),[this.$slots.default||this.label])},render:function(t){return this.$render=t,null}};o.a.component(c.name,c),o.a.component(l.name,l)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(0),s={name:"NMap",model:{prop:"visible"},props:{lat:{default:function(){return 0},type:[Number]},lng:{default:function(){return 0},type:[Number]},zoom:{default:function(){return 15},type:[Number]}},provide:function(){return{NMap:this}},data:function(){return{veMap:null}},mounted:function(){this.veMap=new i.Map(this.$el,{lat:this.lat,lng:this.lng,zoom:this.zoom})},methods:{getMap:function(){return this.veMap}},render:function(t){var e=arguments[0];this.$render=t;var n=["n-map"];return e("div",{class:n},[this.$slots.default])}},a={name:"NMapMarker",inject:{NMap:{default:void 0}},props:{lat:{default:function(){return 0},type:[Number]},lng:{default:function(){return 0},type:[Number]},draggable:{default:function(){return!1},type:[Boolean]},options:{default:function(){return{style:"default"}},type:[Object]}},data:function(){return{veID:Object(i.UUID)(),veMarker:null}},methods:{updateMarkerPosition:function(){this.$emit("update:lat",this.veMarker.marker.getPosition().lat()),this.$emit("update:lng",this.veMarker.marker.getPosition().lng())},initializeMarker:function(){var t=this,e=i.Obj.assign({lat:i.Num.float(this.lat),lng:i.Num.float(this.lng),draggable:this.draggable},this.options);i.Any.isEmpty(this.$slots.default)||(e.html=this.$el.innerHTML),this.veMarker=this.NMap.getMap().createMarker(this.veID,e),this.veMarker.marker.addListener("position_changed",i.Any.debounce(this.updateMarkerPosition)),this.veMarker.marker.addListener("dragstart",(function(){return t.$emit("dragstart",t.veMarker)})),this.veMarker.marker.addListener("dragend",(function(){return t.$emit("dragend",t.veMarker)})),this.veMarker.marker.addListener("mouseover",(function(){return t.$emit("mouseenter",t.veMarker)})),this.veMarker.marker.addListener("mouseout",(function(){return t.$emit("mouseleave",t.veMarker)}))},setMarkerByAddress:function(t){var e=this;this.NMap.getMap().setMarkerByAddress(this.veID,t).then((function(){e.NMap.getMap().focusMarkers(null,e.NMap.zoom)}),(function(){e.Notify(e.trans("Address not found."),"danger")}))}},mounted:function(){this.NMap.$once("hook:mounted",this.initializeMarker)},render:function(t){return t("div",{style:"display: none;"},[this.$slots.default])}};o.a.component(s.name,s),o.a.component(a.name,a)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c=n(13),l=n.n(c),u={name:"NScrollbar",props:{options:{default:function(){return{}},type:[Object]},relative:{default:function(){return!1},type:[Boolean]}},methods:{adjustScrollbars:function(){var t=a.Dom.find(this.$el).css(),e={};t.bottom&&(e["margin-top"]="-15px"),t.right&&(e["margin-left"]="-15px"),a.Any.isEmpty(e)||a.Dom.find(this.$el).css(e)},initialize:function(){this.optiscroll&&this.destroy(),l.a.globalSettings.checkFrequency=750,l.a.globalSettings.scrollMinUpdateInterval=16,this.optiscroll=new l.a(this.$el.parentNode,{classPrefix:"n-scrollbar-",minTrackSize:10,wrapContent:!1,preventParentScroll:!0,forceScrollbars:!0}),this.relative&&a.Dom.find(this.$el).parent().addClass("n-relative");var t={_uid:this._uid};this.relative&&(a.Dom.find(this.$el).on("sizechange",a.Any.debounce(this.adjustScrollbars),t),this.adjustScrollbars()),a.Dom.find(this.$el).parent().addClass("n-scrollbar")},destroy:function(){if(this.optiscroll){this.optiscroll.destroy(),delete this.optiscroll;var t={_uid:this._uid};a.Dom.find(this.$el).off("sizechange",null,t),a.Dom.find(this.$el).parent().removeClass("n-scrollbar")}},refresh:function(){a.Dom.find(this.$el).parent().hasClass("is-enabled")||this.initialize()}},mounted:function(){this.$parent.$on("hook:updated",this.refresh),this.$parent.$on("hook:destroyed",this.destroy),this.initialize()},beforeDestroy:function(){this.$parent.$off("hook:updated"),this.$parent.$off("hook:destroyed")},render:function(){var t=arguments[0];return t("div",s()([{},{on:this.$listeners}]),[this.$slots.default])}};o.a.component(u.name,u)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(0),s={name:"NVirtualscroller",model:{prop:"items"},props:{items:{default:function(){return[]}},itemHeight:{default:function(){return 30}},viewportHeight:{default:function(){return!1}},renderNode:{default:function(){return null}},preloadItems:{default:function(){return 20},type:[Number]},bufferItems:{default:function(){return 20},type:[Number]},frameRate:{default:function(){return 30},type:[Number]}},methods:{refreshDriver:function(){if(this.$refs.viewport&&this.height){var t=this.$refs.viewport.$el.scrollTop,e=Math.floor(t/this.itemHeight);e<0&&(e=0);var n=Math.floor(e-this.preloadItems/2);n<0&&(n=0);var r=Math.floor(n-this.bufferItems/2);r<0&&(r=0);var o=Math.ceil((t+this.height)/this.itemHeight);o>this.items.length&&(o=this.items.length);var i=Math.ceil(o+this.preloadItems/2);i>this.items.length&&(i=this.items.length);var s=Math.ceil(i+this.bufferItems/2);s>this.items.length&&(s=this.items.length);var a=Math.abs(this.state.startBuffer-r);a<Math.round(this.bufferItems/2)&&(a=this.state.startBuffer);var c=Math.abs(this.state.endBuffer-s);c<Math.round(this.bufferItems/2)&&(c=this.state.endBuffer);var l={startIndex:e,startPreload:n,startBuffer:r,endIndex:o,endPreload:i,endBuffer:s};l.startIndex===this.state.startIndex&&l.endIndex===this.state.endIndex||(this.state=l)}},discoverHeight:function(){if(this.viewportHeight&&(this.height=i.Dom.find(this.$el).height()),this.viewportHeight||(this.height=this.items.length*this.itemHeight),0===this.height)return i.Any.delay(this.discoverHeight,100);i.Any.async(this.refreshDriver)},eventScroll:function(){i.Any.async(this.refreshDriver)},eventScrollstop:function(){i.Any.async(this.refreshDriver)}},data:function(){return{state:{startIndex:0,startPreload:0,startBuffer:0,endIndex:0,endPreload:0,endBuffer:0},height:0,veInit:!1,veUpdate:0}},mounted:function(){this.$watch("items",this.discoverHeight);var t={_uid:this._uid};i.Dom.find(this.$el).on("scroll",i.Any.framerate(this.eventScroll,this.frameRate),t),i.Dom.find(this.$el).on("scrollstop",i.Any.debounce(this.eventScrollstop,50),t),i.Dom.find(this.$el).observerResize(this.discoverHeight)(this.$el),this.veInit=!0},beforeDestroy:function(){var t={_uid:this._uid};i.Dom.find(this.$el).off("scroll",null,t),i.Dom.find(this.$el).off("scrollstop",null,t)},renderItems:function(){var t=this,e=i.Arr.slice(i.Any.vals(this.items),this.state.startBuffer,this.state.endBuffer),n=this.state.startPreload-this.state.startBuffer,r=this.state.endPreload-this.state.startBuffer;return i.Arr.each(e,(function(e,o){var i=o<n||o>r;return t.renderNode({value:e,index:o,ghost:i})}))},renderBody:function(){var t=this,e=this.$createElement;return this.veInit?this.items.length?!1===this.viewportHeight?i.Arr.each(this.items,(function(e,n){return t.renderNode({value:e,index:n})})):e("NScrollbar",{ref:"viewport",style:{overflow:"auto",overflowAnchor:"none",outline:"none",height:this.height+"px"}},[e("div",[e("div",{style:{height:this.state.startBuffer*this.itemHeight+"px"}}),this.ctor("renderItems")(),e("div",{style:{height:(this.items.length-this.state.endBuffer)*this.itemHeight+"px"}})])]):this.$slots.empty||null:null},render:function(t){var e=arguments[0];return this.$render=t,e("div",{class:"n-virtualscroller"},[this.$slots.before||null,this.ctor("renderBody")(),this.$slots.default||null])}};o.a.component(s.name,s)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(0),s={name:"NLoader",model:{prop:"visible"},inject:{NLoader:{default:void 0}},provide:function(){return{NLoader:this}},props:{visible:{default:function(){return!1},type:[Boolean]},size:{default:function(){return"default"},type:[String]},minTime:{default:function(){return 1e3},type:[Number]}},data:function(){return{veTiming:0}},methods:{startTimer:function(){var t=this;this.veTiming=Date.now(),window.requestAnimationFrame((function(){return i.Dom.find(t.$el).addClass("n-active")}))},stopTimer:function(){var t=this,e=Date.now()-this.veTiming;if(e<this.minTime)return i.Any.delay(this.stopTimer,this.minTime-e+10);window.requestAnimationFrame((function(){return i.Dom.find(t.$el).removeClass("n-active")}))}},watch:{visible:function(){this.visible?this.startTimer():this.stopTimer()}},mounted:function(){this.visible?this.startTimer():this.stopTimer()},render:function(t){var e=arguments[0];this.$render=t;var n=["n-loader","n-loader--"+this.size];return e("div",{class:n},[this.$slots.default])}};o.a.component(s.name,s)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NPopover",model:{prop:"visible"},inject:{NPopover:{default:void 0}},provide:function(){return{NPopover:this}},props:{visible:{default:function(){return!1},type:[Boolean]},width:{default:function(){return 0}},disabled:{default:function(){return!1},type:[Boolean]},selector:{default:function(){return null}},boundary:{default:function(){return null}},contain:{default:function(){return!0},type:[Boolean]},window:{default:function(){return!1},type:[Boolean]},trigger:{default:function(){return"hover"},type:[String]},type:{default:function(){return"default"},type:[String]},size:{default:function(){return null}},position:{default:function(){return"context"===this.trigger?"bottom-start":"bottom-center"},type:[String]},closeInside:{default:function(){return!1},type:[Boolean]},updateInterval:{default:function(){return 1e3/15},type:[Number]}},watch:{visible:function(){this.veVisible!==this.visible&&(this.veVisible=this.visible)},veVisible:function(){this.$nextTick(this.refresh)}},methods:{close:function(){this.$emit("input",this.veVisible=!1)},refresh:function(){var t=this;if(!this.veVisible)return this.style;window.zIndex||(window.zIndex=9e3);var e={},n=a.Dom.find(this.target).offset("left",this.parent);"context"===this.trigger&&(n=this.clientX-a.Dom.find(this.parent).offset("left"));var r=a.Dom.find(this.target).offset("top",this.parent);"context"===this.trigger&&(r=this.clientY-a.Dom.find(this.parent).offset("top"));var o="context"===this.trigger?0:a.Dom.find(this.target).height(),i="context"===this.trigger?0:a.Dom.find(this.target).width(),s=this.width;"100%"===s&&(s=a.Dom.find(this.target).width());var c={"max-width":s?s+"px":"auto"};this.width&&(c.width=this.width+"px");var l=a.Dom.find(this.$el).realWidth(c),u=a.Dom.find(this.$el).realHeight(c);this.position.match(/^top-(start|center|end)$/)&&(e.top=r-u),this.position.match(/^bottom-(start|center|end)$/)&&(e.top=r+o),this.position.match(/^(top|bottom)-start$/)&&(e.left=n),this.position.match(/^(top|bottom)-end$/)&&(e.left=n+i-l),this.position.match(/^(top|bottom)-center$/)&&(e.left=n+i/2-l/2),this.position.match(/^left-(start|center|end)$/)&&(e.left=n-l),this.position.match(/^right-(start|center|end)$/)&&(e.left=n+i),this.position.match(/^(left|right)-start$/)&&(e.top=r),this.position.match(/^(left|right)-end$/)&&(e.top=r+o-u),this.position.match(/^(left|right)-center$/)&&(e.top=r+o/2-u/2);var h=a.Dom.find(this.parent).width(),p=a.Dom.find(this.parent).height(),f=a.Dom.find(this.target).offset(null,this.parent),d=a.Dom.find(this.target).scroll(null,this.parent),v=0,m=0;a.Dom.find(this.$el).actual((function(){v=t.parent.scrollWidth,m=t.parent.scrollHeight}),{display:"none"}),"context"===this.trigger&&(e.left<0&&(e.left=0),e.left+l>this.parent.clientWidth&&(e.left=f.left-d.left-l),e.top<0&&(e.top=0),e.top+u>this.parent.clientHeight&&(e.top=this.parent.clientHeight-u)),"context"!==this.trigger&&this.position.match(/^(top|bottom)-/)&&this.contain&&(e.left<0&&(e.left=0),e.left+l>v&&(e.left=v-l),e.top+u>m&&(e.top=f.top-u),e.top-u<0&&(e.top=o+f.top)),"context"!==this.trigger&&this.position.match(/^(left|right)-/)&&this.contain&&(e.top<0&&(e.top=0),e.top+u>p&&(e.top=p-u),e.left+l>h&&(e.left=f.left-d.left-l),e.left-l<0&&(e.left=i+f.left));var g=a.Obj.map(a.Obj.clone(e),(function(t){return t+"px"}));return"context"!==this.trigger&&(g["max-width"]=s?s+"px":"auto"),g["z-index"]=window.zIndex++,this.style=g},addClass:function(){a.Dom.find(this.$el).addClass("n-open")},addTargetClass:function(){a.Dom.find(this.target).addClass("n-open")},removeClass:function(){a.Dom.find(this.$el).removeClass("n-open")},removeTargetClass:function(){a.Dom.find(this.target).removeClass("n-open")},eventMousemove:function(t,e){if(!this.disabled){var n=a.Dom.find(e).closest(this.target),r=a.Dom.find(e).closest(this.$el),o=!!n||!!r;this.veVisible!==o&&this.$emit("input",this.veVisible=o)}},eventClick:function(t,e){if(this.clientX=t.clientX,this.clientY=t.clientY,1===t.which&&!this.disabled){var n=a.Dom.find(e).closest(this.target),r=a.Dom.find(e).closest(this.$el),o=!!n||!!r;o&&this.veVisible&&(o=!this.closeInside),this.veVisible!==o&&this.$emit("input",this.veVisible=o)}},eventContextmenu:function(t,e){if(!this.disabled&&3===t.which){var n=a.Dom.find(e).closest(this.target),r=a.Dom.find(e).closest(this.$el),o=!!n||!!r;o&&this.veVisible&&(o=!this.closeInside),o&&t.preventDefault(),this.veVisible!==o&&this.$emit("input",this.veVisible=o)}},eventMousedown:function(t){this.clientX=t.clientX,this.clientY=t.clientY}},data:function(){var t={veVisible:this.visible,clientX:0,clientY:0,target:null,parent:null,style:{display:"none"}};return t},mounted:function(){var t={_uid:this._uid};"hover"===this.trigger&&a.Dom.find(document).on("mousemove",a.Any.debounce(this.eventMousemove),t),"click"===this.trigger&&a.Dom.find(document).on("click",this.eventClick,t),"context"===this.trigger&&(a.Dom.find(document).on("mousedown",this.eventMousedown,t),a.Dom.find(document).on("contextmenu",this.eventContextmenu,t)),this.target=a.Dom.find(this.$el).previous().get(0),a.Any.isEmpty(this.selector)||(this.target=a.Dom.find(this.$el).parent().find(this.selector).get(0)),this.parent=a.Obj.get(this.NPopover,"boundary"),this.boundary&&!this.parent&&(this.parent=a.Dom.find(this.boundary).get(0)),this.window&&!this.parent&&(this.parent=a.Dom.find(this.$el).closestScrollable()),this.parent&&a.Dom.find(this.parent).append(this.$el),this.parent||(this.parent=a.Dom.find(this.target).parent().get(0))},beforeDestroy:function(){var t={_uid:this._uid};a.Dom.find(document).off("mousemove",null,t),a.Dom.find(document).off("click",null,t),a.Dom.find(document).off("contextmenu",null,t),a.Dom.find(document).off("mousedown",null,t),this.$el.remove()},renderBody:function(){var t=this.$createElement;return this.$slots.raw?this.$slots.raw:t("div",{class:"n-popover__frame"},[this.$slots.header&&t("div",{class:"n-popover__header"},[this.$slots.header]),t("div",{class:"n-popover__body"},[this.$slots.default]),this.$slots.footer&&t("div",{class:"n-popover__footer"},[this.$slots.footer])])},render:function(){var t=arguments[0],e=["n-popover","n-popover--"+this.type,"n-popover--"+this.position];this.size&&e.push("n-popover--"+this.size);var n=this.style;this.width&&(n.width=this.width+"px");var r={beforeEnter:this.addClass,afterEnter:this.addTargetClass,beforeLeave:this.removeTargetClass,afterLeave:this.removeClass};return t("div",{class:e,style:this.style},[t("transition",s()([{attrs:{name:"n-fade-fast",mode:"out-in"}},{on:r}]),[this.veVisible?this.ctor("renderBody")():null])])}};o.a.component(c.name,c)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NModal",model:{prop:"visible"},props:{visible:{default:function(){return!1},type:[Boolean]},selector:{default:function(){return null}},boundary:{default:function(){return document.body}},width:{default:function(){return"50%"},type:[String]},height:{default:function(){return"auto"},type:[String]},title:{default:function(){return""},type:[String]},type:{default:function(){return"default"},type:[String]},position:{default:function(){return"center-center"},type:[String]},closable:{default:function(){return!0},type:[Boolean]},closeOutside:{default:function(){return this.closable},type:[Boolean]},transitionModal:{default:function(){return"n-fade-up"},type:[String]},transitionBackdrop:{default:function(){return"n-fade"},type:[String]}},watch:{visible:function(){this.visible!==this.veVisible&&(this.veVisible=this.visible)}},methods:{close:function(t){t.stopPropagation(),this.$emit("input",this.veVisible=!1)},addClass:function(){a.Dom.find(this.$el).addClass("n-open"),a.Dom.find(this.target).addClass("n-open"),a.Dom.find(document.body).addClass("n-open")},removeClass:function(){a.Dom.find(this.$el).removeClass("n-open"),a.Dom.find(this.target).removeClass("n-open"),a.Dom.find(document.body).removeClass("n-open")},eventClick:function(t,e){if(1===t.which){var n=!!a.Dom.find(e).closest(this.target)||this.veVisible;this.veVisible&&this.closable&&(n=!a.Dom.find(e).closest(this.$refs.backdrop)),n!==this.veVisible&&this.$emit("input",this.veVisible=!!n)}}},data:function(){return{target:null,veVisible:this.visible}},mounted:function(){a.Dom.find(document.body).on("click",this.eventClick,{_uid:this._uid}),this.$listeners.close||this.$on("close",this.close),this.target=a.Dom.find(this.$el).previous().get(0),a.Any.isEmpty(this.selector)||(this.target=a.Dom.find(this.$el).parent().find(this.selector).get(0)),a.Dom.find(document.body).append(this.$el)},beforeDestroy:function(){this.$el.remove()},destroyed:function(){a.Dom.find(document.body).off("click",null,{_uid:this._uid})},renderClose:function(){var t=this.$createElement;if(!this.closable)return null;var e={click:this.close};return t("div",s()([{class:"n-modal__close"},{on:e}]),[t("span",{class:this.icons.times})])},renderHeader:function(){var t=this.$createElement;return this.$slots.header||this.title?t("div",{class:"n-modal__header"},[[this.$slots.header||this.title,this.ctor("renderClose")()]]):null},renderFooter:function(){var t=this.$createElement;return this.$slots.footer?t("div",{class:"n-modal__footer"},[this.$slots.footer]):null},renderBody:function(){var t=this.$createElement,e={width:this.width,height:this.height},n=t("div",{key:Object(a.UUID)(),class:"n-modal__frame",style:e},[this.$slots.raw]);return this.$slots.raw?n:t("div",{key:Object(a.UUID)(),class:"n-modal__frame",style:e},[this.ctor("renderHeader")(),t("div",{class:"n-modal__body"},[t("NScrollbar",{class:"n-modal__wrap",attrs:{relative:!0}},[this.$slots.default])]),this.ctor("renderFooter")()])},renderBackdrop:function(){return(0,this.$createElement)("div",{ref:"backdrop",key:Object(a.UUID)(),class:"n-modal__backdrop"})},renderModal:function(){var t=this.$createElement,e=["n-modal","n-modal--"+this.type,"n-modal--"+this.position];this.closable&&e.push("n-closable");var n={beforeEnter:this.addClass,afterLeave:this.removeClass};return t("div",{class:e},[t("transition",{attrs:{name:this.transitionModal,mode:"out-in"}},[this.veVisible?this.ctor("renderBody")():null]),t("transition",s()([{attrs:{name:this.transitionBackdrop,mode:"out-in"}},{on:n}]),[this.veVisible?this.ctor("renderBackdrop")():null])])},render:function(t){return this.$render=t,this.ctor("renderModal")()}};o.a.component(c.name,c)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NConfirm",model:{prop:"visible"},props:{visible:{default:function(){return!1},type:[Boolean]},selector:{default:function(){return null}},boundary:{default:function(){return document.body}},size:{default:function(){return"default"},type:[String]},type:{default:function(){return"primary"},type:[String]},width:{default:function(){return"auto"},type:[String]},position:{default:function(){return"center-center"},type:[String]},closable:{default:function(){return!0},type:[Boolean]}},data:function(){return{veVisible:this.visible}},methods:{abort:function(t){this.$refs.modal.close(t),this.$emit("abort")},confirm:function(t){this.$refs.modal.close(t),this.$emit("confirm")},eventInput:function(t){this.$emit("input",this.veVisible=t)}},watch:{visible:function(){this.visible!==this.veVisible&&(this.veVisible=this.visible)}},renderIcon:function(){var t=this.$createElement;return t("div",{class:"n-confirm__icon"},[t("span",{class:this.icons[this.type]})])},renderBody:function(){return(0,this.$createElement)("div",{class:"n-confirm__body"},[this.$slots.default||this.trans("Are you sure?")])},renderAction:function(){var t=this.$createElement;return t("div",{class:"n-confirm__actions"},[t("NButton",{attrs:{size:this.size,type:"secondary"},on:{click:this.abort}},[this.trans("Abort")]),t("NButton",{attrs:{size:this.size,type:this.type},on:{click:this.confirm}},[this.trans("Confirm")])])},render:function(){var t=arguments[0],e=["n-confirm","n-confirm--"+this.type,"n-confirm--"+this.size],n={type:"confirm",visible:this.veVisible,selector:this.selector,width:this.width,position:this.position,closable:this.closable},r=a.Obj.clone(this.$listeners);return r.input=this.eventInput,t("NModal",s()([{ref:"modal"},{props:n},{},{on:r}]),[t("div",{slot:"raw",class:e},[this.ctor("renderIcon")(),this.ctor("renderBody")(),this.ctor("renderAction")()])])}};o.a.component(c.name,c)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NInput",props:{value:{default:function(){return null}},icon:{default:function(){return null}},iconPosition:{default:function(){return"after"},type:[String]},iconDisabled:{default:function(){return!1},type:[Boolean]},size:{default:function(){return"default"},type:[String]},nativeType:{default:function(){return"text"},type:[String]},round:{default:function(){return!1},type:[Boolean]},disabled:{default:function(){return!1},type:[Boolean]},placeholder:{default:function(){return""},type:[String]}},watch:{value:function(){this.value!==this.veValue&&(this.veValue=this.value)}},methods:{eventIconClick:function(t){this.$emit("icon-click",t)},eventInput:function(t){this.$emit("input",t.target.value)}},data:function(){return{veValue:this.value||""}},renderIcon:function(){var t=this.$createElement;if(!this.icon)return null;var e={click:this.eventIconClick},n={type:"input",icon:this.icon,disabled:this.iconDisabled};return t("NButton",s()([{},{props:n},{},{on:e}]))},renderInput:function(){var t=this.$createElement,e=["n-input","n-input--"+this.size];this.round&&e.push("n-input--round"),this.icon&&(e.push("n-input--icon"),e.push("n-input--icon-"+this.iconPosition));var n={value:this.veValue,type:this.nativeType,disabled:this.disabled,placeholder:this.placeholder},r={};return this.disabled||(r=a.Obj.assign({},this.$listeners)),r.input=this.eventInput,t("input",s()([{domProps:{value:this.veValue},class:e},{attrs:n},{},{on:r}]))},render:function(t){var e=arguments[0];this.$render=t;var n=["n-input__wrapper"];return this.disabled&&n.push("n-disabled"),e("div",{class:n},["before"===this.iconPosition&&this.ctor("renderIcon")(),this.ctor("renderInput")(),"after"===this.iconPosition&&this.ctor("renderIcon")()])}};o.a.component(c.name,c)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=(n(6),n(0)),c={name:"NPaginator",props:{page:{default:function(){return 1},type:[Number]},limit:{default:function(){return 50},type:[Number]},limitOptions:{default:function(){return[25,50,100,250,500]}},total:{default:function(){return 0},type:[Number]},size:{default:function(){return"default"},type:[String]},type:{default:function(){return"secondary"},type:[String]},maxPages:{default:function(){return 7},type:[Number]},layout:{default:function(){return["limit","review","spacer","goto","pages"]},type:[Array]}},computed:{pages:function(){return a.Num.ceil(this.total/this.veLimit)}},data:function(){return{vePage:this.page,veLimit:this.limit}},methods:{changePage:function(t){this.vePage=t},updatePaginate:function(){var t={page:this.vePage,limit:this.veLimit};this.$emit("paginate",t)},eventPageInput:function(t){this.$emit("update:page",this.vePage=t),this.updatePaginate()},eventLimitInput:function(t){this.$emit("update:limit",this.veLimit=t),this.pages<this.vePage&&this.$emit("update:page",this.vePage=1),this.updatePaginate()}},watch:{page:function(){this.page!==this.vePage&&(this.vePage=this.page)},limit:function(){this.limit!==this.veLimit&&(this.veLimit=this.limit)}},renderLimit:function(){var t=this,e=this.$createElement,n={input:this.eventLimitInput},r={value:this.veLimit,size:this.size},o=a.Arr.each(this.limitOptions,(function(n){return e("NSelectOption",{attrs:{disabled:n===t.veLimit,value:n}},[t.choice(":count items",n)])}));return e("div",{class:"n-paginator__limit"},[e("NSelect",s()([{},{props:r},{},{on:n}]),[o])])},renderReview:function(){var t=this.$createElement;return t("div",{class:"n-paginator__review"},[t("span",[this.choice("No items|Total :count item|Total :count items",this.total)])])},renderSpacer:function(){return(0,this.$createElement)("div",{class:"n-paginator__spacer"})},renderGoto:function(){var t=this,e=this.$createElement,n={input:this.eventPageInput},r={value:this.vePage,size:this.size},o=a.Arr.each(Array(this.pages).fill(null),(function(n,r){return e("NSelectOption",{attrs:{disabled:a.Num.int(r)+1===t.vePage,value:a.Num.int(r)+1}},[a.Num.int(r)+1])}));return e("div",{class:"n-paginator__goto"},[e("span",[this.trans("Goto")]),e("NSelect",s()([{},{props:r},{},{on:n}]),[o])])},renderPrev:function(){var t=this,e=this.$createElement,n={type:this.type,square:!0,size:this.size,icon:this.icons.angleLeft};this.vePage-1<1&&(n.disabled=!0);var r={click:function(){return t.eventPageInput(t.vePage-1)}};return e("NButton",s()([{},{props:n},{},{on:r}]))},renderNext:function(){var t=this,e=this.$createElement,n={type:this.type,square:!0,size:this.size,icon:this.icons.angleRight};this.vePage+1>this.pages&&(n.disabled=!0);var r={click:function(){return t.eventPageInput(t.vePage+1)}};return e("NButton",s()([{},{props:n},{},{on:r}]))},renderPage:function(t){var e=this,n=this.$createElement,r=this.vePage,o=Math.abs(this.maxPages/2);r<o&&(r=o);var i=Array(this.pages).length;r>i-o&&(r=i-o);var c=a.Num.int(t)+1;if(c<r-o)return null;if(c>r+o)return null;var l={type:this.type,square:!0,size:this.size};c===this.vePage&&(l.disabled=!0);var u={click:function(){return e.eventPageInput(c)}};return n("NButton",s()([{},{props:l},{},{on:u}]),[c])},renderPages:function(){var t=this;return(0,this.$createElement)("div",{class:"n-paginator__pages"},[this.ctor("renderPrev")(),a.Arr.each(Array(this.pages).fill(null),(function(e,n){return t.ctor("renderPage")(n)})),this.ctor("renderNext")()])},renderSlot:function(t){return this.$slots[t]?this.$slots[t]:null},render:function(){var t=this,e=arguments[0],n=["n-paginator","n-paginator--"+this.size];return e("div",{class:n},[a.Arr.each(this.layout,(function(e){var n=t.ctor("render"+a.Str.ucfirst(e));return n?n():t.ctor("renderSlot")(e)}))])}};o.a.component(c.name,c)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NTextarea",props:{value:{default:function(){return null}},size:{default:function(){return"default"},type:[String]},disabled:{default:function(){return!1},type:[Boolean]},placeholder:{default:function(){return""},type:[String]},autoRows:{default:function(){return!1},type:[Boolean]},maxRows:{default:function(){return 12},type:[Number]},minRows:{default:function(){return 4},type:[Number]},maxLength:{default:function(){return 0},type:[Number]}},watch:{value:function(t){this.value!==this.veValue&&(this.veValue=t)}},methods:{eventInput:function(t){this.$emit("input",t.target.value)}},data:function(){return{veValue:this.value||""}},renderInput:function(){var t=this.$createElement,e=["n-textarea","n-textarea--"+this.size],n={value:this.veValue,rows:this.minRows,disabled:this.disabled,placeholder:this.placeholder};0!==this.maxLength&&(n.maxLength=this.maxLength);var r=(this.veValue.match(/\n/g)||[]).length+1;this.autoRows&&n.rows<r&&(n.rows=r<=this.maxRows?r:this.maxRows);var o=a.Obj.clone(this.$listeners);return o.input=this.eventInput,t("textarea",s()([{domProps:{value:this.veValue},class:e},{attrs:n},{},{on:o}]))},render:function(t){var e=arguments[0];this.$render=t;var n=["n-textarea__wrapper"];return this.disabled&&n.push("n-disabled"),e("div",{class:n},[this.ctor("renderInput")()])}};o.a.component(c.name,c)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0);function c(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var l={name:"NFile",props:{value:{default:function(){return null}},multiple:{default:function(){return!1},type:[Boolean]},icon:{default:function(){return""},type:[String]},size:{default:function(){return"default"},type:[String]},disabled:{default:function(){return!1},type:[Boolean]},placeholder:{default:function(){return""},type:[String]},clearable:{default:function(){return!0},type:[Boolean]},clearableIcon:{default:function(){return this.icons.times},type:[String]},buttonText:{default:function(){return this.trans("Select file")},type:[String]}},methods:{openContext:function(){this.$refs.input.click()},updateFile:function(){this.nativeValue=c(this.$refs.input.files),this.$emit("input",!0===this.multiple?this.nativeValue:a.Arr.first(this.nativeValue))},clearFile:function(){this.nativeValue=[],this.$emit("input",!0===this.multiple?this.nativeValue:null)}},data:function(){return{nativeValue:[]}},render:function(t){var e={"icon-click":this.clearFile},n={size:this.size,disabled:!0,iconDisabled:a.Any.isEmpty(this.nativeValue)},r=a.Locale.choice(":count File|:count Files",this.nativeValue.length);0!==this.nativeValue.length&&(n.value=1===this.nativeValue.length?a.Obj.get(this.nativeValue,"0.name",r):r),!0===this.clearable&&(n.icon=this.clearableIcon);var o={click:this.openContext},i={size:this.size,disabled:this.disabled,icon:this.icon};return t("div",{class:["n-file__wrapper",this.disabled&&"n-disabled"]},[t("NInput",s()([{},{props:n},{},{on:e}])),t("NButton",s()([{},{props:i},{},{on:o}]),[this.buttonText]),t("div",{class:"n-file__input"},[t("input",{ref:"input",attrs:{type:"file",multiple:this.multiple},on:{input:this.updateFile}})])])}};o.a.component(l.name,l)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0);function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l={name:"NCascader",props:{value:{default:function(){return[]},type:[Array]},clearValue:{default:function(){return[]},type:[Array]},items:{default:function(){return[]},type:[Array]},current:{default:function(){return null}},placeholder:{default:function(){return this.trans("Please select")},type:[String]},disabled:{default:function(){return!1},type:[Boolean]},clearable:{default:function(){return!1},type:[Boolean]},size:{default:function(){return"default"},type:[String]},position:{default:function(){return"bottom-start"},type:[String]},boundary:{default:function(){return null}},trigger:{default:function(){return"click"},type:[String]},labelProp:{default:function(){return"label"},type:[String]},valueProp:{default:function(){return"value"},type:[String]},childProp:{default:function(){return"children"},type:[String]}},data:function(){return{veValue:this.value,veHover:this.value,veOpen:!1}},methods:{clear:function(){this.$emit("input",this.veHover=this.veValue=this.clearValue)},eventPopoverInput:function(t){this.veOpen=t},eventHover:function(t){var e=this;this.$once("hook:updated",this.$refs.popover.refresh),"hover"!==this.trigger&&this.$emit("hover",this.veHover=t),clearTimeout(this.veDelay),this.veDelay=setTimeout((function(){e.$emit("hover",e.veHover=t)}),75)},eventSelect:function(t){this.veOpen=!1,this.$emit("input",this.veValue=t)}},watch:{value:function(){this.value!==this.veValue&&(this.veValue=this.value)}},renderLabelClear:function(){var t=this.$createElement;if(!this.clearable||this.disabled)return null;var e={click:this.clear};return t("div",s()([{class:"n-cascader__clear"},{on:e}]),[t("span",{class:this.icons.times})])},renderLabelItems:function(){var t=this,e=this.$createElement,n=this.items,r=[];return a.Arr.each(this.veValue,(function(o){if(n){var i=a.Arr.find(n,c({},t.valueProp,o));n=a.Obj.get(i,t.childProp);var s=e("span",{class:"n-cascader__item"},[a.Obj.get(i,t.labelProp)]);r.push(s)}})),r},renderLabelAngle:function(){var t=this.$createElement;return t("div",{class:"n-cascader__angle"},[t("span",{class:this.icons.angleDown})])},renderLabel:function(){var t=this.$createElement;return t("div",{class:"n-cascader__label"},[!!this.veValue.length&&this.ctor("renderLabelItems")(),!this.veValue.length&&t("span",{class:"n-cascader__placeholder"},[this.placeholder])])},renderDisplay:function(){return(0,this.$createElement)("div",{class:["n-cascader","n-cascader--"+this.size]},[this.ctor("renderLabelClear")(),this.ctor("renderLabel")(),this.ctor("renderLabelAngle")()])},renderOption:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.$createElement,o=a.Arr.clone(n);o.push(t[this.valueProp]);var i=["n-popover-option"];a.Arr.has(this.veValue,t[this.valueProp])&&i.push("n-active"),a.Arr.has(this.veHover,t[this.valueProp])&&i.push("n-current");var c={};"hover"===this.trigger&&(c.mousemove=function(){return e.eventHover(o)},c.click=function(){return e.eventSelect(o)}),"click"===this.trigger&&(c.click=function(){return e.eventHover(o)},c.dblclick=function(){return e.eventSelect(o)});var l=a.Obj.get(t,this.childProp);return r("div",s()([{class:i},{on:c}]),[r("div",{class:"n-cascader-option__label"},[r("span",[a.Obj.get(t,this.labelProp)])]),!a.Any.isEmpty(l)&&r("div",{class:"n-cascader-option__arrow"},[r("span",{class:this.icons.angleRight})])])},renderOptions:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.$createElement;return a.Any.isEmpty(t)?null:r("div",{class:"n-cascader__items"},[r("NScrollbar",{attrs:{relative:!0}},[a.Arr.each(t,(function(t){return e.ctor("renderOption")(t,n)}))])])},renderCascade:function(){var t=this,e=[this.ctor("renderOptions")(this.items)],n=this.items,r=[];return a.Arr.each(this.veHover,(function(o){if(n){r.push(o);var i=a.Arr.find(n,c({},t.valueProp,o));n=a.Obj.get(i,t.childProp);var s=t.ctor("renderOptions")(n,r);e.push(s)}})),e},renderPopover:function(){var t=this.$createElement,e={visible:this.veOpen,type:"cascader",trigger:"click",width:"100%",size:this.size,disabled:this.disabled,position:this.position,boundary:this.boundary,window:!this.boundary},n={input:this.eventPopoverInput};return t("NPopover",s()([{ref:"popover"},{props:e},{},{on:n}]),[this.ctor("renderCascade")()])},render:function(){var t=arguments[0],e=["n-cascader__wrapper"];return this.disabled&&e.push("n-disabled"),t("div",{class:e},[this.ctor("renderDisplay")(),this.ctor("renderPopover")()])}};o.a.component(l.name,l)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c=n(6);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h={name:"NDatepicker",props:{value:{default:function(){return"now"}},clearValue:{default:function(){return null}},arrive:{default:function(){return"now"}},depart:{default:function(){return"now+1day"}},placeholder:{default:function(){return this.trans("Select date")},type:[String]},placeholderArrive:{default:function(){return this.trans("Start date")},type:[String]},placeholderDepart:{default:function(){return this.trans("Start end")},type:[String]},range:{default:function(){return!1},type:[Boolean]},rangeSeparator:{default:function(){return"-"},type:[String]},size:{default:function(){return"default"},type:[String]},position:{default:function(){return"bottom-center"},type:[String]},disabled:{default:function(){return!1},type:[Boolean]},clearable:{default:function(){return!1},type:[Boolean]},format:{default:function(){return"YYYY-MM-DD HH:mm:ss"},type:[String]},displayFormat:{default:function(){return this.trans("YYYY-MM-DD")},type:[String]},weekdays:{default:function(){return[this.trans("Mo"),this.trans("Tu"),this.trans("We"),this.trans("Th"),this.trans("Fr"),this.trans("Sa"),this.trans("So")]},type:[Array]},months:{default:function(){return[this.trans("Jan"),this.trans("Feb"),this.trans("Mar"),this.trans("Apr"),this.trans("May"),this.trans("Jun"),this.trans("Jul"),this.trans("Aug"),this.trans("Sep"),this.trans("Oct"),this.trans("Nov"),this.trans("Dec")]},type:[Array]}},computed:{yearsGrid:function(){return this.tempValue.getYears()},monthsGrid:function(){return this.tempValue.getMonths()},datesGrid:function(){return this.tempValue.getDatesGrid()}},watch:{value:function(){var t=a.Now.make(this.value);!1!==t.valid()&&this.value!==this.nativeValue.format(this.format)&&(this.nativeValue=this.tempValue=a.Now.make(this.value))},tempValue:function(){var t=this;this.$nextTick((function(){return t.$refs.modal.refresh()}))},arrive:function(){this.arrive!==this.nativeArrive.format(this.format)&&(this.nativeArrive=this.tempArrive=a.Now.make(this.arrive))},depart:function(){this.depart!==this.nativeDepart.format(this.format)&&(this.nativeDepart=this.tempDepart=a.Now.make(this.depart))},visible:function(){this.nativeRange=[]},nativeRange:function(){void 0!==this.nativeRange[0]&&(this.tempArrive=this.nativeRange[0]),2===this.nativeRange.length&&(void 0!==this.nativeRange[0]&&(this.nativeArrive=this.nativeRange[0]),void 0!==this.nativeRange[1]&&(this.nativeDepart=this.nativeRange[1]),this.$emit("update:arrive",this.nativeArrive.format(this.format)),this.$emit("update:depart",this.nativeDepart.format(this.format)),this.visible=!1)}},data:function(){return{nativeView:"date",visible:!1,nativeRange:[],tempArrive:a.Now.make(this.arrive),nativeArrive:a.Now.make(this.arrive),tempDepart:a.Now.make(this.depart),nativeDepart:a.Now.make(this.depart),tempValue:a.Now.make(this.value),nativeValue:a.Now.make(this.value)}},methods:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},c.a),renderToolbar:function(t){var e=this,n=t.prev,r=t.next,o=this.$createElement;return n=a.Obj.assign({props:{type:"link",icon:this.icons.angleLeft,square:!0,round:!0}},n),r=a.Obj.assign({props:{type:"link",icon:this.icons.angleRight,square:!0,round:!0}},r),o("div",{class:"n-datepicker__toolbar"},[o("div",{class:"n-datepicker__display"},[o("span",{class:"n-datepicker__month",on:{click:function(){return e.nativeView="month"}}},[this.months[this.tempValue.month()]]),o("span",{class:"n-datepicker__year",on:{click:function(){return e.nativeView="year"}}},[this.tempValue.year()])]),o("div",{class:"n-datepicker__prev"},[o("NButton",s()([{},n]))]),o("div",{class:"n-datepicker__next"},[o("NButton",s()([{},r]))])])},renderDateItem:function(t){var e=this,n=this.$createElement,r=["n-datepicker__day"];t.equalDate("now")&&r.push("n-datepicker__day--today"),t.equalDate(this.nativeValue)&&r.push("n-datepicker__day--selected"),t.month()===this.tempValue.month()&&r.push("n-datepicker__day--current");var o={click:function(){e.$emit("input",t.format(e.format)),e.visible=!1}};return n("div",s()([{},{on:o},{class:r}]),[n("span",[t.format("DD")])])},renderDateRangeItem:function(t){var e=this,n=this.$createElement,r=["n-datepicker__day"];t.equalDate("now")&&r.push("n-datepicker__day--today"),t.month()===this.tempValue.month()&&r.push("n-datepicker__day--current"),0===this.nativeRange.length&&t.equalDate(this.nativeArrive)&&(this.nativeArrive.equalDate(this.nativeDepart)||r.push(this.nativeArrive.before(this.nativeDepart)?"n-datepicker__day--arrive":"n-datepicker__day--depart"),r.push("n-datepicker__day--selected")),0===this.nativeRange.length&&t.equalDate(this.nativeDepart)&&(this.nativeDepart.equalDate(this.nativeArrive)||r.push(this.nativeDepart.before(this.nativeArrive)?"n-datepicker__day--arrive":"n-datepicker__day--depart"),r.push("n-datepicker__day--selected")),1===this.nativeRange.length&&t.equalDate(this.tempArrive)&&!t.equalDate(this.tempDepart)&&r.push(this.tempArrive.before(this.tempDepart)?"n-datepicker__day--arrive":"n-datepicker__day--depart"),1===this.nativeRange.length&&t.equalDate(this.tempDepart)&&!t.equalDate(this.tempArrive)&&r.push(this.tempDepart.before(this.tempArrive)?"n-datepicker__day--arrive":"n-datepicker__day--depart"),1===this.nativeRange.length&&t.between(this.tempArrive,this.tempDepart)&&r.push("n-datepicker__day--between"),0===this.nativeRange.length&&t.between(this.nativeArrive,this.nativeDepart)&&r.push("n-datepicker__day--between"),0===this.nativeRange.length&&t.between(this.nativeArrive,this.nativeDepart)&&r.push("n-datepicker__day--selected");var o={click:function(){e.nativeRange.push(t)},mouseenter:function(){e.tempDepart=t}};return n("div",s()([{},{on:o},{class:r}]),[n("span",[t.format("DD")])])},renderDate:function(){var t=this,e=this.$createElement,n={on:{click:function(){return t.tempValue=t.tempValue.prevMonth()}}},r={on:{click:function(){return t.tempValue=t.tempValue.nextMonth()}}};return e("div",{class:"n-datepicker__dateview"},[e("div",{class:"n-datepicker__header"},[this.ctor("renderToolbar")({prev:n,next:r})]),e("div",{class:"n-datepicker__legend"},[a.Arr.each(this.weekdays,(function(t){return e("div",{class:"n-datepicker__day"},[e("span",[t])])}))]),e("div",{class:"n-datepicker__body"},[a.Arr.each(a.Arr.chunk(this.datesGrid,7),(function(n){return e("div",{class:"n-datepicker__week"},[a.Arr.each(n,t.ctor(t.range?"renderDateRangeItem":"renderDateItem"))])}))])])},renderMonthItem:function(t){var e=this,n=this.$createElement,r=["n-datepicker__month"];t.equalDate(this.nativeValue)&&r.push("n-datepicker__month--selected"),t.month()===a.Now.make().month()&&r.push("n-datepicker__month--current");var o={click:function(){e.tempValue=t,e.nativeView="date"}};return n("div",s()([{},{on:o},{class:r}]),[n("span",[this.months[t.month()]])])},renderMonth:function(){var t=this,e=this.$createElement,n={on:{click:function(){return t.tempValue=t.tempValue.prevYear()}}},r={on:{click:function(){return t.tempValue=t.tempValue.nextYear()}}};return e("div",{class:"n-datepicker__monthview"},[e("div",{class:"n-datepicker__header"},[this.ctor("renderToolbar")({prev:n,next:r})]),e("div",{class:"n-datepicker__body"},[e("div",{class:"n-datepicker__year"},[a.Arr.each(this.monthsGrid,this.ctor("renderMonthItem"))])]),e("div",{class:"n-datepicker__footer"},[e("NButton",{attrs:{type:"link"},on:{click:function(){return t.nativeView="date"}}},[this.trans("Go back")])])])},renderYearItem:function(t){var e=this,n=this.$createElement,r=["n-datepicker__year"];t.equal(this.nativeValue,"YYYY")&&r.push("n-datepicker__year--selected"),t.year()===a.Now.make().year()&&r.push("n-datepicker__year--current");var o={click:function(){e.tempValue=t,e.nativeView="month"}};return n("div",s()([{},{on:o},{class:r}]),[n("span",[t.year()])])},renderYear:function(){var t=this,e=this.$createElement,n={on:{click:function(){return t.tempValue=t.tempValue.prevDecade()}}},r={on:{click:function(){return t.tempValue=t.tempValue.nextDecade()}}};return e("div",{class:"n-datepicker__yearview"},[e("div",{class:"n-datepicker__header"},[this.ctor("renderToolbar")({prev:n,next:r})]),e("div",{class:"n-datepicker__body"},[e("div",{class:"n-datepicker__decade"},[a.Arr.each(this.yearsGrid,this.ctor("renderYearItem"))])]),e("div",{class:"n-datepicker__footer"},[e("NButton",{attrs:{type:"link"},on:{click:function(){return t.nativeView="date"}}},[this.trans("Go back")])])])},renderInput:function(){var t=this,e=this.$createElement,n=["n-datepicker","n-datepicker--"+this.size];!0===this.clearable&&n.push("n-datepicker--clearable"),!0===this.disabled&&n.push("n-datepicker--disabled");return e("div",{class:n},[e("div",{class:"n-datepicker__icon"},[e("span",{class:this.icons.calendar})]),e("div",{class:"n-datepicker__input"},[e("input",{attrs:{type:"text",disabled:this.disabled,placeholder:this.placeholder},domProps:{value:this.value?this.nativeValue.format(this.displayFormat):""},on:{input:function(e){if(e.target.value.length===t.displayFormat.length){var n=a.Now.make(e.target.value);!1!==n.valid()&&t.$emit("input",n.format(t.format))}}}})]),this.clearable&&e("NButton",{attrs:{type:"input",icon:this.icons.times,disabled:this.disabled||a.Any.isEmpty(this.value)},on:{mousedown:function(e){return e.stopPropagation(),t.$emit("input",t.clearValue),void(t.visible=!1)}}})])},renderRangeInput:function(){var t=this,e=this.$createElement,n=["n-datepicker","n-datepicker--"+this.size];!0===this.clearable&&n.push("n-datepicker--clearable"),!0===this.disabled&&n.push("n-datepicker--disabled");return e("div",{class:n},[e("div",{class:"n-datepicker__icon"},[e("span",{class:this.icons.calendar})]),e("div",{class:"n-datepicker__input n-datepicker__input--range"},[e("input",{attrs:{type:"text",disabled:this.disabled,placeholder:this.placeholderArrive},domProps:{value:this.nativeArrive.format(this.displayFormat)},on:{input:function(e){if(e.target.value.length===t.displayFormat.length){var n=a.Now.make(e.target.value);!1!==n.valid()&&(t.$emit("update:arrive",n.format(t.format)),t.$emit("update:depart",t.nativeDepart.format(t.format)))}}}})]),e("span",{class:"n-datepicker__seperator"},[e("span",[this.rangeSeparator])]),e("div",{class:"n-datepicker__input n-datepicker__input--range"},[e("input",{attrs:{type:"text",disabled:this.disabled,placeholder:this.placeholderDepart},domProps:{value:this.nativeDepart.format(this.displayFormat)},on:{input:function(e){if(e.target.value.length===t.displayFormat.length){var n=a.Now.make(e.target.value);!1!==n.valid()&&(t.$emit("update:depart",n.format(t.format)),t.$emit("update:arrive",t.nativeArrive.format(t.format)))}}}})]),this.clearable&&e("NButton",{attrs:{type:"input",icon:this.icons.times,disabled:this.disabled||a.Any.isEmpty(this.arrive)&&a.Any.isEmpty(this.depart)},on:{mtimesusedown:function(e){return e.stopPropagation(),t.$emit("update:arrive",t.clearValue),t.$emit("update:depart",t.clearValue),void(t.visible=!1)}}})])},render:function(){var t=this,e=arguments[0];return e("div",{class:"n-datepicker__wrapper"},[this.ctor(this.range?"renderRangeInput":"renderInput")(),e("NPopover",{ref:"modal",attrs:{trigger:"click",type:"datepicker",width:300,position:this.position,disabled:this.disabled,closeInside:!1},model:{value:t.visible,callback:function(e){t.visible=e}}},[this.ctor("render"+a.Str.ucfirst(this.nativeView))()])])}};o.a.component(h.name,h)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0),c={name:"NTimepicker",props:{value:{default:function(){return"now"}},clearValue:{default:function(){return null}},placeholder:{default:function(){return this.trans("Select time")},type:[String]},size:{default:function(){return null}},position:{default:function(){return"bottom-start"},type:[String]},disabled:{default:function(){return!1},type:[Boolean]},clearable:{default:function(){return!1},type:[Boolean]},format:{default:function(){return"YYYY-MM-DD HH:mm:ss"},type:[String]},displayFormat:{default:function(){return this.trans("HH:mm:ss")},type:[String]},hoursInterval:{default:function(){return 1},type:[Number]},minutesInterval:{default:function(){return 1},type:[Number]},secondsInterval:{default:function(){return 1},type:[Number]}},computed:{hoursGrid:function(){return this.veValue.getHours(this.hoursInterval)},minutesGrid:function(){return this.veValue.getMinutes(this.minutesInterval)},secondsGrid:function(){return this.veValue.getSeconds(this.secondsInterval)}},watch:{value:function(){this.value!==this.veValue.format(this.format)&&(this.veValue=a.Now.make(this.value))}},data:function(){return{veOpen:!1,veValue:a.Now.make(this.value)}},methods:{eventInput:function(t){if(t.target.value.length===this.displayFormat.length){var e=a.Now.make(t.target.value,this.displayFormat);if(e.moment.isValid()){var n=this.veValue.moment.set({hour:e.moment.hour(),minute:e.moment.minute(),second:e.moment.second()});this.veValue=a.Now.make(n),this.$emit("input",this.veValue.format(this.format))}}},eventClear:function(){this.veValue=a.Now.make("now"),this.$emit("input",this.clearValue)},eventSelect:function(t){this.veValue=t.clone(),this.$emit("input",this.veValue.format(this.format))},eventPopoverInput:function(t){this.veOpen=t}},renderToolbar:function(){var t=this.$createElement;return t("div",{class:"n-timepicker__toolbar"},[t("div",{class:"n-timepicker-display"},[t("span",{class:"n-timepicker__time"},[this.veValue.format(this.displayFormat)||this.placeholder])])])},renderIcon:function(){var t=this.$createElement;return t("div",{class:"n-timepicker__icon"},[t("span",{class:this.icons.clock})])},renderClear:function(){var t=this.$createElement;if(!this.clearable)return null;var e={type:"input",icon:this.icons.times};!this.disabled&&this.value||(e.disabled=!0);var n={click:this.eventClear};return t("NButton",s()([{},{props:e},{},{on:n}]))},renderInput:function(){var t=this.$createElement,e={type:"text",placeholder:this.placeholder,disabled:this.disabled},n={input:this.eventInput},r="";return this.value&&(r=this.veValue.format(this.displayFormat)),t("div",{class:"n-timepicker__input"},[t("input",s()([{domProps:{value:r}},{attrs:e},{},{on:n}]))])},renderTimepicker:function(){return(0,this.$createElement)("div",{class:["n-timepicker","n-timepicker--"+this.size]},[this.ctor("renderIcon")(),this.ctor("renderInput")(),this.ctor("renderClear")()])},renderHourItem:function(t){var e=this,n=this.$createElement,r=["n-timepicker__item"];this.veValue.valid()&&t.hour()===this.veValue.hour()&&r.push("n-active");var o={click:function(){return e.eventSelect(t)}};return n("div",s()([{},{on:o},{class:r}]),[n("span",[t.format("HH")])])},renderHourPanel:function(){var t=this.$createElement;return this.displayFormat.match("HH")?t("div",{class:"n-timepicker__panel"},[t("NScrollbar",[a.Arr.each(this.hoursGrid,this.ctor("renderHourItem"))])]):null},renderMinuteItem:function(t){var e=this,n=this.$createElement,r=["n-timepicker__item"];this.veValue.valid()&&t.minute()===this.veValue.minute()&&r.push("n-active");var o={click:function(){return e.eventSelect(t)}};return n("div",s()([{},{on:o},{class:r}]),[n("span",[t.format("mm")])])},renderMinutePanel:function(){var t=this.$createElement;return this.displayFormat.match("mm")?t("div",{class:"n-timepicker__panel"},[t("NScrollbar",[a.Arr.each(this.minutesGrid,this.ctor("renderMinuteItem"))])]):null},renderSecondItem:function(t){var e=this,n=this.$createElement,r=["n-timepicker__item"];this.veValue.valid()&&t.second()===this.veValue.second()&&r.push("n-active");var o={click:function(){return e.eventSelect(t)}};return n("div",s()([{},{on:o},{class:r}]),[n("span",[t.format("ss")])])},renderSecondPanel:function(){var t=this.$createElement;return this.displayFormat.match("ss")?t("div",{class:"n-timepicker__panel"},[t("NScrollbar",[a.Arr.each(this.secondsGrid,this.ctor("renderSecondItem"))])]):null},renderPopover:function(){var t=this.$createElement,e={type:"timepicker",trigger:"click",visible:this.veOpen,size:this.size,position:this.position,disabled:this.disabled},n={input:this.eventPopoverInput};return t("NPopover",s()([{ref:"popover"},{props:e},{},{on:n}]),[t("div",{class:"n-timepicker__time"},[t("div",{class:"n-timepicker__header"},[this.ctor("renderToolbar")()]),t("div",{class:"n-timepicker__body"},[this.ctor("renderHourPanel")(),this.ctor("renderMinutePanel")(),this.ctor("renderSecondPanel")()])])])},render:function(){var t=arguments[0],e=["n-timepicker__wrapper"];return this.disabled&&e.push("n-disabled"),t("div",{class:e},[this.ctor("renderTimepicker")(),this.ctor("renderPopover")()])}};o.a.component(c.name,c)},function(t,e,n){"use strict";n.r(e);var r=n(4),o=n.n(r),i=n(3),s=n.n(i),a=n(0);function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l={name:"NTransfer",props:{value:{default:function(){return[]},type:[Array]},items:{default:function(){return[]},type:[Array]},sourceLabel:{default:function(){return this.trans("Source")},type:[String]},targetLabel:{default:function(){return this.trans("Target")},type:[String]},labelProp:{default:function(){return"label"},type:[String]},uniqueProp:{default:function(){return"id"},type:[String]}},computed:{veSource:function(){var t=this,e=a.Arr.filter(this.items,(function(e){return!a.Arr.find(t.veValue,c({},t.uniqueProp,e[t.uniqueProp]))}));if(a.Any.isEmpty(this.veSourceSearch))return a.Arr.clone(e);var n=new RegExp(this.veSourceSearch);return e=a.Arr.filter(e,(function(e){return e[t.labelProp].match(n)})),a.Arr.clone(e)},veTarget:function(){var t=this,e=a.Arr.filter(this.items,(function(e){return!!a.Arr.find(t.veValue,c({},t.uniqueProp,e[t.uniqueProp]))}));if(a.Any.isEmpty(this.veTargetSearch))return a.Arr.clone(e);var n=new RegExp(this.veTargetSearch);return e=a.Arr.filter(e,(function(e){return e[t.labelProp].match(n)})),a.Arr.clone(e)}},data:function(){return{veID:Object(a.UUID)(),veValue:this.value,veSourceSearch:"",veTargetSearch:""}},methods:{moveItemsTarget:function(t){var e=this;a.Arr.each(t.split(","),(function(t){var n=a.Arr.find(e.items,c({},e.uniqueProp,t));a.Arr.add(e.veValue,n,c({},e.uniqueProp,t))})),this.$emit("input",this.veValue)},moveItemsSource:function(t){var e=this;a.Arr.each(t.split(","),(function(t){a.Arr.remove(e.veValue,c({},e.uniqueProp,t))})),this.$emit("input",this.veValue)},moveToSource:function(){var t=this;a.Arr.each(this.$refs.target.veSelected,(function(e){a.Arr.remove(t.veValue,c({},t.uniqueProp,e))})),this.$refs.target.unselectAllItems(),this.$emit("input",this.veValue)},moveToTarget:function(){var t=this;a.Arr.each(this.$refs.source.veSelected,(function(e){var n=a.Arr.find(t.items,c({},t.uniqueProp,e));a.Arr.add(t.veValue,n,e,c({},t.uniqueProp,e))})),this.$refs.source.unselectAllItems(),this.$emit("input",this.veValue)},toggleSourceSelected:function(){this.$refs.source.toggleAllItems(this.$refs.source.isIntermediate(!0))},toggleTargetSelected:function(){this.$refs.target.toggleAllItems(this.$refs.target.isIntermediate(!0))}},renderSourceSelect:function(){var t=this.$createElement,e={input:this.toggleSourceSelected},n={disabled:!this.veSource.length},r=Object(a.UUID)();return this.$refs.source&&this.veSource.length&&(n.checked=this.$refs.source.isAllSelected(!0),n.intermediate=this.$refs.source.isIntermediate(!0),r=a.Any.md5(this.$refs.source.veSelected)),t("div",{class:"n-transfer__select"},[t("NCheckbox",s()([{key:r},{props:n},{},{on:e}]))])},renderSourceTitle:function(){var t=this.$createElement,e=t("span",{class:"n-transfer__item-title"},[this.sourceLabel]),n=t("span",{key:Object(a.UUID)(),class:"n-transfer__item-count"},[this.veSource.length]);return t("div",{class:"n-transfer__title"},[[e,n]])},renderSourceHeader:function(){return(0,this.$createElement)("div",{class:"n-transfer__header"},[this.ctor("renderSourceSelect")(),this.ctor("renderSourceTitle")()])},renderSourceSearch:function(){var t=this,e=this.$createElement,n={placeholder:this.trans("Search item"),icon:this.icons.times,iconDisabled:!this.veSourceSearch},r={iconClick:function(){return t.veSourceSearch=""},input:function(){return t.$refs.source.unselectAllItems()}};return e("div",{class:"n-transfer__search"},[e("NInput",s()([{},{props:n},{},{on:r},{model:{value:t.veSourceSearch,callback:function(e){t.veSourceSearch=e}}}]))])},renderSourceBody:function(){var t=this.$createElement,e={group:[this.veID],items:this.veSource,renderSelect:!0,viewportHeight:!0,disableMove:!0,updateDelay:100,renderNode:this.ctor("renderNode")},n={move:this.moveItemsSource};return t("div",{class:"n-transfer__body"},[t("NDraggable",s()([{ref:"source"},{props:e},{},{on:n}]))])},renderTargetSelect:function(){var t=this.$createElement,e={input:this.toggleTargetSelected},n={disabled:!this.veTarget.length},r=Object(a.UUID)();return this.$refs.target&&this.veTarget.length&&(n.checked=this.$refs.target.isAllSelected(!0),n.intermediate=this.$refs.target.isIntermediate(!0),r=a.Any.md5(this.$refs.target.veSelected)),t("div",{class:"n-transfer__select"},[t("NCheckbox",s()([{key:r},{props:n},{},{on:e}]))])},renderTargetTitle:function(){var t=this.$createElement,e=t("span",{class:"n-transfer__item-title"},[this.targetLabel]),n=t("span",{key:Object(a.UUID)(),class:"n-transfer__item-count"},[this.veTarget.length]);return t("div",{class:"n-transfer__title"},[[e,n]])},renderTargetHeader:function(){return(0,this.$createElement)("div",{class:"n-transfer__header"},[this.ctor("renderTargetSelect")(),this.ctor("renderTargetTitle")()])},renderTargetSearch:function(){var t=this,e=this.$createElement,n={placeholder:this.trans("Search item"),icon:this.icons.times,iconDisabled:!this.veTargetSearch},r={iconClick:function(){return t.veTargetSearch=""},input:function(){return t.$refs.target.unselectAllItems()}};return e("div",{class:"n-transfer__search"},[e("NInput",s()([{},{props:n},{},{on:r},{model:{value:t.veTargetSearch,callback:function(e){t.veTargetSearch=e}}}]))])},renderTargetBody:function(){var t=this.$createElement,e={group:[this.veID],items:this.veTarget,renderSelect:!0,viewportHeight:!0,disableMove:!0,updateDelay:100,renderNode:this.ctor("renderNode")},n={move:this.moveItemsTarget};return t("div",{class:"n-transfer__body"},[t("NDraggable",s()([{ref:"target"},{props:e},{},{on:n}]))])},renderNode:function(t){var e=this.$createElement;return this.$scopedSlots.default?this.$scopedSlots.default(t):e("div",{class:"n-transfer__item"},[t.value[this.labelProp]])},renderMoveSource:function(){var t=this.$createElement,e={click:this.moveToTarget},n={square:!0,disabled:!0,icon:this.icons.angleRight};return this.$refs.source&&(n.disabled=!this.$refs.source.veSelected.length),t("NButton",s()([{key:Object(a.UUID)()},{props:n},{},{on:e}]))},renderMoveTarget:function(){var t=this.$createElement,e={click:this.moveToSource},n={square:!0,disabled:!0,icon:this.icons.angleLeft};return this.$refs.target&&(n.disabled=!this.$refs.target.veSelected.length),t("NButton",s()([{key:Object(a.UUID)()},{props:n},{},{on:e}]))},render:function(t){var e=arguments[0];return this.$render=t,e("div",{class:"n-transfer"},[e("div",{class:"n-transfer__pane"},[this.ctor("renderSourceHeader")(),this.ctor("renderSourceSearch")(),this.ctor("renderSourceBody")()]),e("div",{class:"n-transfer__controls"},[this.ctor("renderMoveSource")(),this.ctor("renderMoveTarget")()]),e("div",{class:"n-transfer__pane"},[this.ctor("renderTargetHeader")(),this.ctor("renderTargetSearch")(),this.ctor("renderTargetBody")()])])}};o.a.component(l.name,l)}])}));